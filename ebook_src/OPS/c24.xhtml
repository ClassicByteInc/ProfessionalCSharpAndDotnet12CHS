<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops"
    xmlns:svg="http://www.w3.org/2000/svg" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en"
    imt-state="dual" imt-trans-position="after">

<head>
    <title>24 ASP.NET Core --- 24 ASP.NET Core</title>
    <link href="WileyTemplate_v5.5.css" rel="stylesheet" type="text/css" />
    <meta content="urn:uuid:e0000000-0000-0000-0000-000006715209" name="Adept.expected.resource" />
    <style data-id="immersive-translate-input-injected-css">
        .immersive-translate-input {
            position: absolute;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            z-index: 2147483647;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .immersive-translate-attach-loading::after {
            content: " ";

            --loading-color: #f78fb6;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: block;
            margin: 12px auto;
            position: relative;
            color: white;
            left: -100px;
            box-sizing: border-box;
            animation: immersiveTranslateShadowRolling 1.5s linear infinite;

            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-2000%, -50%);
            z-index: 100;
        }

        .immersive-translate-loading-spinner {
            vertical-align: middle !important;
            width: 10px !important;
            height: 10px !important;
            display: inline-block !important;
            margin: 0 4px !important;
            border: 2px rgba(221, 244, 255, 0.6) solid !important;
            border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-radius: 50% !important;
            padding: 0 !important;
            -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
            animation: immersive-translate-loading-animation 0.6s infinite linear !important;
        }

        @-webkit-keyframes immersive-translate-loading-animation {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @keyframes immersive-translate-loading-animation {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(359deg);
            }
        }

        .immersive-translate-input-loading {
            --loading-color: #f78fb6;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: block;
            margin: 12px auto;
            position: relative;
            color: white;
            left: -100px;
            box-sizing: border-box;
            animation: immersiveTranslateShadowRolling 1.5s linear infinite;
        }

        @keyframes immersiveTranslateShadowRolling {
            0% {
                box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            12% {
                box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            25% {
                box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            36% {
                box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color),
                    100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
            }

            50% {
                box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color),
                    110px 0 var(--loading-color), 100px 0 var(--loading-color);
            }

            62% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color),
                    120px 0 var(--loading-color), 110px 0 var(--loading-color);
            }

            75% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    130px 0 var(--loading-color), 120px 0 var(--loading-color);
            }

            87% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
            }

            100% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
            }
        }

        .immersive-translate-toast {
            display: flex;
            position: fixed;
            z-index: 2147483647;
            left: 0;
            right: 0;
            top: 1%;
            width: fit-content;
            padding: 12px 20px;
            margin: auto;
            overflow: auto;
            background: #fef6f9;
            box-shadow: 0px 4px 10px 0px rgba(0, 10, 30, 0.06);
            font-size: 15px;
            border-radius: 8px;
            color: #333;
        }

        .immersive-translate-toast-content {
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        .immersive-translate-toast-hidden {
            margin: 0 20px 0 72px;
            text-decoration: underline;
            cursor: pointer;
        }

        .immersive-translate-toast-close {
            color: #666666;
            font-size: 20px;
            font-weight: bold;
            padding: 0 10px;
            cursor: pointer;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-toast {
                top: 0;
                padding: 12px 0px 0 10px;
            }

            .immersive-translate-toast-content {
                flex-direction: column;
                text-align: center;
            }

            .immersive-translate-toast-hidden {
                margin: 10px auto;
            }
        }

        .immersive-translate-modal {
            display: none;
            position: fixed;
            z-index: 2147483647;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.4);
            font-size: 15px;
        }

        .immersive-translate-modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 40px 24px 24px;
            border: 1px solid #888;
            border-radius: 10px;
            width: 80%;
            max-width: 270px;
            font-family: system-ui, -apple-system, "Segoe UI", "Roboto", "Ubuntu",
                "Cantarell", "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
                "Segoe UI Symbol", "Noto Color Emoji";
            position: relative;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-modal-content {
                margin: 50% auto !important;
            }
        }

        .immersive-translate-modal .immersive-translate-modal-content-in-input {
            max-width: 500px;
        }

        .immersive-translate-modal-content-in-input .immersive-translate-modal-body {
            text-align: left;
            max-height: unset;
        }

        .immersive-translate-modal-title {
            text-align: center;
            font-size: 16px;
            font-weight: 700;
            color: #333333;
        }

        .immersive-translate-modal-body {
            text-align: center;
            font-size: 14px;
            font-weight: 400;
            color: #333333;
            word-break: break-all;
            margin-top: 24px;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-modal-body {
                max-height: 250px;
                overflow-y: auto;
            }
        }

        .immersive-translate-close {
            color: #666666;
            position: absolute;
            right: 16px;
            top: 16px;
            font-size: 20px;
            font-weight: bold;
        }

        .immersive-translate-close:hover,
        .immersive-translate-close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        .immersive-translate-modal-footer {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 24px;
        }

        .immersive-translate-btn {
            width: fit-content;
            color: #fff;
            background-color: #ea4c89;
            border: none;
            font-size: 16px;
            margin: 0 8px;
            padding: 9px 30px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .immersive-translate-btn:hover {
            background-color: #f082ac;
        }

        .immersive-translate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .immersive-translate-btn:disabled:hover {
            background-color: #ea4c89;
        }

        .immersive-translate-cancel-btn {
            /* gray color */
            background-color: rgb(89, 107, 120);
        }

        .immersive-translate-cancel-btn:hover {
            background-color: hsl(205, 20%, 32%);
        }

        .immersive-translate-action-btn {
            background-color: transparent;
            color: #ea4c89;
            border: 1px solid #ea4c89;
        }

        .immersive-translate-btn svg {
            margin-right: 5px;
        }

        .immersive-translate-link {
            cursor: pointer;
            user-select: none;
            -webkit-user-drag: none;
            text-decoration: none;
            color: #007bff;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        .immersive-translate-primary-link {
            cursor: pointer;
            user-select: none;
            -webkit-user-drag: none;
            text-decoration: none;
            color: #ea4c89;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        .immersive-translate-modal input[type="radio"] {
            margin: 0 6px;
            cursor: pointer;
        }

        .immersive-translate-modal label {
            cursor: pointer;
        }

        .immersive-translate-close-action {
            position: absolute;
            top: 2px;
            right: 0px;
            cursor: pointer;
        }

        .imt-image-status {
            background-color: rgba(0, 0, 0, 0.5) !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
            border-radius: 16px !important;
        }

        .imt-image-status img,
        .imt-image-status svg,
        .imt-img-loading {
            width: 28px !important;
            height: 28px !important;
            margin: 0 0 8px 0 !important;
            min-height: 28px !important;
            min-width: 28px !important;
            position: relative !important;
        }

        .imt-img-loading {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAtFBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////oK74hAAAAPHRSTlMABBMIDyQXHwyBfFdDMSw+OjXCb+5RG51IvV/k0rOqlGRM6KKMhdvNyZBz9MaupmxpWyj437iYd/yJVNZeuUC7AAACt0lEQVRIx53T2XKiUBCA4QYOiyCbiAsuuGBcYtxiYtT3f6/pbqoYHVFO5r+iivpo6DpAWYpqeoFfr9f90DsYAuRSWkFnPO50OgR9PwiCUFcl2GEcx+N/YBh6pvKaefHlUgZd1zVe0NbYcQjGBfzrPE8Xz8aF+71D8gG6DHFPpc4a7xFiCDuhaWgKgGIJQ3d5IMGDrpS4S5KgpIm+en9f6PlAhKby4JwEIxlYJV9h5k5nee9GoxHJ2IDSNB0dwdad1NAxDJ/uXDHYmebdk4PdbkS58CIVHdYSUHTYYRWOJblWSyu2lmy3KNFVJNBhxcuGW4YBVCbYGRZwIooipHsNqjM4FbgOQqQqSKQQU9V8xmi1QlgHqQQ6DDBvRUVCDirs+EzGDGOQTCATgtYTnbCVLgsVgRE0T1QE0qHCFAht2z6dLvJQs3Lo2FQoDxWNUiBhaP4eRgwNkI+dAjVOA/kUrIDwf3CG8NfNOE0eiFotSuo+rBiq8tD9oY4Qzc6YJw99hl1wzpQvD7ef2M8QgnOGJfJw+EltQc+oX2yn907QB22WZcvlUpd143dqQu+8pCJZuGE4xCuPXJqqcs5sNpsI93Rmzym1k4Npk+oD1SH3/a3LOK/JpUBpWfqNySxWzCfNCUITuDG5dtuphrUJ1myeIE9bIsPiKrfqTai5WZxbhtNphYx6GEIHihyGFTI69lje/rxajdh0s0msZ0zYxyPLhYCb1CyHm9Qsd2H37Y3lugVwL9kNh8Ot8cha6fUNQ8nuXi5z9/ExsAO4zQrb/ev1yrCB7lGyQzgYDGuxq1toDN/JGvN+HyWNHKB7zEoK+PX11e12G431erGYzwmytAWU56fkMHY5JJnDRR2eZji3AwtIcrEV8Cojat/BdQ7XOwGV1e1hDjGGjXbdArm8uJZtCH5MbcctVX8A1WpqumJHwckAAAAASUVORK5CYII=");
            background-size: 28px 28px;
            animation: image-loading-rotate 1s linear infinite !important;
        }

        .imt-image-status span {
            color: var(--bg-2, #fff) !important;
            font-size: 14px !important;
            line-height: 14px !important;
            font-weight: 500 !important;
            font-family: "PingFang SC", Arial, sans-serif !important;
        }

        @keyframes image-loading-rotate {
            from {
                transform: rotate(360deg);
            }

            to {
                transform: rotate(0deg);
            }
        }
    </style>
    <style data-id="immersive-translate-default-injected-css">
        :root {
            --immersive-translate-theme-underline-borderColor: #72ece9;
            --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
            --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
            --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
            --immersive-translate-theme-highlight-backgroundColor: #ffff00;
            --immersive-translate-theme-dashed-borderColor: #59c1bd;
            --immersive-translate-theme-blockquote-borderColor: #cc3355;
            --immersive-translate-theme-thinDashed-borderColor: #ff374f;
            --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
            --immersive-translate-theme-dashedBorder-borderRadius: 0;
            --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
            --immersive-translate-theme-solidBorder-borderRadius: 0;
            --immersive-translate-theme-dotted-borderColor: #94a3b8;
            --immersive-translate-theme-wavy-borderColor: #72ece9;
            --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
            --immersive-translate-theme-grey-textColor: #2f4f4f;
            --immersive-translate-theme-marker-backgroundColor: #fbda41;
            --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
            --immersive-translate-theme-marker2-backgroundColor: #ffff00;
            --immersive-translate-theme-background-backgroundColor: #dbafaf;
            --immersive-translate-theme-background-backgroundColor-rgb: 219, 175, 175;
            --immersive-translate-theme-background-backgroundOpacity: 12;
            --immersive-translate-theme-opacity-opacity: 10;
        }

        [imt-state="dual"] .immersive-translate-target-translation-pre-whitespace {
            white-space: pre-wrap !important;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container {
            position: absolute;
            background-color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
                sans-serif;
            top: 0;
            width: 600px;
            height: 100%;
            z-index: 2;
            line-height: 1.3;
            font-size: 16px;
        }

        [imt-state="dual"] .immersive-translate-target-wrapper[dir="rtl"] {
            text-align: right;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container .immersive-translate-target-wrapper {
            color: rgb(0, 0, 0);
            white-space: normal;
            position: absolute;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container .immersive-translate-target-wrapper font {
            color: inherit;
            white-space: inherit;
            position: unset;
        }

        [imt-state="translation"] .immersive-translate-target-wrapper &gt;

        br {
            display: none;
        }

        [imt-state="translation"] .immersive-translate-target-translation-block-wrapper {
            margin: 0 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper {
            margin: 8px 0 !important;
            display: inline-block;
        }

        [imt-trans-position="before"] .immersive-translate-target-translation-block-wrapper {
            display: block;
        }

        [imt-trans-position="before"] .immersive-translate-target-translation-block-wrapper {
            margin-top: 0 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-pdf-block-wrapper {
            margin: 0 !important;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-grey-inner {
            color: var(--immersive-translate-theme-grey-textColor);
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-underline-inner {
            border-bottom: 1px solid var(--immersive-translate-theme-underline-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeUnderline-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeUnderline-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
            border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
            padding: 6px;
            margin-top: 2px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
            border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
            padding: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-solidBorder {
            border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
            padding: 6px;
            margin-top: 2px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
            border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
            padding: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeDashed-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeDashed-borderColor) !important;
            text-decoration-style: dashed !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-thinDashed-inner {
            border-bottom: 1px dashed var(--immersive-translate-theme-thinDashed-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-dotted-inner {
            background-image: linear-gradient(to right,
                    var(--immersive-translate-theme-dotted-borderColor) 30%,
                    rgba(255, 255, 255, 0) 0%);
            background-position: bottom;
            background-size: 5px 1px;
            background-repeat: repeat-x;
            padding-bottom: 3px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeDotted-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeDotted-borderColor) !important;
            text-decoration-style: dotted !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-wavy-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-wavy-borderColor) !important;
            text-decoration-style: wavy !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-dashed-inner {
            background: linear-gradient(to right,
                    var(--immersive-translate-theme-dashed-borderColor) 0%,
                    var(--immersive-translate-theme-dashed-borderColor) 50%,
                    transparent 50%,
                    transparent 100%) repeat-x left bottom;
            background-size: 8px 2px;
            padding-bottom: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
            content: "";
            display: block;
            max-width: 80px;
            width: 10%;
            border-top: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
            padding-top: 8px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
            content: "";
            border-left: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
            max-height: 16px;
            height: 16px;
            padding-left: 8px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-highlight-inner {
            background: var(--immersive-translate-theme-highlight-backgroundColor);
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-marker {
            line-height: 1.5em;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-marker2-inner {
            font-weight: bold;
            text-shadow: 10px 0px 3px var(--immersive-translate-theme-marker2-backgroundColor),
                16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
                2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
                -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-marker-inner {
            /* TODO: add more texture */
            background: linear-gradient(to right,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3));
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-weakening {
            opacity: 0.618 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-italic {
            font-style: italic !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-bold {
            font-weight: bold !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-paper {
            margin: 8px 0;
            box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
            padding: 16px 32px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-blockquote {
            border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
            padding-left: 12px !important;
            margin-top: 4px;
            margin-bottom: 4px;
            padding-top: 4px;
            padding-bottom: 4px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-mask-inner {
            filter: blur(5px) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-mask-inner {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner {
            filter: blur(5px) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        /* opacity theme start */

        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner {
            filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-opacity-inner {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner,
        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner:hover {
            filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner:hover {
            filter: none !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-mask-inner:hover {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner:hover {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner:hover {
            filter: none !important;
        }

        /* opacity theme end */

        /* background theme start */
        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-background {
            margin: 8px 0;
            background: rgba(var(--immersive-translate-theme-background-backgroundColor-rgb),
                    calc(var(--immersive-translate-theme-background-backgroundOpacity) * 1%));
            border-radius: 4px;
            box-shadow: unset !important;
            padding: 12px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-background-inner {
            background: rgba(var(--immersive-translate-theme-background-backgroundColor-rgb),
                    calc(var(--immersive-translate-theme-background-backgroundOpacity) * 1%));
            padding-left: 6px;
            padding-right: 6px;
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper .immersive-translate-target-translation-theme-background-inner {
            background: unset;
            padding-left: unset;
            padding-right: unset;
        }

        /* background theme end */

        /* vertical css , please remain it in the last one. */
        .immersive-translate-target-translation-vertical-block-wrapper {
            margin: 0px 8px !important;
        }

        .immersive-translate-text {
            font-size: 15px !important;
        }

        .immersive-translate-error-toast {
            position: fixed;
            top: 5%;
            z-index: 99999999;
            left: 0;
            right: 0;
            margin: auto;
            max-width: 300px;
            padding: 16px;
            border-radius: 12px;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: row;
            justify-content: space-between;
        }

        @media all and (min-width: 750px) {
            .immersive-translate-error-toast {
                max-width: 400px;
            }
        }

        .immersive-translate-clickable-button {
            cursor: pointer;
        }

        .immersive-translate-help-button {
            cursor: pointer;
        }

        .immersive-translate-loading-text:before {
            content: "...";
        }

        /* dark mode for loading */

        @media only screen and (prefers-color-scheme: dark) {
            .immersive-translate-loading {
                border: 2px rgba(255, 255, 255, 0.25) solid !important;
                border-top: 2px rgba(255, 255, 255, 1) solid !important;
            }
        }

        .immersive-translate-error-wrapper {
            position: relative;
            display: inline-flex;
            padding: 6px;
            margin: 0 12px;
            white-space: nowrap;
            font-size: 0.9em;
        }

        [lang="zh-CN"] .immersive-translate-error-wrapper {
            font-size: 0.75em;
        }

        [lang="zh-TW"] .immersive-translate-error-wrapper {
            font-size: 0.75em;
        }

        .immersive-translate-tooltip {
            position: relative;
            display: inline-flex;
            /* little indicater to indicate it's hoverable */
        }

        .immersive-translate-tooltip-content {
            /* here's the magic */
            position: absolute;
            z-index: 100000000000;

            left: 50%;
            bottom: 0;
            transform: translate(-50%, 110%);
            line-height: 1;
            /* and add a small left margin */

            /* basic styles */
            width: max-content;
            max-width: 250px;
            word-wrap: break-word;
            white-space: pre-line;
            padding: 10px;
            border-radius: 10px;
            background: #000c;
            color: #fff;
            text-align: center;
            font-size: 14px;
            display: none;
            /* hide by default */
        }

        .immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
            display: inline-block;
        }

        .immersive-translate-tooltip:hover+.immersive-translate-tooltip-content {
            display: inline-block;
        }

        .immersive-translate-tooltip-content-table {
            left: unset !important;
            bottom: unset !important;
            transform: translate(-10%, 50%) !important;
        }

        .immersive-translate-tooltip:hover:before {
            display: inline-block;
        }

        .immersive-translate-loading-spinner {
            vertical-align: middle !important;
            width: 10px !important;
            height: 10px !important;
            display: inline-block !important;
            margin: 0 4px !important;
            border: 2px rgba(221, 244, 255, 0.6) solid !important;
            border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-radius: 50% !important;
            padding: 0 !important;
            -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
            animation: immersive-translate-loading-animation 0.6s infinite linear !important;
        }

        @-webkit-keyframes immersive-translate-loading-animation {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @keyframes immersive-translate-loading-animation {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(359deg);
            }
        }

        .imt-image-status {
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--bg-2, #fff);
            font-size: 14px;
        }
    </style>
    <style data-id="immersive-translate-user-custom-style">
        :root {

            .immersive-translate-target-inner {
                font-family: inherit;
            }


            .immersive-translate-target-inner {
                font-family: inherit;
            }
        }
    </style>
    <style data-id="immersive-translate-dynamic-injected-css">
        .immersive-translate-target-wrapper[dir='rtl'] {
            text-align: right;
        }

        .immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {
            display: block;
        }

        .immersive-translate-target-wrapper {
            word-break: break-word;
            user-select: text;
        }

        [imt-state="translation"] .immersive-translate-target-wrapper[dir='rtl'] {
            display: inline-block;
        }

        [dir='rtl'] .immersive-translate-target-wrapper:not([dir]) {
            text-align: left;
        }

        [imt-state=dual] .immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
            display: block;
        }

        [imt-trans-position=before] .immersive-translate-target-translation-block-wrapper {
            display: block !important;
        }

        [imt-state][data-immersive-translate_rtl] .immersive-translate-target-wrapper {
            display: block !important;
        }
    </style>
</head>

<body epub:type="bodymatter" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
    <section aria-labelledby="c24_1" epub:type="chapter" role="doc-chapter"
        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
        <header data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <h1 id="c24_1" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1"><span aria-label="687" epub:type="pagebreak" id="Page_687"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span><span id="c24"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span><span
                    class="chapterNumber"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">24</span><br /><span
                    class="chapterTitle" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ASP.NET
                    Core</span></h1>
        </header>
        <section aria-label="chapter opening" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <span id="c24-sec-0001" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <aside data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                <div class="top hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <hr />
                </div>
                <section class="feature3" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <h3 data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                        data-immersive-translate-paragraph="1">WHAT'S IN THIS CHAPTER?<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">本章包含什么内容？</font>
                            </font>
                        </font>
                    </h3>
                    <ul class="check2" id="c24-list-0001"
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <li id="c24-li-0001" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1">Understanding ASP.NET Core and web technologies<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">理解 ASP.NET Core 和 Web 技术
                                    </font>
                                </font>
                            </font>
                        </li>
                        <li id="c24-li-0002" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1">Using static content<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用静态内容</font>
                                </font>
                            </font>
                        </li>
                        <li id="c24-li-0003" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1">Creating middleware components<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">创建中间件组件</font>
                                </font>
                            </font>
                        </li>
                        <li id="c24-li-0004" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1">Working with endpoint routing<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">处理端点路由</font>
                                </font>
                            </font>
                        </li>
                        <li id="c24-li-0005" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1">Working with HTTP request and response<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">处理 HTTP 请求和响应</font>
                                </font>
                            </font>
                        </li>
                        <li id="c24-li-0006" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1">Using sessions for state management<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用会话进行状态管理</font>
                                </font>
                            </font>
                        </li>
                        <li id="c24-li-0007" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1">Hosting web applications with Microsoft Azure<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用 Microsoft Azure 托管 Web
                                        应用程序</font>
                                </font>
                            </font>
                        </li>
                        <li id="c24-li-0008" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1">Creating Docker images<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">创建 Docker 镜像</font>
                                </font>
                            </font>
                        </li>
                    </ul>
                    <div class="bottom hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <hr />
                    </div>
                </section>
            </aside>
            <aside data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                <div class="top hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <hr />
                </div>
                <section class="feature3" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span
                        id="c24-fea-0001" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                    <h3 id="head-2-217" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                        data-immersive-translate-paragraph="1">CODE DOWNLOADS FOR THIS CHAPTER<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">本章代码下载</font>
                            </font>
                        </font>
                    </h3>
                    <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span
                            id="c24-sec-0003"
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                        <p id="c24-para-0003" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1">The source code for this chapter is available on the
                            book page at <code
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="http://www.wiley.com">www.wiley.com</a></code>.
                            Click the Downloads link. The code can also be found at <code
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://github.com/ProfessionalCSharp/ProfessionalCSharp2021">https://github.com/ProfessionalCSharp/ProfessionalCSharp2021</a></code>
                            in the directory <code
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">3_Web/ASPNETCore</code>.
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章的源代码可在书籍页面 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="http://www.wiley.com">www.wiley.com</a></code>
                                        上找到。点击下载链接。代码也可以在目录 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">3_Web/ASPNETCore</code>
                                        中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://github.com/ProfessionalCSharp/ProfessionalCSharp2021">https://github.com/ProfessionalCSharp/ProfessionalCSharp2021</a></code>
                                        找到。</font>
                                </font>
                            </font>
                        </p>
                        <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1">The code for this chapter is divided into the
                            following major examples:<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章的代码分为以下主要示例：</font>
                                </font>
                            </font>
                        </p>
                        <ul class="check" id="c24-list-0002"
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                            <li id="c24-li-0009" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                                data-immersive-translate-paragraph="1">SimpleHost</li>
                            <li id="c24-li-0010" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                                data-immersive-translate-paragraph="1">WebSampleApp</li>
                        </ul>
                        <p id="c24-para-0005" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1">Samples from this chapter mainly use the namespaces
                            <code
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Microsoft.AspNetCore</code>
                            and <code
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">System.Text</code>
                            (and subnamespaces). All the sample projects have <i
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">nullable
                                reference types</i> enabled.<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章的示例主要使用命名空间 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Microsoft.AspNetCore</code>
                                        和 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">System.Text</code>
                                        （及其子命名空间）。所有示例项目都启用了可空引用类型。</font>
                                </font>
                            </font>
                        </p>
                    </section>
                    <div class="bottom hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <hr />
                    </div>
                </section>
            </aside>
        </section>
        <section aria-labelledby="head-2-218" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <span id="c24-sec-0004" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <h2 id="head-2-218" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">UNDERSTANDING WEB TECHNOLOGIES<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">理解 Web 技术</font>
                    </font>
                </font>
            </h2>
            <p id="c24-para-0006" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">After ASP.NET with the .NET Framework was released in 2002,
                ASP.NET Core (the first version released in 2016) was a complete rewrite that not only offers running
                this technology on Linux but also uses modern patterns (for example, dependency injection is built in)
                and offers new ways to create web applications. Razor Pages offer an easy way to create HTML pages mixed
                with C# code with support for dependency <span aria-label="688" epub:type="pagebreak" id="Page_688"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>injection. From the
                outside, ASP.NET Core MVC looks similar to the previous MVC technology with ASP.NET, but inside it's
                very different. Blazor gives a full-stack .NET option. Instead of writing JavaScript code, you can write
                C# code that runs either on the server (Blazor Server) or on the client in a WebAssembly (Blazor WASM).
                Blazor is based on Razor Components that extend the functionality of Razor Pages.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">2002 年 ASP.NET 与.NET Framework
                            发布后，ASP.NET Core（2016 年发布的第一个版本）进行了完全重写，不仅支持在 Linux 上运行这项技术，还采用了现代模式（例如，依赖注入是内置的），并提供了创建 Web
                            应用的新方法。Razor Pages 提供了一种简单的方法，可以在支持依赖注入的情况下混合 C#代码创建 HTML 页面。从外部看，ASP.NET Core MVC 与之前的
                            ASP.NET MVC 技术看起来相似，但内部差异很大。Blazor 提供了全栈.NET 选项。你不必编写 JavaScript 代码，而是可以编写在服务器（Blazor
                            Server）或客户端的 WebAssembly（Blazor WASM）上运行的 C#代码。Blazor 基于 Razor 组件，扩展了 Razor Pages 的功能。
                        </font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0007" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">This chapter covers the foundation of ASP.NET Core. <a
                    href="c25.xhtml" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter
                    25</a>, “Services,” covers services where the Web API with ASP.NET Core plays an important part. For
                binary platform-independent communication, <a href="c25.xhtml"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter 25</a> also covers
                GRPC. <a href="c26.xhtml" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter
                    26</a>, “Razor Pages and MVC,” covers ASP.NET Razor Pages and MVC. <a href="c27.xhtml"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter 27</a>, “Blazor,”
                extends Razor Pages with Razor Components and covers full-stack .NET development with Blazor.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">本章涵盖了 ASP.NET Core 的基础。第 25 章“服务”介绍了
                            Web API 在 ASP.NET Core 中的重要作用，并涵盖了用于二进制平台无关通信的 GRPC。第 26 章“Razor Pages 和 MVC”介绍了 ASP.NET
                            Razor Pages 和 MVC。第 27 章“Blazor”通过 Razor 组件扩展了 Razor Pages，并介绍了使用 Blazor 进行全栈.NET 开发。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0008" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Before I get into the foundations of ASP.NET, I'll spend a few
                pages describing core web technologies that are important to know when creating web applications: HTML,
                CSS, JavaScript, scripting libraries, and WebAssembly.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在深入 ASP.NET 基础之前，我会用几页篇幅介绍创建 Web
                            应用时需要了解的核心 Web 技术：HTML、CSS、JavaScript、脚本库和 WebAssembly。</font>
                    </font>
                </font>
            </p>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0005"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-455" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">HTML </h3>
                <p id="c24-para-0009" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">HTML is the markup language that is interpreted by web
                    browsers. It defines elements to display various headings, tables, lists, and input elements such as
                    text and combo boxes.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">HTML
                                是网页浏览器解释的标记语言。它定义了用于显示各种标题、表格、列表和输入元素（如文本框和组合框）的元素。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0010" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">HTML is a living standard that refers to modern web
                    technologies (<code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://html.spec.whatwg.org/">https://html.spec.whatwg.org/</a></code>)
                    and is continuously improving. It not only contains the semantic structure of web pages with the
                    HTML elements but also styling with CSS, many JavaScript APIs such as the Fetch API, (<code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a></code>),
                    the Storage API (<code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://storage.spec.whatwg.org/">https://storage.spec.whatwg.org/</a></code>),
                    and others.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">HTML 是一个不断发展的现代网络技术标准（ <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://html.spec.whatwg.org/">https://html.spec.whatwg.org/</a></code>
                                ），并且持续改进。它不仅包含使用 HTML 元素定义的网页语义结构，还包含使用 CSS 的样式，以及许多 JavaScript API，如 Fetch API（ <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a></code>
                                ）、Storage API（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://storage.spec.whatwg.org/">https://storage.spec.whatwg.org/</a></code>
                                ）等。</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0006"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-456" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">CSS </h3>
                <p id="c24-para-0011" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Whereas HTML defines the content of web pages, CSS defines
                    the look. In the earlier days of HTML, for example, the list item tag <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">&lt;li&gt;</code> defined
                    whether list elements should be displayed with a circle, a disc, or a square. Now, such information
                    is completely removed from HTML and is instead put into a cascading style sheet (CSS).<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">HTML 定义网页的内容，而 CSS 定义外观。例如，在 HTML
                                的早期，列表项标签 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">&lt;li&gt;</code>
                                定义了列表元素是否以圆形、实心圆或方形显示。现在，这类信息已完全从 HTML 中移除，转而放入层叠样式表（CSS）中。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0012" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">With CSS styles, you can use flexible selectors to select
                    HTML elements, and you can define styles for these elements. You can select an element via its ID or
                    its name, and you can define CSS classes that can be referenced from within the HTML code. With
                    newer versions of CSS, you can define quite complex rules for selecting specific HTML elements.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 CSS 样式，你可以通过灵活的选择器选择 HTML
                                元素，并为这些元素定义样式。你可以通过元素的 ID 或名称选择元素，并可以定义可在 HTML 代码中引用的 CSS 类。通过 CSS 的新版本，你可以为特定的 HTML
                                元素定义相当复杂的规则。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0013" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">As of today, some web project templates make use of
                    Bootstrap, which was originally developed by Twitter, but now a small team at GitHub maintains it
                    (<code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://github.com/twbs/bootstrap">https://github.com/twbs/bootstrap</a></code>).
                    Bootstrap is a collection of CSS and HTML conventions, and you can easily adapt different looks and
                    download ready-to-use templates. Visit <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://getbootstrap.com">https://getbootstrap.com</a></code>
                    for documentation and basic templates.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">截至今天，一些网页项目模板使用了 Bootstrap，它最初由
                                Twitter 开发，但现在由 GitHub 的一个小团队维护（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://github.com/twbs/bootstrap">https://github.com/twbs/bootstrap</a></code>
                                ）。Bootstrap 是一系列 CSS 和 HTML 规范，你可以轻松地调整不同的外观并下载现成的模板。访问 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://getbootstrap.com">https://getbootstrap.com</a></code>
                                获取文档和基本模板。</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0007"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-457" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">JavaScript and TypeScript<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">JavaScript 和 TypeScript</font>
                        </font>
                    </font>
                </h3>
                <p id="c24-para-0014" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Not all platforms and browsers can use .NET code, but nearly
                    every browser understands <i
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">JavaScript</i>. One
                    common misconception about JavaScript is that it has something to do with Java. In fact, only the
                    name is similar because Netscape (the originator of JavaScript) made an agreement with Sun (Sun
                    invented Java) to be allowed to use Java in the name. Today, neither Netscape nor Sun exists. Sun
                    was bought by Oracle, and now Oracle holds the trademark for Java.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">并非所有平台和浏览器都能使用.NET 代码，但几乎所有浏览器都理解
                                JavaScript。关于 JavaScript 的一个常见误解是它与 Java 有关。实际上，只有名称相似，因为 Netscape（JavaScript 的起源者）与
                                Sun（Java 的发明者）达成协议，允许在名称中使用 Java。今天，Netscape 和 Sun 都不存在了。Sun 被 Oracle 收购，现在 Oracle 拥有
                                Java 的商标权。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0015" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Java and JavaScript (and C#) have the same roots—the C
                    programming language. JavaScript is a functional programming language that is not object-oriented,
                    although object-oriented capabilities have been added to it.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">Java 和 JavaScript（以及 C#）有相同的根源——C
                                编程语言。JavaScript 是一种函数式编程语言，不是面向对象的，尽管它已经增加了面向对象的功能。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0016" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">JavaScript enables accessing the <i
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">document object model</i>
                    (DOM) from the HTML page, which makes it possible to change elements dynamically on the client.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">JavaScript 能够从 HTML
                                页面访问文档对象模型（DOM），这使得可以在客户端动态更改元素。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0017" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">ECMAScript is the standard that defines the current and
                    upcoming features of the JavaScript language. Check <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://tc39.es/ecma262/">https://tc39.es/ecma262/</a></code>
                    for the current state and future changes of the JavaScript language. New features are added every
                    year, much like new features are added to C#.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">ECMAScript 是定义 JavaScript
                                语言当前和未来特性的标准。查看 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://tc39.es/ecma262/">https://tc39.es/ecma262/</a></code>
                                了解 JavaScript 语言的当前状态和未来变化。每年都会添加新特性，就像 C#一样。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0018" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1"><span aria-label="689" epub:type="pagebreak" id="Page_689"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>Even though many
                    browsers don't support the newest ECMAScript version, you can still write new ECMAScript code.
                    Instead of writing JavaScript code, you can use <i
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">TypeScript</i>. The
                    TypeScript syntax is based on ECMAScript, but it has some enhancements, such as strongly typed code
                    and annotations. You'll find many similarities between C# and TypeScript. Because the TypeScript
                    compiler transpiles (or compiles) to JavaScript, TypeScript can be used in every place where
                    JavaScript is needed. For more information on TypeScript, check <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://www.typescriptlang.org">https://www.typescriptlang.org</a></code>.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">尽管许多浏览器不支持最新的 ECMAScript
                                版本，但你仍然可以编写新的 ECMAScript 代码。与其编写 JavaScript 代码，你可以使用 TypeScript。TypeScript 的语法基于
                                ECMAScript，但它有一些增强功能，例如强类型代码和注释。你会发现 C#和 TypeScript 之间有许多相似之处。因为 TypeScript 编译器将
                                TypeScript 转译（或编译）为 JavaScript，所以 TypeScript 可以用在所有需要 JavaScript 的地方。有关 TypeScript
                                的更多信息，请查看 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://www.typescriptlang.org">https://www.typescriptlang.org</a></code>
                                。</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0008"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-458" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Scripting Libraries <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">脚本库</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">In addition to the JavaScript programming language, you might
                    need scripting libraries. Scripting libraries can be used on the client in combination with the
                    server-side functionality of ASP.NET Core.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">除了 JavaScript
                                编程语言，你可能还需要脚本库。脚本库可以与 ASP.NET Core 的服务器端功能结合使用，在客户端运行。</font>
                        </font>
                    </font>
                </p>
                <ul class="check" id="c24-list-0003"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <li id="c24-li-0011" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                        data-immersive-translate-paragraph="1">jQuery (supported by the OpenJS Foundation <code
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://openjsf.org">https://openjsf.org</a></code>)
                        is a library that abstracts browser differences when accessing DOM elements and reacting to
                        events. A few years ago, this library was used with nearly every website. Today, more options
                        are available, and you can't expect to have jQuery available everywhere.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">jQuery（由 OpenJS 基金会支持 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://openjsf.org">https://openjsf.org</a></code>
                                    ）是一个抽象化浏览器差异的库，用于访问 DOM 元素和响应事件。几年前，这个库几乎被每个网站使用。如今，有更多选择可供使用，你无法期望 jQuery 无处不在。
                                </font>
                            </font>
                        </font>
                    </li>
                    <li id="c24-li-0012" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                        data-immersive-translate-paragraph="1">Angular (<code
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://angular.io">https://angular.io</a></code>)
                        is a library from Google based on the MVC pattern for simplifying development and testing with
                        single-page web applications. (Unlike ASP.NET MVC, Angular offers the MVC pattern with
                        client-side code.)<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">Angular（ <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://angular.io">https://angular.io</a></code>
                                    ）是 Google 基于 MVC 模式开发的库，用于简化单页 Web 应用的开发和测试。（与 ASP.NET MVC 不同，Angular 提供的是带有客户端代码的
                                    MVC 模式。）</font>
                            </font>
                        </font>
                    </li>
                    <li id="c24-li-0013" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                        data-immersive-translate-paragraph="1">React (<code
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://reactjs.org">https://reactjs.org</a></code>)
                        is a library from Facebook that offers functionality to easily update user interfaces as data
                        changes in the background.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">React（ <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://reactjs.org">https://reactjs.org</a></code>
                                    ）是 Facebook 提供的库，它提供了在后台数据变化时轻松更新用户界面的功能。</font>
                            </font>
                        </font>
                    </li>
                </ul>
                <p id="c24-para-0020" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">ASP.NET Core templates for Visual Studio include templates
                    for Angular and React. Visual Studio 2019 and Visual Studio Code support IntelliSense and debugging
                    JavaScript and TypeScript code.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">Visual Studio 的 ASP.NET Core 模板包括
                                Angular 和 React 模板。Visual Studio 2019 和 Visual Studio Code 支持 JavaScript 和 TypeScript
                                代码的 IntelliSense 和调试。</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0009"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-459" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">WebAssembly </h3>
                <p id="c24-para-0021" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">WebAssembly is another standard with HTML technologies (<code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://webassembly.org/">https://webassembly.org/</a></code>).
                    WebAssembly allows writing binary code that's running in the browser so that not only JavaScript
                    code but also the binary WASM code can run in the browser. The code is still running in the
                    sandboxed environment of the browser, so it's safe to run this binary code on the client. The goal
                    is to allow the creation of applications that need more CPU power to run in the browser, such as
                    photo and video editing tools, CAD applications, and virtual reality and virtual machines (<code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://webassembly.org/docs/use-cases/">https://webassembly.org/docs/use-cases/</a></code>).
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">WebAssembly 是另一个与 HTML 技术相关的标准（
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://webassembly.org/">https://webassembly.org/</a></code>
                                ）。WebAssembly 允许编写在浏览器中运行的二进制代码，因此不仅 JavaScript 代码，二进制的 WASM
                                代码也可以在浏览器中运行。代码仍然在浏览器的沙盒环境中运行，因此可以在客户端安全地运行此二进制代码。目标是允许创建需要在浏览器中运行更多 CPU
                                资源的应用程序，例如照片和视频编辑工具、CAD 应用程序以及虚拟现实和虚拟机（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://webassembly.org/docs/use-cases/">https://webassembly.org/docs/use-cases/</a></code>
                                ）。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Microsoft ported the .NET runtime to WASM code. This allows
                    running .NET assemblies in the browser. This is used by Blazor, which is a library that can run
                    Razor components either on the server or in the client within WebAssembly. This technology is
                    covered in <a href="c27.xhtml"
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter 27</a>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">微软将 .NET 运行时移植到了 WASM
                                代码。这允许在浏览器中运行 .NET 程序集。Blazor 使用了这项技术，Blazor 是一个可以在服务器上或 WebAssembly 中的客户端内运行 Razor
                                组件的库。这项技术将在第 27 章中介绍。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <div class="top hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <p id="c24-para-0023" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NOTE</b> <i
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Styling web
                                applications and writing JavaScript code is not covered in this book. You can read more
                                about HTML and styles in </i>HTML and CSS: Design and Build Websites<i
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"> by John Duckett
                                (John Wiley &amp; Sons, 2011), and you can get up to speed with </i>Beginning
                            JavaScript, Fifth Edition<i
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">, by Jeremy
                                McPeak and Paul Wilton (Wrox, 2015).</i>
                            <font data-immersive-translate-error-id="43"
                                class="notranslate immersive-translate-target-wrapper immersive-translate-target-wrapper-error"
                                translate="no" lang="zh-CN"></font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section>
        </section>
        <section aria-labelledby="head-2-219" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <span id="c24-sec-0011" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <h2 id="head-2-219" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">CREATING AN ASP.NET CORE WEB PROJECT<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">创建一个 ASP.NET Core 网络项目</font>
                    </font>
                </font>
            </h2>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Now that you have some background about web technologies, let's
                start by creating a simple console application and just a few lines of code to convert it to a web
                application. This first web app sample in this chapter answers HTTP requests and returns simple HTML
                code:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            现在你已经了解了些网络技术，让我们从一个简单的控制台应用程序开始，并添加几行代码将其转换为网络应用程序。本章中的第一个网络应用程序示例会响应 HTTP 请求并返回简单的 HTML
                            代码：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0001"><code>&gt; dotnet new console -o SimpleHost</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1"><span aria-label="690" epub:type="pagebreak" id="Page_690"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>The SDK of the project
                file needs to be changed to <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Microsoft.NET.Sdk.Web</code>
                to reference all of the NuGet packages needed by web applications (project configuration file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SimpleHost.csproj</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">项目文件中的 SDK 需要更改为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Microsoft.NET.Sdk.Web</code>
                            以引用网络应用程序所需的全部 NuGet 包（项目配置文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SimpleHost.csproj</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0002"><code>&lt;Project <b>Sdk="Microsoft.NET.Sdk.Web"</b>&gt;</code>
<code> </code>
<code>  &lt;PropertyGroup&gt;</code>
<code>    &lt;TargetFramework&gt;net5.0&lt;/TargetFramework&gt;</code>
<code>    &lt;Nullable&gt;enable&lt;/Nullable&gt;</code>
<code>  &lt;/PropertyGroup&gt;</code>
<code> </code>
<code>&lt;/Project&gt;</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">With the top-level statements of the application, the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Start</code> method of the
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebHost</code> class is
                invoked. This method has a parameter of <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code>. <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code> is a
                delegate that receives an <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code> as
                parameter and returns a <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Task</code>. The <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code> can be
                used to read the request from the client and send a return. With the sample code, a response containing
                an HTML string is returned. The method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WaitForShutdownAsync</code>
                starts a task and keeps this task running until you use Ctrl+C or SIGTERM to stop the application (code
                file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SimpleHost/Program.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">通过应用程序的顶层语句，会调用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebHost</code> 类的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Start</code>
                            方法。这个方法有一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code>
                            类型的参数。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code>
                            是一个委托，它接收一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>
                            类型的参数并返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Task</code> 类型的值。
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>
                            可以用来读取客户端的请求并发送响应。在示例代码中，返回了一个包含 HTML 字符串的响应。方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WaitForShutdownAsync</code>
                            启动了一个任务，并保持该任务运行，直到你使用 Ctrl+C 或 SIGTERM 停止应用程序（代码文件 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SimpleHost/Program.cs</code>
                            ）。</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0003"><code>using Microsoft.AspNetCore;</code>
<code>using Microsoft.AspNetCore.Hosting;</code>
<code>using Microsoft.AspNetCore.Http;</code>
<code> </code>
<code>await WebHost.Start(async context =&gt;</code>
<code>{</code>
<code>  await context.Response.WriteAsync("&lt;h1&gt;A Simple Host!&lt;/h1&gt;");</code>
<code>}).WaitForShutdownAsync();</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">With this in action, you can start the application with <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet run</code> and access
                it from a browser with the address <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://localhost:5001">https://localhost:5001</a></code>.
                As soon as you request pages from the server, you'll also see log output in the console. ASP.NET Core
                hosting shows info-level log output with every request, such as the following:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">有了这个设置，你可以使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet run</code>
                            启动应用程序，并通过浏览器使用地址 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://localhost:5001">https://localhost:5001</a></code>
                            访问它。一旦你从服务器请求页面，你也会在控制台中看到日志输出。ASP.NET Core 宿主会在每个请求中显示 info 级别的日志输出，例如以下内容：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0004"><code>info: Microsoft.AspNetCore.Hosting.Diagnostics[1]</code>
<code>      Request starting HTTP/2 GET https://localhost:5001/ - -</code>
<code>info: Microsoft.AspNetCore.Hosting.Diagnostics[2]</code>
<code>      Request finished HTTP/2 GET https://localhost:5001/ - - - 200 - - 31.4379ms</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">To see logging output when starting the application (which also
                shows the port numbers the Kestrel server is listening to), you can add an <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">appsettings.json</code> file
                that's read with the default configuration (config file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SimpleHost/appsettings.json</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要在启动应用程序时查看日志输出（同时显示 Kestrel
                            服务器监听的端口号），可以添加一个以默认配置读取的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">appsettings.json</code>
                            文件（配置文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SimpleHost/appsettings.json</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0005"><code>{</code>
<code>  "Logging": {</code>
<code>    "Console": {</code>
<code>      "LogLevel": {</code>
<code>        "Default": "Trace"</code>
<code>      }</code>
<code>    }</code>
<code>  }</code>
<code>}</code></pre>
            <p id="c24-para-0029" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">With this simple web application, you can read the request coming
                in from the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code> and return
                different results based on the requests.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用这个简单的 Web 应用程序，你可以读取来自 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>
                            的请求，并根据请求返回不同的结果。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0030" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebHost</code> class uses the
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code> class discussed
                in <a href="c15.xhtml" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter
                    15</a>, “Dependency Injection and Configuration.” The <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Start</code> method of the
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebHost</code> class
                implicitly invokes the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CreateDefaultBuilder</code>
                of the <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code> class to
                configure several services, adds services for ASP.NET Core, and configures the Kestrel server. See <a
                    href="c19.xhtml" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter
                    19</a>, “Networking,” for information on how to define a custom configuration of the Kestrel server.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1"> <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebHost</code>
                            类使用了在第 15 章“依赖注入和配置”中讨论的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code> 类。
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebHost</code> 类的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Start</code>
                            方法隐式地调用了 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code> 类的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CreateDefaultBuilder</code>
                            来配置多个服务，添加了 ASP.NET Core 的服务，并配置了 Kestrel 服务器。有关如何定义 Kestrel 服务器自定义配置的信息，请参阅第 19 章“网络”。
                        </font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0031" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1"><span aria-label="691" epub:type="pagebreak" id="Page_691"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>You can change the
                configuration of the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebHost</code> class using
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">StartWith</code> where an
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                can be used on further configuration. The <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code> is
                shown later in this chapter when modifying middleware with ASP.NET Core. The <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Services</code> property of
                the <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebHost</code> class
                can be used to register services with the DI container.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">你可以使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">StartWith</code>
                            来更改 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebHost</code>
                            类的配置，其中可以在进一步配置中使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                            。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                            在本章修改 ASP.NET Core 中间件时将稍后显示。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebHost</code> 类的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Services</code>
                            属性可用于向 DI 容器注册服务。</font>
                    </font>
                </font>
            </p>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0012"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-460" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Host Server <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">宿主服务器</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Opening the project with Visual Studio creates the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">launchsetting.json</code>
                    file in the Properties folder. This file is also created when you create a web application using
                    <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet new web</code>.
                    With this file, you can specify environment variables that are used when starting the application,
                    as well as URLs used by the Kestrel server. A profile to run IIS Express is configured in addition
                    to the project command where the Kestrel server is started (configuration file <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SimpleHost/Properties/launchsettings.json</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 Visual Studio 打开项目会在 Properties
                                文件夹中创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">launchsetting.json</code>
                                文件。当您使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet new web</code>
                                创建 Web 应用程序时，此文件也会被创建。通过此文件，您可以指定启动应用程序时使用的环境变量，以及 Kestrel 服务器使用的 URL。除了 Kestrel
                                服务器启动的项目命令（配置文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SimpleHost/Properties/launchsettings.json</code>
                                ）外，还配置了用于运行 IIS Express 的配置文件：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0006"><code>{</code>
<code>  "iisSettings": {</code>
<code>    "windowsAuthentication": false,</code>
<code>    "anonymousAuthentication": true,</code>
<code>    "iisExpress": {</code>
<code>      "applicationUrl": "http://localhost:35246",</code>
<code>      "sslPort": 44397</code>
<code>    }</code>
<code>  },</code>
<code>  "profiles": {</code>
<code>    "IIS Express": {</code>
<code>      "commandName": "IISExpress",</code>
<code>      "launchBrowser": true,</code>
<code>      "environmentVariables": {</code>
<code>        "ASPNETCORE_ENVIRONMENT": "Development"</code>
<code>      }</code>
<code>    },</code>
<code>    "SimpleHost": {</code>
<code>      "commandName": "Project",</code>
<code>      "dotnetRunMessages": "true",</code>
<code>      "launchBrowser": true,</code>
<code>      "applicationUrl": "https://localhost:5001;http://localhost:5000",</code>
<code>      "environmentVariables": {</code>
<code>        "ASPNETCORE_ENVIRONMENT": "Development"</code>
<code>      }</code>
<code>    }</code>
<code>  }</code>
<code>}</code></pre>
                <aside data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <div class="top hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <p id="c24-para-0034" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NOTE</b> <i
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">When you use
                                Visual Studio on Windows, Internet Information Services (IIS) Express is installed with
                                Visual Studio. When you start the web app from Visual Studio, you can select between the
                                different profiles configured in </i> <code
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">launchsettings.json</code>
                            <i data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"> to start the
                                application via </i> <code
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IIS Express</code>
                            <i data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"> or the </i> <code
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SimpleHost</code>
                            <i data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"> profile. The
                                profile with the same name as the application just starts the Kestrel server. When IIS
                                is started, Kestrel is used behind the scenes. To support ASP.NET Core with IIS, a
                                module is installed that forwards the request to the Kestrel server. This Kestrel
                                functionality within IIS can run out of process or in process of the worker process.
                                When you install the ASP.NET runtime on the server where IIS is hosted, make sure to
                                install the Hosting Bundle that includes the IIS module (</i> <code
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://dotnet.microsoft.com/download/dotnet/5.0">https://dotnet.microsoft.com/download/dotnet/5.0</a></code>
                            <i data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">).</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意 当你在 Windows 上使用 Visual
                                        Studio 时，Internet Information Services (IIS) Express 会随 Visual Studio 一起安装。当你从
                                        Visual Studio 启动 Web 应用时，你可以在 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">launchsettings.json</code>
                                        中配置的不同配置文件之间选择，通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IIS Express</code>
                                        或 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SimpleHost</code>
                                        配置文件来启动应用程序。与应用程序同名配置文件仅启动 Kestrel 服务器。当 IIS 启动时，Kestrel 在后台使用。为了支持 IIS 的
                                        ASP.NET Core，会安装一个模块将请求转发给 Kestrel 服务器。IIS 中的 Kestrel
                                        功能可以在进程外或作为工作进程的进程内运行。当你在托管 IIS 的服务器上安装 ASP.NET 运行时时，请确保安装包含 IIS 模块的 Hosting
                                        Bundle ( <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://dotnet.microsoft.com/download/dotnet/5.0">https://dotnet.microsoft.com/download/dotnet/5.0</a></code>
                                        )。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section> <span aria-label="692" epub:type="pagebreak" id="Page_692" role="doc-pagebreak"
                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0014"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-461" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Startup <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">启动</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Let's move into a more powerful web application. Creating an
                    empty web application using <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet new web -o WebSampleApp</code>
                    creates <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Program.cs</code> with a
                    <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Main</code> method
                    using the <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code>
                    class, a <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup.cs</code> file
                    with the <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code>
                    class, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">appsettings.json</code>
                    from the configuration, and <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">launchsettings.json</code>
                    to configure profiles and environment variables. Something that's different with the configuration
                    of the <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code>
                    class than what you've seen in earlier chapters is the use of the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ConfigureWebHostDefaults</code>
                    method and the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStartup</code> method,
                    as shown in the following code snippet. The method <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ConfigureWebHostDefaults</code>
                    configures the Kestrel server and adds IIS integration if it's running on the Windows platform, sets
                    up the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IWebHostEnvironment</code>
                    for static web assets, and configures some middleware modules. With the generic type parameter, the
                    <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStartup</code>
                    method defines the class that should be used next for starting up the server; from the template
                    generated, this is the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code> class
                    (code file <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">让我们进入一个更强大的 Web 应用程序。使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet new web -o WebSampleApp</code>
                                创建一个空 Web 应用程序会创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Program.cs</code>
                                ，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Main</code>
                                方法，通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code>
                                类，一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup.cs</code>
                                文件，包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code>
                                类，从配置中获取 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">appsettings.json</code>
                                ，以及配置文件和环境变量。与 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code>
                                类配置的不同之处在于，与之前章节中看到的不同之处在于使用了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ConfigureWebHostDefaults</code>
                                方法和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStartup</code>
                                方法，如下面的代码片段所示。方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ConfigureWebHostDefaults</code>
                                配置 Kestrel 服务器，如果它在 Windows 平台上运行，则添加 IIS 集成，设置 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IWebHostEnvironment</code>
                                用于静态 Web 资源，并配置一些中间件模块。通过泛型参数， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStartup</code>
                                方法定义了接下来用于启动服务器的类；从模板生成的，这是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code>
                                类（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0007"><code>public class Program</code>
<code>{</code>
<code>  public static void Main(string[] args)</code>
<code>  {</code>
<code>    CreateHostBuilder(args).Build().Run();</code>
<code>  }</code>
<code> </code>
<code>  public static IHostBuilder CreateHostBuilder(string[] args) =&gt;</code>
<code>    Host.CreateDefaultBuilder(args)</code>
<code>      .ConfigureWebHostDefaults(webBuilder =&gt;</code>
<code>      {</code>
<code>        webBuilder.UseStartup&lt;Startup&gt;();</code>
<code>      });</code>
<code>}</code></pre>
                <p id="c24-para-0036" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">With web applications, the dependency injection container
                    usually is configured with the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code> class
                    instead of the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code> class. The
                    <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code> class
                    has two important methods that are invoked dynamically from the ASP.NET Core runtime as shown in the
                    following code snippet: <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ConfigureServices</code>
                    and <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Configure</code>.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">对于 Web 应用程序，依赖注入容器通常使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code>
                                类而不是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code>
                                类进行配置。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code>
                                类有两个重要的方法，这些方法由 ASP.NET Core 运行时动态调用，如下面的代码片段所示： <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ConfigureServices</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Configure</code>
                                。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0037" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ConfigureServices</code>
                    method is used to configure the dependency injection container (you can use the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ConfigureServices</code>
                    method of the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code> class in a
                    similar way). This method has an <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IServiceCollection</code>
                    property that contains all the services already registered in the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Main</code> method, and
                    it allows you to add additional services.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ConfigureServices</code>
                                方法用于配置依赖注入容器（你也可以以类似方式使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code>
                                类的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ConfigureServices</code>
                                方法）。该方法有一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IServiceCollection</code>
                                属性，其中包含在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Main</code>
                                方法中已注册的所有服务，并允许你添加其他服务。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0038" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Configure</code> method
                    is invoked dynamically to configure the ASP.NET Core middleware. Middleware is invoked with every
                    HTTP request. The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Configure</code> method
                    receives parameters via dependency injection. The parameters defined in the template are of type
                    <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                    and <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IWebHostEnvironment</code>.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Configure</code>
                                方法动态地被调用以配置 ASP.NET Core 中间件。中间件在每次 HTTP 请求时都会被调用。 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Configure</code>
                                方法通过依赖注入接收参数。模板中定义的参数类型为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IWebHostEnvironment</code>
                                。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0039" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The interface <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IWebHostEnvironment</code>
                    allows you to access the name of the environment (<code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">EnvironmentName</code>),
                    the root path for the content (the directory of the sources), and the root path for the web content
                    files (the subdirectory <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">wwwroot</code>). The
                    default provider that accesses these directories is the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">PhysicalFileProvider</code>.
                    With a different provider, the content can be served from other sources—for example, from a
                    database. Within the implementation of the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Configure</code> method,
                    the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IWebHostEnvironment</code>
                    is used to check whether the current environment is <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Development</code> by
                    invoking the extension method <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsDevelopment</code>.
                    Exceptions are returned to the caller only in the development environment. Because of security
                    issues, in the production environment, the user doesn't see detailed information on the exception.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">接口 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IWebHostEnvironment</code>
                                允许你访问环境名称（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">EnvironmentName</code>
                                ）、内容根路径（源代码目录）、以及网页内容文件根路径（子目录 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">wwwroot</code>
                                ）。访问这些目录的默认提供者是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">PhysicalFileProvider</code>
                                。使用不同的提供者，内容可以从其他来源提供——例如，从数据库。在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Configure</code>
                                方法的实现中，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IWebHostEnvironment</code>
                                来检查当前环境是否为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Development</code>
                                ，通过调用扩展方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsDevelopment</code>
                                。异常仅会在开发环境中返回给调用者。由于安全问题，在生产环境中，用户不会看到异常的详细信息。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                    interface is used to add middleware to the HTTP request pipeline. When you invoke the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code> method of this
                    interface, you can build the HTTP request pipeline to define what should be done in answer to a
                    request. The <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code>
                    method is implemented using a fluent API, and it again returns an <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>.
                    With this, multiple middleware objects can easily be added to the pipeline. Several <span
                        aria-label="693" epub:type="pagebreak" id="Page_693" role="doc-pagebreak"
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>extension methods,
                    such as <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseRouting</code> and
                    <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseEndpoints</code>,
                    make it easier to add middleware. Middleware will be added in several sections in this chapter.
                    Later in this chapter, in the section “Creating Custom Middleware,” you can create custom middleware
                    and add it to the pipeline:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                                接口用于向 HTTP 请求管道添加中间件。当你调用该接口的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code>
                                方法时，可以构建 HTTP 请求管道，定义在接收到请求时应该执行什么操作。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code>
                                方法使用声明式 API 实现，并且它再次返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                                。通过这种方式，可以轻松地将多个中间件对象添加到管道中。包括 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseRouting</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseEndpoints</code>
                                在内的多个扩展方法，使得添加中间件更加便捷。本章的多个部分将添加中间件。在本章后文“创建自定义中间件”部分，你可以创建自定义中间件并将其添加到管道中：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0008"><code>public class Startup</code>
<code>{</code>
<code>  <b>public void ConfigureServices(IServiceCollection services)</b></code>
<code>  {</code>
<code>  }</code>
<code> </code>
<code>  <b>public void Configure(IApplicationBuilder app, IWebHostEnvironment env)</b></code>
<code>  {</code>
<code>    if (env.IsDevelopment())</code>
<code>    {</code>
<code>      app.UseDeveloperExceptionPage();</code>
<code>    }</code>
<code>            </code>
<code>    app.UseRouting();</code>
<code> </code>
<code>    app.UseEndpoints(endpoints =&gt;</code>
<code>    {</code>
<code>      endpoints.MapGet("/", async context =&gt;</code>
<code>      {</code>
<code>        await context.Response.WriteAsync("Hello World!");</code>
<code>      });</code>
<code>    });</code>
<code>  }</code>
<code>}</code></pre>
            </section>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0015"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-462" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Sample Application Preparations <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">示例应用程序准备</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The sample application contains an entry page where all the
                    features shown by the application can easily be accessed using HTML links:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">示例应用程序包含一个入口页面，通过 HTML
                                链接可以轻松访问应用程序显示的所有功能：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0009"><code>endpoints.MapGet("/", async context =&gt;</code>
<code>{</code>
<code>  string[] lines = new[]</code>
<code>  {</code>
<code>    @"&lt;ul&gt;",</code>
<code>      @"&lt;li&gt;&lt;a href=""/hello.html""&gt;Static Files&lt;/a&gt; - requires " + </code>
<code>        @"UseStaticFiles&lt;/li&gt;",</code>
<code>      @"&lt;li&gt;Request and Response",</code>
<code>        @"&lt;ul&gt;",</code>
<code>          @"&lt;li&gt;&lt;a href=""/RequestAndResponse""&gt;Request and Response&lt;/a&gt;&lt;/li&gt;",</code>
<code>          @"&lt;li&gt;&lt;a href=""/RequestAndResponse/header""&gt;Header&lt;/a&gt;&lt;/li&gt;",</code>
<code>          @"&lt;li&gt;&lt;a href=""/RequestAndResponse/add?x=38&amp;y=4""&gt;Add&lt;/a&gt;&lt;/li&gt;",</code>
<code> </code>
<code>          //…</code>
<code> </code>
<code>        @"&lt;/ul&gt;",</code>
<code>      @"&lt;/li&gt;",</code>
<code>    @"&lt;/ul&gt;"</code>
<code>  };</code>
<code> <span aria-label="694" epub:type="pagebreak" id="Page_694" role="doc-pagebreak"></span></code>
<code>  StringBuilder sb = new();</code>
<code>  foreach (var line in lines)</code>
<code>  {</code>
<code>    sb.Append(line);</code>
<code>  }</code>
<code>  string html = sb.ToString().HtmlDocument("Web Sample App");</code>
<code> </code>
<code>  await context.Response.WriteAsync(html);</code>
<code>});</code></pre>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HTMLExtensions</code>
                    class is defined to create some specific HTML and reduce the amount of HTML code needed. This class
                    defines extension methods to create <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">div</code>, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">span</code>, and <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">li</code> elements (code
                    file <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Extensions/HtmlExtensions.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HTMLExtensions</code>
                                类用于创建特定的 HTML 并减少所需的 HTML 代码量。此类定义了扩展方法来创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">div</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">span</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">li</code>
                                元素（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Extensions/HtmlExtensions.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0010"><code>public static class HtmlExtensions</code>
<code>{</code>
<code>  public static string Div(this string value) =&gt;</code>
<code>    $"&lt;div&gt;{value}&lt;/div&gt;";</code>
<code> </code>
<code>  public static string Span(this string value) =&gt;</code>
<code>    $"&lt;span&gt;{value}&lt;/span&gt;";</code>
<code> </code>
<code>  public static string Div(this string key, string value) =&gt;</code>
<code>    $"{key.Span()}: {value.Span()}".Div();</code>
<code> </code>
<code>  public static string Li(this string value) =&gt;</code>
<code>    $@"&lt;li&gt;{value}&lt;/li&gt;";</code>
<code> </code>
<code>  public static string Li(this string value, string url) =&gt;</code>
<code>    $@"&lt;li&gt;&lt;a href=""{url}""&gt;{value}&lt;/a&gt;&lt;/li&gt;";</code>
<code> </code>
<code>  public static string Ul(this string value) =&gt;</code>
<code>    $"&lt;ul&gt;{value}&lt;/ul&gt;";</code>
<code> </code>
<code>  public static string HtmlDocument(this string content, string title)</code>
<code>  {</code>
<code>    StringBuilder sb = new();</code>
<code>    sb.Append("&lt;!DOCTYPE HTML&gt;");</code>
<code>    sb.Append("&lt;head&gt;&lt;meta charset=\"utf-8\"&gt;&lt;title&gt;{title}&lt;/title&gt;&lt;/head&gt;");</code>
<code>    sb.Append("&lt;body&gt;");</code>
<code>    sb.Append(content);</code>
<code>    sb.Append("&lt;/body&gt;");</code>
<code>    return sb.ToString();</code>
<code>  }</code>
<code>}</code></pre>
            </section>
        </section>
        <section aria-labelledby="head-2-220" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <span id="c24-sec-0016" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <h2 id="head-2-220" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">ADDING CLIENT-SIDE CONTENT<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">添加客户端内容 </font>
                    </font>
                </font>
            </h2>
            <p id="c24-para-0043" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Usually you don't want to just send simple strings to the client.
                By default, simple HTML files and other static content can't be sent. ASP.NET Core reduces the overhead
                as much as possible. Even static files are not returned from the server if you do not enable them.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">通常你并不希望只是将简单的字符串发送给客户端。默认情况下，简单的 HTML
                            文件和其他静态内容无法发送。ASP.NET Core 尽可能减少开销。即使静态文件，如果你没有启用它们，也不会从服务器返回。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1"><span aria-label="695" epub:type="pagebreak" id="Page_695"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>To enable static files
                served from the web server, you can add the extension method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStaticFiles</code> to add
                the required middleware. This middleware checks whether the request matches an existing file (code file
                <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要启用从 Web 服务器提供静态文件，你可以添加扩展方法 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStaticFiles</code>
                            来添加所需的中间件。这个中间件检查请求是否匹配现有文件（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0011"><code>public void Configure(IApplicationBuilder app, IWebHostEnvironment env)</code>
<code>{</code>
<code>  /…</code>
<code>  <b>app.UseStaticFiles();</b></code>
<code> </code>
<code>  app.UseRouting();</code>
<code>  <b>//…</b></code>
<code> </code>
<code>}</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The folder where you add static files is the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">wwwroot</code> folder within
                the project. Let's add static content by adding a simple HTML file (code file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/wwwroot/hello.html</code>),
                as shown here:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">你添加静态文件的文件夹是项目中的 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">wwwroot</code>
                            文件夹。让我们通过添加一个简单的 HTML 文件（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/wwwroot/hello.html</code>
                            ）来添加静态内容，如下所示：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0012"><code>&lt;!DOCTYPE html&gt;</code>
<code>&lt;html&gt;</code>
<code>  &lt;head&gt;</code>
<code>    &lt;meta charset="utf-8"/&gt;</code>
<code>    &lt;title&gt;ASP.NET Core Sample&lt;/title&gt;</code>
<code>  &lt;/head&gt;</code>
<code>  &lt;body&gt;</code>
<code>    &lt;h1&gt;Hello, ASP.NET with Static Files&lt;/h1&gt;</code>
<code>  &lt;/body&gt;</code>
<code>&lt;/html&gt;</code></pre>
            <p id="c24-para-0046" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Now you make a request to the HTML file from the browser after
                starting the server—for example, <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://localhost:5001/Hello.html">https://localhost:5001/Hello.html</a></code>.
                If you uncomment the extension method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStaticFiles</code>, the
                HTML file is not returned from the request.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">现在在启动服务器后，从浏览器请求 HTML 文件——例如， <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://localhost:5001/Hello.html">https://localhost:5001/Hello.html</a></code>
                            。如果你取消注释扩展方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStaticFiles</code>
                            ，请求不会返回 HTML 文件。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0047" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The NuGet server is hosting NuGet packages containing .NET
                libraries. Most JavaScript libraries can be found on the Node server. These libraries are packaged with
                Node Package Manager (NPM), WebPack, Parcel, or other package managers. This topic is not covered here.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">NuGet 服务器正在托管包含.NET 库的 NuGet 包。大多数
                            JavaScript 库可以在 Node 服务器上找到。这些库使用 Node Package Manager (NPM)、WebPack、Parcel
                            或其他包管理器进行打包。本主题不涉及这些内容。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">When using .NET, you can create a web application using Angular
                and an ASP.NET Core backend with the web API:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用 .NET 时，您可以使用 Angular 和 ASP.NET Core
                            后端（通过 Web API）创建一个 Web 应用程序：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0013"><code>&gt; dotnet new angular -o AngularSample</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">In the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ClientApp</code> subfolder,
                you'll find a file named <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">package.json</code>, which
                contains the configuration for NPM. You can create a similar project with the React JavaScript library
                for the frontend and ASP.NET Core with the backend; there's a similar folder structure with <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">package.json</code> for
                JavaScript libraries:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ClientApp</code>
                            子文件夹中，您会找到一个名为 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">package.json</code>
                            的文件，其中包含 NPM 的配置。您可以使用 React JavaScript 库作为前端和 ASP.NET Core 作为后端创建一个类似的项目；JavaScript
                            库有一个类似的文件夹结构，即 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">package.json</code>
                            ：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0014"><code>&gt; dotnet new react -o ReactSample</code></pre>
            <p id="c24-para-0050" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">This is a separate topic on its own. However, if you don't need
                to use a JavaScript library in a size similar to Angular or React and just want to use a few JavaScript
                and CSS files, the library manager can be all that you need. With this tool you can download JavaScript
                libraries from providers, select the files from the libraries you need, and copy them to your local
                source code.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">这本身是一个独立的话题。但是，如果您不需要使用与 Angular 或
                            React 相当规模的 JavaScript 库，并且只想使用一些 JavaScript 和 CSS 文件，那么库管理器可能就足够了。使用这个工具，您可以从提供者那里下载
                            JavaScript 库，选择您需要的库中的文件，并将它们复制到您的本地源代码中。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">To install the library manager as a global tool, use this:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要作为全局工具安装库管理器，请使用这个命令：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0015"><code>&gt; dotnet tool install microsoft.web.librarymanager.cli -g</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Then you can use the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">libman</code> command to get
                libraries. To initialize <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">libman</code> for the
                project, while in the project directory, invoke the following command:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">然后你可以使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">libman</code>
                            命令来获取库。为了初始化 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">libman</code>
                            以供项目使用，在项目目录中，执行以下命令：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0016"><code>&gt; libman init</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1"><span aria-label="696" epub:type="pagebreak" id="Page_696"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>You'll be asked where
                to get the JavaScript libraries. By default, <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">cdnjs</code> is used. This
                creates <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">the libman.json</code> file
                as shown here:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">系统会询问你从哪里获取 JavaScript 库。默认情况下使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">cdnjs</code>
                            。这会创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">the libman.json</code>
                            文件，如下所示：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0017"><code>{</code>
<code>  "version": "1.0",</code>
<code>  "defaultProvider": "cdnjs",</code>
<code>  "libraries": []</code>
<code>}</code></pre>
            <p id="c24-para-0054" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The providers you can use are <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">cdnjs</code> (<code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://cdnjs.com">https://cdnjs.com</a></code>),
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">jsdlvr</code> (<code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://www.jsdelivr.com/">https://www.jsdelivr.com/</a></code>),
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">unpkg</code> (<code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://unpkg.com/">https://unpkg.com/</a></code>),
                and filesystem. <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">unpkg</code> is the content
                delivery network (CDN) service from Node that offers all the packages available on the Node server.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">你可以使用的提供者是 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">cdnjs</code> (
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://cdnjs.com">https://cdnjs.com</a></code>
                            ), <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">jsdlvr</code> (
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://www.jsdelivr.com/">https://www.jsdelivr.com/</a></code>
                            ), <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">unpkg</code> (
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://unpkg.com/">https://unpkg.com/</a></code>
                            ) 和文件系统。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">unpkg</code> 是
                            Node 提供的内容分发网络（CDN）服务，它提供 Node 服务器上所有可用的软件包。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">To get the files needed for jQuery, you can invoke the following
                command:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要获取 jQuery 所需的文件，你可以调用以下命令：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0018"><code>&gt; libman install jquery</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Within the libraries section, you'll find a reference to the
                library and the destination where the files should be copied to. You need to copy the files to the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">wwwroot</code> directory
                where static files are served from the web application, as shown here:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在库部分，你会找到库的引用以及文件应该复制到的目标位置。你需要将文件复制到
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">wwwroot</code>
                            目录，这是 Web 应用程序提供静态文件的位置，如下所示：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0019"><code>{</code>
<code>  "version": "1.0",</code>
<code>  "defaultProvider": "cdnjs",</code>
<code>  "libraries": [</code>
<code>    {</code>
<code>      "library": "jquery@3.6.0",</code>
<code>      "destination": "wwwroot\\lib\\jquery"</code>
<code>    }</code>
<code>  ]</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">If you don't need the complete package content with your
                application, you can specify what files should be retrieved from the package with the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">files</code> element, and you
                can change to get a specific library from a different CDN service with the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">provider</code> element
                (config file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/libman.json</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">如果你不需要将整个软件包内容与应用程序一起使用，你可以使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">files</code>
                            元素指定应该从软件包中检索哪些文件，并且你可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">provider</code>
                            元素（配置文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/libman.json</code>
                            ）切换到从不同的 CDN 服务获取特定库。</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0020"><code>{</code>
<code>  "version": "1.0",</code>
<code>  "defaultProvider": "cdnjs",</code>
<code>  "libraries": [</code>
<code>    {</code>
<code>      "provider": "unpkg",</code>
<code>      <b>"library": "bootstrap@4.6.0",</b></code>
<code>      <b>"files": [ "dist/css/bootstrap.css", "dist/js/bootstrap.js" ],</b></code>
<code>      "destination": "wwwroot/lib/bootstrap"</code>
<code>    },</code>
<code>    {</code>
<code>      "library": "jquery@3.6.0",</code>
<code>      "destination": "wwwroot/lib/jquery"</code>
<code>    }</code>
<code>  ]</code>
<code>}</code></pre>
        </section>
        <section aria-labelledby="head-2-221" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <span id="c24-sec-0017" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <h2 id="head-2-221" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">CREATING CUSTOM MIDDLEWARE<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">创建自定义中间件</font>
                    </font>
                </font>
            </h2>
            <p id="c24-para-0058" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">When you invoke the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStaticFiles</code>
                extension method with the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>,
                as shown in the previous section, middleware is implemented. This middleware checks the request if a
                physical file is available. If it is, this file is returned. Otherwise, the next middleware is invoked.
                Middleware is implemented as a pipeline—one <span aria-label="697" epub:type="pagebreak" id="Page_697"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>middleware follows the
                next one. With middleware, authentication and authorization, session handling, caching, and more
                functionalities are implemented.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">当你在上一节中用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStaticFiles</code>
                            扩展方法调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                            时，中间件就会被实现。这个中间件会检查请求中是否存在物理文件。如果存在，则返回该文件。否则，会调用下一个中间件。中间件以管道的形式实现——一个中间件接着下一个中间件。通过中间件，可以实现身份验证和授权、会话处理、缓存以及其他更多功能。
                        </font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">You can implement custom middleware functionality by invoking the
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code> method. The
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code> method is
                declared with this parameter and return type:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">你可以通过调用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code>
                            方法来实现自定义中间件功能。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code>
                            方法的声明参数和返回类型如下：</font>
                    </font>
                </font>
            </p>
            <pre
                id="c24-code-0021"><code>IApplicationBuilder Use(Func&lt;RequestDelegate, RequestDelegate&gt; middleware);</code></pre>
            <p id="c24-para-0060" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code> method returns an
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>,
                so you can invoke the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code> method with a
                fluent API. The parameter is a delegate with a <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code> as a
                parameter and return type. <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code> is a
                delegate that defines an <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code> as a
                parameter returning a <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Task</code>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1"> <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code> 方法返回
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                            ，因此你可以用流畅的 API 调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code>
                            方法。参数是一个委托，参数类型和返回类型都是 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code>
                            。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code>
                            是一个委托，它定义了一个参数为 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>
                            、返回类型为 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Task</code> 的委托。
                        </font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">With the following invocation of the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code> method, the
                variable <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">next</code> is a
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code>
                parameter. This parameter references a lambda with the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code> parameter
                and returns a <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Task</code>.
                With the implementation of the lambda, a custom header named <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CustomHeader1</code> is
                written to the HTTP response, and then the next middleware defined with the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">next</code> variable is
                invoked (code file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">通过以下对 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code>
                            方法的调用，变量 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">next</code> 是一个
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code>
                            参数。该参数引用一个带有 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>
                            参数的 lambda 表达式，并返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Task</code> 。在
                            lambda 表达式的实现中，会向 HTTP 响应写入一个名为 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CustomHeader1</code>
                            的自定义头部，然后调用由 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">next</code>
                            变量定义的下一个中间件（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0022"><code>public void Configure(IApplicationBuilder app, IWebHostEnvironment env)</code>
<code>{</code>
<code>  if (env.IsDevelopment())</code>
<code>  {</code>
<code>    app.UseDeveloperExceptionPage();</code>
<code>  }</code>
<code> </code>
<code>  <b>app.Use(next =&gt; context =&gt;</b></code>
<code>  <b>{</b></code>
<code>    <b>context.Response.Headers.Add("CustomHeader1", "custom header value");</b></code>
<code>    <b>return next(context);</b></code>
<code>  <b>});</b></code>
<code> </code>
<code> </code>
<code>  app.UseStaticFiles();</code>
<code>  //…</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Instead of implementing the middleware as a parameter of the
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code> method, you can
                create a class such as the following <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HeaderMiddleware</code>
                class. With a middleware class, the constructor receives the next middleware with the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code>
                parameter. Here you need to remember the next middleware reference to invoke it after the middleware's
                functionality is done. With the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Invoke</code> method, you
                implement the functionality of the middleware and invoke the next middleware forwarding the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>. The
                sample code writes a custom HTTP header to the HTTP response similar to the previous middleware (code
                file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Middleware/HeaderMiddleware.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">你不必将中间件实现为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Use</code>
                            方法的参数，而是可以创建如下 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HeaderMiddleware</code>
                            类。使用中间件类时，构造函数通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code>
                            参数接收下一个中间件。你需要记住下一个中间件的引用，以便在中间件功能完成后调用它。通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Invoke</code>
                            方法，你实现中间件的功能并调用下一个中间件，传递 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>
                            。示例代码向 HTTP 响应写入自定义 HTTP 头部，类似于之前的中间件（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Middleware/HeaderMiddleware.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0023"><code>public class HeaderMiddleware</code>
<code>{</code>
<code>  private readonly RequestDelegate _next;</code>
<code> </code>
<code>  public HeaderMiddleware(RequestDelegate next) =&gt; _next = next;</code>
<code> </code>
<code>  public Task Invoke(HttpContext httpContext)</code>
<code>  {</code>
<code>    httpContext.Response.Headers.Add("CustomHeader2", "custom header value");</code>
<code>    return _next(httpContext);</code>
<code>  }</code>
<code>}</code></pre>
            <p id="c24-para-0063" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Implementing the middleware in a class has the advantage that you
                can add a lot more to the constructor—for example, other services that you might need from the
                middleware implementation or configuration settings, such as using the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IOptions</code> interface.
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IOptions</code> is covered
                in <a href="c15.xhtml" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter
                    15</a>.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            在类中实现中间件的优势在于你可以在构造函数中添加更多内容——例如，你可能需要从中间件实现中获取的其他服务或配置设置，比如使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IOptions</code>
                            接口。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IOptions</code>
                            在第 15 章中介绍。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1"><span aria-label="698" epub:type="pagebreak" id="Page_698"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>To make it easy to
                register the middleware, an extension method for the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                can be defined. The method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseHeaderMiddleware</code>
                invokes the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseMiddleware</code> method
                by passing the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HeaderMiddleware</code> as a
                generic parameter (code file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Middleware/HeaderMiddleware.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">为了方便注册中间件，可以定义 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IApplicationBuilder</code>
                            的扩展方法。方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseHeaderMiddleware</code>
                            通过将 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HeaderMiddleware</code>
                            作为泛型参数传递来调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseMiddleware</code>
                            方法（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Middleware/HeaderMiddleware.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0024"><code>public static class HeaderMiddlewareExtensions</code>
<code>{</code>
<code>  public static IApplicationBuilder UseHeaderMiddleware(</code>
<code>    this IApplicationBuilder builder) =&gt; </code>
<code>    builder.UseMiddleware&lt;HeaderMiddleware&gt;();</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">This middleware is added similar to the way all the other
                middleware is added. Because the middleware extension method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseHeaderMiddleware</code> is
                added after <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStaticFiles</code>, with
                static files this header information is not returned to the client (code file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">这个中间件的添加方式与其他所有中间件的添加方式类似。因为中间件扩展方法
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseHeaderMiddleware</code>
                            是在 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseStaticFiles</code>
                            之后添加的，所以对于静态文件，这些头部信息不会返回给客户端（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0025"><code>app.Use(next =&gt; context =&gt;</code>
<code>{</code>
<code>  context.Response.Headers.Add("CustomHeader1", "custom header value");</code>
<code>  return next(context);</code>
<code>});</code>
<code> </code>
<code>app.UseStaticFiles();</code>
<code> </code>
<code>app.UseHeaderMiddleware();</code></pre>
            <p id="c24-para-0066" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">When you run the application, you see the header returned to the
                client (using the browser's developer tools), and the heading shows up in every page, no matter which of
                the previously created links you use (see <a href="#c24-fig-0001" id="R_c24-fig-0001"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Figure 24-1</a>).<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            运行应用程序时，你可以通过浏览器的开发者工具看到返回给客户端的头部信息，并且标题会出现在每个页面中，无论你使用之前创建的哪个链接（见图 24-1）。</font>
                    </font>
                </font>
            </p> <span aria-label="699" epub:type="pagebreak" id="Page_699" role="doc-pagebreak"
                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <figure data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"> <img
                    alt="Snapshot of asp.net core sample." class="center" src="images/c24f001.png" />
                <figcaption data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span class="figureLabel"
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a
                                href="#R_c24-fig-0001" id="c24-fig-0001" role="doc-backlink"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><b
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                                    data-immersive-translate-paragraph="1">FIGURE 24-1<font
                                        class="notranslate immersive-translate-target-wrapper"
                                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">
                                              </font>
                                        <font
                                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                            data-immersive-translate-translation-element-mark="1">
                                            <font
                                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                                data-immersive-translate-translation-element-mark="1">图 24-1</font>
                                        </font>
                                    </font></b></a></span></p>
                </figcaption>
            </figure>
        </section>
        <section aria-labelledby="head-2-222" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <span id="c24-sec-0018" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <h2 id="head-2-222" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">ENDPOINT ROUTING<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">ENDPOINT 路由 </font>
                    </font>
                </font>
            </h2>
            <p id="c24-para-0067" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">How the links map to code is defined by endpoint routing.
                Endpoint routing is implemented as middleware, using the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseRouting</code> method. The
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseRouting</code> method
                needs to be followed by the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseEndpoints</code> method
                where the routes are defined. <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseRouting</code> uses the
                <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">EndpointRoutingMiddleware</code>
                where the routing decisions are made; it defines what route maps to which implementation. However,
                middleware specified before the routing can change the endpoint for a request. For example, if a request
                is denied because the user is not authenticated, the route is changed for this request—for example, to a
                page with unauthorized information.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">链接如何映射到代码是由 endpoint 路由定义的。Endpoint
                            路由作为中间件实现，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseRouting</code>
                            方法。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseRouting</code>
                            方法需要后跟 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseEndpoints</code>
                            方法来定义路由。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseRouting</code>
                            使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">EndpointRoutingMiddleware</code>
                            来做出路由决策；它定义了哪个路由映射到哪个实现。然而，在路由之前的中间件可以改变请求的
                            endpoint。例如，如果因为用户未通过身份验证而拒绝请求，这个请求的路由会改变——例如，改为显示未授权信息的页面。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0068" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">To define routes, different technologies offer extension methods
                to the interface <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IEndpointRouteBuilder</code>.
                With Razor Pages, the method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">MapRazorPages</code> defines
                routing to link to Razor Pages in the Pages folder where the link maps the name of the Razor Page. With
                SignalR, the method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">MapHub</code> maps a
                specified link to a class that derives from the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Hub</code> class. In the next
                four chapters, you'll learn about different routes using attribute-based routing with web APIs, and then
                route definitions with GRPC, Razor Pages, MVC routes, Blazor, and SignalR. In this chapter, you define
                custom routes without using these technologies.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要定义路由，不同的技术提供了对 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IEndpointRouteBuilder</code>
                            接口的扩展方法。使用 Razor Pages 时， <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">MapRazorPages</code>
                            方法定义路由以链接到 Pages 文件夹中的 Razor Pages，链接映射 Razor Page 的名称。使用 SignalR 时， <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">MapHub</code>
                            方法将指定链接映射到继承自 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Hub</code>
                            类的类。在接下来的四章中，你将学习使用基于属性的 Web API 路由的不同路由，然后学习 GRPC、Razor Pages、MVC 路由、Blazor 和 SignalR
                            的路由定义。在本章中，你将定义不使用这些技术的自定义路由。</font>
                    </font>
                </font>
            </p>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0019"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-463" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Defining Routes <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">定义路由</font>
                        </font>
                    </font>
                </h3>
                <p id="c24-para-0069" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">In the previous code samples, you saw how to define a route
                    with the <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Map</code> (or
                    <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">MapGet</code>) method.
                    Using the string <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/</code> as an argument
                    defined the response to the root path. <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Map</code> is an
                    extension method for the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IEndpointRouteBuilder</code>
                    interface, which is the parameter type of the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseEndpoints</code>
                    method.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在之前的代码示例中，你看到了如何使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Map</code> （或
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">MapGet</code>
                                ）方法定义路由。使用字符串 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/</code>
                                作为参数定义了对根路径的响应。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Map</code> 是
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IEndpointRouteBuilder</code>
                                接口的扩展方法，而 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseEndpoints</code>
                                方法的参数类型正是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IEndpointRouteBuilder</code>。
                            </font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The following invocation of the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Map</code> method defines
                    the route to the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/session</code> URL. If
                    the URL matches this link, the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SessionSample</code>
                    service is retrieved from the DI container, and the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SessionAsync</code>
                    method is invoked (code file <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">以下 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Map</code>
                                方法的调用定义了到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/session</code>
                                URL 的路由。如果 URL 与此链接匹配，DI 容器中会检索 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SessionSample</code>
                                服务，并调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SessionAsync</code>
                                方法（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0026"><code>endpoints.Map("/session", async context =&gt;</code>
<code>{</code>
<code>  var service = context.RequestServices.GetRequiredService&lt;SessionSample&gt;();</code>
<code>  await service.SessionAsync(context);</code>
<code>});</code></pre>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The following code snippet shows using a string pattern with
                    a <i data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">route parameter</i>. The
                    URI segment that follows <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr/</code> maps to a
                    route value with a key named <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">action</code>. Using a
                    URI such as <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr/header</code>, the
                    parts of this URI can be retrieved using the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetRouteValue</code>
                    method of the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>
                    object. Because a <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">?</code> is added to the
                    route parameter, the action is optional, and the URI <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr</code> without
                    following URI segments also matches this route definition. The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">action</code> variable
                    will be <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">null</code> in
                    that case. With the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">switch</code> expression
                    used here, the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">switch</code> path is
                    designed using tuple pattern matching where both the route parameter and the HTTP method are used
                    for the decision (code file <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">以下代码片段展示了使用带路由参数的字符串模式。紧随 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr/</code>
                                后的 URI 段映射到名为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">action</code>
                                的路由值。使用如 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr/header</code>
                                的 URI，可以通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetRouteValue</code>
                                对象的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>
                                方法获取此 URI 的各个部分。由于在路由参数中添加了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">?</code>
                                ，因此该操作是可选的，不包含后续 URI 段的 URI <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr</code>
                                也匹配此路由定义。在这种情况下， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">action</code>
                                变量将是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">null</code>
                                。使用这里的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">switch</code>
                                表达式， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">switch</code>
                                路径是通过元组模式匹配设计的，其中路由参数和 HTTP 方法都用于决策（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0027"><code><b>endpoints.Map("/randr/{action?}", async context =&gt;</b> </code>
<code>{</code>
<code>  var service = context.RequestServices.GetRequiredService&lt;RequestAndResponseSamples&gt;();</code>
<code>  <b>string? action = context.GetRouteValue("action")?.ToString();</b></code>
<code>  string method = context.Request.Method;</code>
<code>  string result = (action, method) switch</code>
<code>  {</code>
<code>    (null, "GET") =&gt; service.GetRequestInformation(context.Request),</code>
<code>    ("header", "GET") =&gt; service.GetHeaderInformation(context.Request),</code>
<code>    ("add", "GET") =&gt; service.QueryString(context.Request),</code>
<code>    ("content", "GET") =&gt; service.Content(context.Request),</code>
<code>    ("form", "GET" or "POST") =&gt; service.Form(context.Request),</code>
<code>    ("writecookie", "GET") =&gt; service.WriteCookie(context.Response),</code>
<code>    ("readcookie", "GET") =&gt; service.ReadCookie(context.Request),<span aria-label="700" epub:type="pagebreak" id="Page_700" role="doc-pagebreak"></span></code>
<code>    ("json", "GET") =&gt; service.GetJson(context.Response),</code>
<code>    _ =&gt; string.Empty</code>
<code>  };</code>
<code> </code>
<code>  if (action is "json")</code>
<code>  {</code>
<code>    await context.Response.WriteAsync(result);</code>
<code>  }</code>
<code>  else</code>
<code>  {</code>
<code>    var doc = result.HtmlDocument("Request and Response Samples");</code>
<code>    await context.Response.WriteAsync(doc);</code>
<code>  }</code>
<code>});</code></pre>
            </section>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0020"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-464" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Route Constraints <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">路由约束</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">With the pattern parameter, you can specify constraints as
                    defined in the following code snippet. Here, the two mandatory URI segments that follow the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/add</code> need to map
                    to <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">int</code> values;
                    otherwise, this <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Map</code> method doesn't
                    have a match for the route, and the following route definitions are checked for matches. The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetRouteValue</code>
                    returns a nullable object containing the string value, and you need to convert it to the type you
                    need (code file <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用模式参数，您可以指定以下代码片段中定义的约束。在这里，紧随
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/add</code>
                                之后的两个必需的 URI 段需要映射到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">int</code>
                                值；否则，这个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Map</code>
                                方法没有与路由匹配的项，系统会检查后续的路由定义以寻找匹配项。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetRouteValue</code>
                                返回一个包含字符串值的可空对象，您需要将其转换为所需的类型（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0028"><code>endpoints.Map(<b>"/add/{x:int}/{y:int}"</b>, async context =&gt;</code>
<code>{</code>
<code>  int x = int.Parse(context.GetRouteValue("x")?.ToString() ?? "0");</code>
<code>  int y = int.Parse(context.GetRouteValue("y")?.ToString() ?? "0");</code>
<code>  await context.Response.WriteAsync($"The result of {x} + {y} is {x + y}");</code>
<code>});</code></pre>
                <p id="c24-para-0073" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Besides <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">int</code>, you can pass
                    several constraints such as <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">bool</code>, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">datetime</code>, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">min</code>, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">max</code>, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">length</code>, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">minlength</code>, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">range</code>, and others.
                    Check the documentation for route constraint references at <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing?view=aspnetcore-5.0#route-constraint-reference">https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing?view=aspnetcore-5.0#route-constraint-reference</a></code>.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">除了 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">int</code>
                                ，您还可以传递多种约束，如 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">bool</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">datetime</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">min</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">max</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">length</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">minlength</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">range</code>
                                及其他。请查阅 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing?view=aspnetcore-5.0#route-constraint-reference">https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing?view=aspnetcore-5.0#route-constraint-reference</a></code>
                                处的路由约束引用文档。</font>
                        </font>
                    </font>
                </p>
            </section>
        </section>
        <section aria-labelledby="head-2-223" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <span id="c24-sec-0021" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <h2 id="head-2-223" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">REQUEST AND RESPONSE<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">请求与响应</font>
                    </font>
                </font>
            </h2>
            <p id="c24-para-0074" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">With the HTTP protocol, the client sends an HTTP request to the
                server. This request is answered with an HTTP response.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在 HTTP 协议中，客户端向服务器发送 HTTP 请求。该请求会得到
                            HTTP 响应的回应。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0075" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The request consists of a header and, in many cases, body
                information to the server. The server uses the header information to know about the needs of the client
                and can send different results based on this information. Let's take a look at what information is sent
                by the client.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            请求由一个头部和许多情况下包含的正文信息组成，发送给服务器。服务器使用头部信息来了解客户端的需求，并可以根据这些信息发送不同的结果。让我们看看客户端发送了哪些信息。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetRequestInformation</code>
                uses an <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpRequest</code>
                object to access <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Scheme</code>, <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code>, <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Path</code>, <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">QueryString</code>, <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Method</code>, and <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Protocol</code> properties
                (code file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestAndResponseSamples.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">方法 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetRequestInformation</code>
                            使用一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpRequest</code>
                            对象来访问 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Scheme</code> 、
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Host</code> 、
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Path</code> 、
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">QueryString</code>
                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Method</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Protocol</code>
                            属性（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestAndResponseSamples.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0029"><code>public string GetRequestInformation(HttpRequest request)</code>
<code>{</code>
<code>  StringBuilder sb = new();</code>
<code>  sb.Append("scheme".Div(<b>request.Scheme</b>));</code>
<code>  sb.Append("host".Div(<b>request.Host.HasValue</b> ? request.Host.Value : </code>
<code>    "no host"));<span aria-label="701" epub:type="pagebreak" id="Page_701" role="doc-pagebreak"></span></code>
<code>  sb.Append("path".Div(<b>request.Path</b>));</code>
<code>  sb.Append("query string".Div(<b>request.QueryString.</b>HasValue ? </code>
<code>    request.QueryString.Value : "no query string"));</code>
<code>  sb.Append("method".Div(<b>request.Method</b>));</code>
<code>  sb.Append("protocol".Div(<b>request.Protocol</b>));</code>
<code>  return sb.ToString();</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">All the requests to demonstrate the sample code of this section
                are served passing the path <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr</code> to the server,
                as specified in the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code> class. With
                the implementation of the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code>
                parameter, the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestAndResponseSamples</code>
                object is retrieved from the DI container, and the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetRequestInformation</code>
                method is invoked. The result is then written to the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpResponse</code> object
                (code file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">所有请求都通过将路径 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr</code>
                            传递给服务器来演示本节示例代码，如 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code>
                            类中指定的。通过实现 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestDelegate</code>
                            参数，从依赖注入容器中获取 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">RequestAndResponseSamples</code>
                            对象，并调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetRequestInformation</code>
                            方法。结果随后写入 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpResponse</code>
                            对象（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                            ）。</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0030"><code>endpoints.Map("/randr/{action?}", async context =&gt; </code>
<code>{</code>
<code>  var service = context.RequestServices.GetRequiredService&lt;RequestAndResponseSamples&gt;();</code>
<code>  string? action = context.GetRouteValue("action")?.ToString();</code>
<code>  string method = context.Request.Method;</code>
<code>  string result = (action, method) switch</code>
<code>  {</code>
<code>    (null, "GET") =&gt; service.GetRequestInformation(context.Request),</code>
<code>    ("header", "GET") =&gt; service.GetHeaderInformation(context.Request),</code>
<code>    //…</code>
<code>  };</code>
<code>  await context.Response.WriteAsync(result);</code>
<code>});</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Starting the program and accessing <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://localhost:5001/randr/">https://localhost:5001/randr/</a></code>
                results in the following information:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">启动程序并访问 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://localhost:5001/randr/">https://localhost:5001/randr/</a></code>
                            将得到以下信息：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0031"><code>scheme: https</code>
<code>host: localhost:001</code>
<code>path: /randr</code>
<code>query string: no query string</code>
<code>method: GET</code>
<code>protocol: HTTP/2</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">When you add a query string, such as <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://localhost:5001/randr?x=3&amp;y=5">https://localhost:5001/randr?x=3&amp;y=5</a></code>,
                the query string accessing the property <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">QueryString</code> shows up:
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">当你添加查询字符串，如 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://localhost:5001/randr?x=3&amp;y=5">https://localhost:5001/randr?x=3&amp;y=5</a></code>
                            ，访问属性 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">QueryString</code>
                            的查询字符串会显示出来：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0032"><code>query string: ?x=3&amp;y=5</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The following sections implement the different methods to show
                request headers, query strings, and more.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">以下部分实现了显示请求头、查询字符串等不同方法。</font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                <div class="top hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <p id="c24-para-0081" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NOTE</b> <i
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">For HTML encoding the
                            result, read <a href="c20.xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter 20</a>,
                            “Security.”</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意：若要对结果进行 HTML 编码，请阅读第 20
                                    章“安全”。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <hr />
                    </div>
                </section>
            </aside>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0023"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-465" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Request Headers <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">请求头</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Let's take a look at what information the client sends within
                    the HTTP header. To access the HTTP header information, the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpRequest</code> object
                    defines the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Headers</code> property.
                    This is of type <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IHeaderDictionary</code>,
                    and it contains a dictionary with the name of the header and a string array for the values. Using
                    this information, the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Div</code> method created
                    earlier is used to write <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">div</code> elements for
                    the client (code file <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestAndResponseSamples.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">让我们看看客户端在 HTTP 头中发送了哪些信息。要访问 HTTP
                                头信息， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpRequest</code>
                                对象定义了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Headers</code>
                                属性。这是一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IHeaderDictionary</code>
                                类型，它包含一个以头名称为键、字符串数组为值的字典。使用这些信息，可以调用先前创建的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Div</code>
                                方法来为客户端写入 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">div</code>
                                元素（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestAndResponseSamples.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0033"><code>public string GetHeaderInformation(HttpRequest request)</code>
<code>{<span aria-label="702" epub:type="pagebreak" id="Page_702" role="doc-pagebreak"></span></code>
<code>  StringBuilder sb = new();</code>
<code>  foreach (var header in request.Headers)</code>
<code>  {</code>
<code>    sb.Append(header.Key.Div(string.Join("; ", header.Value)));</code>
<code>  }</code>
<code>  return sb.ToString();</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The results you see depend on the HTTP version, browser,
                    operating system, and configured languages that you're using. With Microsoft Edge running on Windows
                    10, you can see values as shown here:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你看到的结果取决于你使用的 HTTP
                                版本、浏览器、操作系统和配置的语言。在 Windows 10 上运行的 Microsoft Edge 中，你可以看到如下所示的值：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0034"><code>:authority: localhost:5001</code>
<code>:method: GET</code>
<code>:path: /randr/header</code>
<code>:scheme: https</code>
<code>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;</code>
<code>q=0.8,application/signed-exchange;v=b3;q=0.9</code>
<code>Accept-Encoding: gzip, deflate, br</code>
<code>Accept-Language: en-US,en;q=0.9,de;q=0.8</code>
<code>Cookie: color=red</code>
<code>Host: localhost:5001</code>
<code>Referer: https://localhost:5001/</code>
<code>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 </code>
<code>(KHTML, like Gecko) Chrome/91.0.4435.0 Safari/537.36 Edg/91.0.825.0</code>
<code>Upgrade-Insecure-Requests: 1</code>
<code>sec-ch-ua: " Not;A Brand";v="99", "Microsoft Edge";v="91", "Chromium";v="91"</code>
<code>sec-ch-ua-mobile: ?0</code>
<code>sec-fetch-site: same-origin</code>
<code>sec-fetch-mode: navigate</code>
<code>sec-fetch-user: ?1</code>
<code>sec-fetch-dest: document</code></pre>
                <p id="c24-para-0084" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">What can you get out of this header information?<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你能从这些头部信息中获得什么？</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0085" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">With HTTP/2 the authority, method, path, and scheme headers
                    are now prefixed with a <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">:</code>. Some headers
                    used with HTTP/1.1, such as the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Connection</code> header,
                    are no longer needed with HTTP/2.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 HTTP/2 时，权限、方法、路径和方案标头现在以 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">:</code>
                                为前缀。一些与 HTTP/1.1 一起使用的标头，如 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Connection</code>
                                标头，在 HTTP/2 中不再需要。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0086" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Accept</code> header
                    defines the Multipurpose Internet Mail Extensions (MIME) formats the browser accepts. MIME was
                    originally used with email attachments but now has a more general-purpose use. The list is in order
                    by the preferred formats. Depending on this information, you might decide to return data with
                    different formats based on the client's needs. Edge prefers HTML followed by XHTML and XML followed
                    by WEBP and APNG. With some of this information, a quantifier is also defined. The browsers used for
                    the output all have *
                    <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">.</code>
                    * at the end of this list to accept all data returned.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Accept</code>
                                标头定义了浏览器接受的 Multipurpose Internet Mail Extensions (MIME)格式。MIME
                                最初用于电子邮件附件，但现在有更广泛的应用。列表按首选格式排序。根据这些信息，您可能会根据客户端的需求以不同格式返回数据。Edge 优先选择 HTML，其次是 XHTML 和
                                XML，然后是 WEBP 和 APNG。根据部分信息，还定义了一个量化符。用于输出的浏览器在该列表的末尾都有* <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">.</code>
                                *以接受所有返回的数据。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0087" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">User-Agent</code> header
                    was used in ancient HTML times to differentiate the code to return to the client. Configuration
                    files existed that list the capabilities of specific browsers. Because this often failed with newer
                    browser versions and some browsers allow you to customize this string, this is no longer used. Just
                    check the user agent string from the Edge browser that marks itself as Mozilla, AppleWebKit, Gecko,
                    Chrome, Safari, and Edge. Instead of using the user-agent header, just check dynamically for the
                    browser capabilities when working with JavaScript code.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">User-Agent</code>
                                头部在古老的 HTML 时代用于区分返回给客户端的代码。配置文件列出了特定浏览器的功能。由于这在新版浏览器中经常失效，且某些浏览器允许自定义该字符串，因此不再使用。只需检查
                                Edge 浏览器发送的用户代理字符串，该浏览器会将自己标记为 Mozilla、AppleWebKit、Gecko、Chrome、Safari 和 Edge。在与
                                JavaScript 代码交互时，与其使用用户代理头部，不如动态检查浏览器功能。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0088" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Accept-Language</code>
                    header information shows the languages the user has configured. You can use this information to
                    return localized information. Localization is discussed in <a href="c22.xhtml"
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter 22</a>,
                    “Localization.”<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Accept-Language</code>
                                头部信息显示了用户配置的语言。您可以使用这些信息返回本地化信息。本地化在第 22 章“本地化”中讨论。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0089" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sec-fetch-xx</code>
                    header information belongs to the fetch metadata request headers of HTTP/2. <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sec-fetch-site</code> is
                    used with cross-origin resource sharing (CORS). <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sec-fetch-mode</code>
                    defines how the request <span aria-label="703" epub:type="pagebreak" id="Page_703"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>was initiated.
                    <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sec-fetch-user</code>
                    gives the information if the request was initiated by a user. <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">?1</code> is true, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">?0</code> false. <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sec-fetch-dest</code>
                    defines the request destination to the server. With HTML code where the navigation was initiated,
                    the value is <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">document</code>. Other
                    values are <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">script</code>, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">serviceworker</code>,
                    <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">audio</code>, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">image</code>, and others.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sec-fetch-xx</code>
                                头部信息属于 HTTP/2 的 fetch 元数据请求头部。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sec-fetch-site</code>
                                用于跨源资源共享（CORS）。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sec-fetch-mode</code>
                                定义了请求是如何发起的。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sec-fetch-user</code>
                                提供了请求是否由用户发起的信息。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">?1</code> 为真，
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">?0</code> 为假。
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sec-fetch-dest</code>
                                定义了请求的服务器目标。在 HTML 代码中发起导航时，该值为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">document</code>
                                。其他值为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">script</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">serviceworker</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">audio</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">image</code>
                                等其他值。</font>
                        </font>
                    </font>
                </p>
                <p id="c24-para-0090" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The header information that you've seen so far is what the
                    browser sends for very simple sites. Usually, there will be more detail, such as cookies,
                    authentication information, and custom information. To see all the information that is sent to and
                    from a server, including the header information, you can use the browser's developer tools and start
                    a network session; you'll see not only all the requests that are sent to the server but also header,
                    body, parameters, cookies, and timing information, as shown in <a href="#c24-fig-0002"
                        id="R_c24-fig-0002"
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Figure 24-2</a>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                你之前看到的头部信息是浏览器为非常简单的网站发送的。通常情况下，会有更多详细信息，例如
                                cookies、认证信息和自定义信息。要查看发送到服务器和从服务器接收的所有信息，包括头部信息，你可以使用浏览器的开发者工具并启动一个网络会话；你不仅能看到发送到服务器的所有请求，还能看到头部、正文、参数、cookies
                                和时间信息，如图 24-2 所示。</font>
                        </font>
                    </font>
                </p>
                <figure data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"> <img
                        alt="Snapshot of the homepage f Wiley Publisher." class="center" src="images/c24f002.png" />
                    <figcaption data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span
                                class="figureLabel"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a
                                    href="#R_c24-fig-0002" id="c24-fig-0002" role="doc-backlink"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><b
                                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                                        data-immersive-translate-paragraph="1">FIGURE 24-2<font
                                            class="notranslate immersive-translate-target-wrapper"
                                            data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                            <font class="notranslate"
                                                data-immersive-translate-translation-element-mark="1">  </font>
                                            <font
                                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                                data-immersive-translate-translation-element-mark="1">
                                                <font
                                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                                    data-immersive-translate-translation-element-mark="1">图 24-2</font>
                                            </font>
                                        </font></b></a></span></p>
                    </figcaption>
                </figure>
            </section>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0024"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-466" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Query Parameters <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">查询参数</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The following <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">QueryParameters</code>
                    method is used to retrieve parameters named <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">x</code> and <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">y</code> from the query
                    string. If parsing the parameters to <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">int</code> values
                    succeeds, a calculation is done. Depending on the input, different HTML code is returned (code file
                    <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestAndResponseSamples.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">以下 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">QueryParameters</code>
                                方法用于从查询字符串中获取名为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">x</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">y</code>
                                的参数。如果将参数解析为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">int</code>
                                值成功，则会进行计算。根据输入，会返回不同的 HTML 代码（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestAndResponseSamples.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0035"><code>public string QueryString(HttpRequest request)</code>
<code>{</code>
<code>  <b>string xtext = request.Query["x"];</b></code>
<code>  <b>string ytext = request.Query["y"];</b></code>
<code> <span aria-label="704" epub:type="pagebreak" id="Page_704" role="doc-pagebreak"></span></code>
<code>  if (xtext == null || ytext == null)</code>
<code>  {</code>
<code>    return "x and y must be set".Div();</code>
<code>  }</code>
<code> </code>
<code>  if (!int.TryParse(xtext, out int x))</code>
<code>  {</code>
<code>    return $"Error parsing {xtext}".Div();</code>
<code>  }</code>
<code> </code>
<code>  if (!int.TryParse(ytext, out int y))</code>
<code>  {</code>
<code>    return $"Error parsing {ytext}".Div();</code>
<code>  }</code>
<code>  return $"{x} + {y} = {x + y}".Div();</code>
<code>}</code></pre>
                <p id="c24-para-0092" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IQueryCollection</code>
                    returned from the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Query</code> string also
                    enables you to access all the keys using the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Keys</code> property, and
                    it offers a <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ContainsKey</code> method
                    to check whether a specified key is available.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">从 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Query</code>
                                字符串返回的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IQueryCollection</code>
                                还允许您使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Keys</code>
                                属性访问所有键，并提供了一种 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ContainsKey</code>
                                方法来检查指定的键是否存在。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Using the URL <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://localhost:5001/randr/add?x=39&amp;y=3">https://localhost:5001/randr/add?x=39&amp;y=3</a></code>
                    shows this result in the browser:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 URL <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://localhost:5001/randr/add?x=39&amp;y=3">https://localhost:5001/randr/add?x=39&amp;y=3</a></code>
                                在浏览器中显示此结果：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0036"><code>39 + 3 = 42</code></pre>
            </section>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0025"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-467" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Form Data <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">表单数据</font>
                        </font>
                    </font>
                </h3>
                <p id="c24-para-0094" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Instead of passing data from the user to the server with a
                    query string, you can use the form HTML element. This example uses an HTTP POST request instead of
                    GET. With a POST request, the user data is passed with the body of the request instead of within the
                    query string.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">您可以使用表单 HTML
                                元素，而不是通过查询字符串将用户数据传递给服务器。此示例使用 HTTP POST 请求而不是 GET 请求。使用 POST
                                请求时，用户数据随请求体传递，而不是在查询字符串中传递。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Using form data is defined with two requests. First, the form
                    is sent to the client with a GET request, and then the user fills in the form and submits the data
                    with a POST request. As shown in the following code snippet, the method <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Form</code> invokes the
                    <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetForm</code> or <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ShowForm</code> method,
                    depending on the HTTP method type (code file <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestResponseSamples.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用表单数据涉及两个请求。首先，表单通过 GET
                                请求发送到客户端，然后用户填写表单并使用 POST 请求提交数据。如以下代码片段所示，方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Form</code>
                                根据 HTTP 方法类型（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestResponseSamples.cs</code>
                                ）调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetForm</code>
                                或 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ShowForm</code>
                                方法：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0037"><code>public string Form(HttpRequest request) =&gt;</code>
<code>  request.Method switch</code>
<code>  {</code>
<code>    "GET" =&gt; GetForm(),</code>
<code>    "POST" =&gt; ShowForm(request),</code>
<code>    _ =&gt; string.Empty</code>
<code>  };</code></pre>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The form is created with an input element named <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">text1</code> and a Submit
                    button. Clicking the Submit button invokes the form's <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">action</code> method with
                    an HTTP method as defined with the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">method</code> argument:
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">表单使用一个名为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">text1</code>
                                的输入元素和一个提交按钮创建。点击提交按钮会调用表单的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">action</code>
                                方法，其 HTTP 方法通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">method</code>
                                参数定义：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0038"><code>private static string GetForm() =&gt;</code>
<code>  "&lt;form method=\"post\" action=\"/randr/form\"&gt;" +</code>
<code>  "&lt;input type=\"text\" name=\"text1\"/&gt;" +</code>
<code>  "&lt;input type=\"submit\" value=\"Submit\ "/&gt;" +</code>
<code>  "&lt;/form&gt;";</code></pre>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">For reading the form data, the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpRequest</code> class
                    defines a <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Form</code>
                    property. This property returns an <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IFormCollection</code>
                    object that contains all the data from the form that is sent to the server:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">对于读取表单数据， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpRequest</code>
                                类定义了一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Form</code>
                                属性。该属性返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IFormCollection</code>
                                对象，其中包含发送到服务器的所有表单数据：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0039"><code>private string ShowForm(HttpRequest request)</code>
<code>{<span aria-label="705" epub:type="pagebreak" id="Page_705" role="doc-pagebreak"></span></code>
<code>  StringBuilder sb = new();</code>
<code>  if (request.HasFormContentType)</code>
<code>  {</code>
<code>    IFormCollection coll = request.Form;</code>
<code>    foreach (var key in coll.Keys)</code>
<code>    {</code>
<code>      sb.Append(key.Div(HtmlEncoder.Default.Encode(coll[key])));</code>
<code>    }</code>
<code>    return sb.ToString();</code>
<code>  }</code>
<code>  else return "no form".Div();</code>
<code>}</code></pre>
                <p id="c24-para-0098" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Using the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr/form</code> link,
                    the form is received with the GET request. When you click the Submit button, the form is sent with
                    the POST request, and you can see the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">text1</code> key for the
                    form data.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr/form</code>
                                链接，表单通过 GET 请求接收。当你点击提交按钮时，表单通过 POST 请求发送，你可以看到表单数据的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">text1</code>
                                键。</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0026"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-468" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Cookies </h3>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">To remember user data between multiple requests, you can use
                    cookies. Adding a cookie to the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpResponse</code>
                    object sends the cookie within the HTTP header from the server to the client. By default, a cookie
                    is temporary (not stored on the client), and the browser sends it back to the server if the URL is
                    the same domain where the cookie was coming from. You can set the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Path</code> to restrict
                    when the browser returns the cookie. In this case, the cookie is returned only when it comes from
                    the same domain and the path <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr</code> is used.
                    When you set the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Expires</code> property,
                    the cookie is a persistent cookie, which means it is stored on the client. When the expiration time
                    passes, the cookie will be removed. However, there's no guarantee that the cookie isn't removed
                    earlier (code file <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestResponseSamples.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">为了在多个请求之间记住用户数据，你可以使用 cookies。向
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpResponse</code>
                                对象添加 cookie 会将 cookie 通过 HTTP 头从服务器发送到客户端。默认情况下，cookie 是临时的（不会存储在客户端），如果 URL 是来自 cookie
                                的相同域，浏览器会将其发送回服务器。你可以设置 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Path</code>
                                来限制浏览器何时返回 cookie。在这种情况下，只有当它来自相同域且使用路径 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/randr</code>
                                时，cookie 才会被返回。当你设置 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Expires</code>
                                属性时，cookie 是持久 cookie，这意味着它存储在客户端。当过期时间过去后，cookie 将被删除。但是，没有保证 cookie 不会更早被删除（代码文件 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestResponseSamples.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0040"><code>public string WriteCookie(HttpResponse response)</code>
<code>{</code>
<code>  response.Cookies.Append("color", "red", new CookieOptions</code>
<code>  {</code>
<code>    Path = "/randr",</code>
<code>    Expires = DateTime.Now.AddDays(1)</code>
<code>  });</code>
<code>  return "cookie written".Div();</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The cookie can be read again by reading the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpRequest</code>
                    object. The <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Cookies</code> property
                    contains all the cookies that are returned by the browser:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">通过读取 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpRequest</code>
                                对象可以再次读取 cookie。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Cookies</code>
                                属性包含浏览器返回的所有 cookies：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0041"><code>public string ReadCookie(HttpRequest request)</code>
<code>{</code>
<code>  StringBuilder sb = new();</code>
<code>  IRequestCookieCollection cookies = request.Cookies;</code>
<code>  foreach (var key in cookies.Keys)</code>
<code>  {</code>
<code>    sb.Append(key.Div(cookies[key]));</code>
<code>  }</code>
<code>  return sb.ToString();</code>
<code>}</code></pre>
                <p id="c24-para-0101" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">For testing cookies, you can also use the browser's developer
                    tools. The tools show all the information about the cookies that are sent and received.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要测试
                                Cookie，您也可以使用浏览器的开发者工具。这些工具会显示所有发送和接收的 Cookie 信息。</font>
                        </font>
                    </font>
                </p>
            </section> <span aria-label="706" epub:type="pagebreak" id="Page_706" role="doc-pagebreak"
                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <section data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><span id="c24-sec-0027"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
                <h3 id="head-3-469" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">Sending JSON<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">发送 JSON</font>
                        </font>
                    </font>
                </h3>
                <p id="c24-para-0102" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The server returns more than HTML code; it also returns many
                    kinds of data formats, such as CSS files, images, and videos. The client knows what kind of data it
                    receives with the help of a MIME type in the response header.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">服务器返回的不仅仅是 HTML 代码，还包括多种数据格式，如 CSS
                                文件、图片和视频。客户端通过响应头中的 MIME 类型知道它接收了什么类型的数据。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">The method <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetJson</code> creates a
                    JSON string from an anonymous object with <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Title</code>, <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Publisher</code>, and
                    <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Author</code>
                    properties. To serialize this object with JSON, the NuGet package <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NewtonSoft.Json</code> is
                    added, and the namespace <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NewtonSoft.Json</code>
                    imported. The MIME type for the JSON format is <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">application/json</code>.
                    This is set via the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ContentType</code>
                    property of the <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpResponse</code> (code
                    file <code
                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestResponseSample.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">GetJson</code>
                                使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Title</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Publisher</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Author</code>
                                属性从匿名对象创建一个 JSON 字符串。为了用 JSON 序列化这个对象，添加了 NuGet 包 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NewtonSoft.Json</code>
                                ，并导入了命名空间 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NewtonSoft.Json</code>
                                。JSON 格式的 MIME 类型是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">application/json</code>
                                。这通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpResponse</code>
                                （代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/RequestResponseSample.cs</code>
                                ）的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ContentType</code>
                                属性设置：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0042"><code>public string GetJson(HttpResponse response)</code>
<code>{</code>
<code>  var b = new</code>
<code>  {</code>
<code>    Title = "Professional C# and .NET - 2021 Edition",</code>
<code>    Publisher = "Wiley",</code>
<code>    Author = "Christian Nagel"</code>
<code>  };</code>
<code>  string json = JsonSerializer.Serialize(b);</code>
<code>  response.ContentType = "application/json";</code>
<code>  return json;</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                    data-immersive-translate-paragraph="1">This is the data returned to the client:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这是返回给客户端的数据：</font>
                        </font>
                    </font>
                </p>
                <pre id="c24-code-0043"><code>{"Title":"Professional C# and .NET 2021","Publisher":"Wiley",</code>
<code>  "Author":"Christian Nagel"}</code></pre>
                <aside data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <div class="top hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <p id="c24-para-0106" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NOTE</b> <i
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">JSON
                                serialization is explained in <a href="c18.xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter
                                    18</a>, “Files and Streams.” Sending/receiving JSON with REST APIs is covered in <a
                                    href="c25.xhtml"
                                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter
                                    25</a>, “Services.”</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意：JSON 序列化在第 18
                                        章“文件和流”中解释。使用 REST API 发送/接收 JSON 在第 25 章“服务”中介绍。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section>
        </section>
        <section aria-labelledby="head-2-224" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <span id="c24-sec-0029" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <h2 id="head-2-224" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">SESSION STATE<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">会话状态 </font>
                    </font>
                </font>
            </h2>
            <p id="c24-para-0107" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">A service that is implemented using middleware is <i
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">session state</i>. Session
                state enables temporarily remembering data from the client on the server. Session state itself is
                implemented as middleware.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            使用中间件实现的服务是会话状态。会话状态允许在服务器上临时保存来自客户端的数据。会话状态本身也是以中间件的形式实现的。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0108" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Session state is initiated when a user first requests a page from
                a server. While the user keeps opening pages on the server, the session continues until a timeout
                (typically 10 minutes) occurs. To keep state on the server while the user navigates to a new page, state
                can be written to a session. When a timeout is reached, the session data is removed.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            当用户首次从服务器请求页面时，会话状态被初始化。在用户持续打开服务器上的页面期间，会话会持续到超时（通常为 10
                            分钟）发生。为了在用户导航到新页面时在服务器上保持状态，可以将状态写入会话。当超时达到时，会话数据将被移除。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0109" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">To identify a session, on the first request, a temporary cookie
                with a session identifier is created. This cookie is returned from the client with every request to the
                server until the browser is closed, and then the cookie is deleted. Session identifiers can also be sent
                in the URL string as an alternative to using cookies.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要识别会话，在第一次请求时，会创建一个包含会话标识符的临时
                            cookie。这个 cookie 会随着客户端的每次请求发送到服务器，直到浏览器关闭，然后 cookie 会被删除。会话标识符也可以作为使用 cookie 的替代方案，通过 URL
                            字符串发送。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0110" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">On the server side, session information can be stored in local
                memory. In a web farm, session state that is stored in local memory doesn't propagate between different
                systems. With a sticky session configuration, the user always returns to the same physical server, so
                the user has the state available on the server—unless the server fails. If the server is not configured
                to use sticky sessions, the client request can go to any server instance. With such a configuration, you
                can store session state within distributed memory or a database. Storing session state in distributed
                memory also helps with process recycling of the server process; recycling kills session state if you're
                using just a single server process.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在服务器端，会话信息可以存储在本地内存中。在一个 Web
                            农场中，存储在本地内存中的会话状态不会在不同系统之间传播。通过配置粘性会话，用户始终返回到同一个物理服务器，因此用户可以在服务器上获取状态——除非服务器发生故障。如果服务器未配置为使用粘性会话，客户端请求可以发送到任何服务器实例。在这种配置下，你可以在分布式内存或数据库中存储会话状态。在分布式内存中存储会话状态也有助于服务器进程的进程回收；如果你只使用单个服务器进程，进程回收会杀死会话状态。
                        </font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0111" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1"><span aria-label="707" epub:type="pagebreak" id="Page_707"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>To enable sessions,
                you need to configure middleware and the DI container. With the DI container, you need to register the
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ISessionStore</code>
                interface that's used by the middleware.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            要启用会话，你需要配置中间件和依赖注入容器。在依赖注入容器中，你需要注册中间件使用的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ISessionStore</code>
                            接口。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The following code snippet shows the registration of the DI
                container. The <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddSession</code> method is
                an extension method that registers <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ISessionStore</code> with the
                implementation class <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">DistributedSessionStore</code>.
                The class <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">DistributedSessionStore</code>
                needs an object implementing <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IDistributedCache</code> with
                the constructor. This is registered with the extension method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddDistributedMemoryCache</code>.
                With the options of the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddSession</code> method, you
                can configure the idle timeout and the cookie options. The cookie is used to identify the session (code
                file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">以下代码片段展示了依赖注入容器的注册。 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddSession</code>
                            方法是一个扩展方法，它将 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ISessionStore</code>
                            与实现类 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">DistributedSessionStore</code>
                            注册。类 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">DistributedSessionStore</code>
                            需要一个实现 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IDistributedCache</code>
                            的对象，并通过构造函数进行注册。这是通过扩展方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddDistributedMemoryCache</code>
                            实现的。通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddSession</code>
                            方法的选项，你可以配置空闲超时和 cookie 选项。cookie 用于识别会话（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0044"><code>public void ConfigureServices(IServiceCollection services)</code>
<code>{</code>
<code>  services.AddScoped&lt;SampleService&gt;();</code>
<code>  <b>services.AddDistributedMemoryCache();</b></code>
<code>  <b>services.AddSession(options =&gt;</b></code>
<code>    <b>options.IdleTimeout = TimeSpan.FromMinutes(10));</b></code>
<code>  <b>//…</b></code>
<code>}</code></pre>
            <aside data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                <div class="top hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <p id="c24-para-0114" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NOTE</b> <i
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Instead of using </i>
                        <code
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddDistributedMemoryCache</code>
                        <i data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"> to store the session,
                            you can add the NuGet package </i> <code
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Microsoft.Extensions.Caching.StackExchangeRedis</code>
                        <i data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"> and configure it to
                            use a Redis server for the cache across different instances.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意：您可以使用 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddDistributedMemoryCache</code>
                                    存储会话，也可以添加 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Microsoft.Extensions.Caching.StackExchangeRedis</code>
                                    NuGet 包，并配置它使用 Redis 服务器作为跨不同实例的缓存。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <hr />
                    </div>
                </section>
            </aside>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The second part is to configure the middleware in the pipeline by
                calling the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseSession</code> extension
                method. You need to invoke this method before any response is written where the session might be
                required—such as is done with the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseHeaderMiddleware</code>—thus
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseSession</code> is called
                before the other methods. The code that uses session information is mapped to the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/Session</code> path (code
                file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">第二步是通过调用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseSession</code>
                            扩展方法来配置管道中的中间件。您需要在可能需要会话的任何响应写入之前调用此方法——例如，与 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseHeaderMiddleware</code>
                            一起使用的方式——因此 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">UseSession</code>
                            在其他方法之前被调用。使用会话信息的代码映射到 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/Session</code>
                            路径（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0045"><code>public void Configure(IApplicationBuilder app, ILoggerFactory loggerFactory)</code>
<code>{</code>
<code>  //…</code>
<code>  <b>app.UseSession();</b></code>
<code>  app.UseHeaderMiddleware();</code>
<code>  //…</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">You can write session state using <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Setxxx</code> methods, such
                as <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SetString</code> and
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SetInt32</code>. These
                methods are defined with the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ISession</code> interface
                that is returned from the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Session</code> property of
                the <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>.
                Session data is retrieved using <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Getxxx</code> methods (code
                file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/SessionSample.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">您可以使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Setxxx</code>
                            方法写入会话状态，例如 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SetString</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SetInt32</code>
                            。这些方法定义在从 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>
                            的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Session</code>
                            属性返回的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ISession</code>
                            接口中。会话数据使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Getxxx</code>
                            方法检索（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/SessionSample.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0046"><code>public class SessionSample</code>
<code>{</code>
<code>  private const string SessionVisits = nameof(SessionVisits);</code>
<code>  private const string SessionTimeCreated = nameof(SessionTimeCreated);</code>
<code>  public static async Task SessionAsync(HttpContext context)</code>
<code>  {</code>
<code>    int visits = context.Session.GetInt32(SessionVisits) ?? 0;</code>
<code>    string timeCreated = context.Session.GetString(SessionTimeCreated) ??</code>
<code>      string.Empty;</code>
<code>    if (string.IsNullOrEmpty(timeCreated))</code>
<code>    {<span aria-label="708" epub:type="pagebreak" id="Page_708" role="doc-pagebreak"></span></code>
<code>      timeCreated = DateTime.Now.ToString("t", CultureInfo.InvariantCulture);</code>
<code>      context.Session.SetString(SessionTimeCreated, timeCreated);</code>
<code>    }</code>
<code>    DateTime timeCreated2 = DateTime.Parse(timeCreated);</code>
<code>    context.Session.SetInt32(SessionVisits, ++visits);</code>
<code>    await context.Response.WriteAsync(</code>
<code>      $"Number of visits within this session: {visits} " +</code>
<code>      $"that was created at {timeCreated2:T}; " +</code>
<code>      $"current time: {DateTime.Now:T}");</code>
<code>  }</code>
<code>}</code></pre>
            <aside data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                <div class="top hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <p id="c24-para-0118" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NOTE</b> <i
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">The sample code uses
                            an invariant culture to store the time when the session was created. The time shown to the
                            user is using a specific culture. It's a good practice to use invariant cultures storing
                            culture-specific data on the server. Information about invariant cultures and how to set
                            cultures is explained in <a href="c22.xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter
                                22</a>.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    注意：示例代码使用不变文化来存储会话创建时的时间。显示给用户的时间使用特定的文化。在服务器上存储特定文化数据时使用不变文化是一种良好实践。关于不变文化和如何设置文化的信息在第
                                    22 章中解释。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <hr />
                    </div>
                </section>
            </aside>
        </section>
        <section aria-labelledby="head-2-225" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <span id="c24-sec-0032" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <h2 id="head-2-225" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">HEALTH CHECKS<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">健康检查</font>
                    </font>
                </font>
            </h2>
            <p id="c24-para-0119" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">When you're running the web application in production, it's a
                good idea to implement health checks, which can automatically detect if there's an issue while the
                application is being monitored. Based on this, the routers can redirect to different service instances,
                the application can be restarted, or other actions can be triggered—for example, administrators can
                receive notifications.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在生产环境中运行 Web
                            应用程序时，实施健康检查是个好主意，这可以自动检测应用程序在监控过程中是否出现问题。基于这一点，路由器可以重定向到不同的服务实例，应用程序可以重启，或触发其他操作——例如，管理员可以收到通知。
                        </font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0120" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">When implementing health checks, you need to think about
                different scenarios. For example, the application might be <i
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">live</i> as soon as it
                responds to requests and might be <i
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">running</i> when the
                initialization is completed and the caches are filled. The application can be in a <i
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">healthy</i> state if every
                service used by the application can be reached and the database can be accessed. When the application is
                working partially, for example when not so important services cannot be reached, the state is <i
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">degraded</i>. If the
                application cannot be reached, it's <i
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">unhealthy</i>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            在实施健康检查时，你需要考虑不同的场景。例如，应用程序可能在响应请求时立即运行，也可能在初始化完成且缓存填充后运行。如果应用程序使用的每个服务都可访问且数据库可访问，应用程序处于健康状态。当应用程序部分运行时，例如不太重要的服务无法访问，状态会降级。如果应用程序无法访问，则状态为不健康。
                        </font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">With ASP.NET Core, you can implement health checks with a simple
                method or a class that implements the interface <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IHealthCheck</code>. With the
                sample application, the service class <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthSample</code> is
                created to simulate healthy and unhealthy states. Invoking the method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SetHealthy</code> by passing
                a false value, the properties <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsHealthy</code> and <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsReady</code> return false.
                By setting a true value, the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsHealthy</code> method
                immediately returns true. The <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsReady</code> property
                returns true after a delay of 10 seconds (code file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/HealthSample.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用 ASP.NET Core，你可以通过一个简单的方法或一个实现接口
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IHealthCheck</code>
                            的类来实施健康检查。在示例应用程序中，创建了一个服务类 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthSample</code>
                            来模拟健康和不健康的状态。通过传递一个 false 值来调用方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">SetHealthy</code>
                            ，属性 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsHealthy</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsReady</code> 返回
                            false。通过设置一个 true 值，方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsHealthy</code>
                            立即返回 true。属性 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsReady</code>
                            在延迟 10 秒后返回 true（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Services/HealthSample.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0047"><code>public class HealthSample : IDisposable</code>
<code>{</code>
<code>  private Timer? _timer;</code>
<code>  public void SetHealthy(bool healthy = true)</code>
<code>  {</code>
<code>    if (IsHealthy == healthy) return;</code>
<code> </code>
<code>    _isReady = false;</code>
<code>    IsHealthy = healthy;</code>
<code> </code>
<code>    if (IsHealthy)</code>
<code>    {</code>
<code>      if (_timer is not null)</code>
<code>      {</code>
<code>        _timer.Dispose();<span aria-label="709" epub:type="pagebreak" id="Page_709" role="doc-pagebreak"></span></code>
<code>      }</code>
<code>      _timer = new(o =&gt;</code>
<code>      {</code>
<code>        _isReady = true;</code>
<code>      }, null, TimeSpan.FromSeconds(10), Timeout.InfiniteTimeSpan);</code>
<code>    }</code>
<code>  }</code>
<code> </code>
<code>  public void Dispose() =&gt; _timer?.Dispose();</code>
<code> </code>
<code>  public bool IsHealthy { get; set; } = false;</code>
<code> </code>
<code>  private bool _isReady = false;</code>
<code>  public bool IsReady =&gt; IsHealthy &amp;&amp; _isReady;</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The class <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CustomHealthCheck</code>
                implements the interface <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IHealthCheck</code>. This
                interface defines the method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CheckHealthAsync</code> that
                needs to be implemented to return a <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthCheckResult</code>. The
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthCheckResult</code>
                can be <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Healthy</code>,
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Degraded</code>, and <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Unhealthy</code>. With the
                health test, the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsHealthy</code> property of
                the <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthSample</code> is
                checked to return the corresponding state (code file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/CustomHealthCheck.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">类 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CustomHealthCheck</code>
                            实现了接口 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IHealthCheck</code>
                            。这个接口定义了需要实现的方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CheckHealthAsync</code>
                            来返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthCheckResult</code>
                            。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthCheckResult</code>
                            可以是 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Healthy</code> 、
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Degraded</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Unhealthy</code>
                            。在健康测试中，检查 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthSample</code>
                            的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsHealthy</code>
                            属性来返回相应状态（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/CustomHealthCheck.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0048"><code>public class CustomHealthCheck : IHealthCheck</code>
<code>{</code>
<code>  private readonly HealthSample _healthSample;</code>
<code>  public CustomHealthCheck(HealthSample healthSample) =&gt; _healthSample = healthSample;</code>
<code> </code>
<code>  public Task&lt;HealthCheckResult&gt; CheckHealthAsync(HealthCheckContext context, </code>
<code>    CancellationToken cancellationToken = default)</code>
<code>  {</code>
<code>    if (_healthSample.IsLive) return Task.FromResult(</code>
<code>      HealthCheckResult.Healthy("healthy"));</code>
<code>    else return Task.FromResult(HealthCheckResult.Unhealthy("unhealthy"));</code>
<code>  }</code>
<code>}</code></pre>
            <p id="c24-para-0123" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The class <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CustomReadyCheck</code> is
                implemented in a similar way. It just checks for the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsReady</code> property of
                the <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthSample</code>
                service.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">类 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CustomReadyCheck</code>
                            的实现方式类似。它只是检查 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthSample</code>
                            服务的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IsReady</code>
                            属性。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">To activate health checks, you need to register the service
                classes in the DI container and define routes for health checking, as shown in the following code
                snippet. The method <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddHealthChecks</code>
                registers a health check service class that derives from the abstract base class <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthCheckService</code> and
                returns an <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IHealthChecksBuilder</code>
                that can be used to add multiple health checks. The two health check types added are <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CustomHealthCheck</code> and
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CustomReadyCheck</code>
                using the <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddCheck</code>
                method. The first parameter of this method defines the name of the health check. With the second
                parameter, you can define what health status should be returned on failure. The third parameter defines
                tags that you can use to select specific health checks that should be used with a health link (code file
                <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            要激活健康检查，您需要在依赖注入容器中注册服务类，并定义用于健康检查的路由，如下面的代码片段所示。方法 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddHealthChecks</code>
                            注册了一个派生自抽象基类 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthCheckService</code>
                            的健康检查服务类，并返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">IHealthChecksBuilder</code>
                            ，可用于添加多个健康检查。添加的两个健康检查类型是 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CustomHealthCheck</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">CustomReadyCheck</code>
                            ，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddCheck</code>
                            方法。此方法的第一个参数定义了健康检查的名称。使用第二个参数，您可以定义在失败时应返回的健康状态。第三个参数定义了您可以使用标签来选择特定健康检查的标签，这些标签应与健康链接（代码文件
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                            ）一起使用：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0049"><code>public void ConfigureServices(IServiceCollection services)</code>
<code>{</code>
<code>  //…</code>
<code>  services.AddSingleton&lt;HealthSample&gt;();</code>
<code>  services.AddHealthChecks()</code>
<code>    .AddCheck&lt;CustomHealthCheck&gt;("livecheck", </code>
<code>      HealthStatus.Unhealthy, tags: new[] { "liveness" })<span aria-label="710" epub:type="pagebreak" id="Page_710" role="doc-pagebreak"></span></code>
<code>    .AddCheck&lt;CustomReadyCheck&gt;("readycheck", </code>
<code>      HealthStatus.Degraded, tags: new[] { "readiness" });</code>
<code>}</code></pre>
            <p id="c24-para-0125" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Instead of passing a type with the generic parameter of the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddCheck</code> method, you
                can pass a delegate to the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddCheck</code> and <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddCheckAsync</code> methods.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">您也可以不通过 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddCheck</code>
                            方法的泛型参数传递类型，而是将委托传递给 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddCheck</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">AddCheckAsync</code>
                            方法。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">In the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Configure</code> method where
                the middleware is configured, you specify links for health checks with the endpoint configuration. With
                the following code snippet, the first invocation of the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">MapHealthChecks</code> method
                defines a link where all health checks specified are tested. The <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">MapHealthChecks</code> method
                has an option to pass <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthCheckOptions</code>
                with the second parameter. Here, the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Predicate</code> property is
                set and can be used to select health check definitions that are marked with the tag <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">liveness</code>. You can also
                specify which HTTP status codes should be returned based on the health information. The sample code just
                specifies the same configuration as the default configuration: 200 OK with healthy and degraded status
                and 503 service unavailable when the health check returned unhealthy. You can adapt this to your needs
                (code file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在配置中间件的 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Configure</code>
                            方法中，你通过端点配置指定健康检查的链接。使用以下代码片段， <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">MapHealthChecks</code>
                            方法的第一次调用定义了一个链接，其中指定的所有健康检查都会被测试。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">MapHealthChecks</code>
                            方法有一个选项，可以通过第二个参数传递 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthCheckOptions</code>
                            。在这里， <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Predicate</code>
                            属性被设置，并可用于选择带有 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">liveness</code>
                            标签的健康检查定义。你还可以指定基于健康信息的应返回哪些 HTTP 状态码。示例代码仅指定了与默认配置相同的配置：健康和降级状态返回 200 OK，当健康检查返回不健康时返回 503
                            服务不可用。你可以根据需要调整（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0050"><code>app.UseEndpoints(endpoints =&gt;</code>
<code>{</code>
<code>  endpoints.MapHealthChecks("/health/allchecks");</code>
<code>  endpoints.MapHealthChecks("/health/live", new HealthCheckOptions()</code>
<code>  {</code>
<code>    Predicate = reg =&gt; reg.Tags.Contains("liveness"),</code>
<code>    ResultStatusCodes = new Dictionary&lt;HealthStatus, int&gt;()</code>
<code>    {</code>
<code>      [HealthStatus.Healthy] = StatusCodes.Status200OK,</code>
<code>      [HealthStatus.Degraded] = StatusCodes.Status200OK,</code>
<code>      [HealthStatus.Unhealthy] = StatusCodes.Status503ServiceUnavailable</code>
<code>    }</code>
<code>  });</code></pre>
            <p id="c24-para-0127" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">To implement health checks, ASP.NET Core includes functionality
                in the namespace <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Microsoft.Extensions.Diagnostics.HealthChecks</code>.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要实现健康检查，ASP.NET Core 在 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Microsoft.Extensions.Diagnostics.HealthChecks</code>
                            命名空间中包含了相关功能。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The next health check maps to the link <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/health/ready</code> and uses
                the readiness health check. This code sample shows that you can fully customize the output with the
                options by setting the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ResponseWriter</code>
                property. This property needs a delegate that receives the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code> and the
                <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthReport writer</code>.
                You can use this writer to get every issue that was returned from the different health checks and return
                this information to the caller via the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code> (code file
                <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">下一个健康检查映射到链接 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">/health/ready</code>
                            并使用就绪健康检查。这个代码示例展示了你可以通过设置 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ResponseWriter</code>
                            属性来完全自定义输出。这个属性需要一个委托，该委托接收 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthReport writer</code>
                            。你可以使用这个写入器来获取从不同的健康检查返回的每个问题，并通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HttpContext</code>
                            返回这些信息给调用者（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Startup.cs</code>
                            ):</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0051"><code>endpoints.MapHealthChecks("/health/ready", new HealthCheckOptions</code>
<code>{</code>
<code>  Predicate = reg =&gt; reg.Tags.Contains("readiness"),</code>
<code>  ResponseWriter = async (context, writer) =&gt;</code>
<code>  {</code>
<code>    context.Response.StatusCode = writer.Status switch</code>
<code>    {</code>
<code>      HealthStatus.Healthy =&gt; StatusCodes.Status200OK,</code>
<code>      HealthStatus.Degraded =&gt; StatusCodes.Status503ServiceUnavailable,</code>
<code>      HealthStatus.Unhealthy =&gt; StatusCodes.Status503ServiceUnavailable,</code>
<code>      _ =&gt; StatusCodes.Status503ServiceUnavailable</code>
<code>    };</code>
<code> </code>
<code>    if (writer.Status == HealthStatus.Healthy)</code>
<code>    {<span aria-label="711" epub:type="pagebreak" id="Page_711" role="doc-pagebreak"></span></code>
<code>      await context.Response.WriteAsync("ready");</code>
<code>    }</code>
<code>    else</code>
<code>    {</code>
<code>      await context.Response.WriteAsync(writer.Status.ToString());</code>
<code>      await context.Response.WriteAsync($"duration: {writer.TotalDuration}");</code>
<code>    }</code>
<code>  }</code>
<code>});</code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">With this health check in place, you can try the links to receive
                health check information. With the downloadable sample code, the link <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sethealthy/?healthy=true</code>
                can be used to set the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthSample</code> service
                class to live and ready, passing false to unhealthy.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            有了这个健康检查功能，您可以尝试这些链接来获取健康检查信息。通过可下载的示例代码，可以使用链接 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">sethealthy/?healthy=true</code>
                            将 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">HealthSample</code>
                            服务类设置为运行状态并准备就绪，向不健康的传递 false。</font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                <div class="top hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <p id="c24-para-0130" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NOTE</b> <i
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Instead of creating
                            health check types for every scenario you need, you can use available NuGet packages with
                            health-check classes such as </i><code
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Microsoft.Extensions.Diagnostics.HealthChecks.EntityFrameworkCore</code><i
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">, which checks for
                            accessibility of the database server connected to the EF Core context. With </i><code
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ASPNETCore.HealthChecks.*</code><i
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"> packages (these
                            packages are not from Microsoft), health checks for SQL Server, Redis, Application Insights,
                            MongoDB, CosmosDB, Azure KeyVault, and many other scenarios are available for use. Check the
                            GitHub repo at </i><code
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://github.com/xabaril/AspNetCore.Diagnostics.HealthChecks">https://github.com/xabaril/AspNetCore.Diagnostics.HealthChecks</a></code><i
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"> for more
                            information.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    注意：您无需为每个场景创建健康检查类型，可以直接使用包含健康检查类的 NuGet 包，例如 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Microsoft.Extensions.Diagnostics.HealthChecks.EntityFrameworkCore</code>
                                    ，该类用于检查与 EF Core 上下文连接的数据库服务器的可访问性。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">ASPNETCore.HealthChecks.*</code>
                                    包（这些包并非来自 Microsoft），即可获得用于 SQL Server、Redis、Application
                                    Insights、MongoDB、CosmosDB、Azure KeyVault 以及其他许多场景的健康检查功能。有关更多信息，请查看 GitHub 仓库 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://github.com/xabaril/AspNetCore.Diagnostics.HealthChecks">https://github.com/xabaril/AspNetCore.Diagnostics.HealthChecks</a></code>
                                    。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <hr />
                    </div>
                </section>
            </aside>
        </section>
        <section aria-labelledby="head-2-226" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <span id="c24-sec-0034" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <h2 id="head-2-226" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">DEPLOYMENT<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">部署</font>
                    </font>
                </font>
            </h2>
            <p id="c24-para-0131" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">To publish the web application, from the Visual Studio Solution
                Explorer, you can select the Publish option in the context menu of the application. From there, you can
                directly publish the application to an on-premises IIS or a Microsoft Azure App Service. Using the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet</code> CLI, you can
                use <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet publish</code>
                to prepare the files for publication (be sure the current directory of your command prompt is the
                directory of the project file). Use the option <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">-c Release</code> to prepare
                release code to publish. Read <a href="c01.xhtml"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Chapter 1</a>, “.NET
                Applications and Tools,” to include the runtime with the publish package.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要发布 Web 应用程序，可以从 Visual Studio
                            解决方案资源管理器中，在应用程序的上下文菜单中选择发布选项。然后，您可以直接将应用程序发布到本地 IIS 或 Microsoft Azure App Service。使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet</code>
                            CLI，您可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet publish</code>
                            准备发布文件（请确保您的命令提示符当前目录是项目文件所在的目录）。使用选项 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">-c Release</code>
                            准备发布版本代码。请阅读第一章“.NET 应用程序和工具”，以将运行时包含在发布包中。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0132" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">With Microsoft Azure, you can create an Azure App Service plan
                with Windows or Linux environments and a web app and publish the .NET application there. See the readme
                file with the chapter's downloadable code for a script and instructions to create an Azure App Service
                plan and a web app using the Azure CLI.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用 Microsoft Azure，您可以创建一个具有 Windows 或
                            Linux 环境的 Azure App Service 计划，并发布 .NET 应用程序。请参阅章节的可下载代码中的 README 文件，以获取使用 Azure CLI 创建
                            Azure App Service 计划和 Web 应用的脚本和说明。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0133" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">One great option to publish your application is to create a
                Docker image. With a Docker image, you have one file that you can publish into a registry (such as <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="http://hub.docker.com">hub.docker.com</a></code>
                or your private Azure Container Registry), and you can pull the image from an Azure Container Instance,
                a Kubernetes cluster, or an Azure App Service to run the image within a Docker container.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">发布应用程序的一个绝佳选项是创建 Docker 镜像。使用 Docker
                            镜像，您有一个文件可以发布到注册表（例如 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="http://hub.docker.com">hub.docker.com</a></code>
                            或您的私有 Azure 容器注册表），并且您可以从 Azure 容器实例、Kubernetes 集群或 Azure App Service 拉取镜像，在 Docker
                            容器内运行该镜像。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0134" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">To create a Docker image from the application, you need to have a
                file named <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Dockerfile</code> with the
                commands to create the image, and you need to have Docker Desktop installed. The following <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Dockerfile</code> consists of
                multiple stages to create a Docker image. Every stage starts with a <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM</code> command. The
                first <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM</code> command
                creates a temporary image that is based on the image <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="http://mcr.microsoft.com/dotnet/aspnet:5.0">mcr.microsoft.com/dotnet/aspnet:5.0</a></code>.
                This is Microsoft's prebuilt image containing the .NET 5 runtime and is optimized for production. With
                the Docker command <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">EXPOSE</code>, ports 80 and
                443 are opened.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要从应用程序创建 Docker 镜像，您需要一个名为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Dockerfile</code>
                            的文件，其中包含创建镜像的命令，并且需要安装 Docker Desktop。以下 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Dockerfile</code>
                            包含多个阶段来创建 Docker 镜像。每个阶段都以 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM</code>
                            命令开始。第一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM</code>
                            命令创建一个基于镜像 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="http://mcr.microsoft.com/dotnet/aspnet:5.0">mcr.microsoft.com/dotnet/aspnet:5.0</a></code>
                            的临时镜像。这是一个包含 .NET 5 运行的 Microsoft 预构建镜像，并针对生产进行了优化。使用 Docker 命令 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">EXPOSE</code> ，端口
                            80 和 443 被打开。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1"><span aria-label="712" epub:type="pagebreak" id="Page_712"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>The next stage is
                based on a different image. <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="http://mcr.microsoft.com/dotnet/sdk:5.0">mcr.microsoft.com/dotnet/sdk:5.0</a></code>
                is the .NET 5.0 image that has the .NET SDK included. The new temporary image that's created is built
                using the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet restore</code> command
                (to restore all packages from the NuGet server) and the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet build</code> command
                (to build the binaries for the application). The third <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM</code> continues with
                the second build image (<code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM build AS publish</code>)
                and invokes the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet publish</code> command
                to create the files needed for publication. The fourth and last <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM</code> uses the result
                of the first image (<code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM base as final</code>),
                copies the publish files from the publish image, and defines the entry point of the resulting image.
                When this image is started, the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet</code> driver is used
                to load <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp.dll</code> to
                start up the Kestrel server (Docker file <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Dockerfile</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">下一阶段基于不同的镜像。 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="http://mcr.microsoft.com/dotnet/sdk:5.0">mcr.microsoft.com/dotnet/sdk:5.0</a></code>
                            是包含 .NET SDK 的 .NET 5.0 镜像。新创建的临时镜像使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet restore</code>
                            命令（从 NuGet 服务器恢复所有包）和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet build</code>
                            命令（构建应用程序的二进制文件）进行构建。第三个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM</code>
                            继续使用第二个构建镜像（ <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM build AS publish</code>
                            ），并调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet publish</code>
                            命令来创建发布所需的文件。第四个也是最后一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM</code>
                            使用第一个镜像（ <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">FROM base as final</code>
                            ）的结果，从发布镜像复制发布文件，并定义结果镜像的入口点。当这个镜像启动时，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">dotnet</code>
                            驱动加载 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp.dll</code>
                            来启动 Kestrel 服务器（Docker 文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">WebSampleApp/Dockerfile</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0052"><code>FROM mcr.microsoft.com/dotnet/aspnet:5.0 AS base</code>
<code>WORKDIR /app</code>
<code>EXPOSE 80</code>
<code>EXPOSE 443</code>
<code> </code>
<code>FROM mcr.microsoft.com/dotnet/sdk:5.0 AS build</code>
<code>WORKDIR /src</code>
<code>COPY ["WebSampleApp.csproj", "."]</code>
<code>RUN dotnet restore "./WebSampleApp.csproj"</code>
<code>COPY . .</code>
<code>WORKDIR "/src/."</code>
<code>RUN dotnet build "WebSampleApp.csproj" -c Release -o /app/build</code>
<code> </code>
<code>FROM build AS publish</code>
<code>RUN dotnet publish "WebSampleApp.csproj" -c Release -o /app/publish</code>
<code> </code>
<code>FROM base AS final</code>
<code>WORKDIR /app</code>
<code>COPY --from=publish /app/publish .</code>
<code>ENTRYPOINT ["dotnet", "WebSampleApp.dll"]</code>
<code> </code></pre>
            <p data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">Using the Docker Desktop, you can build and publish the image
                using the Docker CLI with the current directory set to the location of the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Dockerfile</code>. The
                command <code data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">docker build</code>
                builds the image (you can see your images with <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">docker images</code>), <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">docker tag</code> tags the
                image with the prefix name of your container registry, and <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">docker push</code> pushes the
                image to the registry:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用 Docker Desktop，你可以将当前目录设置为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Dockerfile</code>
                            的位置，然后使用 Docker CLI 构建和发布镜像。命令 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">docker build</code>
                            构建镜像（你可以用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">docker images</code>
                            查看你的镜像）， <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">docker tag</code>
                            为镜像添加容器注册表的名称前缀， <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">docker push</code>
                            将镜像推送到注册表：</font>
                    </font>
                </font>
            </p>
            <pre id="c24-code-0053"><code>&gt; docker build . -t WebSampleApp/v1.0</code>
<code>&gt; docker tag WebSampleApp/v1.0 {linktoyourregistry}/WebSampleApp/v1.0</code>
<code>&gt; docker push {linktoyourregistry}/WebSampleApp/v1.0</code></pre>
            <aside data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                <div class="top hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                    <p id="c24-para-0138" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">NOTE</b> <i
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Check</i> <code
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="http://www.docker.com">www.docker.com</a></code>
                        <i data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">and</i> <code
                            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://opencontainers.org">https://opencontainers.org</a></code>
                        <i data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">for more information
                            about Docker. Also check the chapter's readme file with the downloadable source code for
                            instructions and a script to create an Azure Container Registry and to publish the image
                            stored from the registry to an Azure App Service.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 查看关于 Docker 的更多信息，请检查 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="http://www.docker.com">www.docker.com</a></code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"><a href="https://opencontainers.org">https://opencontainers.org</a></code>
                                    。同时，查看本章的 readme 文件和可下载的源代码，以获取说明和脚本，用于创建 Azure 容器注册表，并将注册表中存储的镜像发布到 Azure App
                                    Service。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
                        <hr />
                    </div>
                </section>
            </aside>
        </section> <span aria-label="713" epub:type="pagebreak" id="Page_713" role="doc-pagebreak"
            data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
        <section aria-labelledby="head-2-227" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">
            <span id="c24-sec-0036" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"></span>
            <h2 id="head-2-227" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">SUMMARY<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">摘要</font>
                    </font>
                </font>
            </h2>
            <p id="c24-para-0139" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">In this chapter, you explored the foundation of ASP.NET Core and
                web applications. With this you learned how to register services with the DI container in the ASP.NET
                Core way, as well as configuring and creating custom middleware in the <code
                    data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code> class. Using
                endpoint routing, you configured routes to implement functionality based on requests from the client and
                to return HTTP responses including features such as cookies, form data, and storing session information.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在本章中，你探索了 ASP.NET Core 和 Web
                            应用的基础。通过学习，你了解了如何以 ASP.NET Core 的方式在依赖注入容器中注册服务，以及如何在 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47">Startup</code>
                            类中配置和创建自定义中间件。使用端点路由，你配置了路由来实现基于客户端请求的功能，并返回 HTTP 响应，包括 cookie、表单数据以及存储会话信息等特性。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0140" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">You've seen how to implement health checking, which can be of
                great use when deploying Docker images and when you use many services that interact with each other.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">你已经看到了如何实现健康检查，这在部署 Docker
                            镜像以及使用许多相互交互的服务时非常有用。</font>
                    </font>
                </font>
            </p>
            <p id="c24-para-0141" data-immersive-translate-walked="528573de-1b40-4ca6-b3dd-65021e5f2a47"
                data-immersive-translate-paragraph="1">The next chapter shows how you can use ASP.NET Core to deal with
                JSON request and responses with web APIs and also use GRPC for the binary communication with services.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">下一章将展示你如何使用 ASP.NET Core 处理 Web API 中的
                            JSON 请求和响应，以及如何使用 GRPC 与服务进行二进制通信。</font>
                    </font>
                </font>
            </p>
        </section>
    </section>
</body>
<div id="immersive-translate-popup" style="all: initial"></div>

</html>