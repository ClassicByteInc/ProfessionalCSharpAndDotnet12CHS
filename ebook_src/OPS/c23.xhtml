<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops"
    xmlns:svg="http://www.w3.org/2000/svg" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en"
    imt-state="dual" imt-trans-position="after">

<head>
    <title>23 测试 --- 23 Tests</title>
    <link href="WileyTemplate_v5.5.css" rel="stylesheet" type="text/css" />
    <meta content="urn:uuid:e0000000-0000-0000-0000-000006715209" name="Adept.expected.resource" />
    <style data-id="immersive-translate-input-injected-css">
        .immersive-translate-input {
            position: absolute;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            z-index: 2147483647;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .immersive-translate-attach-loading::after {
            content: " ";

            --loading-color: #f78fb6;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: block;
            margin: 12px auto;
            position: relative;
            color: white;
            left: -100px;
            box-sizing: border-box;
            animation: immersiveTranslateShadowRolling 1.5s linear infinite;

            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-2000%, -50%);
            z-index: 100;
        }

        .immersive-translate-loading-spinner {
            vertical-align: middle !important;
            width: 10px !important;
            height: 10px !important;
            display: inline-block !important;
            margin: 0 4px !important;
            border: 2px rgba(221, 244, 255, 0.6) solid !important;
            border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-radius: 50% !important;
            padding: 0 !important;
            -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
            animation: immersive-translate-loading-animation 0.6s infinite linear !important;
        }

        @-webkit-keyframes immersive-translate-loading-animation {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @keyframes immersive-translate-loading-animation {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(359deg);
            }
        }

        .immersive-translate-input-loading {
            --loading-color: #f78fb6;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: block;
            margin: 12px auto;
            position: relative;
            color: white;
            left: -100px;
            box-sizing: border-box;
            animation: immersiveTranslateShadowRolling 1.5s linear infinite;
        }

        @keyframes immersiveTranslateShadowRolling {
            0% {
                box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            12% {
                box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            25% {
                box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            36% {
                box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color),
                    100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
            }

            50% {
                box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color),
                    110px 0 var(--loading-color), 100px 0 var(--loading-color);
            }

            62% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color),
                    120px 0 var(--loading-color), 110px 0 var(--loading-color);
            }

            75% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    130px 0 var(--loading-color), 120px 0 var(--loading-color);
            }

            87% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
            }

            100% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
            }
        }

        .immersive-translate-toast {
            display: flex;
            position: fixed;
            z-index: 2147483647;
            left: 0;
            right: 0;
            top: 1%;
            width: fit-content;
            padding: 12px 20px;
            margin: auto;
            overflow: auto;
            background: #fef6f9;
            box-shadow: 0px 4px 10px 0px rgba(0, 10, 30, 0.06);
            font-size: 15px;
            border-radius: 8px;
            color: #333;
        }

        .immersive-translate-toast-content {
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        .immersive-translate-toast-hidden {
            margin: 0 20px 0 72px;
            text-decoration: underline;
            cursor: pointer;
        }

        .immersive-translate-toast-close {
            color: #666666;
            font-size: 20px;
            font-weight: bold;
            padding: 0 10px;
            cursor: pointer;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-toast {
                top: 0;
                padding: 12px 0px 0 10px;
            }

            .immersive-translate-toast-content {
                flex-direction: column;
                text-align: center;
            }

            .immersive-translate-toast-hidden {
                margin: 10px auto;
            }
        }

        .immersive-translate-modal {
            display: none;
            position: fixed;
            z-index: 2147483647;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.4);
            font-size: 15px;
        }

        .immersive-translate-modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 40px 24px 24px;
            border: 1px solid #888;
            border-radius: 10px;
            width: 80%;
            max-width: 270px;
            font-family: system-ui, -apple-system, "Segoe UI", "Roboto", "Ubuntu",
                "Cantarell", "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
                "Segoe UI Symbol", "Noto Color Emoji";
            position: relative;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-modal-content {
                margin: 50% auto !important;
            }
        }

        .immersive-translate-modal .immersive-translate-modal-content-in-input {
            max-width: 500px;
        }

        .immersive-translate-modal-content-in-input .immersive-translate-modal-body {
            text-align: left;
            max-height: unset;
        }

        .immersive-translate-modal-title {
            text-align: center;
            font-size: 16px;
            font-weight: 700;
            color: #333333;
        }

        .immersive-translate-modal-body {
            text-align: center;
            font-size: 14px;
            font-weight: 400;
            color: #333333;
            word-break: break-all;
            margin-top: 24px;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-modal-body {
                max-height: 250px;
                overflow-y: auto;
            }
        }

        .immersive-translate-close {
            color: #666666;
            position: absolute;
            right: 16px;
            top: 16px;
            font-size: 20px;
            font-weight: bold;
        }

        .immersive-translate-close:hover,
        .immersive-translate-close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        .immersive-translate-modal-footer {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 24px;
        }

        .immersive-translate-btn {
            width: fit-content;
            color: #fff;
            background-color: #ea4c89;
            border: none;
            font-size: 16px;
            margin: 0 8px;
            padding: 9px 30px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .immersive-translate-btn:hover {
            background-color: #f082ac;
        }

        .immersive-translate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .immersive-translate-btn:disabled:hover {
            background-color: #ea4c89;
        }

        .immersive-translate-cancel-btn {
            /* gray color */
            background-color: rgb(89, 107, 120);
        }

        .immersive-translate-cancel-btn:hover {
            background-color: hsl(205, 20%, 32%);
        }

        .immersive-translate-action-btn {
            background-color: transparent;
            color: #ea4c89;
            border: 1px solid #ea4c89;
        }

        .immersive-translate-btn svg {
            margin-right: 5px;
        }

        .immersive-translate-link {
            cursor: pointer;
            user-select: none;
            -webkit-user-drag: none;
            text-decoration: none;
            color: #007bff;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        .immersive-translate-primary-link {
            cursor: pointer;
            user-select: none;
            -webkit-user-drag: none;
            text-decoration: none;
            color: #ea4c89;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        .immersive-translate-modal input[type="radio"] {
            margin: 0 6px;
            cursor: pointer;
        }

        .immersive-translate-modal label {
            cursor: pointer;
        }

        .immersive-translate-close-action {
            position: absolute;
            top: 2px;
            right: 0px;
            cursor: pointer;
        }

        .imt-image-status {
            background-color: rgba(0, 0, 0, 0.5) !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
            border-radius: 16px !important;
        }

        .imt-image-status img,
        .imt-image-status svg,
        .imt-img-loading {
            width: 28px !important;
            height: 28px !important;
            margin: 0 0 8px 0 !important;
            min-height: 28px !important;
            min-width: 28px !important;
            position: relative !important;
        }

        .imt-img-loading {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAtFBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////oK74hAAAAPHRSTlMABBMIDyQXHwyBfFdDMSw+OjXCb+5RG51IvV/k0rOqlGRM6KKMhdvNyZBz9MaupmxpWyj437iYd/yJVNZeuUC7AAACt0lEQVRIx53T2XKiUBCA4QYOiyCbiAsuuGBcYtxiYtT3f6/pbqoYHVFO5r+iivpo6DpAWYpqeoFfr9f90DsYAuRSWkFnPO50OgR9PwiCUFcl2GEcx+N/YBh6pvKaefHlUgZd1zVe0NbYcQjGBfzrPE8Xz8aF+71D8gG6DHFPpc4a7xFiCDuhaWgKgGIJQ3d5IMGDrpS4S5KgpIm+en9f6PlAhKby4JwEIxlYJV9h5k5nee9GoxHJ2IDSNB0dwdad1NAxDJ/uXDHYmebdk4PdbkS58CIVHdYSUHTYYRWOJblWSyu2lmy3KNFVJNBhxcuGW4YBVCbYGRZwIooipHsNqjM4FbgOQqQqSKQQU9V8xmi1QlgHqQQ6DDBvRUVCDirs+EzGDGOQTCATgtYTnbCVLgsVgRE0T1QE0qHCFAht2z6dLvJQs3Lo2FQoDxWNUiBhaP4eRgwNkI+dAjVOA/kUrIDwf3CG8NfNOE0eiFotSuo+rBiq8tD9oY4Qzc6YJw99hl1wzpQvD7ef2M8QgnOGJfJw+EltQc+oX2yn907QB22WZcvlUpd143dqQu+8pCJZuGE4xCuPXJqqcs5sNpsI93Rmzym1k4Npk+oD1SH3/a3LOK/JpUBpWfqNySxWzCfNCUITuDG5dtuphrUJ1myeIE9bIsPiKrfqTai5WZxbhtNphYx6GEIHihyGFTI69lje/rxajdh0s0msZ0zYxyPLhYCb1CyHm9Qsd2H37Y3lugVwL9kNh8Ot8cha6fUNQ8nuXi5z9/ExsAO4zQrb/ev1yrCB7lGyQzgYDGuxq1toDN/JGvN+HyWNHKB7zEoK+PX11e12G431erGYzwmytAWU56fkMHY5JJnDRR2eZji3AwtIcrEV8Cojat/BdQ7XOwGV1e1hDjGGjXbdArm8uJZtCH5MbcctVX8A1WpqumJHwckAAAAASUVORK5CYII=");
            background-size: 28px 28px;
            animation: image-loading-rotate 1s linear infinite !important;
        }

        .imt-image-status span {
            color: var(--bg-2, #fff) !important;
            font-size: 14px !important;
            line-height: 14px !important;
            font-weight: 500 !important;
            font-family: "PingFang SC", Arial, sans-serif !important;
        }

        @keyframes image-loading-rotate {
            from {
                transform: rotate(360deg);
            }

            to {
                transform: rotate(0deg);
            }
        }
    </style>
    <style data-id="immersive-translate-default-injected-css">
        :root {
            --immersive-translate-theme-underline-borderColor: #72ece9;
            --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
            --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
            --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
            --immersive-translate-theme-highlight-backgroundColor: #ffff00;
            --immersive-translate-theme-dashed-borderColor: #59c1bd;
            --immersive-translate-theme-blockquote-borderColor: #cc3355;
            --immersive-translate-theme-thinDashed-borderColor: #ff374f;
            --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
            --immersive-translate-theme-dashedBorder-borderRadius: 0;
            --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
            --immersive-translate-theme-solidBorder-borderRadius: 0;
            --immersive-translate-theme-dotted-borderColor: #94a3b8;
            --immersive-translate-theme-wavy-borderColor: #72ece9;
            --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
            --immersive-translate-theme-grey-textColor: #2f4f4f;
            --immersive-translate-theme-marker-backgroundColor: #fbda41;
            --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
            --immersive-translate-theme-marker2-backgroundColor: #ffff00;
            --immersive-translate-theme-background-backgroundColor: #dbafaf;
            --immersive-translate-theme-background-backgroundColor-rgb: 219, 175, 175;
            --immersive-translate-theme-background-backgroundOpacity: 12;
            --immersive-translate-theme-opacity-opacity: 10;
        }

        [imt-state="dual"] .immersive-translate-target-translation-pre-whitespace {
            white-space: pre-wrap !important;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container {
            position: absolute;
            background-color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
                sans-serif;
            top: 0;
            width: 600px;
            height: 100%;
            z-index: 2;
            line-height: 1.3;
            font-size: 16px;
        }

        [imt-state="dual"] .immersive-translate-target-wrapper[dir="rtl"] {
            text-align: right;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container .immersive-translate-target-wrapper {
            color: rgb(0, 0, 0);
            white-space: normal;
            position: absolute;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container .immersive-translate-target-wrapper font {
            color: inherit;
            white-space: inherit;
            position: unset;
        }

        [imt-state="translation"] .immersive-translate-target-wrapper &gt;

        br {
            display: none;
        }

        [imt-state="translation"] .immersive-translate-target-translation-block-wrapper {
            margin: 0 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper {
            margin: 8px 0 !important;
            display: inline-block;
        }

        [imt-trans-position="before"] .immersive-translate-target-translation-block-wrapper {
            display: block;
        }

        [imt-trans-position="before"] .immersive-translate-target-translation-block-wrapper {
            margin-top: 0 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-pdf-block-wrapper {
            margin: 0 !important;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-grey-inner {
            color: var(--immersive-translate-theme-grey-textColor);
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-underline-inner {
            border-bottom: 1px solid var(--immersive-translate-theme-underline-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeUnderline-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeUnderline-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
            border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
            padding: 6px;
            margin-top: 2px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
            border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
            padding: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-solidBorder {
            border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
            padding: 6px;
            margin-top: 2px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
            border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
            padding: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeDashed-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeDashed-borderColor) !important;
            text-decoration-style: dashed !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-thinDashed-inner {
            border-bottom: 1px dashed var(--immersive-translate-theme-thinDashed-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-dotted-inner {
            background-image: linear-gradient(to right,
                    var(--immersive-translate-theme-dotted-borderColor) 30%,
                    rgba(255, 255, 255, 0) 0%);
            background-position: bottom;
            background-size: 5px 1px;
            background-repeat: repeat-x;
            padding-bottom: 3px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeDotted-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeDotted-borderColor) !important;
            text-decoration-style: dotted !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-wavy-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-wavy-borderColor) !important;
            text-decoration-style: wavy !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-dashed-inner {
            background: linear-gradient(to right,
                    var(--immersive-translate-theme-dashed-borderColor) 0%,
                    var(--immersive-translate-theme-dashed-borderColor) 50%,
                    transparent 50%,
                    transparent 100%) repeat-x left bottom;
            background-size: 8px 2px;
            padding-bottom: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
            content: "";
            display: block;
            max-width: 80px;
            width: 10%;
            border-top: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
            padding-top: 8px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
            content: "";
            border-left: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
            max-height: 16px;
            height: 16px;
            padding-left: 8px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-highlight-inner {
            background: var(--immersive-translate-theme-highlight-backgroundColor);
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-marker {
            line-height: 1.5em;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-marker2-inner {
            font-weight: bold;
            text-shadow: 10px 0px 3px var(--immersive-translate-theme-marker2-backgroundColor),
                16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
                2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
                -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-marker-inner {
            /* TODO: add more texture */
            background: linear-gradient(to right,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3));
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-weakening {
            opacity: 0.618 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-italic {
            font-style: italic !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-bold {
            font-weight: bold !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-paper {
            margin: 8px 0;
            box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
            padding: 16px 32px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-blockquote {
            border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
            padding-left: 12px !important;
            margin-top: 4px;
            margin-bottom: 4px;
            padding-top: 4px;
            padding-bottom: 4px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-mask-inner {
            filter: blur(5px) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-mask-inner {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner {
            filter: blur(5px) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        /* opacity theme start */

        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner {
            filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-opacity-inner {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner,
        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner:hover {
            filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner:hover {
            filter: none !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-mask-inner:hover {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner:hover {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner:hover {
            filter: none !important;
        }

        /* opacity theme end */

        /* background theme start */
        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-background {
            margin: 8px 0;
            background: rgba(var(--immersive-translate-theme-background-backgroundColor-rgb),
                    calc(var(--immersive-translate-theme-background-backgroundOpacity) * 1%));
            border-radius: 4px;
            box-shadow: unset !important;
            padding: 12px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-background-inner {
            background: rgba(var(--immersive-translate-theme-background-backgroundColor-rgb),
                    calc(var(--immersive-translate-theme-background-backgroundOpacity) * 1%));
            padding-left: 6px;
            padding-right: 6px;
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper .immersive-translate-target-translation-theme-background-inner {
            background: unset;
            padding-left: unset;
            padding-right: unset;
        }

        /* background theme end */

        /* vertical css , please remain it in the last one. */
        .immersive-translate-target-translation-vertical-block-wrapper {
            margin: 0px 8px !important;
        }

        .immersive-translate-text {
            font-size: 15px !important;
        }

        .immersive-translate-error-toast {
            position: fixed;
            top: 5%;
            z-index: 99999999;
            left: 0;
            right: 0;
            margin: auto;
            max-width: 300px;
            padding: 16px;
            border-radius: 12px;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: row;
            justify-content: space-between;
        }

        @media all and (min-width: 750px) {
            .immersive-translate-error-toast {
                max-width: 400px;
            }
        }

        .immersive-translate-clickable-button {
            cursor: pointer;
        }

        .immersive-translate-help-button {
            cursor: pointer;
        }

        .immersive-translate-loading-text:before {
            content: "...";
        }

        /* dark mode for loading */

        @media only screen and (prefers-color-scheme: dark) {
            .immersive-translate-loading {
                border: 2px rgba(255, 255, 255, 0.25) solid !important;
                border-top: 2px rgba(255, 255, 255, 1) solid !important;
            }
        }

        .immersive-translate-error-wrapper {
            position: relative;
            display: inline-flex;
            padding: 6px;
            margin: 0 12px;
            white-space: nowrap;
            font-size: 0.9em;
        }

        [lang="zh-CN"] .immersive-translate-error-wrapper {
            font-size: 0.75em;
        }

        [lang="zh-TW"] .immersive-translate-error-wrapper {
            font-size: 0.75em;
        }

        .immersive-translate-tooltip {
            position: relative;
            display: inline-flex;
            /* little indicater to indicate it's hoverable */
        }

        .immersive-translate-tooltip-content {
            /* here's the magic */
            position: absolute;
            z-index: 100000000000;

            left: 50%;
            bottom: 0;
            transform: translate(-50%, 110%);
            line-height: 1;
            /* and add a small left margin */

            /* basic styles */
            width: max-content;
            max-width: 250px;
            word-wrap: break-word;
            white-space: pre-line;
            padding: 10px;
            border-radius: 10px;
            background: #000c;
            color: #fff;
            text-align: center;
            font-size: 14px;
            display: none;
            /* hide by default */
        }

        .immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
            display: inline-block;
        }

        .immersive-translate-tooltip:hover+.immersive-translate-tooltip-content {
            display: inline-block;
        }

        .immersive-translate-tooltip-content-table {
            left: unset !important;
            bottom: unset !important;
            transform: translate(-10%, 50%) !important;
        }

        .immersive-translate-tooltip:hover:before {
            display: inline-block;
        }

        .immersive-translate-loading-spinner {
            vertical-align: middle !important;
            width: 10px !important;
            height: 10px !important;
            display: inline-block !important;
            margin: 0 4px !important;
            border: 2px rgba(221, 244, 255, 0.6) solid !important;
            border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-radius: 50% !important;
            padding: 0 !important;
            -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
            animation: immersive-translate-loading-animation 0.6s infinite linear !important;
        }

        @-webkit-keyframes immersive-translate-loading-animation {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @keyframes immersive-translate-loading-animation {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(359deg);
            }
        }

        .imt-image-status {
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--bg-2, #fff);
            font-size: 14px;
        }
    </style>
    <style data-id="immersive-translate-user-custom-style">
        :root {

            .immersive-translate-target-inner {
                font-family: inherit;
            }


            .immersive-translate-target-inner {
                font-family: inherit;
            }
        }
    </style>
    <style data-id="immersive-translate-dynamic-injected-css">
        .immersive-translate-target-wrapper[dir='rtl'] {
            text-align: right;
        }

        .immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {
            display: block;
        }

        .immersive-translate-target-wrapper {
            word-break: break-word;
            user-select: text;
        }

        [imt-state="translation"] .immersive-translate-target-wrapper[dir='rtl'] {
            display: inline-block;
        }

        [dir='rtl'] .immersive-translate-target-wrapper:not([dir]) {
            text-align: left;
        }

        [imt-state=dual] .immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
            display: block;
        }

        [imt-trans-position=before] .immersive-translate-target-translation-block-wrapper {
            display: block !important;
        }

        [imt-state][data-immersive-translate_rtl] .immersive-translate-target-wrapper {
            display: block !important;
        }
    </style>
</head>

<body epub:type="bodymatter" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
    <section aria-labelledby="c23_1" epub:type="chapter" role="doc-chapter"
        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
        <header data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
            <h1 id="c23_1" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1"><span aria-label="668" epub:type="pagebreak" id="Page_668"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span><span id="c23"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span><span
                    class="chapterNumber"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">23</span><br /><span
                    class="chapterTitle"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Tests</span></h1>
        </header>
        <section aria-label="chapter opening" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
            <span id="c23-sec-0001" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
            <aside data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                <div class="top hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <hr />
                </div>
                <section class="feature3" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <h3 data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                        data-immersive-translate-paragraph="1">WHAT'S IN THIS CHAPTER?<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">本章包含什么内容？</font>
                            </font>
                        </font>
                    </h3>
                    <ul class="check2" id="c23-list-0001"
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <li id="c23-li-0001" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                            data-immersive-translate-paragraph="1">Performing unit tests with <code
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                                        执行单元测试</font>
                                </font>
                            </font>
                        </li>
                        <li id="c23-li-0002" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                            data-immersive-translate-paragraph="1">Determining code coverage<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">确定代码覆盖率</font>
                                </font>
                            </font>
                        </li>
                        <li id="c23-li-0003" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                            data-immersive-translate-paragraph="1">Using a mocking library<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用模拟库</font>
                                </font>
                            </font>
                        </li>
                        <li id="c23-li-0004" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                            data-immersive-translate-paragraph="1">Performing integration testing with ASP.NET Core<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用 ASP.NET Core 进行集成测试
                                    </font>
                                </font>
                            </font>
                        </li>
                    </ul>
                    <div class="bottom hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <hr />
                    </div>
                </section>
            </aside>
            <aside data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                <div class="top hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <hr />
                </div>
                <section class="feature3" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><span
                        id="c23-fea-0001" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
                    <h3 id="head-2-211" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                        data-immersive-translate-paragraph="1">CODE DOWNLOADS FOR THIS CHAPTER<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">本章代码下载</font>
                            </font>
                        </font>
                    </h3>
                    <section data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><span
                            id="c23-sec-0003"
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
                        <p id="c23-para-0003" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                            data-immersive-translate-paragraph="1">The source code for this chapter is available on the
                            book page at <code
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://www.wiley.com">www.wiley.com</a></code>.
                            Click the Downloads link. The code can also be found at <code
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/ProfessionalCSharp/ProfessionalCSharp2021">https://github.com/ProfessionalCSharp/ProfessionalCSharp2021</a></code>
                            in the directory <code
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">2_Libs/Tests</code>.
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章的源代码可在书籍页面 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://www.wiley.com">www.wiley.com</a></code>
                                        上找到。点击下载链接。代码也可以在目录 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">2_Libs/Tests</code>
                                        中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/ProfessionalCSharp/ProfessionalCSharp2021">https://github.com/ProfessionalCSharp/ProfessionalCSharp2021</a></code>
                                        找到。</font>
                                </font>
                            </font>
                        </p>
                        <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                            data-immersive-translate-paragraph="1">The code for this chapter is divided into the
                            following major examples:<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章的代码分为以下主要示例：</font>
                                </font>
                            </font>
                        </p>
                        <ul class="check" id="c23-list-0002"
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                            <li id="c23-li-0005" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                                data-immersive-translate-paragraph="1">UnitTestingSample<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">单元测试示例</font>
                                    </font>
                                </font>
                            </li>
                            <li id="c23-li-0006" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                                data-immersive-translate-paragraph="1">MockingSample<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">模拟示例</font>
                                    </font>
                                </font>
                            </li>
                            <li id="c23-li-0007" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                                data-immersive-translate-paragraph="1">ASPNETCoreSample<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">ASP.NET Core 示例</font>
                                    </font>
                                </font>
                            </li>
                        </ul>
                        <p id="c23-para-0005" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                            data-immersive-translate-paragraph="1">All the samples have nullable reference types
                            enabled.<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">所有样本都启用了可空引用类型。 </font>
                                </font>
                            </font>
                        </p>
                    </section>
                    <div class="bottom hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <hr />
                    </div>
                </section>
            </aside>
        </section>
        <section aria-labelledby="head-2-212" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
            <span id="c23-sec-0004" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
            <h2 id="head-2-212" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">OVERVIEW<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">概述</font>
                    </font>
                </font>
            </h2>
            <p id="c23-para-0006" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">Application development is becoming agile. When using waterfall
                process models to analyze the requirements, it's not unusual that you design the application
                architecture, do the implementation, and then find out as the solution is ready that you built an
                application that is not needed by the user. Software development becomes agile with faster release
                cycles and early participation of the end users. Just take a look at Windows 10: with millions of
                Windows insiders who give feedback to early builds, updates happen every few months or even weeks. There
                was one special week during the beta program of Windows 10 when Windows insiders received three builds
                of Windows 10 within one week. Windows 10 is a huge program, but Microsoft managed to change development
                in a big way. Also, if you participate in the open-source <span aria-label="669" epub:type="pagebreak"
                    id="Page_669" role="doc-pagebreak"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>project of .NET, you
                can get nightly builds of NuGet packages. If you're adventurous, you might even write a book about an
                upcoming technology.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            应用开发正变得敏捷。当使用瀑布式流程模型来分析需求时，你设计应用架构、完成实现，然后在解决方案准备就绪时发现你构建的应用并非用户所需的情况并不罕见。软件开发通过更快的发布周期和早期用户的参与变得更加敏捷。只需看看
                            Windows 10：有数百万的 Windows 内部人员向早期版本提供反馈，更新每隔几个月甚至几周就会发生。在 Windows 10 的测试阶段，有一个特殊的星期，Windows
                            内部人员在一周内收到了三个 Windows 10 版本。Windows 10 是一个庞大的项目，但微软成功地在开发方式上进行了重大改变。此外，如果你参与.NET 的开源项目，你可以获得
                            NuGet 包的每日构建版本。如果你足够大胆，甚至可以写一本关于即将到来的技术的书。</font>
                    </font>
                </font>
            </p>
            <p id="c23-para-0007" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">With such fast and continuous changes—and nightly builds that you
                are creating—you can't wait for insiders or end users to find all the issues. Windows 10 insiders
                wouldn't have been happy with Windows 10 crashing every few minutes. How often have you made a change in
                the implementation of a method only to find out something that doesn't seem related is not working
                anymore? You might have tried to avoid such issues by not changing the method and instead copying and
                changing the code to create a new method, which in turn creates a maintenance nightmare. It frequently
                happens that you fix a method in one place but miss the other ones with code duplicates.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            面对如此快速且持续的变化——以及你正在构建的每日构建版本——你无法等待内部人员或最终用户发现所有问题。Windows 10 内部人员不会对 Windows 10
                            每隔几分钟就崩溃感到满意。你有多频繁地更改方法的实现，结果发现似乎无关紧要的事情不再正常工作？你可能试图通过不更改方法，而是复制并修改代码来创建新方法，从而避免这类问题，但这反过来又创造了维护噩梦。经常发生的情况是，你在某处修复了一个方法，却遗漏了代码重复的其他地方。
                        </font>
                    </font>
                </font>
            </p>
            <p id="c23-para-0008" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">You can avoid issues like these. Create tests for your methods,
                and let the tests run automatically. Using Visual Studio Enterprise, you can even run the tests with
                Live Unit Testing where the test runs while you're typing in the editor. Later, the test should run
                after you've checked in the source code. With continuous integration (CI) pipelines, load and security
                tests can run nightly so you can use CPU power that you don't need overnight.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">你可以避免这类问题。为你的方法创建测试，并让测试自动运行。使用 Visual
                            Studio Enterprise，你甚至可以在编辑器中输入时通过 Live Unit Testing
                            运行测试。稍后，测试应在你提交源代码后运行。通过持续集成（CI）管道，负载和安全测试可以每晚运行，这样你就可以利用夜间不需要的 CPU 资源。</font>
                    </font>
                </font>
            </p>
            <p id="c23-para-0009" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">Creating tests from the start increases the cost for the project
                from the beginning, but as the project progresses and during maintenance, creating tests has advantages
                and reduces the overall project cost.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            从一开始就创建测试会增加项目初期的成本，但随着项目的推进和维护阶段，创建测试具有优势并降低整体项目成本。</font>
                    </font>
                </font>
            </p>
            <p id="c23-para-0010" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">This chapter has a focus on creating unit tests but also explains
                how to create integration tests with ASP.NET Core web applications. You'll also get references to create
                UI tests with XAML-based applications and to load tests with web applications.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">本章重点介绍如何创建单元测试，但也解释了如何使用 ASP.NET Core
                            Web 应用程序创建集成测试。你还将获得使用基于 XAML 的应用程序创建 UI 测试以及使用 Web 应用程序进行负载测试的参考。</font>
                    </font>
                </font>
            </p>
            <p id="c23-para-0011" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">A unit test should verify the functionality of the smallest
                testable parts of an application—for example, methods. When you pass different input values, a unit test
                should check all possible paths through a method.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            单元测试应验证应用程序中最小可测试部分的功能——例如方法。当你传入不同的输入值时，单元测试应检查方法中所有可能的路径。</font>
                    </font>
                </font>
            </p>
        </section>
        <section aria-labelledby="head-2-213" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
            <span id="c23-sec-0005" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
            <h2 id="head-2-213" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">UNIT TESTING<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">单元测试</font>
                    </font>
                </font>
            </h2>
            <p id="c23-para-0012" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">Writing unit tests helps with code maintenance. For example, when
                you're performing a code update, you want to be confident that the update isn't going to break something
                else. Having automatic unit tests in place helps to ensure that all functionality is retained after code
                changes are made.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            编写单元测试有助于代码维护。例如，当您进行代码更新时，您希望确信更新不会破坏其他东西。部署自动单元测试有助于确保在代码更改后所有功能都得以保留。</font>
                    </font>
                </font>
            </p>
            <p id="c23-para-0013" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">The .NET CLI has built-in support to create and run unit tests.
                <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet new mstest</code>
                creates a unit test project with MSTest (<code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/microsoft/testfx">https://github.com/microsoft/testfx</a></code>).
                You can create a unit test with NUnit with <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet new nunit</code>
                (<code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://nunit.org/">https://nunit.org/</a></code>).
                <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet new xunit</code>
                creates a unit test project with <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                (<code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://xunit.net/">https://xunit.net/</a></code>).
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">.NET CLI 具有创建和运行单元测试的内置支持。 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet new mstest</code>
                            使用 MSTest ( <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/microsoft/testfx">https://github.com/microsoft/testfx</a></code>
                            ) 创建单元测试项目。您可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet new nunit</code>
                            ( <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://nunit.org/">https://nunit.org/</a></code>
                            ) 创建 NUnit 单元测试。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet new xunit</code>
                            使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                            ( <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://xunit.net/">https://xunit.net/</a></code>
                            ) 创建单元测试项目。</font>
                    </font>
                </font>
            </p>
            <p id="c23-para-0014" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">Because the .NET and ASP.NET Core teams make use of <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>,
                in this book, the test projects are built with <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                as well. However, if you prefer a different framework, it shouldn't be too hard to adapt. With other
                unit testing frameworks, you'll see different attributes to specify the tests and different methods for
                asserts, but the functionality is largely the same.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">由于 .NET 和 ASP.NET Core 团队使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                            ，因此在本书中，测试项目也使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                            构建。但是，如果您更喜欢其他框架，应该不难进行适配。使用其他单元测试框架时，您会看到不同的属性来指定测试，以及不同的断言方法，但功能大体相同。</font>
                    </font>
                </font>
            </p>
            <section data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><span id="c23-sec-0006"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
                <h3 id="head-3-448" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Creating Unit Tests <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">创建单元测试</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">The following example tests a simple method in a class
                    library named <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples</code>.
                    This is a .NET 5 class library. The class <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">DeepThought</code>
                    contains the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">TheAnswerToTheUltimateQuestionOfLifeTheUniverseAndEverything</code>
                    method, which returns <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">42</code> as a result
                    (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/DeepThought.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">以下示例测试了一个名为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples</code>
                                的类库中的简单方法。这是一个 .NET 5 类库。类 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">DeepThought</code>
                                包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">TheAnswerToTheUltimateQuestionOfLifeTheUniverseAndEverything</code>
                                方法，该方法返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">42</code>
                                作为结果（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/DeepThought.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0001"><code>public class DeepThought</code>
<code>{</code>
<code>  public int TheAnswerOfTheUltimateQuestionOfLifeTheUniverseAndEverything() =&gt; 42;</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1"><span aria-label="670" epub:type="pagebreak" id="Page_670"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>To ensure that
                    nobody changes the method to return a wrong result (maybe someone who didn't read <i
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">The Hitchhiker's Guide to
                        the Galaxy</i>), a unit test is created. To create a unit test project with xUnit, you can use
                    the <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet</code>
                    command<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                为确保没有人将方法更改为返回错误结果（也许有人没读过《银河系漫游指南》），创建了一个单元测试。要使用 xUnit 创建单元测试项目，可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet</code>
                                命令</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0002"><code>&gt; dotnet new xunit</code></pre>
                <p id="c23-para-0016" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">or you can add the project template xUnit Test Project from
                    Visual Studio.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">或者你可以从 Visual Studio 中添加 xUnit
                                测试项目模板。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Before creating the first tests, it's a good idea to think
                    about naming tests and test projects. Of course, you can use names as you like, but you can find a
                    good guideline from the .NET Core team at<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                在创建第一个测试之前，考虑测试和测试项目的命名是一个好主意。当然，你可以使用自己喜欢的名称，但你可以从 .NET Core 团队那里找到一份良好的指南。</font>
                        </font>
                    </font>
                </p>
                <pre
                    id="c23-code-0003"><code>https://github.com/dotnet/aspnetcore/wiki/Engineering-guidelines#unit-tests-and-functional-tests</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Here's a summary of the guidelines:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这是一份指南的总结：</font>
                        </font>
                    </font>
                </p>
                <ul class="check" id="c23-list-0003"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <li id="c23-li-0008" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                        data-immersive-translate-paragraph="1">A test project has the name <code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Tests</code> appended
                        to the name of the project—for example, for the project <code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples</code>,
                        the test project has the name <code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests</code>.
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">测试项目名称会在项目名称后追加 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Tests</code>
                                    ，例如，对于项目 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples</code>
                                    ，测试项目的名称为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests</code>
                                    。</font>
                            </font>
                        </font>
                    </li>
                    <li id="c23-li-0009" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                        data-immersive-translate-paragraph="1">Test class names have the same class name as the class
                        being tested, and the word <code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Test</code> is
                        appended to the name. For example, the test class for <code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.DeepThought</code>
                        is <code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.DeepThoughtTest</code>.
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">测试类名称与被测试的类名称相同，并在名称后追加 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Test</code>
                                    。例如， <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.DeepThought</code>
                                    的测试类为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.DeepThoughtTest</code>
                                    。</font>
                            </font>
                        </font>
                    </li>
                    <li id="c23-li-0010" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                        data-immersive-translate-paragraph="1">Unit test method names have a descriptive name. For
                        example, the name <code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync_ThrowsForNull</code>
                        indicates a unit test to invoke the <code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync</code>
                        method to check whether it throws an exception passing <code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">null</code>.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">单元测试方法名称应具有描述性名称。例如，名称 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync_ThrowsForNull</code>
                                    表示一个单元测试，用于调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync</code>
                                    方法并检查传递 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">null</code>
                                    时是否会抛出异常。</font>
                            </font>
                        </font>
                    </li>
                </ul>
                <p id="c23-para-0020" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                    test project contains references to the NuGet packages <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Microsoft.NET.Test.Sdk</code>,
                    <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">xunit</code>, <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">xunit.runner.visualstudio</code>,
                    and <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">coverlet.collector</code>.
                    <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">coverlet.collector</code>
                    is used to analyze the code coverage—the percentage of the source code lines that is covered by unit
                    tests.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                                测试项目包含对 NuGet 包 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Microsoft.NET.Test.Sdk</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">xunit</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">xunit.runner.visualstudio</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">coverlet.collector</code>
                                的引用。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">coverlet.collector</code>
                                用于分析代码覆盖率——即被单元测试覆盖的源代码行百分比。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">With <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>,
                    a test method is marked with the attribute <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Fact</code>. The
                    implementation of the test method creates an instance of <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">DeepThought</code> and
                    invokes the method that is to be tested: <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">TheAnswerToTheUltimateQuestionOfLifeTheUniverseAndEverything</code>.
                    The return value is compared with the value <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">42</code> using <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.Equal</code>. In
                    case <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.Equal</code>
                    fails, the test fails (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.UnitTestingSamples.Tests/DeepThoughtTest.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                                时，测试方法会标记上 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Fact</code>
                                属性。测试方法的实现会创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">DeepThought</code>
                                的一个实例，并调用要测试的方法： <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">TheAnswerToTheUltimateQuestionOfLifeTheUniverseAndEverything</code>
                                。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.Equal</code>
                                将返回值与值 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">42</code>
                                进行比较。如果 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.Equal</code>
                                失败，则测试失败（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.UnitTestingSamples.Tests/DeepThoughtTest.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0004"><code>public class DeepThoughtTest</code>
<code>{</code>
<code>  [Fact]</code>
<code>  public void ResultOfTheAnswerToTheUltimateQuestionOfLifeTheUniverseAndEverything()</code>
<code>  {</code>
<code>    // arrange</code>
<code>    int expected = 42;</code>
<code>    DeepThought dt = new();</code>
<code> </code>
<code>    // act</code>
<code>    int actual =</code>
<code>      dt.TheAnswerToTheUltimateQuestionOfLifeTheUniverseAndEverything();</code>
<code> </code>
<code>    // assert</code>
<code>    Assert.Equal(expected, actual);</code>
<code>  }</code>
<code>}</code></pre>
                <p id="c23-para-0022" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1"><span aria-label="671" epub:type="pagebreak" id="Page_671"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>Unit tests are
                    defined by three A's: arrange, act, and assert. First, everything is <i
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">arranged</i> for the unit
                    test to start. In the first test, with the arrange phase, a variable <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">expected</code> is
                    assigned the value that is expected from calling the method to test, and an instance of the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">DeepThought</code> class
                    is invoked. Now everything is ready to test the functionality. This happens with the <i
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">act</i> phase—the method
                    is invoked. After completing the act phase, you need to verify whether the result is as expected.
                    This is done in the <i
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">assert</i> phase using a
                    method of the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert</code> class.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">单元测试由三个 A
                                定义：安排（arrange）、执行（act）和断言（assert）。首先，为单元测试启动进行所有安排。在第一个测试中，在安排阶段，变量 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">expected</code>
                                被赋予调用待测方法后预期的值，并调用了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">DeepThought</code>
                                类的实例。现在一切就绪，可以测试功能。这发生在执行阶段——方法被调用。完成执行阶段后，需要验证结果是否符合预期。这通过 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert</code>
                                类的方法在断言阶段完成。</font>
                        </font>
                    </font>
                </p>
                <p id="c23-para-0023" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert</code> class is
                    part of the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                    framework in the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Xunit</code> namespace.
                    This class offers several static methods that you can use with unit tests. Here you have many
                    different options to check for valid results. <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.True</code>
                    requires that the expression returns <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">true</code> to be
                    successful. <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.False</code> is
                    the opposite of that; the expression needs to return <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">false</code> to be
                    successful. With <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.InRange</code>,
                    the result must be within a specified range. <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.Null</code> and
                    <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.NotNull</code>
                    are used to check for results returning null. Results of collections can be checked with <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.Contains</code>,
                    <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.DoesNotContain</code>,
                    and <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.All</code>.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert</code>
                                类是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                                框架在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Xunit</code>
                                命名空间的一部分。这个类提供了几个静态方法，你可以用它们来进行单元测试。这里有很多不同的选项来检查有效结果。 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.True</code>
                                要求表达式返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">true</code>
                                才能成功。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.False</code>
                                是它的反面；表达式需要返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">false</code>
                                才能成功。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.InRange</code>
                                时，结果必须在指定范围内。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.Null</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.NotNull</code>
                                用于检查返回 null 的结果。集合的结果可以用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.Contains</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.DoesNotContain</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Assert.All</code>
                                来检查。</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><span id="c23-sec-0007"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
                <h3 id="head-3-449" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Running Unit Tests <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">运行单元测试</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">To run unit tests, you can use the Test Explorer from Visual
                    Studio or the .NET CLI:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要运行单元测试，你可以使用 Visual Studio
                                的测试浏览器或 .NET CLI：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0005"><code>&gt; dotnet test</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">With the sample application, this results in this successful
                    output:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用示例应用程序，这将产生以下成功输出：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0006"><code>Determining projects to restore…</code>
<code>Restored C:\procsharp\tests\UnitTestingSamples\UnitTestingSamples.csproj (in 94 ms).</code>
<code>Restored C:\procsharp\tests\UnitTestingSamples\UnitTestingSamples.Tests\</code>
<code>UnitTestingSamples.Tests.csproj (in 482 ms).</code>
<code>UnitTestingSamples -&gt; C:\procsharp\tests\UnitTestingSamples\UnitTestingSamples\bin\Debug\</code>
<code>net5.0\UnitTestingSamples.dll</code>
<code>UnitTestingSamples.Tests -&gt; C:\procsharp\tests\UnitTestingSamples\UnitTestingSamples.Tests\</code>
<code>bin\Debug\net5.0\UnitTestingSamples.Tests.dll</code>
<code>Test run for C:\procsharp\tests\UnitTestingSamples\UnitTestingSamples.Tests\bin\Debug\net5.0\</code> <code>UnitTestingSamples.Tests.dll (.NETCoreApp,Version=v5.0)</code>
<code>Microsoft (R) Test Execution Command Line Tool Version 16.9.0</code>
<code>Copyright (c) Microsoft Corporation.  All rights reserved.</code>
<code> </code>
<code>Starting test execution, please wait…</code>
<code>A total of 1 test files matched the specified pattern.</code>
<code> </code>
<code>Passed!  - Failed:     0, Passed:     1, Skipped:     0, Total:     1, </code>
<code>Duration: 4 ms - UnitTestingSamples.Tests.dll (net5.0)</code></pre>
                <p id="c23-para-0026" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Of course, this was a simple scenario; the tests are not
                    usually that simple. For example, methods can throw exceptions; they can have different paths for
                    returning other values; and they can make use of other code (for example, database access code, or
                    services that are invoked) that shouldn't be tested with the single unit test. Now let's look at a
                    more involved scenario for unit testing.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                当然，这只是一个简单的场景；测试通常不会这么简单。例如，方法可能会抛出异常；它们可以有不同的返回其他值的路径；并且它们可能会使用其他代码（例如，数据库访问代码，或被调用的服务），这些不应该用单个单元测试来测试。现在让我们来看一个更复杂的单元测试场景。
                            </font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><span id="c23-sec-0008"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
                <h3 id="head-3-450" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Implementing Complex Methods <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">实现复杂方法</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">StringSample</code> class
                    defines a constructor with a string parameter, the method <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringDemo</code>, and
                    a field. The method <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringDemo</code> uses
                    different paths depending on the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">first</code> and <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">second</code> parameters
                    and returns a string that results from these parameters (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/StringSample.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">StringSample</code>
                                类定义了一个带有字符串参数的构造函数、方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringDemo</code>
                                以及一个字段。方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringDemo</code>
                                根据不同的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">first</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">second</code>
                                参数使用不同的路径，并返回一个由这些参数产生的字符串（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/StringSample.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0007"><code>public class StringSample</code>
<code>{<span aria-label="672" epub:type="pagebreak" id="Page_672" role="doc-pagebreak"></span></code>
<code>  public StringSample(string init)</code>
<code>  {</code>
<code>    if (init is null)</code>
<code>      throw new ArgumentNullException(nameof(init));</code>
<code> </code>
<code>    _init = init;</code>
<code>  }</code>
<code> </code>
<code>  private string _init;</code>
<code> </code>
<code>  public string GetStringDemo(string first, string second)</code>
<code>  {</code>
<code>    if (first is null) throw new ArgumentNullException(nameof(first));</code>
<code>    if (string.IsNullOrEmpty(first)) </code>
<code>      throw new ArgumentException("empty string is not allowed", first);</code>
<code>    if (second is null) throw new ArgumentNullException(nameof(second));</code>
<code>    if (second.Length&gt; first.Length)</code>
<code>      throw new ArgumentOutOfRangeException(nameof(second),</code>
<code>        "must be shorter than first");</code>
<code> </code>
<code>    int startIndex = first.IndexOf(second);</code>
<code>    if (startIndex &lt; 0)</code>
<code>    {</code>
<code>      return $"{second} not found in {first}";</code>
<code>    }</code>
<code>    else if (startIndex &lt; 5)</code>
<code>    {</code>
<code>      string result = first.Remove(startIndex, second.Length);</code>
<code>      return $"removed {second} from {first}: {result}";</code>
<code>    }</code>
<code>    else</code>
<code>    {</code>
<code>      return _init.ToUpperInvariant();</code>
<code>    }</code>
<code>  }</code>
<code>}</code></pre>
                <aside data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <div class="top hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <p id="c23-para-0029" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">NOTE</b> <i
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">When you're
                                writing unit tests for complex methods, the unit test also sometimes gets complex. Here
                                it is helpful to debug the unit test to find out what's going on. Debugging unit tests
                                is straightforward with Visual Studio: just add breakpoints to the unit test code, and
                                from the context menu of the Test Explorer, select Debug Selected Tests.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意
                                        当为复杂方法编写单元测试时，单元测试有时也会变得复杂。在这种情况下，通过调试单元测试来了解发生了什么是有帮助的。使用 Visual Studio
                                        调试单元测试非常直接：只需在单元测试代码中添加断点，然后从测试资源管理器的上下文菜单中选择“调试选定测试”。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p id="c23-para-0030" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Every possible execution route and check for exceptions
                    should be covered by unit tests, as discussed next.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">单元测试应涵盖所有可能的执行路径和异常检查，如下一节所述。
                            </font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><span id="c23-sec-0010"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
                <h3 id="head-3-451" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Expecting Exceptions <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">期待异常</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">When invoking the constructor of the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">StringSample</code> class
                    and calling the method <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringDemo</code> with
                    null, an <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ArgumentNullException</code>
                    is expected. You can easily check exceptions with testing code: apply the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ExpectedException</code>
                    attribute to the test method as shown in the following example. This way, the test method succeeds
                    with the exception (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/StringSampleTest.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当调用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">StringSample</code>
                                类的构造函数并使用 null 调用方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringDemo</code>
                                时，预期会抛出 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ArgumentNullException</code>
                                。您可以通过测试代码轻松检查异常：将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ExpectedException</code>
                                属性应用于测试方法，如下例所示。这样，测试方法会成功抛出异常（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/StringSampleTest.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0008"><code>[Fact]</code>
<code>public void GetStringDemoExceptions()<span aria-label="673" epub:type="pagebreak" id="Page_673" role="doc-pagebreak"></span></code>
<code>{</code>
<code>  StringSample sample = new(string.Empty);</code>
<code>  <b>Assert.Throws&lt;ArgumentNullException&gt;(() =&gt; sample.GetStringDemo(null!, "a"));</b></code>
<code>  <b>Assert.Throws&lt;ArgumentNullException&gt;(() =&gt; sample.GetStringDemo("a", null!));</b></code>
<code>  <b>Assert.Throws&lt;ArgumentException&gt;(() =&gt;</b></code>
<code>    <b>sample.GetStringDemo(string.Empty, "a"));</b></code>
<code>}</code></pre>
                <aside data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <div class="top hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <p id="c23-para-0033" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">NOTE</b> <i
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Although the
                                library project has nullable reference types enabled and the parameters of the method
                                are not annotated with nullable references, you should still check for receiving null
                                values and throwing </i><code
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ArgumentNullException</code><i
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">. If the calling
                                application does not use C# 8 or later, the compiler does not result in compiler
                                warnings passing null. Older compilers ignore the attributes created for nullable
                                reference types, and the result would just be a </i><code
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">NullReferenceException</code><i
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"> at locations
                                it's probably not expected. Even with nullable reference types enabled, it's still a
                                good practice to check for null with the method parameters.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">
                                        注意：尽管库项目启用了可空引用类型，并且方法的参数没有标注可空引用，但您仍然应该检查接收 null 值并抛出 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ArgumentNullException</code>
                                        。如果调用应用程序不使用 C# 8 或更高版本，编译器不会产生编译警告来传递 null。旧版编译器会忽略为可空引用类型创建的属性，结果只是在可能不期望的位置出现
                                        <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">NullReferenceException</code>
                                        。即使启用了可空引用类型，检查方法参数的 null 值仍然是一个好习惯。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section>
            <section data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><span id="c23-sec-0012"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
                <h3 id="head-3-452" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Testing All Code Paths <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">测试所有代码路径</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">To test all code paths, you can create multiple tests, with
                    each one taking a different route. The following test sample passes the strings <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">a</code> and <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">b</code> to the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringDemo</code>
                    method. Because the second string is not contained within the first string, the first path of the
                    <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">if</code> statement
                    applies. The result is checked accordingly (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/StringSampleTest.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                要测试所有代码路径，您可以创建多个测试，每个测试采用不同的路径。以下测试示例将字符串 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">a</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">b</code> 传递给
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringDemo</code>
                                方法。由于第二个字符串不包含在第一个字符串中， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">if</code>
                                语句的第一条路径适用。结果按相应方式检查（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/StringSampleTest.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0009"><code>[Fact]</code>
<code>public void GetStringDemoBNotInA()</code>
<code>{</code>
<code>  // arrange</code>
<code>  string expected = "b not found in a";</code>
<code>  StringSample sample = new(string.Empty);</code>
<code> </code>
<code>  // act</code>
<code>  string actual = sample.GetStringDemo("a", "b");</code>
<code> </code>
<code>  // assert</code>
<code>  Assert.Equal(expected, actual);</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">You can also define a test method with parameters and use
                    attributes passing different values. For this, the test method needs to have the attribute <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Theory</code> instead of
                    <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Fact</code> applied.
                    Data can be passed using multiple <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">InlineData</code>
                    attributes that define the values, as shown in the following code snippet. With this in place, the
                    test runner invokes the method <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringDemoInlineData</code>
                    multiple times and passes values for every <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">InlineData</code>
                    attribute:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                您还可以定义一个带参数的测试方法，并使用属性传递不同的值。为此，测试方法需要应用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Theory</code>
                                属性而不是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Fact</code>
                                属性。可以使用多个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">InlineData</code>
                                属性来定义值，如下面的代码片段所示。这样，测试运行器会多次调用该方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringDemoInlineData</code>
                                并为每个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">InlineData</code>
                                属性传递值：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0010"><code><b>[Theory]</b></code>
<code><b>[InlineData("", "a", "b", "b not found in a")]</b></code>
<code><b>[InlineData("", "longer string", "nger", "removed nger from longer string: lo string")]</b></code>
<code><b>[InlineData("init", "longer string", "string", "INIT")]</b></code>
<code>public void GetStringDemoInlineData(string init, string a, string b, string expected)</code>
<code>{</code>
<code>  StringSample sample = new(init);<span aria-label="674" epub:type="pagebreak" id="Page_674" role="doc-pagebreak"></span></code>
<code>  string actual = sample.GetStringDemo(a, b);</code>
<code>  Assert.Equal(expected, actual);</code>
<code>} </code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Instead of using multiple <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">InlineData</code>
                    attributes, you can also define a method that returns the values passed to the test method (such as
                    the following <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringSampleData</code>
                    method) and specify the method name with the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MemberData</code>
                    attribute. This way you can use any source of data for the unit test:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">您也可以不使用多个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">InlineData</code>
                                属性，而是定义一个返回传递给测试方法的值的方法（例如下面的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">GetStringSampleData</code>
                                方法），并使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MemberData</code>
                                属性指定方法名。这样您可以使用任何数据源进行单元测试：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0011"><code>[Theory]</code>
<code><b>[MemberData(nameof(GetStringSampleData))]</b></code>
<code>public void GetStringDemoMemberData(string init, string a, string b, string expected)</code>
<code>{</code>
<code>  StringSample sample = new(init);</code>
<code>  string actual = sample.GetStringDemo(a, b);</code>
<code>  Assert.Equal(expected, actual);</code>
<code>}</code>
<code> </code>
<code>public static IEnumerable&lt;object[]&gt; GetStringSampleData() =&gt;</code>
<code>  new[]</code>
<code>  {</code>
<code>    new object[] { "", "a", "b", "b not found in a" },</code>
<code>    new object[] { "", "longer string", "nger", </code>
<code>      "removed nger from longer string: lo string" },</code>
<code>    new object[] { "init", "longer string", "string", "INIT" }</code>
<code>  };</code></pre>
            </section>
            <section data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><span id="c23-sec-0013"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
                <h3 id="head-3-453" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Code Coverage <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">代码覆盖率</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">To see what code is covered by unit tests and what code is
                    still missing, you can use the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">--collect</code> option
                    of the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet test</code>
                    command. The NuGet package <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">coverlet.collector</code>
                    is added to the project to collect code coverage in a platform-independent manner. In addition to
                    the NuGet package, you need to add the .NET CLI tool <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">coverlet.console</code>.
                    To install this tool with the test project, you can add a <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">tool-manifest</code> file
                    and add the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">coverlet.console</code>
                    to the project tools (or instead add this tool as a global tool to your profile with the option
                    <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">-g</code>). The second
                    tool installed is the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet-reportgenerator</code>,
                    which gives you graphical output of the generated XML file from Coverlet:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要查看哪些代码被单元测试覆盖，哪些代码仍然缺失，你可以使用
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet test</code>
                                命令的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">--collect</code>
                                选项。将 NuGet 包 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">coverlet.collector</code>
                                添加到项目中，以便以平台无关的方式收集代码覆盖率。除了 NuGet 包，你还需要添加 .NET CLI 工具 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">coverlet.console</code>
                                。要使用测试项目安装此工具，你可以添加一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">tool-manifest</code>
                                文件，并将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">coverlet.console</code>
                                添加到项目工具（或者用选项 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">-g</code>
                                将此工具作为全局工具添加到你的配置文件中）。安装的第二款工具是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">dotnet-reportgenerator</code>
                                ，它为你提供从 Coverlet 生成的 XML 文件的图形输出：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0012"><code>&gt; dotnet new tool-manifest</code>
<code>&gt; dotnet tool install coverlet.console</code>
<code>&gt; dotnet tool install dotnet-reportgenerator-globaltool</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">With the collector and this tool in place, you can run the
                    tests with the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">--collect</code> option
                    and pass the string <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XPlat Code Coverage</code>,
                    as shown in the next snippet. After running the unit tests with this option, results are found in
                    the <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">TestResults</code>
                    folder.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">安装了收集器和这款工具后，你可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">--collect</code>
                                选项运行测试，并传递字符串 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XPlat Code Coverage</code>
                                ，如下一个代码片段所示。使用此选项运行单元测试后，结果可以在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">TestResults</code>
                                文件夹中找到。</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0013"><code>&gt; dotnet test --collect "XPlat Code Coverage"</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">To get an HTML view of the report, you can now use the report
                    generator. With the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">-reports</code> option,
                    you specify the directory of the XML file that contains the collection information. The option <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">-targetdir</code>
                    specifies the name of the directory where you want the HTML output. With the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">-reportTypes</code>
                    option, you can specify the output format:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要获取报告的 HTML 查看方式，现在可以使用报告生成器。使用
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">-reports</code>
                                选项，你可以指定包含收集信息的 XML 文件的目录。选项 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">-targetdir</code>
                                指定你希望 HTML 输出的目录名称。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">-reportTypes</code>
                                选项，你可以指定输出格式：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0014"><code>&gt; dotnet tool run reportgenerator -reports:TestResults\{GUID}\coverage.cobertura.xml -</code>
<code>targetdir:coveragereport -reportTypes:Html</code></pre>
                <p id="c23-para-0040" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">When you open the HTML that's generated, you see a view
                    similar to <a href="#c23-fig-0001" id="R_c23-fig-0001"
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Figure 23-1</a>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当你打开生成的 HTML 时，你会看到一个类似于图 23-1
                                的视图。</font>
                        </font>
                    </font>
                </p> <span aria-label="675" epub:type="pagebreak" id="Page_675" role="doc-pagebreak"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
                <figure data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"> <img
                        alt="Snapshot of the details of summary, risk hotspots, and coverage." class="center"
                        src="images/c23f001.png" />
                    <figcaption data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><span
                                class="figureLabel"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a
                                    href="#R_c23-fig-0001" id="c23-fig-0001" role="doc-backlink"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><b
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                                        data-immersive-translate-paragraph="1">FIGURE 23-1<font
                                            class="notranslate immersive-translate-target-wrapper"
                                            data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                            <font class="notranslate"
                                                data-immersive-translate-translation-element-mark="1">  </font>
                                            <font
                                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                                data-immersive-translate-translation-element-mark="1">
                                                <font
                                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                                    data-immersive-translate-translation-element-mark="1">图 23-1</font>
                                            </font>
                                        </font></b></a></span></p>
                    </figcaption>
                </figure>
                <p id="c23-para-0041" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">See the documentation at <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/coverlet-coverage/coverlet">https://github.com/coverlet-coverage/coverlet</a></code>
                    and <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/Microsoft/vstest-docs/blob/master/docs/analyze.md">https://github.com/Microsoft/vstest-docs/blob/master/docs/analyze.md</a></code>
                    for more information on the different options you have with Coverlet and how to use this and other
                    collectors with Visual Studio.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">有关 Coverlet 的不同选项以及如何在 Visual
                                Studio 中使用此工具和其他收集器的更多信息，请参阅文档中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/coverlet-coverage/coverlet">https://github.com/coverlet-coverage/coverlet</a></code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/Microsoft/vstest-docs/blob/master/docs/analyze.md">https://github.com/Microsoft/vstest-docs/blob/master/docs/analyze.md</a></code>
                                。</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><span id="c23-sec-0014"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
                <h3 id="head-3-454" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">External Dependencies <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">外部依赖</font>
                        </font>
                    </font>
                </h3>
                <p id="c23-para-0042" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Many methods are dependent on some functionality outside the
                    application's control—for example, calling a web service or accessing a database. Maybe the service
                    or database is not available during some test runs, which tests the availability of these external
                    resources. Or worse, maybe the database or service returns different data over time, and it's hard
                    to compare this with expected data. Such functionality outside the scope of what should be tested
                    must be excluded from the unit test.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">许多方法依赖于应用程序控制之外的一些功能——例如，调用一个 Web
                                服务或访问数据库。也许在有些测试运行期间，服务或数据库不可用，这会测试这些外部资源的可用性。或者更糟的是，也许数据库或服务随时间返回不同的数据，而很难将其与预期数据进行比较。这种超出应测试范围的功能必须从单元测试中排除。
                            </font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">The following example is dependent on some outside
                    functionality. The method <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                    accesses an XML file from a web server that contains a list of Formula 1 world champions with <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Firstname</code>, <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Lastname</code>, <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Wins</code>, and <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Country</code> elements.
                    This list is filtered by country, and it's numerically ordered using the value from the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Wins</code> element. The
                    returned data is an <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XElement</code> that
                    contains converted XML code (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/Formula1.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">以下示例依赖于某些外部功能。方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                                访问一个包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Firstname</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Lastname</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Wins</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Country</code>
                                元素的 F1 世界冠军列表的 XML 文件，该文件位于 Web 服务器上。此列表按国家进行筛选，并使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Wins</code>
                                元素的值进行数值排序。返回的数据是一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XElement</code>
                                ，其中包含转换后的 XML 代码（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/Formula1.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0015"><code>public XElement ChampionsByCountry(string country)</code>
<code>{</code>
<code>  XElement champions = XElement.Load(F1Addresses.RacersUrl);</code>
<code>  var q = from r in champions.Elements("Racer")</code>
<code>          where r.Element("Country").Value == country</code>
<code>          orderby int.Parse(r.Element("Wins").Value) descending</code>
<code>          select new XElement("Racer",</code>
<code>            new XAttribute("Name", r.Element("Firstname").Value + " " +<span aria-label="676" epub:type="pagebreak" id="Page_676" role="doc-pagebreak"></span></code>
<code>              r.Element("Lastname").Value),</code>
<code>            new XAttribute("Country", r.Element("Country").Value),</code>
<code>            new XAttribute("Wins", r.Element("Wins").Value));</code>
<code>          return new XElement("Racers", q.ToArray());</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">The link to the XML file is defined by the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">F1Addresses</code> class
                    (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/F1Addresses.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">XML 文件的链接由 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">F1Addresses</code>
                                类定义（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/F1Addresses.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0016"><code>public class F1Addresses</code>
<code>{</code>
<code>  public const string RacersUrl =</code>
<code>    "http://www.cninnovation.com/downloads/Racers.xml";</code>
<code>}</code></pre>
                <p id="c23-para-0045" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">For the method <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>,
                    you should do a unit test. The test should not be dependent on the source from the server. Server
                    unavailability is one issue, but it can also be expected that the data on the server changes over
                    time to return new champions and other values. The test should ensure that filtering and ordering is
                    done as expected independent of the source from the server.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">对于方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                                ，您应该进行单元测试。测试不应依赖于服务器上的源。服务器不可用是一个问题，但也可以预期服务器上的数据会随时间变化以返回新的冠军和其他值。测试应确保筛选和排序按预期进行，而与服务器上的源无关。
                            </font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">One way to create a unit test that is independent of the data
                    source is to refactor the implementation of the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                    method by using dependency injection. Here, a factory that returns an <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XElement</code> is
                    created to replace the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XElement.Load</code>
                    method. The interface <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IChampionsLoader</code>
                    is the only outside requirement used from the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                    method. The interface <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IChampionsLoader</code>
                    defines the method <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">LoadChampions</code> that
                    can replace the aforementioned method (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/IChampionsLoader.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">创建一个与数据源无关的单元测试的一种方法是通过依赖注入重构
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                                方法的实现。这里创建了一个返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XElement</code>
                                的工厂来替换 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XElement.Load</code>
                                方法。接口 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IChampionsLoader</code>
                                是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                                方法唯一使用的外部要求。接口 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IChampionsLoader</code>
                                定义了可以替换上述方法的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">LoadChampions</code>
                                方法（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/IChampionsLoader.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0017"><code>public interface IChampionsLoader</code>
<code>{</code>
<code>  XElement LoadChampions();</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">The class <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsLoader</code>
                    implements the interface <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IChampionsLoader</code>
                    by using the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XElement.Load</code>
                    method—the method that was used beforehand by the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                    method (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/ChampionsLoader.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">类 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsLoader</code>
                                通过使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XElement.Load</code>
                                方法实现了接口 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IChampionsLoader</code>
                                ——这是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                                方法之前使用的方法（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/ChampionsLoader.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0018"><code>public class ChampionsLoader: IChampionsLoader</code>
<code>{</code>
<code>  public XElement LoadChampions() =&gt; XElement.Load(F1Addresses.RacersUrl);</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Now it's possible to change the implementation of the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                    method by using an interface to load the champions instead of directly using <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XElement.Load</code>. The
                    <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IChampionsLoader</code>
                    is passed with the constructor of the class <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Formula1</code>, and this
                    loader is then used by <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                    (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/Formula1.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在可以通过使用接口来加载冠军，而不是直接使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">XElement.Load</code>
                                来改变 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                                方法的实现。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IChampionsLoader</code>
                                通过类的构造器 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Formula1</code>
                                传递，然后 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsByCountry</code>
                                使用这个加载器（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples/Formula1.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0019"><code>public class Formula1</code>
<code>{</code>
<code>  private readonly IChampionsLoader _loader;</code>
<code>  public Formula1(IChampionsLoader loader) =&gt; _loader = loader;</code>
<code> </code>
<code>  public XElement ChampionsByCountry(string country)</code>
<code>  {</code>
<code>    var q = from r in _loader.LoadChampions().Elements("Racer")</code>
<code>            where r.Element("Country").Value == country<span aria-label="677" epub:type="pagebreak" id="Page_677" role="doc-pagebreak"></span></code>
<code>            orderby int.Parse(r.Element("Wins").Value) descending</code>
<code>            select new XElement("Racer",</code>
<code>              new XAttribute("Name", r.Element("Firstname").Value + " " +</code>
<code>                r.Element("Lastname").Value),</code>
<code>              new XAttribute("Country", r.Element("Country").Value),</code>
<code>              new XAttribute("Wins", r.Element("Wins").Value));</code>
<code>    return new XElement("Racers", q.ToArray());</code>
<code>  }</code>
<code>}</code></pre>
                <p id="c23-para-0049" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">With a typical implementation, a <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsLoader</code>
                    instance would be passed to the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Formula1</code>
                    constructor to retrieve the racers from the server.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在典型的实现中，会将 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsLoader</code>
                                实例传递给 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Formula1</code>
                                的构造器，以从服务器获取赛车。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">When you're creating the unit test, you can implement a
                    custom method that returns sample Formula 1 champions, as shown in the method <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Formula1SampleData</code>
                    (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/Formula1Test.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当您创建单元测试时，可以实现一个自定义方法来返回示例 F1
                                冠军，如方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Formula1SampleData</code>
                                （代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/Formula1Test.cs</code>
                                ）所示：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0020"><code>internal static string Formula1SampleData()</code>
<code>{</code>
<code>  return @"</code>
<code>&lt;Racers&gt;</code>
<code>  &lt;Racer&gt;</code>
<code>    &lt;Firstname&gt;Nelson&lt;/Firstname&gt;</code>
<code>    &lt;Lastname&gt;Piquet&lt;/Lastname&gt;</code>
<code>    &lt;Country&gt;Brazil&lt;/Country&gt;</code>
<code>    &lt;Starts&gt;204&lt;/Starts&gt;</code>
<code>    &lt;Wins&gt;23&lt;/Wins&gt;</code>
<code>  &lt;/Racer&gt;</code>
<code>  &lt;Racer&gt;</code>
<code>    &lt;Firstname&gt;Ayrton&lt;/Firstname&gt;</code>
<code>    &lt;Lastname&gt;Senna&lt;/Lastname&gt;</code>
<code>    &lt;Country&gt;Brazil&lt;/Country&gt;</code>
<code>    &lt;Starts&gt;161&lt;/Starts&gt;</code>
<code>    &lt;Wins&gt;41&lt;/Wins&gt;</code>
<code>  &lt;/Racer&gt;</code>
<code>  &lt;Racer&gt;</code>
<code>    &lt;Firstname&gt;Nigel&lt;/Firstname&gt;</code>
<code>    &lt;Lastname&gt;Mansell&lt;/Lastname&gt;</code>
<code>    &lt;Country&gt;England&lt;/Country&gt;</code>
<code>    &lt;Starts&gt;187&lt;/Starts&gt;</code>
<code>    &lt;Wins&gt;31&lt;/Wins&gt;</code>
<code>  &lt;/Racer&gt;</code>
<code>  //… more sample data</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">The method <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Formula1VerificationData</code>
                    returns sample test data that matches the expected result (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/Formula1Test.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Formula1VerificationData</code>
                                返回与预期结果匹配的示例测试数据（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/Formula1Test.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0021"><code>internal static XElement Formula1VerificationData()</code>
<code>{</code>
<code>  return XElement.Parse(@"</code>
<code>&lt;Racers&gt;</code>
<code>  &lt;Racer Name=""Mika Hakkinen"" Country=""Finland"" Wins=""20""/&gt;</code>
<code>  &lt;Racer Name=""Kimi Raikkonen"" Country=""Finland"" Wins=""18""/&gt;</code>
<code>&lt;/Racers&gt;");</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1"><span aria-label="678" epub:type="pagebreak" id="Page_678"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>The loader of the
                    test data implements the same interface—
                    <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IChampionsLoader</code>—as
                    the <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsLoader</code>
                    class. This loader makes use of the sample data; it doesn't access the web server (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/Formula1Test.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">测试数据的加载器实现了与 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ChampionsLoader</code>
                                类相同的接口— <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IChampionsLoader</code>
                                —。这个加载器使用样本数据；它不访问网络服务器（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/Formula1Test.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0022"><code>public class F1TestLoader: IChampionsLoader</code>
<code>{</code>
<code>  public XElement LoadChampions() =&gt; XElement.Parse(Formula1SampleData());</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Now it's easy to create a unit test that makes use of the
                    sample data (code file <code
                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/Formula1Test.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在很容易创建一个使用样本数据的单元测试（代码文件 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">UnitTestingSamples.Tests/Formula1Test.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c23-code-0023"><code>[Fact]</code>
<code>public void ChampionsByCountryFilterFinland()</code>
<code>{</code>
<code>  Formula1 f1 = new Formula1(new F1TestLoader());</code>
<code>  XElement actual = f1.ChampionsByCountry("Finland");</code>
<code>  Assert.AreEqual(Formula1VerificationData().ToString(), actual.ToString());</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                    data-immersive-translate-paragraph="1">Of course, a real test should do more than cover a case that
                    passes <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Finland</code>
                    as a string, and two champions are returned with the test data. You should write other tests to pass
                    a string with no matching result to return more than two champions and to result in a number sort
                    order that is different from the alphanumeric sort order.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当然，一个真正的测试应该做更多的工作，而不仅仅是覆盖一个将
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Finland</code>
                                作为字符串通过的情况，并且测试数据返回了两个冠军。你应该编写其他测试，以通过一个没有匹配结果的字符串来返回超过两个冠军，并导致一个与字母数字排序顺序不同的数字排序顺序。
                            </font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <div class="top hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <p id="c23-para-0055" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">NOTE</b> <i
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">To test methods
                                that don't use dependency injection and to replace the internally used dependencies with
                                test classes, you can use Microsoft Fakes. Check </i><code
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://docs.microsoft.com/en-us/visualstudio/test/isolating-code-under-test-with-microsoft-fakes">https://docs.microsoft.com/en-us/visualstudio/test/isolating-code-under-test-with-microsoft-fakes</a></code><i
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"> for more
                                information on Microsoft Fakes.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意
                                        要测试不使用依赖注入的方法，并将内部使用的依赖项替换为测试类，你可以使用 Microsoft Fakes。有关 Microsoft Fakes
                                        的更多信息，请查看 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://docs.microsoft.com/en-us/visualstudio/test/isolating-code-under-test-with-microsoft-fakes">https://docs.microsoft.com/en-us/visualstudio/test/isolating-code-under-test-with-microsoft-fakes</a></code>
                                        。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section>
        </section>
        <section aria-labelledby="head-2-214" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
            <span id="c23-sec-0016" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
            <h2 id="head-2-214" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">USING A MOCKING LIBRARY<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用模拟库</font>
                    </font>
                </font>
            </h2>
            <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">Let's get into a more complex example: creating a unit test for a
                client-side service library from an app using the MVVM pattern. Read <a href="c30.xhtml"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Chapter 30</a>, “Patterns
                with XAML Apps,” for a complete picture of this app. The sample code for this chapter only includes a
                library used by this app. This service uses dependency injection to inject the repository defined by the
                interface <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IBooksRepository</code>. The
                unit tests for testing the method <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync</code>
                shouldn't test the repository; they test only the functionality within the method. For the repository,
                another unit test should be done. The following code snippet shows the implementation of the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">BooksService</code> class
                (code file <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib/Services/BooksService.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">让我们来看一个更复杂的例子：为一个使用 MVVM
                            模式的应用创建一个客户端服务库的单元测试。要全面了解这个应用，请阅读第 30 章“带有 XAML 应用的模式”。本章的示例代码只包含这个应用使用的库。这个服务使用依赖注入来注入由接口
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IBooksRepository</code>
                            定义的仓库。测试方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync</code>
                            的单元测试不应该测试仓库；它们只测试方法内的功能。对于仓库，应该进行另一个单元测试。以下代码片段显示了 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">BooksService</code>
                            类的实现（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib/Services/BooksService.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c23-code-0024"><code>public class BooksService: IBooksService</code>
<code>{</code>
<code>  private readonly ObservableCollection&lt;Book&gt; _books = new();</code>
<code>  private readonly IBooksRepository _booksRepository;</code>
<code>  public BooksService(IBooksRepository repository) =&gt;</code>
<code>    _booksRepository = repository;</code>
<code> </code>
<code>  public async Task LoadBooksAsync()</code>
<code>  {</code>
<code>    if (_books.Count&gt; 0) return;</code>
<code>    IEnumerable&lt;Book&gt; books = await _booksRepository.GetItemsAsync();<span aria-label="679" epub:type="pagebreak" id="Page_679" role="doc-pagebreak"></span></code>
<code>    _books.Clear();</code>
<code>    foreach (var b in books)</code>
<code>    {</code>
<code>      _books.Add(b);</code>
<code>    }</code>
<code>  }</code>
<code> </code>
<code>  public Book? GetBook(int bookId) =&gt;</code>
<code>    _books.Where(b =&gt; b.BookId == bookId).SingleOrDefault();</code>
<code> </code>
<code>  public async Task&lt;Book&gt; AddOrUpdateBookAsync(Book book)</code>
<code>  {</code>
<code>    if (book is null) throw new ArgumentNullException(nameof(book));</code>
<code> </code>
<code>    Book? updated = null;</code>
<code>    if (book.BookId == 0)</code>
<code>    {</code>
<code>      updated = await _booksRepository.AddAsync(book);</code>
<code>      _books.Add(updated);</code>
<code>    }</code>
<code>    else</code>
<code>    {</code>
<code>      updated = await _booksRepository.UpdateAsync(book);</code>
<code>      if (updated is null) throw new InvalidOperationException();</code>
<code> </code>
<code>      Book old = _books.Where(b =&gt; b.BookId == updated.BookId).Single();</code>
<code>      int ix = _books.IndexOf(old);</code>
<code>      _books.RemoveAt(ix);</code>
<code>      _books.Insert(ix, updated);</code>
<code>    }</code>
<code>    return updated;</code>
<code>  }</code>
<code> </code>
<code>  public IEnumerable&lt;Book&gt; Books =&gt; _books;</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">Because the unit test for <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync</code>
                shouldn't test the repository used for <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IBooksRepository</code>, you
                need to implement a repository used for testing. To make this easy, you can use a mocking library that
                automatically fills in the blanks. A commonly used mocking library is Moq. With the unit testing
                project, the NuGet package <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Moq</code> is added.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">因为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync</code>
                            的单元测试不应该测试用于 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IBooksRepository</code>
                            的仓库，所以你需要实现一个用于测试的仓库。为了简化这个过程，你可以使用模拟库来自动填充空白。常用的模拟库是 Moq。在单元测试项目中，添加了 NuGet 包 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Moq</code> 。
                        </font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                <div class="top hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <p id="c23-para-0058" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">NOTE</b> <i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Instead of using the
                            Moq framework, you also can implement an in-memory repository with sample data. You probably
                            do this anyway to have sample data for the app during design time of the user interface.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 除了使用 Moq
                                    框架外，你还可以使用内存中的仓库并填充示例数据。你可能无论如何都会这样做，以便在用户界面的设计时间有示例数据。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <hr />
                    </div>
                </section>
            </aside>
            <p id="c23-para-0059" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">When you use <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>,
                a new instance of the test class is created for every test run. In case you need common functionality
                for multiple tests, you can move this functionality to the constructor. If resources need to be released
                after each test run, you can implement the interface <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IDisposable</code>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">当你使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                            时，每个测试运行都会为测试类创建一个新实例。如果你需要为多个测试提供通用功能，可以将这些功能移动到构造函数中。如果需要在每次测试运行后释放资源，你可以实现接口 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IDisposable</code>
                            。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">Within the constructor of the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">BooksServiceTest</code>
                class, a <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Mock</code> object
                is instantiated with the generic parameter <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IBooksRepository</code>. The
                <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Mock</code> constructor
                creates an implementation for the interface. Because you need some results from the repository other
                than null to create useful tests, the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Setup</code> method defines
                which parameters can be passed, and the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ReturnsAsync</code> method
                defines the result that's returned from the method stub. <span aria-label="680" epub:type="pagebreak"
                    id="Page_680" role="doc-pagebreak"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>You access the mock
                object by using the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Object</code> property of the
                <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Mock</code> class, and it
                is passed on to create an instance of the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">BooksService</code> class.
                With these settings in place, you can implement the unit tests (code file <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib.Tests/Services/BooksServiceTest.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">BooksServiceTest</code>
                            类的构造函数中，使用泛型参数 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IBooksRepository</code>
                            实例化了一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Mock</code> 对象。
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Mock</code>
                            构造函数创建接口的实现。由于你需要从仓库获取一些非 null 的结果来创建有用的测试， <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Setup</code>
                            方法定义了可以传递的参数，而 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ReturnsAsync</code>
                            方法定义了从方法桩返回的结果。通过使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Mock</code> 类的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Object</code>
                            属性访问模拟对象，并将其传递给创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">BooksService</code>
                            类的实例。配置好这些设置后，你可以实现单元测试（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib.Tests/Services/BooksServiceTest.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c23-code-0025"><code>public class BooksServiceTest : IDisposable</code>
<code>{</code>
<code>  private const string TestTitle = "Test Title";</code>
<code>  private const string UpdatedTestTitle = "Updated Test Title";</code>
<code>  public const string APublisher = "A Publisher";</code>
<code>  private BooksService _booksService;</code>
<code> </code>
<code>  private Book _newBook = new Book</code>
<code>  {</code>
<code>    BookId = 0,</code>
<code>    Title = TestTitle,</code>
<code>    Publisher = APublisher</code>
<code>  };</code>
<code> </code>
<code>  private Book _expectedBook = new Book</code>
<code>  {</code>
<code>    BookId = 1,</code>
<code>    Title = TestTitle,</code>
<code>    Publisher = APublisher</code>
<code>  };</code>
<code>  private Book _notInRepositoryBook = new Book</code>
<code>  {</code>
<code>    BookId = 42,</code>
<code>    Title = TestTitle,</code>
<code>    Publisher = APublisher</code>
<code>  };</code>
<code>  private Book _updatedBook = new Book</code>
<code>  {</code>
<code>    BookId = 1,</code>
<code>    Title = UpdatedTestTitle,</code>
<code>    Publisher = APublisher</code>
<code>  };</code>
<code> </code>
<code>  public BooksServiceTest()</code>
<code>  {</code>
<code>    <b>Mock&lt;IBooksRepository&gt; mock = new();</b></code>
<code>    <b>mock.Setup(repository =&gt;</b> </code>
<code>      <b>repository.AddAsync(_newBook)).ReturnsAsync(_expectedBook);</b></code>
<code>    <b>mock.Setup(repository =&gt;</b>  </code>
<code>      <b>repository.UpdateAsync(_notInRepositoryBook)).ReturnsAsync(null as Book);</b></code>
<code>    <b>mock.Setup(repository =&gt;</b> </code>
<code>      <b>repository.UpdateAsync(_updatedBook)).ReturnsAsync(_updatedBook);</b></code>
<code> </code>
<code>    <b>_booksService = new BooksService(mock.Object);</b></code>
<code>  }</code>
<code>  //…</code></pre>
            <aside data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                <div class="top hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <p id="c23-para-0062" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">NOTE</b> <i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">The </i> <code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IDisposable</code> <i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"> interface is
                            explained in detail in <a href="c13.xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Chapter 13</a>,
                            “Managed and Unmanaged Memory.”</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IDisposable</code>
                                    接口在“托管和非托管内存”章节（第 13 章）中有详细说明。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <hr />
                    </div>
                </section>
            </aside>
            <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1"><span aria-label="681" epub:type="pagebreak" id="Page_681"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>The first unit test
                implemented—
                <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync_ThrowsForNull</code>—verifies
                that an <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ArgumentNullException</code>
                is thrown in case null is passed to the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync</code>
                method. The implementation just needs the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_booksService</code> member
                variable that is instantiated within the constructor, but it doesn't need the mocking setup. This code
                sample also shows that unit test methods can be implemented as asynchronous methods that return a <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Task</code> (code file <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib.Tests/Services/BooksServiceTest.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">第一个单元测试实现—— <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync_ThrowsForNull</code>
                            ——验证当向 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync</code>
                            方法传递 null 时会抛出 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ArgumentNullException</code>
                            。实现只需要构造函数中实例化的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_booksService</code>
                            成员变量，但不需要模拟设置。这个代码示例还表明单元测试方法可以作为异步方法实现，返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Task</code> （代码文件
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib.Tests/Services/BooksServiceTest.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c23-code-0026"><code>[Fact]</code>
<code>public async Task AddOrUpdateBookAsync_ThrowsForNull()</code>
<code>{</code>
<code>  // arrange</code>
<code>  Book nullBook = null;</code>
<code>  // act and assert</code>
<code>  <b>await Assert.ThrowsAsync&lt;ArgumentNullException&gt;(() =&gt;</b> </code>
<code>    <b>_booksService.AddOrUpdateBookAsync(nullBook));</b></code>
<code>}</code></pre>
            <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">The unit test method <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBook_AddedBookReturnsFromRepository</code>
                adds a new book (variable <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_newBook</code>) to the
                service and expects the book <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_expectedBook</code> to be
                returned. Within the implementation of the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync</code>
                method, the <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddAsync</code>
                method of the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IBooksRepository</code> is
                invoked; thus, the previously defined mock setup for this method applies. The result of this method
                should be that the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Book</code> returned is equal
                to the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_expectedBook</code>, and the
                _
                <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">expectedBook</code> also
                needs to be added to the books collection of the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">BooksService</code> (code
                file <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib.Tests/Services/BooksServiceTest.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">单元测试方法 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBook_AddedBookReturnsFromRepository</code>
                            向服务添加一本新书（变量 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_newBook</code>
                            ），并期望返回书 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_expectedBook</code>
                            。在 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBookAsync</code>
                            方法的实现中，调用了 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IBooksRepository</code>
                            的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddAsync</code>
                            方法；因此，先前定义的对此方法的模拟设置适用。此方法的结果应该是返回的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Book</code> 等于
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_expectedBook</code>
                            ，并且 _ <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">expectedBook</code>
                            也需要添加到 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">BooksService</code>
                            的书籍集合中（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib.Tests/Services/BooksServiceTest.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c23-code-0027"><code>[Fact]</code>
<code>public async Task AddOrUpdateBook_AddedBookReturnsFromRepository()</code>
<code>{</code>
<code>  // arrange in constructor</code>
<code>  // act</code>
<code>  Book actualAdded = await _booksService.AddOrUpdateBookAsync(_newBook);</code>
<code> </code>
<code>  // assert</code>
<code>  Assert.Equal(_expectedBook, actualAdded);</code>
<code>  Assert.Contains(_expectedBook, _booksService.Books);</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">The unit test <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBook_UpdateNotExistingBookThrows</code>
                verifies that trying to update a book that does not exist in the service needs to result in an <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">InvalidOperationException</code>
                (code file <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib.Tests/Services/BooksServiceTest.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">单元测试 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBook_UpdateNotExistingBookThrows</code>
                            验证尝试更新服务中不存在的书籍需要抛出 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">InvalidOperationException</code>
                            （代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib.Tests/Services/BooksServiceTest.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c23-code-0028"><code>[Fact]</code>
<code>public async Task AddOrUpdateBook_UpdateNotExistingBookThrows()</code>
<code>{</code>
<code>  // arrange in constructor</code>
<code>  // act and assert</code>
<code>  await Assert.ThrowsAsync&lt;InvalidOperationException&gt;(() =&gt;  </code>
<code>    _booksService.AddOrUpdateBookAsync(_notInRepositoryBook));</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">The usual case to update a book is dealt with in the unit test
                <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBook_UpdateBook</code>.
                Here, extra preparation is needed to first add the book to the service before updating it (code file
                <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib.Tests/Services/BooksServiceTest.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">更新书籍的常规情况在单元测试 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">AddOrUpdateBook_UpdateBook</code>
                            中处理。这里，首先需要先向服务添加书籍，然后再更新它（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">MockingSamples/BooksLib.Tests/Services/BooksServiceTest.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c23-code-0029"><code>[Fact]</code>
<code>public async Task AddOrUpdateBook_UpdateBook()<span aria-label="682" epub:type="pagebreak" id="Page_682" role="doc-pagebreak"></span></code>
<code>{</code>
<code>  // arrange</code>
<code>  await _booksService.AddOrUpdateBookAsync(_newBook);</code>
<code> </code>
<code>  // act</code>
<code>  Book updatedBook = await _booksService.AddOrUpdateBookAsync(_updatedBook);</code>
<code> </code>
<code>  // assert</code>
<code>  Assert.Equal(_updatedBook, updatedBook);</code>
<code>  Assert.Contains(_updatedBook, _booksService.Books);</code>
<code>}</code></pre>
            <aside data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                <div class="top hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <p id="c23-para-0068" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">NOTE</b> <i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">When you use the MVVM
                            pattern with XAML-based applications and the MVC pattern with web-based applications, you
                            reduce the complexity of the user interface and reduce the need for complex UI testing.
                            However, there are still some scenarios that should be tested with the UI—for example,
                            navigating through pages, drag and drop of elements, and more. This is where UI testing
                            comes in. Appium supports testing XAML applications including UWP and Mobile MAUI
                            applications. Check </i><code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://appium.io">https://appium.io</a></code><i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"> for more information
                            about Appium. Visual Studio App Center (</i><code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://appcenter.ms">https://appcenter.ms</a></code><i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">) makes it easy to
                            run UI tests of MAUI applications on hundreds of different Android and iOS devices. Check
                        </i><code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/ProfessionalCSharp/MoreSamples">https://github.com/ProfessionalCSharp/MoreSamples</a></code><i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"> and </i><code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://csharp.christiannagel.com">https://csharp.christiannagel.com</a></code><i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"> for samples of using
                            Appium to test the book's WinUI applications.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 当你使用 MVVM 模式与基于 XAML
                                    的应用程序以及 MVC 模式与基于 Web 的应用程序时，你可以减少用户界面的复杂性并减少对复杂 UI 测试的需求。然而，仍然有一些场景需要使用 UI
                                    进行测试——例如，页面导航、元素的拖放等。这就是 UI 测试发挥作用的地方。Appium 支持测试基于 XAML 的应用程序，包括 UWP 和 Mobile MAUI
                                    应用程序。有关 Appium 的更多信息，请查看 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://appium.io">https://appium.io</a></code>
                                    。Visual Studio App Center ( <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://appcenter.ms">https://appcenter.ms</a></code>
                                    ) 可以轻松在数百种不同的 Android 和 iOS 设备上运行 MAUI 应用程序的 UI 测试。查看 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/ProfessionalCSharp/MoreSamples">https://github.com/ProfessionalCSharp/MoreSamples</a></code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://csharp.christiannagel.com">https://csharp.christiannagel.com</a></code>
                                    以获取使用 Appium 测试本书 WinUI 应用程序的示例。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <hr />
                    </div>
                </section>
            </aside>
        </section>
        <section aria-labelledby="head-2-215" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
            <span id="c23-sec-0020" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
            <h2 id="head-2-215" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">ASP.NET CORE INTEGRATION TESTING<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">ASP.NET CORE 集成测试</font>
                    </font>
                </font>
            </h2>
            <p id="c23-para-0069" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">To test web applications, you can create unit tests that invoke
                methods of the controllers, repository, and utility classes. Tag helpers are simple methods in which the
                test can be covered by unit tests. Unit tests are used to test the functionality of the algorithms of
                the methods—in other words, the logic inside the methods.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要测试 Web
                            应用程序，你可以创建单元测试来调用控制器、存储库和实用程序类的方法。标签辅助方法是简单的测试方法，可以被单元测试覆盖。单元测试用于测试方法的算法功能——换句话说，就是方法内部的逻辑。
                        </font>
                    </font>
                </font>
            </p>
            <p id="c23-para-0070" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">To test not only small units but all the functionality together,
                you use <i data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">integration tests</i>.
                With integration tests, not only is a single method tested but all the functionality in combination is
                tested—for example, sending a request to open a page, including accessing functionality in the backend.
                You should have a lot more unit tests than integration tests. The Azure DevOps team has thousands of
                unit tests but only a few integration tests. If the same functionality could be covered either by unit
                or integration tests, you should choose unit tests.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            为了测试不仅小单元而且所有功能一起，你使用集成测试。通过集成测试，不仅测试单个方法，还测试所有功能的组合——例如，发送请求打开页面，包括访问后端功能。你应该有比集成测试多得多的单元测试。Azure
                            DevOps 团队有数千个单元测试，但只有几个集成测试。如果相同的功能可以通过单元测试或集成测试覆盖，你应该选择单元测试。</font>
                    </font>
                </font>
            </p>
            <p id="c23-para-0071" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">ASP.NET Core offers the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">WebApplicationFactory</code>
                class in the NuGet package and the namespace <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Microsoft.AspNetCore.Mvc.Testing</code>
                to bootstrap an application in-memory for functional end-to-end testing.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">ASP.NET Core 在 NuGet 包中提供 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">WebApplicationFactory</code>
                            类和在 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Microsoft.AspNetCore.Mvc.Testing</code>
                            命名空间中，用于在内存中启动应用程序进行功能端到端测试。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">To create an ASP.NET Core integration test, create an ASP.NET
                Core Web Application named <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ASPNETCoreSample</code> with
                the Empty template. Running the application from the generated code returns the string <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Hello World!</code>, and this
                will be tested from an integration test using <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要创建 ASP.NET Core 集成测试，使用空模板创建一个名为
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ASPNETCoreSample</code>
                            的 ASP.NET Core Web 应用程序。从生成的代码运行应用程序返回字符串 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Hello World!</code>
                            ，这将使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                            从集成测试进行测试。</font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                <div class="top hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <p id="c23-para-0073" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">NOTE</b> <i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ASP.NET Core is
                            covered in detail in <a href="c24.xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Chapters 24</a>
                            to <a href="c28.xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">28</a>.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意：ASP.NET Core 在 24 至 28
                                    章中有详细说明。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <hr />
                    </div>
                </section>
            </aside>
            <p id="c23-para-0074" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">The <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                project <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ASPNETCoreSample.IntegrationTest</code>
                needs a package reference to <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Microsoft.AspNetCore.Mvc.Testing</code>.
                This package contains the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">WebApplicationFactory</code>
                class to host and start the web application and to send requests. A reference to the web project <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ASPNETCoreSample</code> is
                needed as well.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">项目 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                            需要一个包引用到 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Microsoft.AspNetCore.Mvc.Testing</code>
                            。这个包包含了用于托管和启动 Web 应用程序以及发送请求的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">WebApplicationFactory</code>
                            类。还需要一个对 Web 项目 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ASPNETCoreSample</code>
                            的引用。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1"><span aria-label="683" epub:type="pagebreak" id="Page_683"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>With <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>,
                every time a test runs, the test class is newly instantiated, and the constructor is invoked. To share
                instances between multiple test methods, you use the generic interface <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IFixture</code> as an
                annotation to the test class. The type generic defined with this interface is instantiated once for all
                test methods with the class. In the following code snippet, this is the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">WebApplicationFactory</code>
                class. The generic parameter of the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">WebApplicationFactory</code>
                is the entry point of the application, which can be the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Startup</code> or the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Program</code> class. Here,
                the <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Startup</code> class is
                used to instantiate the web application to configure the dependency injection container and the
                middleware (code file <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ASPNETCoreSample/ASPNETCoreSample.IntegrationTest/AspNetCoreSampleTest.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                            时，每次运行测试时，测试类都会被重新实例化，并调用构造函数。为了在多个测试方法之间共享实例，你使用泛型接口 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">IFixture</code>
                            作为测试类的注解。使用这个接口定义的泛型类型会为所有测试方法通过类进行一次实例化。在以下代码片段中，这就是 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">WebApplicationFactory</code>
                            类。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">WebApplicationFactory</code>
                            的泛型参数是应用程序的入口点，可以是 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Startup</code> 或
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Program</code>
                            类。这里使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Startup</code>
                            类来实例化 Web 应用程序以配置依赖注入容器和中间件（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ASPNETCoreSample/ASPNETCoreSample.IntegrationTest/AspNetCoreSampleTest.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c23-code-0030"><code>public class ASPNETCoreSampleTest</code>
<code>  : IClassFixture&lt;WebApplicationFactory&lt;ASPNETCoreSample.Startup&gt;&gt;</code>
<code>{</code>
<code>  private readonly WebApplicationFactory&lt;ASPNETCoreSample.Startup&gt; _factory;</code>
<code> </code>
<code>  public ASPNETCoreSampleTest(WebApplicationFactory&lt;ASPNETCoreSample.Startup&gt; factory)</code>
<code>    =&gt; _factory = factory;</code>
<code>  //…</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">In the integration test, by using the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_factory</code> variable you
                create an <code data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">HttpClient</code>
                object that's configured by the factory. This client makes requests to the web application. This <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">HttpClient</code> is
                configured to follow redirects and to pass cookies received. With the implementation of the test class
                in the following code snippet, an HTTP GET request is done, and the response is compared with the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Hello World!</code> string
                that should be returned from the web application (code file <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ASPNETCoreSample/ASPNETCoreSample.IntegrationTest/AspNetCoreSampleTest.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在集成测试中，通过使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_factory</code>
                            变量，你创建了一个由工厂配置的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">HttpClient</code>
                            对象。这个客户端向 Web 应用程序发起请求。这个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">HttpClient</code>
                            被配置为遵循重定向并传递接收到的 cookie。通过以下代码片段中的测试类实现，执行了一个 HTTP GET 请求，并将响应与 Web 应用程序应返回的 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Hello World!</code>
                            字符串（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">ASPNETCoreSample/ASPNETCoreSample.IntegrationTest/AspNetCoreSampleTest.cs</code>
                            ）进行比较：</font>
                    </font>
                </font>
            </p>
            <pre id="c23-code-0031"><code>[Fact]</code>
<code>public async Task ReturnHelloWorld()</code>
<code>{          </code>
<code>  // arrange</code>
<code>  var client = _factory.CreateClient();</code>
<code> </code>
<code>  // act</code>
<code>  var response = await client.GetAsync("/");</code>
<code> </code>
<code>  // assert</code>
<code>  response.EnsureSuccessStatusCode();</code>
<code>  string responseString = await response.Content.ReadAsStringAsync();</code>
<code>  Assert.Equal("Hello World!", responseString);</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">With the <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">HttpClient</code> class
                returned from the factory, you can create HTTP requests using verbs such as GET, POST, and PUT, and add
                HTTP header information. Read <a href="c19.xhtml"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Chapter 19</a>, “Networking,”
                for more information on this class. When you use the factory with <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_factory.Server.CreateWebSocketClient</code>,
                you can also use a <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">WebSocketClient</code> to
                create WebSocket requests. WebSockets are covered in <a href="c28.xhtml"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">Chapter 28</a>, “SignalR.”
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用工厂返回的 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">HttpClient</code>
                            类，你可以使用 GET、POST 和 PUT 等动词创建 HTTP 请求，并添加 HTTP 头信息。有关此类的更多信息，请阅读第 19 章“网络”。当你使用工厂与 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">_factory.Server.CreateWebSocketClient</code>
                            时，也可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">WebSocketClient</code>
                            来创建 WebSocket 请求。WebSocket 在第 28 章“SignalR”中介绍。</font>
                    </font>
                </font><span aria-label="684" epub:type="pagebreak" id="Page_684" role="doc-pagebreak"
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span></p>
            <aside data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                <div class="top hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                    <p id="c23-para-0078" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">NOTE</b> <i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">With web
                            applications, it is also a good practice to create performance and load tests. Does the
                            application scale? How many users can the application support with one server? How many
                            servers are needed to support a specific number of users? Which bottleneck is not that easy
                            to scale? To answer these questions, performance and load tests can help. To create
                            end-to-end tests nowadays, people often use Selenium or Playwright. Appium, which I
                            mentioned earlier with testing desktop and mobile applications, is based on Selenium. The
                            ASP.NET Core team switched after the release of .NET 5 from Selenium to Playwright. Read
                            more about Selenium at </i><code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://www.selenium.dev/">https://www.selenium.dev/</a></code><i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">. Playwright is
                            developed by Microsoft (</i><code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://playwright.dev/">https://playwright.dev/</a></code><i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">) with the source
                            code available at </i><code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/microsoft/playwright">https://github.com/microsoft/playwright</a></code><i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">. Check </i><code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/ProfessionalCSharp/MoreSamples">https://github.com/ProfessionalCSharp/MoreSamples</a></code><i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"> and </i><code
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://csharp.christiannagel.com">https://csharp.christiannagel.com</a></code><i
                            data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"> for samples and
                            articles using Playwright to test the web samples of the book.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 对于 Web
                                    应用程序，创建性能和负载测试也是一个好习惯。应用程序是否可扩展？一个服务器能支持多少用户？支持特定数量的用户需要多少服务器？哪些瓶颈不容易扩展？为了回答这些问题，性能和负载测试可以提供帮助。如今创建端到端测试时，人们通常使用
                                    Selenium 或 Playwright。我之前提到的用于测试桌面和移动应用程序的 Appium 基于 Selenium。ASP.NET Core 团队在.NET 5
                                    发布后从 Selenium 切换到了 Playwright。想了解更多关于 Selenium 的内容，请查看 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://www.selenium.dev/">https://www.selenium.dev/</a></code>
                                    。Playwright 由微软开发（ <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://playwright.dev/">https://playwright.dev/</a></code>
                                    ），源代码可在 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/microsoft/playwright">https://github.com/microsoft/playwright</a></code>
                                    找到。查看 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://github.com/ProfessionalCSharp/MoreSamples">https://github.com/ProfessionalCSharp/MoreSamples</a></code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="https://csharp.christiannagel.com">https://csharp.christiannagel.com</a></code>
                                    获取使用 Playwright 测试本书 Web 示例的示例和文章。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
                        <hr />
                    </div>
                </section>
            </aside>
        </section>
        <section aria-labelledby="head-2-216" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759">
            <span id="c23-sec-0023" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"></span>
            <h2 id="head-2-216" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">SUMMARY<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">摘要</font>
                    </font>
                </font>
            </h2>
            <p id="c23-para-0079" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">Source code is not complete without unit tests. To test the
                functionality of your application, you should create unit tests. With unit tests, you're safe to make
                changes in your code without breaking other parts. You've seen how to create unit tests with <code
                    data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                and how to test for all the different paths. You've seen mock classes in place to get implementation for
                dependent contracts that you don't want to test.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            没有单元测试，源代码就是不完整的。为了测试你的应用程序的功能，你应该创建单元测试。有了单元测试，你可以在代码中进行更改，而不用担心破坏其他部分。你已经看到了如何使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"><a href="http://xunit.net">xUnit.net</a></code>
                            创建单元测试，以及如何测试所有不同的路径。你还看到了模拟类的使用，以获取你不想测试的依赖合同的实现。</font>
                    </font>
                </font>
            </p>
            <p id="c23-para-0080" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">With integration tests, you've seen how an ASP.NET Core web
                application can be loaded in memory and an HTTP client can be used from a test.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">通过集成测试，你看到了一个 ASP.NET Core Web
                            应用程序如何在内存中加载，以及如何在测试中使用 HTTP 客户端。</font>
                    </font>
                </font>
            </p>
            <p id="c23-para-0081" data-immersive-translate-walked="88eee6a8-3225-4a9c-83dd-2ff64c108759"
                data-immersive-translate-paragraph="1">This was the last chapter of the second part of this book. The
                next part, “Web Applications and Services,” is where you begin to dig into web applications and services
                with ASP.NET Core. In that part you will use Razor Pages, MVC, and Blazor for the user interface, and
                ASP.NET Core Web API, Azure Functions, GRPC, and SignalR for the services.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">这是本书第二部分的最后一章。下一部分是“Web
                            应用程序和服务”，在那里你将开始使用 ASP.NET Core 深入挖掘 Web 应用程序和服务。在那部分中，你将使用 Razor Pages、MVC 和 Blazor
                            来构建用户界面，以及使用 ASP.NET Core Web API、Azure Functions、GRPC 和 SignalR 来构建服务。</font>
                    </font>
                </font>
            </p>
        </section>
    </section>
</body>
<div id="immersive-translate-popup" style="all: initial"></div>

</html>