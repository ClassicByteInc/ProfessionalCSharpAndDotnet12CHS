<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops"
    xmlns:svg="http://www.w3.org/2000/svg" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en"
    imt-state="dual" imt-trans-position="after">

<head>
    <title>5 运算符和类型转换 --- 5 Operators and Casts</title>
    <link href="WileyTemplate_v5.5.css" rel="stylesheet" type="text/css" />
    <meta content="urn:uuid:e0000000-0000-0000-0000-000006715209" name="Adept.expected.resource" />
    <style data-id="immersive-translate-input-injected-css">
        .immersive-translate-input {
            position: absolute;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            z-index: 2147483647;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .immersive-translate-attach-loading::after {
            content: " ";

            --loading-color: #f78fb6;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: block;
            margin: 12px auto;
            position: relative;
            color: white;
            left: -100px;
            box-sizing: border-box;
            animation: immersiveTranslateShadowRolling 1.5s linear infinite;

            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-2000%, -50%);
            z-index: 100;
        }

        .immersive-translate-loading-spinner {
            vertical-align: middle !important;
            width: 10px !important;
            height: 10px !important;
            display: inline-block !important;
            margin: 0 4px !important;
            border: 2px rgba(221, 244, 255, 0.6) solid !important;
            border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-radius: 50% !important;
            padding: 0 !important;
            -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
            animation: immersive-translate-loading-animation 0.6s infinite linear !important;
        }

        @-webkit-keyframes immersive-translate-loading-animation {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @keyframes immersive-translate-loading-animation {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(359deg);
            }
        }

        .immersive-translate-input-loading {
            --loading-color: #f78fb6;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: block;
            margin: 12px auto;
            position: relative;
            color: white;
            left: -100px;
            box-sizing: border-box;
            animation: immersiveTranslateShadowRolling 1.5s linear infinite;
        }

        @keyframes immersiveTranslateShadowRolling {
            0% {
                box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            12% {
                box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            25% {
                box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            36% {
                box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color),
                    100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
            }

            50% {
                box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color),
                    110px 0 var(--loading-color), 100px 0 var(--loading-color);
            }

            62% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color),
                    120px 0 var(--loading-color), 110px 0 var(--loading-color);
            }

            75% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    130px 0 var(--loading-color), 120px 0 var(--loading-color);
            }

            87% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
            }

            100% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
            }
        }

        .immersive-translate-toast {
            display: flex;
            position: fixed;
            z-index: 2147483647;
            left: 0;
            right: 0;
            top: 1%;
            width: fit-content;
            padding: 12px 20px;
            margin: auto;
            overflow: auto;
            background: #fef6f9;
            box-shadow: 0px 4px 10px 0px rgba(0, 10, 30, 0.06);
            font-size: 15px;
            border-radius: 8px;
            color: #333;
        }

        .immersive-translate-toast-content {
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        .immersive-translate-toast-hidden {
            margin: 0 20px 0 72px;
            text-decoration: underline;
            cursor: pointer;
        }

        .immersive-translate-toast-close {
            color: #666666;
            font-size: 20px;
            font-weight: bold;
            padding: 0 10px;
            cursor: pointer;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-toast {
                top: 0;
                padding: 12px 0px 0 10px;
            }

            .immersive-translate-toast-content {
                flex-direction: column;
                text-align: center;
            }

            .immersive-translate-toast-hidden {
                margin: 10px auto;
            }
        }

        .immersive-translate-modal {
            display: none;
            position: fixed;
            z-index: 2147483647;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.4);
            font-size: 15px;
        }

        .immersive-translate-modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 40px 24px 24px;
            border: 1px solid #888;
            border-radius: 10px;
            width: 80%;
            max-width: 270px;
            font-family: system-ui, -apple-system, "Segoe UI", "Roboto", "Ubuntu",
                "Cantarell", "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
                "Segoe UI Symbol", "Noto Color Emoji";
            position: relative;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-modal-content {
                margin: 50% auto !important;
            }
        }

        .immersive-translate-modal .immersive-translate-modal-content-in-input {
            max-width: 500px;
        }

        .immersive-translate-modal-content-in-input .immersive-translate-modal-body {
            text-align: left;
            max-height: unset;
        }

        .immersive-translate-modal-title {
            text-align: center;
            font-size: 16px;
            font-weight: 700;
            color: #333333;
        }

        .immersive-translate-modal-body {
            text-align: center;
            font-size: 14px;
            font-weight: 400;
            color: #333333;
            word-break: break-all;
            margin-top: 24px;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-modal-body {
                max-height: 250px;
                overflow-y: auto;
            }
        }

        .immersive-translate-close {
            color: #666666;
            position: absolute;
            right: 16px;
            top: 16px;
            font-size: 20px;
            font-weight: bold;
        }

        .immersive-translate-close:hover,
        .immersive-translate-close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        .immersive-translate-modal-footer {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 24px;
        }

        .immersive-translate-btn {
            width: fit-content;
            color: #fff;
            background-color: #ea4c89;
            border: none;
            font-size: 16px;
            margin: 0 8px;
            padding: 9px 30px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .immersive-translate-btn:hover {
            background-color: #f082ac;
        }

        .immersive-translate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .immersive-translate-btn:disabled:hover {
            background-color: #ea4c89;
        }

        .immersive-translate-cancel-btn {
            /* gray color */
            background-color: rgb(89, 107, 120);
        }

        .immersive-translate-cancel-btn:hover {
            background-color: hsl(205, 20%, 32%);
        }

        .immersive-translate-action-btn {
            background-color: transparent;
            color: #ea4c89;
            border: 1px solid #ea4c89;
        }

        .immersive-translate-btn svg {
            margin-right: 5px;
        }

        .immersive-translate-link {
            cursor: pointer;
            user-select: none;
            -webkit-user-drag: none;
            text-decoration: none;
            color: #007bff;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        .immersive-translate-primary-link {
            cursor: pointer;
            user-select: none;
            -webkit-user-drag: none;
            text-decoration: none;
            color: #ea4c89;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        .immersive-translate-modal input[type="radio"] {
            margin: 0 6px;
            cursor: pointer;
        }

        .immersive-translate-modal label {
            cursor: pointer;
        }

        .immersive-translate-close-action {
            position: absolute;
            top: 2px;
            right: 0px;
            cursor: pointer;
        }

        .imt-image-status {
            background-color: rgba(0, 0, 0, 0.5) !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
            border-radius: 16px !important;
        }

        .imt-image-status img,
        .imt-image-status svg,
        .imt-img-loading {
            width: 28px !important;
            height: 28px !important;
            margin: 0 0 8px 0 !important;
            min-height: 28px !important;
            min-width: 28px !important;
            position: relative !important;
        }

        .imt-img-loading {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAtFBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////oK74hAAAAPHRSTlMABBMIDyQXHwyBfFdDMSw+OjXCb+5RG51IvV/k0rOqlGRM6KKMhdvNyZBz9MaupmxpWyj437iYd/yJVNZeuUC7AAACt0lEQVRIx53T2XKiUBCA4QYOiyCbiAsuuGBcYtxiYtT3f6/pbqoYHVFO5r+iivpo6DpAWYpqeoFfr9f90DsYAuRSWkFnPO50OgR9PwiCUFcl2GEcx+N/YBh6pvKaefHlUgZd1zVe0NbYcQjGBfzrPE8Xz8aF+71D8gG6DHFPpc4a7xFiCDuhaWgKgGIJQ3d5IMGDrpS4S5KgpIm+en9f6PlAhKby4JwEIxlYJV9h5k5nee9GoxHJ2IDSNB0dwdad1NAxDJ/uXDHYmebdk4PdbkS58CIVHdYSUHTYYRWOJblWSyu2lmy3KNFVJNBhxcuGW4YBVCbYGRZwIooipHsNqjM4FbgOQqQqSKQQU9V8xmi1QlgHqQQ6DDBvRUVCDirs+EzGDGOQTCATgtYTnbCVLgsVgRE0T1QE0qHCFAht2z6dLvJQs3Lo2FQoDxWNUiBhaP4eRgwNkI+dAjVOA/kUrIDwf3CG8NfNOE0eiFotSuo+rBiq8tD9oY4Qzc6YJw99hl1wzpQvD7ef2M8QgnOGJfJw+EltQc+oX2yn907QB22WZcvlUpd143dqQu+8pCJZuGE4xCuPXJqqcs5sNpsI93Rmzym1k4Npk+oD1SH3/a3LOK/JpUBpWfqNySxWzCfNCUITuDG5dtuphrUJ1myeIE9bIsPiKrfqTai5WZxbhtNphYx6GEIHihyGFTI69lje/rxajdh0s0msZ0zYxyPLhYCb1CyHm9Qsd2H37Y3lugVwL9kNh8Ot8cha6fUNQ8nuXi5z9/ExsAO4zQrb/ev1yrCB7lGyQzgYDGuxq1toDN/JGvN+HyWNHKB7zEoK+PX11e12G431erGYzwmytAWU56fkMHY5JJnDRR2eZji3AwtIcrEV8Cojat/BdQ7XOwGV1e1hDjGGjXbdArm8uJZtCH5MbcctVX8A1WpqumJHwckAAAAASUVORK5CYII=");
            background-size: 28px 28px;
            animation: image-loading-rotate 1s linear infinite !important;
        }

        .imt-image-status span {
            color: var(--bg-2, #fff) !important;
            font-size: 14px !important;
            line-height: 14px !important;
            font-weight: 500 !important;
            font-family: "PingFang SC", Arial, sans-serif !important;
        }

        @keyframes image-loading-rotate {
            from {
                transform: rotate(360deg);
            }

            to {
                transform: rotate(0deg);
            }
        }
    </style>
    <style data-id="immersive-translate-default-injected-css">
        :root {
            --immersive-translate-theme-underline-borderColor: #72ece9;
            --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
            --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
            --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
            --immersive-translate-theme-highlight-backgroundColor: #ffff00;
            --immersive-translate-theme-dashed-borderColor: #59c1bd;
            --immersive-translate-theme-blockquote-borderColor: #cc3355;
            --immersive-translate-theme-thinDashed-borderColor: #ff374f;
            --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
            --immersive-translate-theme-dashedBorder-borderRadius: 0;
            --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
            --immersive-translate-theme-solidBorder-borderRadius: 0;
            --immersive-translate-theme-dotted-borderColor: #94a3b8;
            --immersive-translate-theme-wavy-borderColor: #72ece9;
            --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
            --immersive-translate-theme-grey-textColor: #2f4f4f;
            --immersive-translate-theme-marker-backgroundColor: #fbda41;
            --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
            --immersive-translate-theme-marker2-backgroundColor: #ffff00;
            --immersive-translate-theme-background-backgroundColor: #dbafaf;
            --immersive-translate-theme-background-backgroundColor-rgb: 219, 175, 175;
            --immersive-translate-theme-background-backgroundOpacity: 12;
            --immersive-translate-theme-opacity-opacity: 10;
        }

        [imt-state="dual"] .immersive-translate-target-translation-pre-whitespace {
            white-space: pre-wrap !important;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container {
            position: absolute;
            background-color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
                sans-serif;
            top: 0;
            width: 600px;
            height: 100%;
            z-index: 2;
            line-height: 1.3;
            font-size: 16px;
        }

        [imt-state="dual"] .immersive-translate-target-wrapper[dir="rtl"] {
            text-align: right;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container .immersive-translate-target-wrapper {
            color: rgb(0, 0, 0);
            white-space: normal;
            position: absolute;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container .immersive-translate-target-wrapper font {
            color: inherit;
            white-space: inherit;
            position: unset;
        }

        [imt-state="translation"] .immersive-translate-target-wrapper &gt;

        br {
            display: none;
        }

        [imt-state="translation"] .immersive-translate-target-translation-block-wrapper {
            margin: 0 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper {
            margin: 8px 0 !important;
            display: inline-block;
        }

        [imt-trans-position="before"] .immersive-translate-target-translation-block-wrapper {
            display: block;
        }

        [imt-trans-position="before"] .immersive-translate-target-translation-block-wrapper {
            margin-top: 0 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-pdf-block-wrapper {
            margin: 0 !important;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-grey-inner {
            color: var(--immersive-translate-theme-grey-textColor);
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-underline-inner {
            border-bottom: 1px solid var(--immersive-translate-theme-underline-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeUnderline-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeUnderline-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
            border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
            padding: 6px;
            margin-top: 2px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
            border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
            padding: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-solidBorder {
            border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
            padding: 6px;
            margin-top: 2px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
            border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
            padding: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeDashed-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeDashed-borderColor) !important;
            text-decoration-style: dashed !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-thinDashed-inner {
            border-bottom: 1px dashed var(--immersive-translate-theme-thinDashed-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-dotted-inner {
            background-image: linear-gradient(to right,
                    var(--immersive-translate-theme-dotted-borderColor) 30%,
                    rgba(255, 255, 255, 0) 0%);
            background-position: bottom;
            background-size: 5px 1px;
            background-repeat: repeat-x;
            padding-bottom: 3px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeDotted-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeDotted-borderColor) !important;
            text-decoration-style: dotted !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-wavy-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-wavy-borderColor) !important;
            text-decoration-style: wavy !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-dashed-inner {
            background: linear-gradient(to right,
                    var(--immersive-translate-theme-dashed-borderColor) 0%,
                    var(--immersive-translate-theme-dashed-borderColor) 50%,
                    transparent 50%,
                    transparent 100%) repeat-x left bottom;
            background-size: 8px 2px;
            padding-bottom: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
            content: "";
            display: block;
            max-width: 80px;
            width: 10%;
            border-top: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
            padding-top: 8px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
            content: "";
            border-left: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
            max-height: 16px;
            height: 16px;
            padding-left: 8px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-highlight-inner {
            background: var(--immersive-translate-theme-highlight-backgroundColor);
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-marker {
            line-height: 1.5em;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-marker2-inner {
            font-weight: bold;
            text-shadow: 10px 0px 3px var(--immersive-translate-theme-marker2-backgroundColor),
                16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
                2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
                -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-marker-inner {
            /* TODO: add more texture */
            background: linear-gradient(to right,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3));
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-weakening {
            opacity: 0.618 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-italic {
            font-style: italic !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-bold {
            font-weight: bold !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-paper {
            margin: 8px 0;
            box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
            padding: 16px 32px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-blockquote {
            border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
            padding-left: 12px !important;
            margin-top: 4px;
            margin-bottom: 4px;
            padding-top: 4px;
            padding-bottom: 4px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-mask-inner {
            filter: blur(5px) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-mask-inner {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner {
            filter: blur(5px) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        /* opacity theme start */

        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner {
            filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-opacity-inner {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner,
        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner:hover {
            filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner:hover {
            filter: none !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-mask-inner:hover {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner:hover {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner:hover {
            filter: none !important;
        }

        /* opacity theme end */

        /* background theme start */
        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-background {
            margin: 8px 0;
            background: rgba(var(--immersive-translate-theme-background-backgroundColor-rgb),
                    calc(var(--immersive-translate-theme-background-backgroundOpacity) * 1%));
            border-radius: 4px;
            box-shadow: unset !important;
            padding: 12px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-background-inner {
            background: rgba(var(--immersive-translate-theme-background-backgroundColor-rgb),
                    calc(var(--immersive-translate-theme-background-backgroundOpacity) * 1%));
            padding-left: 6px;
            padding-right: 6px;
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper .immersive-translate-target-translation-theme-background-inner {
            background: unset;
            padding-left: unset;
            padding-right: unset;
        }

        /* background theme end */

        /* vertical css , please remain it in the last one. */
        .immersive-translate-target-translation-vertical-block-wrapper {
            margin: 0px 8px !important;
        }

        .immersive-translate-text {
            font-size: 15px !important;
        }

        .immersive-translate-error-toast {
            position: fixed;
            top: 5%;
            z-index: 99999999;
            left: 0;
            right: 0;
            margin: auto;
            max-width: 300px;
            padding: 16px;
            border-radius: 12px;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: row;
            justify-content: space-between;
        }

        @media all and (min-width: 750px) {
            .immersive-translate-error-toast {
                max-width: 400px;
            }
        }

        .immersive-translate-clickable-button {
            cursor: pointer;
        }

        .immersive-translate-help-button {
            cursor: pointer;
        }

        .immersive-translate-loading-text:before {
            content: "...";
        }

        /* dark mode for loading */

        @media only screen and (prefers-color-scheme: dark) {
            .immersive-translate-loading {
                border: 2px rgba(255, 255, 255, 0.25) solid !important;
                border-top: 2px rgba(255, 255, 255, 1) solid !important;
            }
        }

        .immersive-translate-error-wrapper {
            position: relative;
            display: inline-flex;
            padding: 6px;
            margin: 0 12px;
            white-space: nowrap;
            font-size: 0.9em;
        }

        [lang="zh-CN"] .immersive-translate-error-wrapper {
            font-size: 0.75em;
        }

        [lang="zh-TW"] .immersive-translate-error-wrapper {
            font-size: 0.75em;
        }

        .immersive-translate-tooltip {
            position: relative;
            display: inline-flex;
            /* little indicater to indicate it's hoverable */
        }

        .immersive-translate-tooltip-content {
            /* here's the magic */
            position: absolute;
            z-index: 100000000000;

            left: 50%;
            bottom: 0;
            transform: translate(-50%, 110%);
            line-height: 1;
            /* and add a small left margin */

            /* basic styles */
            width: max-content;
            max-width: 250px;
            word-wrap: break-word;
            white-space: pre-line;
            padding: 10px;
            border-radius: 10px;
            background: #000c;
            color: #fff;
            text-align: center;
            font-size: 14px;
            display: none;
            /* hide by default */
        }

        .immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
            display: inline-block;
        }

        .immersive-translate-tooltip:hover+.immersive-translate-tooltip-content {
            display: inline-block;
        }

        .immersive-translate-tooltip-content-table {
            left: unset !important;
            bottom: unset !important;
            transform: translate(-10%, 50%) !important;
        }

        .immersive-translate-tooltip:hover:before {
            display: inline-block;
        }

        .immersive-translate-loading-spinner {
            vertical-align: middle !important;
            width: 10px !important;
            height: 10px !important;
            display: inline-block !important;
            margin: 0 4px !important;
            border: 2px rgba(221, 244, 255, 0.6) solid !important;
            border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-radius: 50% !important;
            padding: 0 !important;
            -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
            animation: immersive-translate-loading-animation 0.6s infinite linear !important;
        }

        @-webkit-keyframes immersive-translate-loading-animation {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @keyframes immersive-translate-loading-animation {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(359deg);
            }
        }

        .imt-image-status {
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--bg-2, #fff);
            font-size: 14px;
        }
    </style>
    <style data-id="immersive-translate-user-custom-style">
        :root {

            .immersive-translate-target-inner {
                font-family: inherit;
            }


            .immersive-translate-target-inner {
                font-family: inherit;
            }
        }
    </style>
    <style data-id="immersive-translate-dynamic-injected-css">
        .immersive-translate-target-wrapper[dir='rtl'] {
            text-align: right;
        }

        .immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {
            display: block;
        }

        .immersive-translate-target-wrapper {
            word-break: break-word;
            user-select: text;
        }

        [imt-state="translation"] .immersive-translate-target-wrapper[dir='rtl'] {
            display: inline-block;
        }

        [dir='rtl'] .immersive-translate-target-wrapper:not([dir]) {
            text-align: left;
        }

        [imt-state=dual] .immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
            display: block;
        }

        [imt-trans-position=before] .immersive-translate-target-translation-block-wrapper {
            display: block !important;
        }

        [imt-state][data-immersive-translate_rtl] .immersive-translate-target-wrapper {
            display: block !important;
        }
    </style>
</head>

<body epub:type="bodymatter" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
    <section aria-labelledby="c05_1" epub:type="chapter" role="doc-chapter"
        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
        <header data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
            <h1 id="c05_1" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1"><span aria-label="119" epub:type="pagebreak" id="Page_119"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span><span id="c05"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span><span
                    class="chapterNumber"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">5</span><br /><span
                    class="chapterTitle"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Operators and Casts</span>
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">5 运算符和类型转换</font>
                    </font>
                </font>
            </h1>
        </header>
        <section aria-label="chapter opening" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
            <span id="c05-sec-0001" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <h3 data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">WHAT'S IN THIS CHAPTER?<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">本章内容</font>
                            </font>
                        </font>
                    </h3>
                    <ul class="check2" id="c05-list-0001"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <li id="c05-li-0001" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Operators in C#<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">C#中的运算符</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0002" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Implicit and explicit conversions<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">隐式和显式转换</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0003" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Overloading standard operators for custom types<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">为自定义类型重载标准运算符</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0004" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Comparing objects for equality<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">比较对象是否相等</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0005" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Implementing custom indexers<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">实现自定义索引器</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0006" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">User-defined conversions<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">用户自定义转换</font>
                                </font>
                            </font>
                        </li>
                    </ul>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span
                        id="c05-fea-0001" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                    <h3 id="head-2-41" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">CODE DOWNLOADS FOR THIS CHAPTER<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">本章代码下载</font>
                            </font>
                        </font>
                    </h3>
                    <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span
                            id="c05-sec-0003"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                        <p id="c05-para-0004" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">The source code for this chapter is available on the
                            book page at <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><a href="http://www.wiley.com">www.wiley.com</a></code>.
                            Click the Downloads link. The code can also be found at <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><a href="https://github.com/ProfessionalCSharp/ProfessionalCSharp2021">https://github.com/ProfessionalCSharp/ProfessionalCSharp2021</a></code>
                            in the directory <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">1_CS/OperatorsAndCasts</code>.
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章的源代码可在第 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><a href="http://www.wiley.com">www.wiley.com</a></code>
                                        页的书籍页面上找到。点击下载链接。代码也可以在第 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><a href="https://github.com/ProfessionalCSharp/ProfessionalCSharp2021">https://github.com/ProfessionalCSharp/ProfessionalCSharp2021</a></code>
                                        处的 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">1_CS/OperatorsAndCasts</code>
                                        目录中找到。</font>
                                </font>
                            </font>
                        </p>
                        <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">The code for this chapter is divided into the
                            following major examples:<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章的代码分为以下主要示例：</font>
                                </font>
                            </font>
                        </p>
                        <ul class="check" id="c05-list-0002"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <li id="c05-li-0007" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                                data-immersive-translate-paragraph="1">OperatorsSample<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">运算符示例</font>
                                    </font>
                                </font>
                            </li>
                            <li id="c05-li-0008" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                                data-immersive-translate-paragraph="1">BinaryCalculations<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">二进制计算</font>
                                    </font>
                                </font>
                            </li>
                            <li id="c05-li-0009" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                                data-immersive-translate-paragraph="1">OperatorOverloadingSample<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">运算符重载示例</font>
                                    </font>
                                </font>
                            </li>
                            <li id="c05-li-0010" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                                data-immersive-translate-paragraph="1">EqualitySample<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">相等性示例</font>
                                    </font>
                                </font>
                            </li>
                            <li id="c05-li-0011" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                                data-immersive-translate-paragraph="1">CustomIndexerSample<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">自定义索引器示例</font>
                                    </font>
                                </font>
                            </li>
                            <li id="c05-li-0012" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                                data-immersive-translate-paragraph="1">UserDefinedConversion<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">用户定义转换</font>
                                    </font>
                                </font>
                            </li>
                        </ul>
                        <p id="c05-para-0006" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">All the projects have nullable reference types
                            enabled.<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">所有项目都启用了可空引用类型。 </font>
                                </font>
                            </font>
                        </p>
                        <p id="c05-para-0007" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><span aria-label="120" epub:type="pagebreak"
                                id="Page_120" role="doc-pagebreak"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>The
                            preceding chapters have covered most of what you need to start writing useful programs using
                            C#. This chapter continues the discussion with essential language elements and illustrates
                            some powerful aspects of C# that enable you to extend its capabilities. This chapter also
                            covers information about using operators and extending custom types with operator
                            overloading and custom conversion.<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">前面的章节已经涵盖了开始使用
                                        C#编写有用程序所需的大部分内容。本章将继续讨论重要的语言元素，并说明
                                        C#的一些强大功能，这些功能使您能够扩展其能力。本章还涵盖了使用运算符以及通过运算符重载和自定义转换扩展自定义类型的信息。</font>
                                </font>
                            </font>
                        </p>
                    </section>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside>
        </section>
        <section aria-labelledby="head-2-42" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
            <span id="c05-sec-0004" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <h2 id="head-2-42" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">OPERATORS<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">运算符</font>
                    </font>
                </font>
            </h2>
            <p id="c05-para-0008" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">C# supports the operators and expressions listed in the following
                table. In the table, the operators start with the highest precedence and go down to the lowest.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            C#支持以下表格中列出的运算符和表达式。在表格中，运算符从最高优先级开始，依次降到最低优先级。</font>
                    </font>
                </font>
            </p>
            <table border="1" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <thead data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <th class="left bgcolor2" scope="col">CATEGORY</th>
                        <th class="left bgcolor2" scope="col">OPERATOR</th>
                    </tr>
                </thead>
                <tbody data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Primary<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">主要</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x.y x?.y f</code>(<code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x) a[x] x++ x-- x! x-&gt;y new typeof default checked unchecked delegate nameof sizeof delegate stackalloc</code>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Unary<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">一元</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+x -x !x ~x ++x --x ^x (T)x await &amp;x *x true false</code>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Range<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">范围</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x..y</code></td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Multiplicative<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">乘法</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x*y x/y x%y</code>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Additive<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">加法</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x+y x-y</code>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Shift<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">移位</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x&lt;&lt;y x&gt;&gt;y</code>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Relational<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">关系</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x&lt;y x&gt;y x&lt;=y x&gt;=y</code>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Type testing<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">类型测试</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is as</code></td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Equality<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">相等性</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x==y x!=y</code>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Logical<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">逻辑</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x&amp;y x^y x|y</code>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Conditional logical<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">条件逻辑</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x&amp;&amp;y x||y</code>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Null coalescing<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">空合并运算符</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x??y</code></td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Conditional operator<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">条件运算符</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">c?t:f</code></td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Assignment<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">赋值运算符</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x=y x+=y x-=y x*=y x/=y x%=y x&amp;=y x|=y x^=y x&lt;&lt;=y x&gt;&gt;=y x??=y</code>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Lambda expression<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">Lambda 表达式</font>
                                </font>
                            </font>
                        </td>
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">=&gt;</code></td>
                    </tr>
                </tbody>
            </table>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <p id="c05-para-0010" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Four specific
                            operators (</i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">*</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">-&gt;</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, and </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&amp;</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">) are available only
                            in unsafe code (code that bypasses C#'s type-safety checking), which is discussed in <a
                                href="c13.xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 13</a>,
                            “Managed and Unmanaged Memory.”</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 四个特定运算符（ <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">*</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">-&gt;</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&amp;</code>
                                    ）仅在非安全代码（绕过 C#的类型安全检查的代码）中可用，这将在第 13 章“托管和非托管内存”中讨论。</font>
                            </font>
                        </font>
                    </p>
                    <p id="c05-para-0011" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Using the new range and hat operators with strings is
                            covered in <a href="c02.xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 2</a>,
                            “Core C#.” Using these operators with arrays is covered in <a href="c06.xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 6</a>,
                            “Arrays,” where you also can read how to support custom collections with these operators.
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用新范围和帽运算符与字符串相关的内容在第 2
                                        章“核心 C#”中介绍。使用这些运算符与数组相关的内容在第 6 章“数组”中介绍，在那里你还可以了解到如何使用这些运算符支持自定义集合。</font>
                                </font>
                            </font></i></p>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside> <span aria-label="121" epub:type="pagebreak" id="Page_121" role="doc-pagebreak"
                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0006"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-121" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Compound Assignment Operators <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">复合赋值运算符</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Compound assignment operators are a shortcut to using the
                    assignment operator with another operator. Instead of writing <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x = x + 2</code>, you can
                    use the compound assignment <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x += 2</code>.
                    Incrementing by <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">1</code> is required even
                    more often, so there's another shortcut, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x++</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                复合赋值运算符是使用赋值运算符与另一个运算符结合使用的快捷方式。你不必写 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x = x + 2</code>
                                ，可以直接使用复合赋值 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x += 2</code>
                                。由于增加 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">1</code>
                                的需求更为频繁，因此还有一个快捷方式 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x++</code> ：
                            </font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0001"><code>int x = 1;</code>
<code>int x += 2; // shortcut for int x = x + 2;</code>
<code>x++; // shortcut for x = x + 1;</code></pre>
                <p id="c05-para-0013" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Shortcuts can be used with all the other compound assignment
                    operators. A new compound assignment operator has been available since C# 8: the null-coalescing
                    compound assignment operator. This operator is discussed later in this chapter.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">快捷方式可以与所有其他复合赋值运算符一起使用。自 C# 8
                                以来，一个新的复合赋值运算符已经可用：空合并复合赋值运算符。这个运算符将在本章后面讨论。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0014" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">You may be wondering why there are two examples for the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">++</code> increment
                    operator. Placing the operator <i
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">before</i> the expression
                    is known as a <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">prefix</i>;
                    placing the operator <i
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">after</i> the expression
                    is known as a <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">postfix</i>.
                    Note that there is a difference in the way they behave.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">您可能想知道为什么 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">++</code>
                                增量运算符有两个示例。将运算符放在表达式之前称为前缀；将运算符放在表达式之后称为后缀。请注意它们的行为方式有所不同。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The increment and decrement operators can act both as entire
                    expressions and within expressions. When used by themselves, the effect of both the prefix and
                    postfix versions is identical and corresponds to the statement <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x = x + 1</code>. When
                    used within larger expressions, the prefix operator increments the value of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code> <i
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">before</i> the expression
                    is evaluated; in other words, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code> is incremented,
                    and the new value is used as the result of the expression. Conversely, the postfix operator
                    increments the value of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code> <i
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">after</i> the expression
                    is evaluated. The result of the expression returns the original value of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code>. The following
                    example uses the increment operator (<code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">++</code>) as an example
                    to demonstrate the difference between the prefix and postfix behavior (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                自增和自减运算符既可以作为整个表达式使用，也可以在表达式中使用。当单独使用时，前缀和后缀版本的效果相同，相当于语句 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x = x + 1</code>
                                。当用在更大的表达式中时，前缀运算符在表达式计算前增加 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code>
                                的值；换句话说， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code>
                                被增加，新的值用作表达式的结果。相反，后缀运算符在表达式计算后增加 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code>
                                的值。表达式的结果返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code>
                                的原始值。以下示例使用自增运算符（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">++</code>
                                ）来演示前缀和后缀行为之间的区别（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0002"><code>void PrefixAndPostfix()</code>
<code>{</code>
<code>  int x = 5;</code>
<code>  if (++x == 6) // true – x is incremented to 6 before the evaluation</code>
<code>  {</code>
<code>    Console.WriteLine("This will execute");</code>
<code>  }</code>
<code>  if (x++ == 6) // true – x is incremented to 7 after the evaluation</code>
<code>  {</code>
<code>    Console.WriteLine("The value of x is: {x}"); // x has the value 7</code>
<code>  }</code>
<code>}</code></pre>
                <p id="c05-para-0016" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The following sections look at some of the commonly used and
                    new operators that you will frequently use within your C# code.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">接下来的章节将介绍您在 C#代码中经常使用的一些常用和新操作符。
                            </font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0007"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-122" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The Conditional-Expression Operator (?:) <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">条件运算符 (?:)</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The conditional-expression operator (<code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">?:</code>), also known as
                    the <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ternary operator</i>,
                    is a shorthand form of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">if…else</code>
                    construction. It gets its name from the fact that it involves three operands. It allows you to
                    evaluate a condition, returning one value if that condition is true or another value if it is false.
                    The syntax is as follows:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">条件表达式运算符（ <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">?:</code>
                                ），也称为三元运算符，是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">if…else</code>
                                结构的简写形式。它得名于它涉及三个操作数。它允许你评估一个条件，如果条件为真则返回一个值，如果条件为假则返回另一个值。其语法如下：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0003"><code>condition ? true_value: false_value</code></pre>
                <p id="c05-para-0018" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Here, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">condition</code> is the
                    Boolean expression to be evaluated, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code>
                    _
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">value</code> is the
                    value that is returned if <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">condition</code> is true,
                    and <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>
                    _
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">value</code> is the
                    value that is returned otherwise.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这里， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">condition</code>
                                是要评估的布尔表达式， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code> _
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">value</code>
                                是当 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">condition</code>
                                为真时返回的值，而 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>
                                _ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">value</code>
                                是否则返回的值。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">When used sparingly, the conditional-expression operator can
                    add a dash of terseness to your programs. It is especially handy for providing one of a couple of
                    arguments to a function that is being invoked. You can use it <span aria-label="122"
                        epub:type="pagebreak" id="Page_122" role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>to quickly convert
                    a Boolean value to a string value of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code> or <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>. It is also
                    handy for displaying the correct singular or plural form of a word (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                当谨慎使用时，条件表达式运算符可以为你的程序增添简洁性。它特别适用于向被调用的函数提供其中一个参数。你可以用它快速将布尔值转换为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code> 或
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>
                                的字符串值。它也便于显示单词的正确单数或复数形式（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0004"><code>int x = 1;</code>
<code>string s = x + " ";</code>
<code>s += (x == 1 ? "man": "men");</code>
<code>Console.WriteLine(s);</code></pre>
                <p id="c05-para-0020" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">This code displays <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">1 man</code> if <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code> is equal to one
                    but displays the correct plural form for any other number. Note, however, that if your output needs
                    to be localized to different languages, you have to write more sophisticated routines to take into
                    account the different grammatical rules of different languages. Read <a href="c22.xhtml"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 22</a>,
                    “Localization,” for globalizing and localizing .NET applications.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这段代码在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code>
                                等于一时显示 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">1 man</code>
                                ，但在任何其他数字时显示正确的复数形式。然而，请注意，如果你的输出需要本地化为不同语言，你必须编写更复杂的例程来考虑不同语言的语法规则。阅读第 22
                                章，“本地化”，了解如何全球化化和本地化 .NET 应用程序。</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0008"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-123" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The checked and unchecked Operators <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">checked 和 unchecked 运算符</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Consider the following code:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">考虑以下代码：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0005"><code>byte b = byte.MaxValue;</code>
<code>b++;</code>
<code>Console.WriteLine(b);</code></pre>
                <p id="c05-para-0022" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code> data type can
                    hold values only in the range 0 to 255. Assigning <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte.MaxValue</code> to a
                    byte results in 255. With 255, all bits of the 8 available bits in the byte are set: 11111111.
                    Incrementing this value by one causes an overflow and results in 0.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>
                                数据类型只能存储 0 到 255 范围内的值。将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte.MaxValue</code>
                                赋值给字节会导致结果为 255。对于 255，字节中所有可用的 8 位都会被置位：11111111。将此值加一会导致溢出，结果为 0。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">To get exceptions in such cases, C# provides the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code> and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">unchecked</code>
                    operators. If you mark a block of code as <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>, the CLR
                    enforces overflow checking, throwing an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OverflowException</code>
                    if an overflow occurs. The following changes the preceding code to include the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code> operator
                    (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要在这种情况下获取异常，C# 提供了 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">unchecked</code>
                                运算符。如果你将代码块标记为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                ，CLR 会强制执行溢出检查，如果发生溢出则抛出 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OverflowException</code>
                                异常。以下代码将前面的代码修改为包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                运算符（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0006"><code>byte b = 255;</code>
<code>checked</code>
<code>{</code>
<code>  b++;</code>
<code>}</code>
<code>Console.WriteLine(b);</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Instead of writing a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code> block, you
                    also can use the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code> keyword in
                    an expression:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">除了编写 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                块，你也可以在表达式中使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                关键字：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0007"><code>b = checked(b + 3);</code></pre>
                <p id="c05-para-0025" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">When you try to run this code, the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OverflowException</code>
                    is thrown.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当你尝试运行这段代码时，会抛出 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OverflowException</code>
                                异常。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">You can enforce overflow checking for all unmarked code by
                    adding the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CheckForOverflowUnderflow</code>
                    setting in the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">csproj</code> file:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">您可以通过在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">csproj</code>
                                文件中添加 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CheckForOverflowUnderflow</code>
                                设置来对所有未标记的代码强制执行溢出检查：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0008"><code>&lt;PropertyGroup&gt;</code>
<code>  &lt;OutputType&gt;Exe&lt;/OutputType&gt;</code>
<code>  &lt;TargetFramework&gt;net5.0&lt;/TargetFramework&gt;</code>
<code>  &lt;Nullable&gt;enable&lt;/Nullable&gt;</code>
<code>  <b>&lt;CheckForOverflowUnderflow&gt;true&lt;/CheckForOverflowUnderflow&gt;</b></code>
<code>&lt;/PropertyGroup&gt;</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">With a project setting to be configured for overflow
                    checking, you can mark code that should not be checked using the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">unchecked</code>
                    operator.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在项目设置中配置溢出检查时，您可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">unchecked</code>
                                运算符标记不应进行检查的代码。</font>
                        </font>
                    </font><span aria-label="123" epub:type="pagebreak" id="Page_123" role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span></p>
                <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <p id="c05-para-0028" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">By default,
                                overflow and underflow are not checked because enforcing checks has a performance
                                impact. When you use checked as the default setting with your project, the result of
                                every arithmetic operation needs to be verified regardless of whether the value is out
                                of bounds. </i><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">i++</code><i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> is an arithmetic
                                operation that's used a lot with </i><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">for</code><i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> loops. To avoid
                                having this performance impact, it's better to keep the default setting (Check for
                                Arithmetic Overflow/Underflow) unchecked and use the </i><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code><i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> operator where
                                needed.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意
                                        默认情况下，不会检查溢出和下溢，因为强制执行检查会影响性能。当您将 checked 作为项目的默认设置时，无论值是否超出范围，都需要验证每个算术操作的结果。
                                        <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">i++</code>
                                        是一种大量用于 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">for</code>
                                        循环的算术操作。为了避免这种性能影响，最好保持默认设置（检查算术溢出/下溢）未选中，并在需要时使用 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                        运算符。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0010"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-124" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The is and as Operators <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">is 和 as 运算符</font>
                        </font>
                    </font>
                </h3>
                <p id="c05-para-0029" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">You can use the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code> and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">as</code> operators to
                    determine whether an object is compatible with a specific type. This is useful with class
                    hierarchies.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">您可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">as</code>
                                运算符来确定对象是否与特定类型兼容。这在类层次结构中很有用。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Let's assume a simple class hierarchy. The class <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DerivedClass</code>
                    derives from the class <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BaseClass</code>. You can
                    assign a variable of type <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DerivedClass</code> to a
                    variable of type <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BaseClass</code>
                    ; all the members of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BaseClass</code> are
                    available with the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DerivedClass</code>. In
                    the following example, an implicit conversion is taking place:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">假设一个简单的类层次结构。类 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DerivedClass</code>
                                继承自类 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BaseClass</code>
                                。您可以将类型为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DerivedClass</code>
                                的变量的值赋给类型为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BaseClass</code>
                                的变量； <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BaseClass</code>
                                的所有成员都可以通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DerivedClass</code>
                                访问。在以下示例中，正在进行隐式转换：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0009"><code>BaseClass = new();</code>
<code>DerivedClass = new();</code>
<code>baseClass = derivedClass; </code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">If you have a parameter of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BaseClass</code> and want
                    to assign it to a variable of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DerivedClass</code>,
                    implicit conversion is not possible. To the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">SomeAction</code> method,
                    an instance of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BaseClass</code> or any
                    type that derives from this class can be passed. This will not necessarily succeed. Here, you can
                    use the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">as</code>
                    operator. The <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">as</code>
                    operator either returns a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DerivedClass</code>
                    instance (if the variable is of this type) or returns <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">如果你有一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BaseClass</code>
                                类型的参数，并想将其赋值给一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DerivedClass</code>
                                类型的变量，则无法进行隐式转换。对于 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">SomeAction</code>
                                方法，可以传递 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BaseClass</code>
                                类型的实例或任何从此类派生的类型。但这不一定成功。在这里，你可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">as</code>
                                运算符。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">as</code>
                                运算符要么返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DerivedClass</code>
                                类型的实例（如果变量是此类型），要么返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code> 。
                            </font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0010"><code>public void SomeAction(BaseClass baseClass)</code>
<code>{</code>
<code>  DerivedClass? derivedClass = baseClass <b>as</b> DerivedClass;</code>
<code>  if (derivedClass != null)</code>
<code>  {</code>
<code>    // use the derivedClass variable</code>
<code>  } </code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Instead of using the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">as</code> operator, you
                    can use the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code>
                    operator. The <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code>
                    operator returns <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code> if the
                    conversion succeeds; otherwise, it returns <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>. With the
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code> operator, a
                    variable can be specified that is assigned if the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code> operator
                    returns true:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">不用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">as</code>
                                运算符，你可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code>
                                运算符。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code>
                                运算符在转换成功时返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code>
                                ，否则返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>
                                。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code>
                                运算符时，可以指定一个变量，如果 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code>
                                运算符返回 true，则分配给该变量：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0011"><code>public void SomeAction(BaseClass baseClass)</code>
<code>{</code>
<code>  if (baseClass <b>is</b> DerivedClass derivedClass)</code>
<code>  {</code>
<code>    // use the derivedClass variable</code>
<code>  }</code>
<code>}</code></pre>
                <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <p id="c05-para-0034" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><a
                                    href="c02.xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 2</a>
                                covers pattern matching with the </i> <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> operator using
                                const, type, and relational patterns.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意：第 2 章介绍了使用
                                        const、类型和关系模式通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">is</code>
                                        运算符进行模式匹配。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section> <span aria-label="124" epub:type="pagebreak" id="Page_124" role="doc-pagebreak"
                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0012"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-125" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The sizeof Operator <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">sizeof 运算符</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">You can determine the size (in bytes) required on the stack
                    by a value type using the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code> operator
                    (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你可以通过使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code>
                                运算符（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>
                                ）来确定值类型在栈上所需的字节数：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0012"><code>Console.WriteLine(sizeof(int));</code></pre>
                <p id="c05-para-0036" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">This displays the number <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">4</code> because an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> is 4 bytes
                    long.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这显示了数字 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">4</code>
                                ，因为一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> 是
                                4 个字节长。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">You can also use the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code> operator
                    with structs if the struct contains only value types—for example, the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Point</code> class as
                    shown here (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Point.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你也可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code>
                                运算符与结构体，如果结构体只包含值类型——例如，这里显示的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Point</code>
                                类（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Point.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0013"><code>public readonly struct Point</code>
<code>{</code>
<code>  public Point(int x, int y) =&gt; (X, Y) = (x, y);</code>
<code> </code>
<code>  public int X { get; }</code>
<code>  public int Y { get; }</code>
<code>}</code></pre>
                <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <p id="c05-para-0039" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">You cannot use
                            </i> <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> with
                                classes.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意 你不能用 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code>
                                        运算符与类一起使用。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">When you use <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code> with custom
                    types, you need to write the code within an unsafe code block (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当你在自定义类型中使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code>
                                时，你需要在 unsafe 代码块（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>
                                ）中编写代码：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0014"><code>unsafe</code>
<code>{</code>
<code>  Console.WriteLine(sizeof(Point));</code>
<code>}</code>
<code> </code></pre>
                <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <p id="c05-para-0042" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">By default,
                                unsafe code is not allowed. You need to specify the </i> <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">AllowUnsafeBlocks</code>
                            <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> in the </i> <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">csproj</code> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> project file. <a
                                    href="c13.xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter
                                    13</a> looks at unsafe code in more detail.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意 默认情况下不允许不安全代码。您需要在
                                        <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">csproj</code>
                                        项目文件中指定 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">AllowUnsafeBlocks</code>
                                        。第 13 章将更详细地探讨不安全代码。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0015"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-126" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The typeof Operator <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">typeof 运算符</font>
                        </font>
                    </font>
                </h3>
                <p id="c05-para-0043" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">typeof</code> operator
                    returns a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Type</code> object
                    representing a specified type. For example, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">typeof(string)</code>
                    returns a <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Type</code>
                    object representing the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.String</code>
                    type. This is useful when you want to use reflection to find information about an object
                    dynamically. For more information, see <a href="c12.xhtml"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 12</a>,
                    “Reflection, Metadata, and Source Generators.”<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">typeof 运算符返回一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Type</code>
                                对象，该对象表示指定的类型。例如， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">typeof(string)</code>
                                返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Type</code>
                                对象，表示 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.String</code>
                                类型。当你想使用反射动态地获取对象信息时，这很有用。有关更多信息，请参阅第 12 章，“反射、元数据和源生成器。”</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0016"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-127" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The nameof Expression <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">nameof 表达式</font>
                        </font>
                    </font>
                </h3>
                <p id="c05-para-0044" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code> operator is
                    of practical use when strings are needed as parameters that are already known at compile time. This
                    operator accepts a symbol, property, or method and returns the name.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当需要将已在编译时已知的字符串作为参数时， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code>
                                运算符很有用。该运算符接受一个符号、属性或方法，并返回其名称。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">One use example is when the name of a variable is needed, as
                    in checking a parameter for null, as shown here:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">一个使用示例是在需要变量名时，例如检查参数是否为
                                null，如下所示：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0015"><code>public void Method(object o)</code>
<code>{</code>
<code>  if (o == null) throw new ArgumentNullException<b>(nameof(o)</b>); </code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1"><span aria-label="125" epub:type="pagebreak" id="Page_125"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>Of course, it
                    would be similar to throw the exception by passing a string instead of using the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code> operator.
                    However, using <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code> prevents
                    you from misspelling the parameter name when you pass it to the exception's constructor. Also, when
                    you change the name of the parameter, you can easily miss changing the string passed to the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ArgumentNullException</code>
                    constructor. Refactoring features also help changing all occurrences where <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code> is used:
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当然，通过传递字符串而不是使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code>
                                运算符来抛出异常也是类似的。但是，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code>
                                可以防止你在将参数传递给异常的构造函数时拼写错误参数名。此外，当你更改参数名时，可能会轻易忘记更改传递给 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ArgumentNullException</code>
                                构造函数的字符串。重构功能还可以帮助你更改所有使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code>
                                的地方：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0016"><code>if (o == null) throw new ArgumentNullException("o");</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Using the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code> operator
                    for the name of a variable is just one use case. You can also use it to get the name of a
                    property—for example, for firing a change event (using the interface <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">INotifyPropertyChanged</code>)
                    in a property <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">set</code> accessor and
                    passing the name of a property.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code>
                                运算符来获取变量的名称只是一个用例。你也可以用它来获取属性的名称——例如，在属性 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">set</code>
                                的访问器中触发一个变更事件（使用接口 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">INotifyPropertyChanged</code>
                                ）并传递属性的名称。</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0017"><code>public string FirstName</code>
<code>{</code>
<code>  get =&gt; _firstName;</code>
<code>  set</code>
<code>  {</code>
<code>    _firstName = value;</code>
<code>    OnPropertyChanged(<b>nameof(FirstName)</b>);</code>
<code>  }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code> operator
                    can also be used to get the name of a method. This also works if the method is overloaded because
                    all overloads result in the same value: the name of the method.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">nameof</code>
                                运算符也可以用来获取方法的名称。如果方法是重载的，这也同样适用，因为所有重载都会产生相同的结果：方法的名称。</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0018"><code>public void Method()</code>
<code>{</code>
<code>  Log($"{<b>nameof(Method)</b>} called");</code></pre>
            </section>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0017"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-128" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The Indexer <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">索引器</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">You use the indexer (brackets) for accessing arrays in <a
                        href="c06.xhtml" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter
                        6</a>. In the following code snippet, the indexer is used to access the third element of the
                    array named <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">arr1</code>
                    by passing the number 2:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你在第 6
                                章中使用索引器（括号）来访问数组。在以下代码片段中，通过传递数字 2，使用索引器来访问名为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">arr1</code>
                                的数组的第三个元素：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0019"><code>int[] arr1 = {1, 2, 3, 4};</code>
<code>int x = <b>arr1[2];</b> // x == 3 </code></pre>
                <p id="c05-para-0050" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Similarly to accessing elements of an array, the indexer is
                    implemented with collection classes (discussed in <a href="c08.xhtml"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 8</a>,
                    “Collections”).<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">类似于访问数组元素，索引器通过集合类实现（在第 8
                                章“集合”中讨论）。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The indexer doesn't require an integer within the brackets.
                    Indexers can be defined with any type. The following code snippet creates a generic dictionary where
                    the key is a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">string</code> and the
                    value an <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>.
                    With dictionaries, the key can be used with the indexer. In the following sample, the string <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">first</code> is passed to
                    the indexer to set this element in the dictionary, and then the same string is passed to the indexer
                    to retrieve this element:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                索引器不需要在括号内使用整数。索引器可以用任何类型定义。以下代码片段创建了一个泛型字典，其中键是 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">string</code>
                                ，值是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                。对于字典，可以使用键与索引器一起使用。在以下示例中，将字符串 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">first</code>
                                传递给索引器来设置字典中的这个元素，然后再次将相同的字符串传递给索引器来检索这个元素：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0020"><code>Dictionary&lt;string, int&gt; dict = new();</code>
<code>dict["first"] = 1;</code>
<code>int x = dict["first"];</code></pre>
                <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <p id="c05-para-0053" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Later in this
                                chapter in the “Implementing Custom Indexers” section, you can read how to create index
                                operators in your own classes.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">
                                        注意：在本章的“实现自定义索引器”部分，你可以阅读如何在自己的类中创建索引运算符。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0019"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-129" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The Null-Coalescing and Null-Coalescing Assignment Operators
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">空合并运算符和空合并赋值运算符</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The null-coalescing operator (<code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">??</code>) provides a
                    shorthand mechanism to cater to the possibility of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code> values when
                    working with nullable and reference types. The operator is placed between two operands—the first
                    operand must be a nullable type or reference type, and the second operand must be of the same type
                    as the first <span aria-label="126" epub:type="pagebreak" id="Page_126" role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>or of a type that
                    is implicitly convertible to the type of the first operand. The null-coalescing operator evaluates
                    as follows:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">空合并运算符（ <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">??</code>
                                ）提供了一种简短的机制，用于在处理可空类型和引用类型时考虑 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                值的可能性。该运算符位于两个操作数之间——第一个操作数必须是可空类型或引用类型，第二个操作数必须与第一个操作数相同类型，或者是可隐式转换为第一个操作数类型的类型。空合并运算符的求值方式如下：
                            </font>
                        </font>
                    </font>
                </p>
                <ul class="check" id="c05-list-0003"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <li id="c05-li-0013" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">If the first operand is not <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>, then the
                        overall expression has the value of the first operand.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">如果第一个操作数不是 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                    ，则整个表达式的值等于第一个操作数。</font>
                            </font>
                        </font>
                    </li>
                    <li id="c05-li-0014" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">If the first operand is <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>, then the
                        overall expression has the value of the second operand.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">如果第一个操作数是 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                    ，则整个表达式的值等于第二个操作数。</font>
                            </font>
                        </font>
                    </li>
                </ul>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Here's an example:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这里有一个例子：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0021"><code>int? a = null;</code>
<code>int b;</code>
<code>b = a ?? 10; // b has the value 10</code>
<code>a = 3;</code>
<code>b = a ?? 10; // b has the value 3</code></pre>
                <p id="c05-para-0056" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">If the second operand cannot be implicitly converted to the
                    type of the first operand, a compile-time error is generated.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                如果第二个操作数不能隐式转换为第一个操作数的类型，则会生成编译时错误。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The null-coalescing operator is not only important with
                    nullable types but also with reference types. In the following code snippet, the property <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Val</code> returns the
                    value of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_val</code> variable only
                    if it is not null. In case it is null, a new instance of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyClass</code> is
                    created, assigned to the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_val</code> variable, and
                    finally returned from the property. This second part of the expression within the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code> accessor only
                    happens when the variable <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_val</code> is null:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                空合并运算符不仅对可空类型重要，对引用类型也同样重要。在以下代码片段中，属性 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Val</code> 仅在
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_val</code>
                                变量不为 null 时返回其值。如果为 null，则创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyClass</code>
                                的新实例，赋值给 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_val</code>
                                变量，并最终从属性中返回。在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code>
                                访问器的表达式中的第二部分，仅当变量 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_val</code> 为
                                null 时才会发生：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0022"><code>private MyClass _val;</code>
<code>public MyClass Val</code>
<code>{</code>
<code>  get =&gt; _val <b>??</b> (_val = new MyClass());</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Using the null-coalescing assignment operator, the preceding
                    code can now be simplified to create a new <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyClass</code> and assign
                    it to <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_val</code> if
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_val</code> is <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用空合并赋值运算符，前面的代码现在可以简化为：如果 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_val</code> 是
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                ，则创建一个新的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyClass</code>
                                并将其赋值给 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_val</code>
                            </font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0023"><code>private MyClass _val;</code>
<code>public MyClass Val</code>
<code>{</code>
<code>  get =&gt; _val <b>??=</b> new MyClass();</code>
<code>}</code></pre>
            </section>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0020"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-130" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The Null-Conditional Operator <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">空条件运算符</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The <i
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null-conditional
                        operator</i>, is a feature of C# that reduces the number of code lines. A great number of code
                    lines in production code verify null conditions. Before accessing members of a variable that is
                    passed as a method parameter, the variable needs to be checked to determine whether it has a value
                    of null. Otherwise, a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NullReferenceException</code>
                    would be thrown. A .NET design guideline specifies that code should never throw exceptions of these
                    types and should always check for null conditions. However, such checks could be missed easily. This
                    code snippet verifies whether the passed parameter <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">p</code> is not null. In
                    case it is null, the method just returns without continuing:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">空条件运算符是
                                C#的一项功能，可以减少代码行数。在产品代码中，有很多代码行用于验证空条件。在访问作为方法参数传递的变量的成员之前，需要检查该变量是否为 null 值。否则，会抛出 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NullReferenceException</code>
                                异常。.NET 设计指南规定，代码不应抛出此类异常，并应始终检查空条件。然而，这些检查很容易被遗漏。这段代码片段验证传递的参数 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">p</code> 是否不为
                                null。如果为 null，该方法将直接返回而不继续：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0024"><code>public void ShowPerson(Person? p)</code>
<code>{</code>
<code>  if (p is null) return;</code>
<code>  string firstName = p.FirstName;</code>
<code>  //…</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1"><span aria-label="127" epub:type="pagebreak" id="Page_127"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>Using the
                    null-conditional operator to access the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">FirstName</code> property
                    (<code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">p?.FirstName</code>),
                    when <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">p</code> is <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>, only <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code> is returned
                    without continuing to the right side of the expression (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用空条件运算符来访问 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">FirstName</code>
                                属性 ( <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">p?.FirstName</code>
                                )，当 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">p</code> 为
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                时，仅返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                而不继续到表达式的右侧（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorsSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0025"><code>public void ShowPerson(Person? p)</code>
<code>{</code>
<code>  string firstName = p?.FirstName;</code>
<code>  //…</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">When a property of an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> type is
                    accessed using the null-conditional operator, the result cannot be directly assigned to an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> type because
                    the result can be <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>. One option
                    to resolve this is to assign the result to a nullable <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当使用空条件运算符访问 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                类型的属性时，结果不能直接赋值给 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                类型，因为结果可能是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                。解决这个问题的一种方法是将结果赋值给可空的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> ：
                            </font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0026"><code>int? age = p?.Age;</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Of course, you can also solve this issue by using the
                    null-coalescing operator and defining another result (for example, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">0</code>) in case the
                    result of the left side is <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当然，你也可以通过使用空合并运算符，并在左侧结果为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                的情况下定义另一个结果（例如， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">0</code>
                                ）来解决这个问题：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0027"><code>int age1 = p?.Age ?? 0;</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">You also can combine multiple null-conditional operators. In
                    the following example, the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Address</code> property
                    of a <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                    object is accessed, and this property in turn defines a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">City</code> property.
                    Null checks need to be done for the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code> object and,
                    if it is not null, also for the result of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Address</code> property:
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你还可以组合多个空条件运算符。在以下示例中，访问了 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                                对象的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Address</code>
                                属性，该属性又定义了一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">City</code>
                                属性。需要对 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                                对象进行空检查，如果它不是空，还需要对 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Address</code>
                                属性的结果进行空检查：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0028"><code>Person p = GetPerson();</code>
<code>string city = null;</code>
<code>if (p != null &amp;&amp; p.HomeAddress != null)</code>
<code>{</code>
<code>  city = p.HomeAddress.City;</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">When you use the null-conditional operator, the code becomes
                    much simpler:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当你使用空条件运算符时，代码会变得简单得多：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0029"><code>string city = p?.HomeAddress?.City;</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">You can also use the null-conditional operator with arrays.
                    With the following code snippet, a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NullReferenceException</code>
                    is thrown using the index operator to access an element of an array variable that is <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                你也可以使用空条件运算符来处理数组。通过以下代码片段，使用索引运算符访问数组变量的元素时，会抛出 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NullReferenceException</code>
                                异常：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0030"><code>int[] arr = null;</code>
<code>int x1 = arr[0];</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Of course, traditional null checks could be done to avoid
                    this exceptional condition. A simpler version uses <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">?[0]</code> to access the
                    first element of the array. In case the result is <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>, the
                    null-coalescing operator returns the value 0 for the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x1</code> variable:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当然，可以通过传统的空值检查来避免这种异常情况。一个更简单的版本使用
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">?[0]</code>
                                来访问数组的第一个元素。如果结果是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                ，空合并运算符会为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x1</code>
                                变量返回值 0：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0031"><code>int x1 = arr?[0] ?? 0;</code></pre>
            </section>
        </section>
        <section aria-labelledby="head-2-43" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
            <span id="c05-sec-0021" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <h2 id="head-2-43" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">USING BINARY OPERATORS<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用二元运算符</font>
                    </font>
                </font>
            </h2>
            <p id="c05-para-0067" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">Working with binary values historically has been an important
                concept to understand when learning programming because the computer works with 0s and 1s. Many people
                who are newer to programming may have missed learning this because they start to learn programming with
                Blocks, Scratch, Python, and possibly JavaScript. If you are already fluent with 0s and 1s, this section
                might still help you as a refresher.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在编程学习的历史中，处理二进制值一直是一个重要的概念，因为计算机使用 0 和
                            1。对于一些初学者来说，他们可能错过了这个学习环节，因为他们从积木、Scratch、Python 或 JavaScript 开始学习编程。如果你已经熟练掌握 0 和
                            1，这一部分仍然可以作为复习帮助你。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">First, let's start with simple calculations using binary
                operators. The method <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">SimpleCalculations</code>
                first declares and initializes the variables <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">binary1</code> and <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">binary2</code> with binary
                values—using the binary literal and <span aria-label="128" epub:type="pagebreak" id="Page_128"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>digit separators.
                Using the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&amp;</code>
                operator, the two values are combined with the binary <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">AND</code> operator and
                written to the variable <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">binaryAnd</code>. In the
                following code, the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">|</code> operator is used to
                create the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">binaryOr</code>
                variable, the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">^</code>
                operator for the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">binaryXOR</code> variable,
                and the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">~</code> operator
                for the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">reverse1</code>
                variable (code file <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BinaryCalculations/Program.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">首先，让我们从使用二进制运算符进行简单计算开始。方法 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">SimpleCalculations</code>
                            首先声明并初始化变量 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">binary1</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">binary2</code>
                            ，使用二进制字面量和数字分隔符。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&amp;</code>
                            运算符，将两个值通过二进制 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">AND</code>
                            运算符组合，并写入变量 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">binaryAnd</code>
                            。在以下代码中，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">|</code> 运算符创建变量
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">binaryOr</code>
                            ，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">^</code> 运算符创建变量
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">binaryXOR</code>
                            ，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">~</code> 运算符创建变量
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">reverse1</code>
                            （代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BinaryCalculations/Program.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0032"><code>void SimpleCalculations()</code>
<code>{</code>
<code>  Console.WriteLine(nameof(SimpleCalculations));</code>
<code>  uint binary1 = 0b1111_0000_1100_0011_1110_0001_0001_1000;</code>
<code>  uint binary2 = 0b0000_1111_1100_0011_0101_1010_1110_0111;</code>
<code>  uint binaryAnd = binary1 &amp; binary2;</code>
<code>  DisplayBits("AND", binaryAnd, binary1, binary2);</code>
<code>  uint binaryOR = binary1 | binary2;</code>
<code>  DisplayBits("OR", binaryOR, binary1, binary2);</code>
<code>  uint binaryXOR = binary1 ^ binary2;</code>
<code>  DisplayBits("XOR", binaryXOR, binary1, binary2);</code>
<code>  uint reverse1 = ~binary1;</code>
<code>  DisplayBits("NOT", reverse1, binary1);</code>
<code>  Console.WriteLine();</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">To display <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> and <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> variables in a
                binary form, the extension method <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ToBinaryString</code> is
                created. <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Convert.ToString</code>
                offers an overload with two <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> parameters, where
                the second <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> value
                is the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">toBase</code>
                parameter. Using this, you can format the output string binary by passing the value 2 (for binary), 8
                (for octal), 10 (for decimal), and 16 (for hexadecimal). By default, if a binary value starts with 0
                values, these values are ignored and not printed. The <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">PadLeft</code> method fills
                up these 0 values in the string. The number of string characters needed is calculated by the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code> operator and a
                left shift of four bits. The <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code> operator
                returns the number of bytes for the specified type, as discussed earlier in this chapter. For displaying
                the bits, the number of bytes needs to be multiplied by 8, which is the same as shifting three bits to
                the left. Another extension method is <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">AddSeparators</code>, which
                adds <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_</code> separators
                after every four digits using LINQ methods (code file <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BinaryCalculations/BinaryExtensions.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要以二进制形式显示 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                            变量，创建了扩展方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ToBinaryString</code>
                            。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Convert.ToString</code>
                            提供了一个带有两个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                            参数的重载，其中第二个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> 值是
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">toBase</code>
                            参数。使用这个方法，你可以通过传递值 2（用于二进制）、8（用于八进制）、10（用于十进制）和 16（用于十六进制）来格式化输出字符串的二进制形式。默认情况下，如果二进制值以 0
                            开头，这些 0 值会被忽略且不会打印。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">PadLeft</code>
                            方法会在字符串中填充这些 0 值。所需字符串字符的数量由 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code>
                            运算符和向左移四位计算得出。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">sizeof</code>
                            运算符返回指定类型的字节数，如本章前面所述。为了显示位，需要将字节数乘以 8，这相当于向左移三位。另一个扩展方法是 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">AddSeparators</code>
                            ，它使用 LINQ 方法在每四个数字后添加 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_</code> 分隔符（代码文件
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BinaryCalculations/BinaryExtensions.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0033"><code>public static class BinaryExtensions</code>
<code>{</code>
<code>  public static string ToBinaryString(this uint number) =&gt;  </code>
<code>    <b>Convert.ToString(number, toBase: 2).PadLeft(sizeof(uint) &lt;&lt; 3, '0');</b></code>
<code> </code>
<code>  public static string ToBinaryString(this int number) =&gt; </code>
<code>    Convert.ToString(number, toBase: 2).PadLeft(sizeof(int) &lt;&lt; 3, '0');</code>
<code> </code>
<code>  public static string AddSeparators(this string number) =&gt;</code>
<code>    string.Join('_',</code>
<code>      Enumerable.Range(0, number.Length / 4)</code>
<code>        .Select(i =&gt; number.Substring(i * 4, 4)).ToArray());</code>
<code>}</code></pre>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <p id="c05-para-0071" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">The </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">AddSeparators</code>
                        <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> method makes use of
                            LINQ. LINQ is discussed in detail in <a href="c09.xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 9</a>,
                            “Language Integrated Query.”</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">AddSeparators</code>
                                    方法使用了 LINQ。LINQ 在第 9 章“语言集成查询”中有详细讨论。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1"><span aria-label="129" epub:type="pagebreak" id="Page_129"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>The method <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DisplayBits</code>, which is
                invoked from the previously shown <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">SimpleCalculations</code>
                method, makes use of the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ToBinaryString</code> and
                <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">AddSeparators</code>
                extension methods. Here, the operands used for the operation are displayed, as well as the result (code
                file <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BinaryCalculations/Program.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">从之前展示的 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">SimpleCalculations</code>
                            方法中调用的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DisplayBits</code>
                            方法，使用了 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ToBinaryString</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">AddSeparators</code>
                            扩展方法。这里显示了用于操作的操作数以及结果（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BinaryCalculations/Program.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0034"><code>void DisplayBits(string title, uint result, uint left, </code>
<code>  uint? right = null)</code>
<code>{</code>
<code>  Console.WriteLine(title);</code>
<code>  Console.WriteLine(left.ToBinaryString().AddSeparators());</code>
<code>  if (right.HasValue)</code>
<code>  {</code>
<code>    Console.WriteLine(right.Value.ToBinaryString().AddSeparators());</code>
<code>  }</code>
<code>  Console.WriteLine(result.ToBinaryString().AddSeparators());</code>
<code>  Console.WriteLine();</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">When you run the application, you can see the following output
                using the binary <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&amp;</code> operator. With
                this operator, the resulting bits are only 1 when both input values are also 1:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">当你运行应用程序时，可以使用二进制 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&amp;</code>
                            运算符看到以下输出。使用这个运算符，只有当两个输入值也都是 1 时，结果位才为 1：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0035"><code>AND</code>
<code>1111_0000_1100_0011_1110_0001_0001_1000</code>
<code>0000_1111_1100_0011_0101_1010_1110_0111</code>
<code>0000_0000_1100_0011_0100_0000_0000_0000</code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">When you apply the binary | operator, the result bit is set (1)
                if one of the input bits is set:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">当你应用二进制 |
                            运算符时，如果其中一个输入位被设置，结果位会被置为（1）：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0036"><code>OR</code>
<code>1111_0000_1100_0011_1110_0001_0001_1000</code>
<code>0000_1111_1100_0011_0101_1010_1110_0111</code>
<code>1111_1111_1100_0011_1111_1011_1111_1111</code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">With the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">^</code> operator, the result
                is set if just one of the original bits is set, but not both:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">^</code>
                            运算符时，如果原始位中只有一个被设置，但不是两个都设置，结果位会被置为：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0037"><code>XOR</code>
<code>1111_0000_1100_0011_1110_0001_0001_1000</code>
<code>0000_1111_1100_0011_0101_1010_1110_0111</code>
<code>1111_1111_0000_0000_1011_1011_1111_1111</code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">And finally, with the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">~</code> operator, the result
                is the negation of the original:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">最后，使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">~</code>
                            运算符时，结果是原始位的取反：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0038"><code>NOT</code>
<code>1111_0000_1100_0011_1110_0001_0001_1000</code>
<code>0000_1111_0011_1100_0001_1110_1110_0111</code></pre>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <p id="c05-para-0078" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">For working with
                            binary values, read about using the </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BitArray</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> class in <a
                                href="c06.xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter
                                6</a>.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 对于处理二进制值，请阅读第 6 章中关于使用
                                    <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BitArray</code>
                                    类的内容。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0024"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-131" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Shifting Bits <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">移位操作</font>
                        </font>
                    </font>
                </h3>
                <p id="c05-para-0079" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">As you've already seen in the previous sample, shifting three
                    bits to the left is a multiplication by 8. A shift by one bit is a multiplication by 2. This is a
                    lot faster than invoking the multiply operator—in case you need to multiply by 2, 4, 8, 16, 32, and
                    so on.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">如前一个示例所示，向左移动三位相当于乘以 8。移动一位相当于乘以
                                2。这比调用乘法运算符要快得多——如果你需要乘以 2、4、8、16、32 等。 </font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1"><span aria-label="130" epub:type="pagebreak" id="Page_130"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>The following code
                    snippet sets one bit in the variable <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">s1</code>, and in the
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">for</code> loop the bit
                    always shifts by one bit (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BinaryCalculations/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">以下代码片段在变量 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">s1</code>
                                中设置一位，并且在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">for</code>
                                循环中该位始终移动一位（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BinaryCalculations/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0039"><code>void ShiftingBits()</code>
<code>{</code>
<code>  Console.WriteLine(nameof(ShiftingBits));</code>
<code>  ushort s1 = 0b01;</code>
<code>  Console.WriteLine($"{"Binary",16} {"Decimal",8} {"Hex",6}");</code>
<code>  for (int i = 0; i &lt; 16; i++)</code>
<code>  { </code>
<code>    Console.WriteLine($"{s1.ToBinaryString(),16} {s1,8} hex: {s1,6:X}");</code>
<code>    s1 = (ushort)(s1 &lt;&lt; 1);</code>
<code>  }</code>
<code>  Console.WriteLine();</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">In the program output, you can see binary, decimal, and
                    hexadecimal values with the loop:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在程序输出中，你可以看到循环中的二进制、十进制和十六进制值：
                            </font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0040"><code>          Binary  Decimal    Hex</code>
<code>0000000000000001        1      1</code>
<code>0000000000000010        2      2</code>
<code>0000000000000100        4      4</code>
<code>0000000000001000        8      8</code>
<code>0000000000010000       16     10</code>
<code>0000000000100000       32     20</code>
<code>0000000001000000       64     40</code>
<code>0000000010000000      128     80</code>
<code>0000000100000000      256    100</code>
<code>0000001000000000      512    200</code>
<code>0000010000000000     1024    400</code>
<code>0000100000000000     2048    800</code>
<code>0001000000000000     4096   1000</code>
<code>0010000000000000     8192   2000</code>
<code>0100000000000000    16384   4000</code>
<code>1000000000000000    32768   8000</code></pre>
            </section>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0025"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-132" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Signed and Unsigned Numbers <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">有符号和无符号数</font>
                        </font>
                    </font>
                </h3>
                <p id="c05-para-0082" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">One important thing to remember when working with binary
                    numbers is that when using signed types, such as <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>, and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code>, the
                    leftmost bit is used to represent the sign. When you use an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>, the highest
                    number available is <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">2147483647</code>
                    —the positive number of 31 bits or <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">0x7FFF_FFFF</code>. With
                    a <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>, the
                    highest number available is <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">4294967295</code> or
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">0xFFFF_FFFF</code>.
                    This represents the positive number of 32 bits. With the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>, the other
                    half of the number range is used for negative numbers.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在处理二进制数时，需要记住的一个重要事项是，在使用有符号类型（如
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code>
                                ）时，最左边的位用于表示符号。当你使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                时，可用的最高数字是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">2147483647</code>
                                —即 31 位的正数或 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">0x7FFF_FFFF</code>
                                。对于 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                ，可用的最高数字是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">4294967295</code>
                                或 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">0xFFFF_FFFF</code>
                                。这表示 32 位的正数。而对于 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                ，数字范围的其他一半则用于表示负数。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">To understand how negative numbers are represented, the
                    following code snippet initializes the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">maxNumber</code> variable
                    to the highest positive number that fits into 15 bits using <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short.MaxValue</code>.
                    Then, in a <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">for</code>
                    loop, the variable is incremented three times. In the results, binary, decimal, and hexadecimal
                    values are shown (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BinaryCalculations/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要理解负数是如何表示的，以下代码片段使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short.MaxValue</code>
                                将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">maxNumber</code>
                                变量初始化为能装入 15 位的最高正数。然后，在一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">for</code>
                                循环中，该变量增加了三次。结果中显示了二进制、十进制和十六进制值（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">BinaryCalculations/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0041"><code>void SignedNumbers()</code>
<code>{</code>
<code>  Console.WriteLine(nameof(SignedNumbers));</code>
<code> </code>
<code>  void DisplayNumber(string title, short x) =&gt;</code>
<code>    Console.WriteLine($"{title,-11} " +</code>
<code>      $"bin: {x.ToBinaryString().AddSeparators()}, " +     </code>
<code>      $"dec: {x,6}, hex: {x,4:X}");</code>
<code> <span aria-label="131" epub:type="pagebreak" id="Page_131" role="doc-pagebreak"></span></code>
<code>  short maxNumber = short.MaxValue;</code>
<code>  DisplayNumber("max short", maxNumber);</code>
<code>  for (int i = 0; i &lt; 3; i++)</code>
<code>  {</code>
<code>    maxNumber++;</code>
<code>    DisplayNumber($"added {i + 1}", maxNumber);</code>
<code>  }</code>
<code>  Console.WriteLine();</code>
<code>  //…</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">With the output of the application, you can see all the
                    bits—except the sign bit—are set to achieve the maximum integer value. The output shows the same
                    value in different formats—binary, decimal, and hexadecimal. Adding 1 to the first output results in
                    an overflow of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code> type setting
                    the sign bit, and all other bits are 0. This is the highest negative value for the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> type. After
                    this result, two more increments are done:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                通过应用程序的输出，你可以看到除了符号位之外的所有位都设置为最大整数值。输出显示了以二进制、十进制和十六进制格式表示的相同值。将第一个输出加 1 会导致 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code>
                                类型设置符号位并使所有其他位为 0，这是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                类型的最高负值。在此结果之后，再进行两次增量操作：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0042"><code>max short    bin: 0111_1111_1111_1111, dec:  32767, hex: 7FFF</code>
<code>added 1      bin: 1000_0000_0000_0000, dec: -32768, hex: 8000</code>
<code>added 2      bin: 1000_0000_0000_0001, dec: -32767, hex: 8001</code>
<code>added 3      bin: 1000_0000_0000_0010, dec: -32766, hex: 8002</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">With the next code snippet, the variable <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">zero</code> is
                    initialized to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">0</code>. In the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">for</code> loop, this
                    variable is decremented three times:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在下一个代码片段中，变量 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">zero</code>
                                被初始化为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">0</code> 。在
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">for</code>
                                循环中，这个变量被减去三次：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0043"><code>short zero = 0;</code>
<code>DisplayNumber("zero", zero);</code>
<code>for (int i = 0; i &lt; 3; i++)</code>
<code>{</code>
<code>  zero--;</code>
<code>  DisplayNumber($"subtracted {i + 1}", zero);</code>
<code>}</code>
<code>Console.WriteLine();</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">With the output, you can see 0 is represented with all the
                    bits not set. Doing a decrement results in decimal <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">-1</code>, which is all
                    the bits set, including the sign bit:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">通过输出可以看到，0 用所有位未设置来表示。执行减操作后得到十进制
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">-1</code>
                                ，所有位都被设置，包括符号位：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0044"><code>zero         bin: 0000_0000_0000_0000, dec:      0, hex:    0</code>
<code>subtracted 1 bin: 1111_1111_1111_1111, dec:     -1, hex: FFFF</code>
<code>subtracted 2 bin: 1111_1111_1111_1110, dec:     -2, hex: FFFE</code>
<code>subtracted 3 bin: 1111_1111_1111_1101, dec:     -3, hex: FFFD</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Next, start with the largest negative number for a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code>. The number
                    is incremented three times:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">接下来，以 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code>
                                的最大负数开始。该数字增加三次：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0045"><code>short minNumber = short.MinValue;</code>
<code>DisplayNumber("min number", minNumber);</code>
<code>for (int i = 0; i &lt; 3; i++)</code>
<code>{</code>
<code>  minNumber++;</code>
<code>  DisplayNumber($"added {i + 1}", minNumber);</code>
<code>}</code>
<code>Console.WriteLine();</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The highest negative number was already shown earlier when
                    overflowing the highest positive number. Earlier you saw this same number when <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int.MinValue</code> was
                    used. This number is then incremented three times:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">之前在最高正数溢出时已经展示了这个最大的负数。之前在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int.MinValue</code>
                                使用时也看到了这个相同的数字。然后该数字增加三次：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0046"><code>min number   bin: 1000_0000_0000_0000, dec: -32768, hex: 8000</code>
<code>added 1      bin: 1000_0000_0000_0001, dec: -32767, hex: 8001</code>
<code>added 2      bin: 1000_0000_0000_0010, dec: -32766, hex: 8002</code>
<code>added 3      bin: 1000_0000_0000_0011, dec: -32765, hex: 8003</code></pre>
            </section>
        </section> <span aria-label="132" epub:type="pagebreak" id="Page_132" role="doc-pagebreak"
            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
        <section aria-labelledby="head-2-44" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
            <span id="c05-sec-0026" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <h2 id="head-2-44" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">TYPE SAFETY<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">类型安全</font>
                    </font>
                </font>
            </h2>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">The Intermediate Language (IL) enforces strong type safety upon
                its code. Strong typing enables many of the services provided by .NET, including security and language
                interoperability. As you would expect from a language compiled into IL, C# is also strongly typed. Among
                other things, this means that data types are not always seamlessly interchangeable. This section looks
                at conversions between primitive types.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">中间语言（IL）对其代码执行强类型检查。强类型检查使.NET
                            提供的许多服务得以实现，包括安全性和语言互操作性。正如你所预期的那样，C#是一种编译成 IL
                            的语言，因此也是强类型的。这其中包括数据类型并不总是可以无缝地相互替换。本节将探讨原始类型之间的转换。</font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <p id="c05-para-0090" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">C# also supports
                            conversions between different reference types and allows you to define how data types that
                            you create behave when converted to and from other types. Both of these topics are discussed
                            later in this chapter.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意
                                    C#还支持不同引用类型之间的转换，并允许你定义你创建的数据类型在转换为和从其他类型转换时的行为。这两个主题将在本章后面讨论。</font>
                            </font>
                        </font>
                    </p>
                    <p id="c05-para-0091" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Generics, however, enable you to avoid some of the
                            most common situations in which you would need to perform type conversions. See <a
                                href="c04.xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 4</a>,
                            “Object-Oriented Programming in C#”, and <a href="c08.xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 8</a>
                            when using many generic collection classes.<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">
                                        然而，泛型使你能够避免一些最常见的需要执行类型转换的情况。在使用许多泛型集合类时，请参阅第 4 章“C#中的面向对象编程”和第 8 章。</font>
                                </font>
                            </font></i></p>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0028"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-133" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Type Conversions <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">类型转换</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Often, you need to convert data from one type to another.
                    Consider the following code:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">通常，你需要将数据从一种类型转换为另一种类型。考虑以下代码：
                            </font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0047"><code>byte value1 = 10;</code>
<code>byte value2 = 23;</code>
<code>byte total = value1 + value2;</code>
<code>Console.WriteLine(total);</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">When you attempt to compile these lines, you get the
                    following error message:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当你尝试编译这些行时，你会得到以下错误消息：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0048"><code>Cannot implicitly convert type 'int' to 'byte'</code></pre>
                <p id="c05-para-0094" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The problem here is that when you add 2 bytes together, the
                    result is returned as an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>, not another
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>. This is
                    because a <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>
                    can contain only 8 bits of data, so adding 2 bytes together could easily result in a value that
                    cannot be stored in a single <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>. If you want
                    to store this result in a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code> variable, you
                    have to convert it back to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>. The
                    following sections discuss two conversion mechanisms supported by C#—<i
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">implicit</i> and <i
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">explicit</i>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这里的问题是当你将两个字节相加时，结果会返回为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                ，而不是另一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>
                                。这是因为一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>
                                只能包含 8 位数据，所以将两个字节相加可能会得到一个无法存储在一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>
                                中的值。如果你想把结果存储在一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>
                                变量中，你必须将其转换回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>
                                。接下来的部分将讨论 C# 支持的两种转换机制——隐式和显式。</font>
                        </font>
                    </font>
                </p>
                <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0029"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                    <h4 id="head-4-27" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Implicit Conversions<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                            <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">隐式转换</font>
                            </font>
                        </font>
                    </h4>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Conversion between types can normally be achieved
                        automatically (implicitly) only if you can guarantee that the value is not changed in any way.
                        This is why the previous code failed; by attempting a conversion from an <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> to a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>, you were
                        potentially losing 3 bytes of data. The compiler won't let you do that unless you explicitly
                        specify that's what you want to do. If you store the result in a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code> instead
                        of a <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>,
                        however, you will have no problems:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    类型之间的转换通常只能自动（隐式）完成，前提是你必须保证值不会以任何方式改变。这就是为什么之前的代码失败了；通过尝试将一个 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                    转换为一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>
                                    ，你可能会丢失 3 个字节的数据。除非你明确指定你想这样做，否则编译器不会让你这样做。然而，如果你将结果存储在一个 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                    而不是一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>
                                    中，你将不会有任何问题：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0049"><code>byte value1 = 10;</code>
<code>byte value2 = 23;</code>
<code>long total = value1 + value2; // this will compile fine</code>
<code>Console.WriteLine(total);</code></pre>
                    <p id="c05-para-0096" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Your program has compiled with no errors at this point
                        because a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code> holds
                        more bytes of data than a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>, so there
                        is no risk of data being lost. In these circumstances, the compiler is happy to make the
                        conversion for you without you needing to ask for it explicitly. As you would expect, you can
                        perform implicit conversions only from a smaller integer type to a larger one, not from larger
                        to smaller. You can also convert between integers and floating-point values; however, the rules
                        are slightly different here. Though you can convert between types of the same size, such as
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                        /
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> to
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> and
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                        /
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code> to
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>, you
                        can also convert from <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                        /
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code> to
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>. You
                        might lose 4 bytes of data doing this, but it only means that the value of the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> you
                        receive will be <span aria-label="133" epub:type="pagebreak" id="Page_133" role="doc-pagebreak"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>less precise
                        than if you had used a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                        ; the compiler regards this as an acceptable possible error because the magnitude of the value
                        is not affected. You can also assign an unsigned variable to a signed variable as long as the
                        value limits of the unsigned type fit between the limits of the signed variable.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">你的程序到目前为止没有编译错误，因为 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                    持有的数据字节数比 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">byte</code>
                                    多，所以不存在数据丢失的风险。在这种情况下，编译器很乐意为你进行转换，而无需你明确请求。正如你所预期的那样，你可以执行隐式转换，但只能从较小的整数类型转换到较大的类型，而不能从较大的类型转换到较小的类型。你还可以在整数和浮点值之间进行转换；然而，这里的规则略有不同。尽管你可以转换相同大小的类型，例如
                                    <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                    / <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                    转换到 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                    / <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code>
                                    转换到 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                    ，你也可以从 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                    / <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code>
                                    转换到 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                    。这样做可能会丢失 4 字节的数据，但这只是意味着你收到的 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                    的值精确度不如使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                    时那么高；编译器认为这是一种可接受的潜在错误，因为值的幅度并未受到影响。只要无符号类型的值范围适合在带符号变量的值范围内，你也可以将一个无符号变量赋值给一个带符号变量。
                                </font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Nullable value types introduce additional considerations
                        when you're implicitly converting value types:<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">可空值类型在您进行隐式转换时引入了额外的考虑因素：
                                </font>
                            </font>
                        </font>
                    </p>
                    <ul class="check" id="c05-list-0004"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <li id="c05-li-0015" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Nullable value types implicitly convert to other
                            nullable value types following the conversion rules described for non-nullable types in the
                            previous rules; that is, <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int?</code>
                            implicitly converts to <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long?</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float?</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double?</code>,
                            and <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">decimal</code>
                            ?.<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">
                                        可空值类型根据前文所述的非可空类型转换规则隐式转换为其他可空值类型；也就是说， <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int?</code>
                                        隐式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long?</code>
                                        、 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float?</code>
                                        、 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double?</code>
                                        和 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">decimal</code>
                                        ？</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0016" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Non-nullable value types implicitly convert to
                            nullable value types according to the conversion rules described in the preceding rules;
                            that is, <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                            implicitly converts to <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long?</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float?</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double?</code>,
                            and <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">decimal?</code>.
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">
                                        非可空值类型根据前文所述的转换规则隐式转换为可空值类型；也就是说， <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                        隐式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long?</code>
                                        、 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float?</code>
                                        、 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double?</code>
                                        和 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">decimal?</code>
                                        。</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0017" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Nullable value types do not implicitly convert to
                            non-nullable value types; you must perform an explicit conversion as described in the next
                            section. That's because there is a chance that a nullable value type will have the value
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>,
                            which cannot be represented by a non-nullable type.<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">
                                        可空值类型不会隐式转换为非可空值类型；你必须执行下一节中描述的显式转换。这是因为可空值类型有可能具有 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                        的值，而非可空类型无法表示该值。</font>
                                </font>
                            </font>
                        </li>
                    </ul>
                </section>
                <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0030"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                    <h4 id="head-4-28" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Explicit Conversions<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                            <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">显式转换</font>
                            </font>
                        </font>
                    </h4>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Many conversions cannot be implicitly made between types,
                        and the compiler returns an error if any are attempted. The following are some of the
                        conversions that cannot be made implicitly:<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    许多类型之间的转换不能隐式进行，如果尝试进行任何转换，编译器会返回错误。以下是一些不能隐式进行的转换：</font>
                            </font>
                        </font>
                    </p>
                    <ul class="check" id="c05-list-0005"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <li id="c05-li-0018" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> to
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code>
                            —Data loss is possible.<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1"> <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                        到 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code>
                                        —可能存在数据丢失。</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0019" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> to
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                            —Data loss is possible.<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1"> <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                        到 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                        —可能存在数据丢失。</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0020" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> to
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                            —Data loss is possible.<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1"> <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                        到 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                        —可能存在数据丢失。</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0021" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> to
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                            —Everything is lost after the decimal point.<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1"> <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                        到 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                        —小数点后的所有内容都会丢失。</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0022" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Any numeric type to <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code>
                            —Data loss is possible.<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">任何数值类型到 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code>
                                        —可能存在数据丢失。</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0023" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">decimal</code>
                            to any other numeric type—The decimal type is internally structured differently from both
                            integers and floating-point numbers.<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1"> <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">decimal</code>
                                        到其他任何数值类型—十进制类型在内部结构与整数和浮点数都不同。</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0024" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int?</code> to
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                            —The nullable type may have the value <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>.<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1"> <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int?</code>
                                        到 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                        —可空类型可能具有 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                        的值。</font>
                                </font>
                            </font>
                        </li>
                    </ul>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">However, you can explicitly carry out such conversions
                        using <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">casts</i>. When
                        you cast one type to another, you deliberately force the compiler to make the conversion. A cast
                        looks like this:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    然而，你可以使用强制转换显式地执行此类转换。当你将一种类型转换为另一种类型时，你故意强制编译器进行转换。强制转换看起来是这样的：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0050"><code>long val = 30000;</code>
<code>int i = (int)val; // A valid cast. The maximum int is 2147483647</code></pre>
                    <p id="c05-para-0100" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">You indicate the type to which you are casting by placing
                        its name in parentheses before the value to be converted.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    您通过在要转换的值之前将目标类型的名称放在括号中来指定要转换的类型。</font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Casting can be a dangerous operation to undertake. Even a
                        simple cast from a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code> to an
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> can
                        cause problems if the value of the original <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code> is
                        greater than the maximum value of an <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                        :<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">强制转换可能是一项危险的操作。即使是从 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                    到 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                    的简单转换，如果原始 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                    的值大于 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                    的最大值，也可能导致问题：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0051"><code>long val = 3000000000;</code>
<code>int i = (int)val; // An invalid cast. The maximum int is 2147483647</code></pre>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">In this case, you get neither an error nor the result you
                        expect. If you run this code and output the value stored in <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">i</code>, this is
                        what you get:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    在这种情况下，您既不会得到错误，也不会得到预期的结果。如果您运行此代码并输出存储在 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">i</code>
                                    中的值，您将得到以下结果：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0052"><code>-1294967296</code></pre>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">It is good practice to assume that an explicit cast does
                        not return the results you expect. As shown earlier, C# provides a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                        operator that you can use to test whether an operation causes an arithmetic overflow. You can
                        <span aria-label="134" epub:type="pagebreak" id="Page_134" role="doc-pagebreak"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>use the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                        operator to confirm that a cast is safe and to force the runtime to throw an overflow exception
                        if it is not:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">假设显式转换不会返回预期结果是一种良好的做法。如前所述，C#
                                    提供了一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                    运算符，您可以使用它来测试操作是否导致算术溢出。您可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                    运算符来确认转换是否安全，并在不安全时强制运行时抛出溢出异常：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0053"><code>long val = 3000000000;</code>
<code>int i = checked((int)val);</code></pre>
                    <p id="c05-para-0104" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Bearing in mind that all explicit casts are potentially
                        unsafe, make sure you include code in your application to deal with possible failures of the
                        casts. <a href="c10.xhtml"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 10</a>,
                        “Errors and Exceptions,” introduces structured exception handling using the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">try</code> and <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">catch</code>
                        statements.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    考虑到所有显式类型转换都有潜在的不安全性，请确保在您的应用程序中包含处理类型转换可能失败的代码。第 10 章“错误和异常”介绍了使用 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">try</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">catch</code>
                                    语句进行结构化异常处理。</font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Using casts, you can convert most primitive data types
                        from one type to another; for example, in the following code, the value <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">0.5</code> is added
                        to <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">price</code>,
                        and the total is cast to an <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                        :<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    使用类型转换，您可以将大多数基本数据类型从一个类型转换为另一个类型；例如，在以下代码中，值 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">0.5</code>
                                    被加到 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">price</code>
                                    ，并且总和被转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                    ：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0054"><code>double price = 25.30;</code>
<code>int approximatePrice = (int)(price + 0.5);</code></pre>
                    <p id="c05-para-0106" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">This gives the price rounded to the nearest dollar.
                        However, in this conversion, data is lost—namely, everything after the decimal point. Therefore,
                        such a conversion should never be used if you want to continue to do more calculations using
                        this modified price value. However, it is useful if you want to output the approximate value of
                        a completed or partially completed calculation—if you don't want to bother the user with a lot
                        of figures after the decimal point.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    这给出了四舍五入到最近一美元的价格。然而，在这种转换中会丢失数据——具体来说，是小数点后的所有内容。因此，如果您想继续使用这个修改后的价格值进行更多计算，则永远不应该使用这种转换。但是，如果您想输出一个已完成或部分完成的计算的大致值——如果您不希望用户被小数点后的许多数字所困扰——这种转换是有用的。
                                </font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">This example shows what happens if you convert an
                        unsigned integer into a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code>
                        :<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">这个例子展示了如果您将无符号整数转换为 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code>
                                    会发生什么：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0055"><code>ushort c = 43;</code>
<code>char symbol = (char)c;</code>
<code>Console.WriteLine(symbol);</code></pre>
                    <p id="c05-para-0108" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">The output is the character that has an ASCII number of
                        43, which is the + sign. This will work for any kind of conversion you want between the numeric
                        types (including <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code>), such as
                        converting a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">decimal</code> into a
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code>, or
                        vice versa.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">输出是 ASCII 码为 43
                                    的字符，即加号。这适用于你想要在数值类型之间进行的任何转换（包括 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code>
                                    ），例如将 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">decimal</code>
                                    转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code>
                                    ，反之亦然。</font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Converting between value types is not restricted to
                        isolated variables, as you have seen. You can convert an array element of type <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code> to a
                        struct member variable of type <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                        :<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    像你所看到的，在值类型之间进行转换并不局限于独立的变量。你可以将类型为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                    的数组元素转换为类型为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                    的结构成员变量：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0056"><code>struct ItemDetails</code>
<code>{</code>
<code>  public string Description;</code>
<code>  public int ApproxPrice;</code>
<code>}</code>
<code>//…</code>
<code>double[] Prices = { 25.30, 26.20, 27.40, 30.00 };</code>
<code>ItemDetails id;</code>
<code>id.Description = "Hello there.";</code>
<code>id.ApproxPrice = (int)(Prices[0] + 0.5);</code></pre>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">To convert a nullable type to a non-nullable type or
                        another nullable type where data loss may occur, you must use an explicit cast. This is true
                        even when converting between elements with the same basic underlying type—for example, <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int?</code> to <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> or <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float?</code> to
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>. This
                        is because the nullable type may have the value <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>, which
                        cannot be represented by the non-nullable type. As long as an explicit cast between two
                        equivalent non-nullable types is possible, so is the explicit cast between nullable types.
                        However, when casting from a nullable type to a non-nullable type and the variable has the value
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>, an
                        <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">InvalidOperationException</code>
                        is thrown. Here is an example:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    要将可空类型转换为非可空类型或另一个可能发生数据丢失的可空类型，你必须使用显式转换。即使是在具有相同基本底层类型的元素之间转换时也是如此——例如， <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int?</code>
                                    转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                    或 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float?</code>
                                    转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                    。这是因为可空类型可能具有 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                    值，而非可空类型无法表示该值。只要两个等价的非可空类型之间可以进行显式转换，那么可空类型之间也可以进行显式转换。然而，当从可空类型转换为非可空类型，且变量具有
                                    <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                    值时，会抛出 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">InvalidOperationException</code>
                                    异常。以下是一个示例：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0057"><code>int? a = null;</code>
<code>int b = (int)a; // Will throw exception</code></pre>
                    <p id="c05-para-0111" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">By using explicit casts and a bit of care and attention,
                        you can convert any instance of a simple value type to almost any other. However, there are
                        limitations on what you can do with explicit type conversions—as far as value types are
                        concerned, you can only convert to and from the numeric and <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code> types and
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">enum</code> types.
                        You cannot directly cast Booleans to any other type or vice versa.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    通过使用显式转换并稍加小心和注意，你可以将任何简单值类型的实例转换为几乎任何其他类型。然而，在显式类型转换方面存在一些限制——就值类型而言，你只能转换到和来自数值类型和
                                    <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code>
                                    类型以及 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">enum</code>
                                    类型。你不能直接将布尔值转换为任何其他类型或反之亦然。</font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><span aria-label="135" epub:type="pagebreak"
                            id="Page_135" role="doc-pagebreak"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>If you need to
                        convert between numeric and string, you can use methods provided in the .NET class library. The
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Object</code> class
                        implements a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ToString</code>
                        method, which has been overridden in all the .NET predefined types and which returns a string
                        representation of the object:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">如果你需要在数值和字符串之间进行转换，可以使用.NET
                                    类库中提供的方法。 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Object</code>
                                    类实现了一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ToString</code>
                                    方法，该方法在所有.NET 预定义类型中都被重写，并返回对象的字符串表示形式：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0058"><code>int i = 10;</code>
<code>string s = i.ToString();</code></pre>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Similarly, if you need to parse a string to retrieve a
                        numeric or Boolean value, you can use the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Parse</code> method
                        supported by all the predefined value types:<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    类似地，如果你需要解析字符串以获取数值或布尔值，你可以使用所有预定义值类型都支持的第 0#方法：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0059"><code>string s = "100";</code>
<code>int i = int.Parse(s);</code>
<code>Console.WriteLine(i + 50); // Add 50 to prove it is really an int</code></pre>
                    <p id="c05-para-0114" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Note that <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Parse</code>
                        registers an error by throwing an exception if it is unable to convert the string (for example,
                        if you try to convert the string <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Hello</code> to an
                        integer). Again, exceptions are covered in <a href="c10.xhtml"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 10</a>.
                        Instead of using the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Parse</code> method,
                        you can also use <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">TryParse</code>,
                        which doesn't throw an exception in case of an error, but returns <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code> if it
                        succeeds.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">请注意，如果 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Parse</code>
                                    无法转换字符串（例如，尝试将字符串 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Hello</code>
                                    转换为整数），它会通过抛出异常来注册错误。再次强调，异常在第 10 章中有所介绍。除了使用 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Parse</code>
                                    方法外，你也可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">TryParse</code>
                                    ，它在出错时不会抛出异常，而是在成功时返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code>
                                    。</font>
                            </font>
                        </font>
                    </p>
                </section>
            </section>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0031"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-134" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Boxing and Unboxing <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">装箱和拆箱</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1"><a href="c02.xhtml"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter 2</a> explains
                    that all types—both the simple predefined types, such as <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code>, and the
                    complex types, such as classes and structs—derive from the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code> type. This
                    means you can treat even literal values as though they are objects:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">第 2 章解释了所有类型——无论是简单的预定义类型，如 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">char</code>
                                ，还是复杂的类型，如类和结构——都派生自 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code>
                                类型。这意味着你可以将字面量值也视为对象：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0060"><code>string s = 10.ToString();</code></pre>
                <p id="c05-para-0116" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">However, you also saw that C# data types are divided into
                    value types, which are allocated on the stack, and reference types, which are allocated on the
                    managed heap. How does this work with the capability to call methods on an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>, if the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> is nothing
                    more than a 4-byte value on the stack?<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">然而，你也看到了
                                C#数据类型分为值类型（在栈上分配）和引用类型（在托管堆上分配）。如果 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                只是一个栈上的 4 字节值，那么如何能够调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                上的方法呢？</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0117" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">C# achieves this through a bit of magic called <i
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">boxing</i>. Boxing and
                    its counterpart, <i
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">unboxing</i>, enable you
                    to convert value types to reference types and then back to value types. I include this topic in the
                    section on casting because this is essentially what you are doing—you are casting your value to the
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code> type.
                    Boxing is the term used to describe the transformation of a value type to a reference type.
                    Basically, the runtime creates a temporary reference-type box for the object on the heap.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">C#
                                通过一种称为装箱的魔法来实现这一点。装箱及其对应物拆箱，使你能够将值类型转换为引用类型，然后再转换回值类型。我将这个主题包含在类型转换部分，因为这就是你实际上所做的事情——你正在将你的值转换为
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code>
                                类型。装箱是用于描述值类型转换为引用类型的术语。基本上，运行时会为对象在堆上创建一个临时的引用类型盒子。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">This conversion can occur implicitly, as in the preceding
                    example, but you can also perform it explicitly:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这种转换可以隐式进行，就像前面的例子一样，但你也可以显式执行它：
                            </font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0061"><code>int myIntNumber = 20;</code>
<code>object myObject = myIntNumber;</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Unboxing is the term used to describe the reverse process,
                    whereby the value of a previously boxed value type is cast back to a value type. Here, I use the
                    term <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">cast</i> because this
                    has to be done explicitly. The syntax is similar to explicit type conversions already described:
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                拆箱是用于描述反向过程的术语，即将先前装箱的值类型的值转换回值类型。在这里，我使用“转换”一词，因为必须显式执行。语法与前面描述的显式类型转换类似：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0062"><code>int myIntNumber = 20;</code>
<code>object myObject = myIntNumber; // Box the int</code>
<code>int mySecondNumber = (int)myObject; // Unbox it back into an int</code></pre>
                <p id="c05-para-0120" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">A variable can be unboxed only if it has been boxed. If you
                    execute the last line when <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">myObject</code> is not a
                    boxed <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>, you
                    get a runtime exception.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">只有当变量已经被装箱时，才能对其进行拆箱。如果你在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">myObject</code>
                                不是一个装箱的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                的情况下执行最后一行代码，你会得到一个运行时异常。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">One word of warning: When unboxing, you have to be careful
                    that the receiving value is of the same type as the value that was boxed. Even if the resulting type
                    has enough room to store all the bytes in the value being unboxed, an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">InvalidCastException</code>
                    is thrown. You can avoid this by casting from the original type in the new type, as shown here:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                一条警告：在拆箱时，必须确保接收的值与装箱时的值类型相同。即使结果类型有足够的空间存储正在拆箱的值中的所有字节，也会抛出 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">InvalidCastException</code>
                                异常。你可以通过在新类型中从原始类型进行强制转换来避免这种情况，如下所示：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0063"><code>int myIntNumber = 42;</code>
<code>object myObject = (object)myIntNumber;</code>
<code>long myLongNumber = <b>(long)(int)myObject;</b></code></pre>
            </section>
        </section> <span aria-label="136" epub:type="pagebreak" id="Page_136" role="doc-pagebreak"
            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
        <section aria-labelledby="head-2-45" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
            <span id="c05-sec-0032" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <h2 id="head-2-45" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">OPERATOR OVERLOADING<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">运算符重载 </font>
                    </font>
                </font>
            </h2>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">Instead of invoking methods, the code can become more readable
                using operators. Just compare these two code lines to add two vectors:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            代码可以通过使用运算符而不是调用方法变得更加易读。只需比较这两行代码来添加两个向量：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0064"><code>vect3 = vect1 + vect2;</code>
<code>vect3 = vect1.Add(vect2);</code></pre>
            <p id="c05-para-0123" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">With predefined number types, you can use <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code>, <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">-</code>, <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">/</code>, <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">*</code>, and <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">%</code> operators, and you
                can also concatenate strings with the + operator. Using such operators is not only possible with
                predefined types, but also with custom types as long as they make sense with the types. What would a
                <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code> operator used with
                two <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code> objects
                do?<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">对于预定义的数字类型，你可以使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code> 、 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">-</code> 、 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">/</code> 、 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">*</code> 和 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">%</code>
                            运算符，并且你还可以使用+运算符合并字符串。使用这样的运算符不仅限于预定义类型，只要它们与类型有意义，也可以用于自定义类型。使用两个 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code> 对象与
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code>
                            运算符会做什么呢？</font>
                    </font>
                </font>
            </p>
            <p id="c05-para-0124" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">You can overload the following operators:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">你可以重载以下操作符：</font>
                    </font>
                </font>
            </p>
            <table border="1" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <thead data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <th class="left bgcolor2" scope="col">OPERATORS</th>
                        <th class="left bgcolor2" scope="col">DESCRIPTION</th>
                    </tr>
                </thead>
                <tbody data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+x</code>, <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">-x</code>, <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">!x</code>, <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">~x</code>, <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">++</code>, <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">--</code>, <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>
                        </td>
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">These are unary operators that can be overloaded.
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">这些是一元操作符，可以被重载。</font>
                                </font>
                            </font>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x + y</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x - y</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x * y</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x / y</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x % y</code>,
                            <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x &amp; y</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x | y</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x ^ y</code>,
                            <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x &lt;&lt; y</code>,
                            <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x &gt;&gt; y</code>,
                            <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x == y, x != y</code>,
                            <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x &lt; y</code>,
                            <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x &gt; y</code>,
                            <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x &lt;= y</code>,
                            <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x &gt;= y</code>
                        </td>
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">These are binary operators that can be overloaded.
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">这些是二元操作符，可以被重载。</font>
                                </font>
                            </font>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">a[i]</code>,
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">a?[i]</code>
                        </td>
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Element access cannot be overloaded with an operator
                            overload, but you can create an indexer, which is shown later in this chapter.<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">
                                        元素访问不能通过操作符重载来重载，但你可以创建一个索引器，这在本章后面将展示。</font>
                                </font>
                            </font>
                        </td>
                    </tr>
                    <tr data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <td class="left bgcolor3"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">(T)x</code></td>
                        <td class="left bgcolor3" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">Instead of using an operator overload, you can use
                            the cast to create a user-defined conversion, which is shown later in this chapter as well.
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">
                                        除了使用运算符重载，您还可以使用强制转换来创建用户自定义的转换，这在本章后面也将展示。</font>
                                </font>
                            </font>
                        </td>
                    </tr>
                </tbody>
            </table>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <p id="c05-para-0126" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">You might wonder what
                            the reason is for overloading the </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> and </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> operators.
                            Conditional logical operators </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&amp;&amp;</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> and </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">||</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> cannot be directly
                            overloaded. To create a custom implementation for these operators, you can overload the </i>
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, the </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, the </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&amp;</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, and the </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">|</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> operators.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 您可能会想知道重载 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>
                                    运算符的原因。条件逻辑运算符 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&amp;&amp;</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">||</code>
                                    不能直接重载。要为这些运算符创建自定义实现，您可以重载 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&amp;</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">|</code>
                                    运算符。</font>
                            </font>
                        </font>
                    </p>
                    <p id="c05-para-0127" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Similarly, you can't
                            explicitly overload compound conversion operators such as </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+=</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> and </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">-=</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">. If you overload the
                            binary operator, compound conversion is implicitly overloaded.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">同样地，你不能显式地重载复合转换运算符，如 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+=</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">-=</code>
                                    。如果你重载了二元运算符，复合转换会隐式地被重载。</font>
                            </font>
                        </font>
                    </p>
                    <p id="c05-para-0128" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Some operators need
                            to be overloaded in pairs. If you overload </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">==</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, you also must
                            overload </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">!=</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">. If you overload
                        </i> <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&lt;</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, then you must
                            overload </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&gt;</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, and if you overload
                        </i> <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&lt;=</code>
                        <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, then you must </i>
                        <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">overload </i> <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&gt;=</code> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">某些运算符需要成对地重载。如果你重载了 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">==</code>
                                    ，你也必须重载 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">!=</code>
                                    。如果你重载了 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&lt;</code>
                                    ，那么你必须重载 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&gt;</code>
                                    ，如果你重载了 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&lt;=</code>
                                    ，那么你必须重载 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">&gt;=</code>
                                    。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0034"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-135" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">How Operators Work <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">运算符的工作原理</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">To understand how to overload operators, it's useful to think
                    about what happens when the compiler encounters an operator. Using the addition operator (<code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code>) as an example,
                    suppose that the compiler processes the following lines of code:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                要理解如何重载运算符，思考编译器遇到运算符时会发生什么是有用的。以加法运算符（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code>
                                ）为例，假设编译器处理以下代码行：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0065"><code>int x = 1;</code>
<code>int y = 2;</code>
<code>long z = x + y;</code></pre>
                <p id="c05-para-0130" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1"><span aria-label="137" epub:type="pagebreak" id="Page_137"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>The compiler
                    identifies that it needs to add two integers and assign the result to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>. The
                    expression <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x + y</code>
                    is just an intuitive and convenient syntax for calling a method that adds two numbers. The method
                    takes two parameters, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code> and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">y</code>, and returns
                    their sum. Therefore, the compiler does the same thing it does for any method call: it looks for the
                    best matching overload of the addition operator based on the parameter types—in this case, one that
                    takes two integers. As with normal overloaded methods, the desired return type does not influence
                    the compiler's choice as to which version of a method it calls. As it happens, the overload called
                    in the example takes two <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> parameters and
                    returns an <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                    ; this return value is subsequently converted to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>. This can
                    result in an overflow if the two added <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> values don't
                    fit into an <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                    although a long is declared to write the result to.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">编译器识别出需要将两个整数相加并将结果赋值给 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                。表达式 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x + y</code>
                                只是一个直观且方便的语法，用于调用一个相加两个数字的方法。该方法接受两个参数 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">y</code>
                                ，并返回它们的和。因此，编译器执行的操作与调用任何方法相同：根据参数类型查找最佳匹配的重载版本——在这种情况下，是一个接受两个整数的重载。与普通重载方法一样，期望的返回类型不会影响编译器选择调用哪个版本的方法。在示例中，调用的重载接受两个
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                参数并返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                ；这个返回值随后被转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                。如果两个相加的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                值不能放入一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                中，这可能导致溢出，尽管声明了一个 long 来写入结果。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The next lines cause the compiler to use a different overload
                    of the addition operator:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">接下来的行导致编译器使用加法运算符的另一个重载版本：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0066"><code>double d1 = 4.0;</code>
<code>double d2 = d1 + x;</code></pre>
                <p id="c05-para-0132" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">In this instance, the parameters are a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code> and an
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>, but there
                    is no overload of the addition operator that takes this combination of parameters. Instead, the
                    compiler identifies the best matching overload of the addition operator as being the version that
                    takes two <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                    s as its parameters, and it implicitly casts the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>. Adding two
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                    s requires a different process from adding two integers. Floating-point numbers are stored as a
                    mantissa and an exponent. Adding them involves bit-shifting the mantissa of one of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                    s so that the two exponents have the same value, adding the mantissas, and then shifting the
                    mantissa of the result and adjusting its exponent to maintain the highest possible accuracy in the
                    answer.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在这个例子中，参数是一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                和一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                ，但没有重载的加法运算符接受这种参数组合。相反，编译器识别出加法运算符的最佳匹配重载版本是接受两个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                作为参数的版本，并将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                隐式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                。将两个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                相加需要一个与将两个整数相加不同的过程。浮点数以尾数和指数的形式存储。将它们相加涉及将其中一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                的尾数进行位移位，使得两个指数具有相同的值，然后相加尾数，并将结果的尾数移位并调整其指数以保持答案的最高精度。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Now you are in a position to see what happens if the compiler
                    finds something like this:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在你可以看到如果编译器发现类似的情况会发生什么：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0067"><code>Vector vect1, vect2, vect3;</code>
<code>// initialize vect1 and vect2</code>
<code>vect3 = vect1 + vect2;</code>
<code>vect1 = vect1 * 2;</code></pre>
                <p id="c05-para-0134" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Here, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code> is the
                    struct, which is defined in the following section. The compiler sees that it needs to add two <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code> instances,
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">vect1</code> and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">vect2</code>, together.
                    It looks for an overload of the addition operator, which takes two <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code> instances
                    as its parameters.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在这里， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                是一个结构体，它在下一节中定义。编译器看到它需要将两个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                实例 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">vect1</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">vect2</code>
                                相加。它查找接受两个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                实例作为参数的加法运算符的重载版本。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0135" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">If the compiler finds an appropriate overload, it calls up
                    the implementation of that operator. If it cannot find one, it checks whether there is any other
                    overload for <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code>
                    that it can use as a best match—perhaps something with two parameters of other data types that can
                    be implicitly converted to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code> instances.
                    If the compiler cannot find a suitable overload, it raises a compilation error, just as it would if
                    it could not find an appropriate overload for any other method call.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                如果编译器找到合适的重载，它会调用该运算符的实现。如果找不到，它会检查是否有其他针对 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code>
                                的重载可以作为最佳匹配——也许是一些具有其他数据类型的两个参数，这些参数可以隐式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                实例。如果编译器找不到合适重载，它会引发编译错误，就像它找不到任何其他方法调用的合适重载时一样。</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0035"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-136" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Operator Overloading with the Vector Type <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用向量类型的运算符重载</font>
                        </font>
                    </font>
                </h3>
                <p id="c05-para-0136" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">This section demonstrates operator overloading through
                    developing a struct named <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code> that
                    represents a three-dimensional vector. The 3D vector is just a set of three numbers (doubles) that
                    tell you how far something is moving. The variables representing the numbers are called <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">X</code>, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Y</code>, and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Z</code>
                    : the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">X</code> tells
                    you how far something moves east, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Y</code> tells you how
                    far it moves north, and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Z</code> tells you how
                    far it moves upward. Combine the three numbers and you get the total movement.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">本节通过开发一个名为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                的结构体来演示运算符重载，该结构体表示一个三维向量。三维向量只是一组三个数字（双精度浮点数），告诉您某物移动的距离。表示这些数字的变量称为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">X</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Y</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Z</code> ：
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">X</code>
                                告诉您某物向东移动的距离， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Y</code>
                                告诉您它向北移动的距离， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Z</code>
                                告诉您它向上移动的距离。将这三个数字结合起来，就得到总移动距离。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">You can add or multiply vectors by other vectors or by
                    numbers. Incidentally, in this context, we use the term <i
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">scalar</i>, which is
                    math-speak for a simple number—in C# terms that is just a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>. The
                    significance of addition should be clear. If you move first by the vector <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">(3.0, 3.0, 1.0)</code>
                    and then move by the vector <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">(2.0, -4.0, -4.0)</code>,
                    the total amount you have moved can be determined by adding the two vectors. Adding vectors means
                    adding each component individually, so you get <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">(5.0, -1.0, -3.0)</code>.
                    In this context, mathematicians write <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">c=a+b</code>, where <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">a</code> and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">b</code> are the vectors
                    and <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">c</code> is the
                    resulting vector. You want to be able to use the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code> struct the
                    same way.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                你可以通过其他向量或数字来添加或乘以向量。顺便一提，在这个上下文中，我们使用术语标量，这是数学术语中一个简单数字的代名词——在 C#术语中，它只是一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                。加法的意义应该是明确的。如果你先移动向量 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">(3.0, 3.0, 1.0)</code>
                                ，然后移动向量 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">(2.0, -4.0, -4.0)</code>
                                ，你可以通过将这两个向量相加来确定总共移动的距离。向量加法意味着逐个分量相加，所以你得到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">(5.0, -1.0, -3.0)</code>
                                。在这个上下文中，数学家会写 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">c=a+b</code>
                                ，其中 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">a</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">b</code> 是向量，
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">c</code>
                                是结果向量。你想以同样的方式使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                结构体。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <p id="c05-para-0138" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">The fact that
                                this example is developed as a struct rather than a class is not significant with
                                operator overloading. Operator overloading works in the same way for structs, classes,
                                and records.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意
                                        这个示例作为结构体而不是类来开发，在运算符重载方面并不重要。运算符重载对于结构体、类和记录的工作方式是相同的。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1"><span aria-label="138" epub:type="pagebreak" id="Page_138"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>The following is
                    the definition for <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                    —containing the read-only public fields, constructors, and a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ToString</code> override
                    so you can easily view the contents of a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>. Operator
                    overloads are added next (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorOverloadingSample/Vector.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">以下是 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                的定义——包含只读公共字段、构造函数和一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ToString</code>
                                重写，以便你可以轻松查看 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                的内容。接下来添加运算符重载（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorOverloadingSample/Vector.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0068"><code>readonly struct Vector</code>
<code>{</code>
<code>  public Vector(double x, double y, double z) =&gt; (X, Y, Z) = (x, y, z);</code>
<code> </code>
<code>  public Vector(Vector v) =&gt; (X, Y, Z) = (v.X, v.Y, v.Z);</code>
<code> </code>
<code>  public readonly double X;</code>
<code>  public readonly double Y;</code>
<code>  public readonly double Z;</code>
<code>  public override string ToString() =&gt; $"( {X}, {Y}, {Z} )";</code>
<code>}</code></pre>
                <p id="c05-para-0140" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">This example has two constructors that require specifying the
                    initial value of the vector, either by passing in the values of each component or by supplying
                    another <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                    whose value can be copied. Constructors like the second one, which takes a single <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code> argument,
                    are often termed <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">copy
                        constructors</i> because they effectively enable you to initialize a class or struct instance by
                    copying another instance.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                这个例子中有两个构造函数，需要指定向量的初始值，可以通过传递每个分量的值或提供一个可以复制其值的另一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                来实现。像第二个这样接受单个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                参数的构造函数，通常被称为拷贝构造函数，因为它们实际上使你能够通过复制另一个实例来初始化类或结构体实例。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Here is the interesting part of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code> struct—the
                    operator overload that provides support for the addition operator:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这是 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                结构体有趣的部分——提供对加法运算符支持的运算符重载：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0069"><code>public static Vector <b>operator +</b>(Vector left, Vector right) =&gt;</code>
<code>  new Vector(left.X + right.X, left.Y + right.Y, left.Z + right.Z); </code></pre>
                <p id="c05-para-0142" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The operator overload is declared in much the same way as a
                    static method, except that the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">operator</code> keyword
                    tells the compiler it is actually an operator overload you are defining. The <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">operator</code> keyword
                    is followed by the actual symbol for the relevant operator, in this case the addition operator
                    (<code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code>). The return
                    type is whatever type you get when you use this operator. Adding two vectors results in a vector;
                    therefore, the return type is also a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>. For this
                    particular override of the addition operator, the return type is the same as the containing class,
                    but that is not necessarily the case, as you see later in this example. The two parameters are the
                    things you are operating on. For binary operators (those that take two parameters), such as the
                    addition and subtraction operators, the first parameter is the value on the left of the operator,
                    and the second parameter is the value on the right.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">运算符重载的声明方式与静态方法类似，只是 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">operator</code>
                                关键字告诉编译器你正在定义的是一个运算符重载。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">operator</code>
                                关键字后面跟着相关运算符的实际符号，在这个例子中是加法运算符（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code>
                                ）。返回类型是你使用这个运算符时得到的结果类型。两个向量相加的结果是一个向量；因此，返回类型也是一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                。对于这个特定的加法运算符重载，返回类型与包含它的类相同，但这并不一定是普遍情况，正如你在这段示例的后面所见。两个参数是你正在操作的实体。对于二元运算符（那些接受两个参数的运算符），例如加法和减法运算符，第一个参数是运算符左侧的值，第二个参数是运算符右侧的值。
                            </font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0143" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The implementation of this operator returns a new <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code> that is
                    initialized using the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">X</code>, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Y</code>, and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Z</code> fields from the
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">left</code> and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">right</code> variables.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这个运算符的实现返回一个新的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                ，它使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">left</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">right</code>
                                变量中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">X</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Y</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Z</code>
                                字段进行初始化。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0144" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">C# requires that all operator overloads be declared as <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">public</code> and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">static</code>, which
                    means they are associated with their class or struct, not with a particular instance. Because of
                    this, the body of the operator overload has no access to nonstatic class members or the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">this</code> identifier.
                    This is fine because the parameters provide all the input data the operator needs to know to perform
                    its task.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">C# 要求所有运算符重载都必须声明为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">public</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">static</code>
                                ，这意味着它们与它们的类或结构相关联，而不是与特定的实例相关联。由于这个原因，运算符重载的体无法访问非静态类成员或 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">this</code>
                                标识符。这很好，因为参数提供了运算符执行任务所需的所有输入数据。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Now all you need to do is write some simple code to test the
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code> struct
                    (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorOverloadingSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在你只需要写一些简单的代码来测试 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Vector</code>
                                结构体（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorOverloadingSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0070"><code>Vector vect1, vect2, vect3;</code>
<code>vect1 = new(3.0, 3.0, 1.0);</code>
<code>vect2 = new(2.0, -4.0, -4.0);</code>
<code>vect3 = vect1 + vect2;</code>
<code>Console.WriteLine($"vect1 = {vect1}");</code>
<code>Console.WriteLine($"vect2 = {vect2}");</code>
<code>Console.WriteLine($"vect3 = {vect3}");</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Compiling and running this code returns the following result:
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">编译并运行这段代码会返回以下结果：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0071"><code>vect1 = ( 3, 3, 1 )</code>
<code>vect2 = ( 2, -4, -4 )</code>
<code>vect3 = ( 5, -1, -3 )</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1"><span aria-label="139" epub:type="pagebreak" id="Page_139"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>Just by
                    implementing the + operator, you can use the compound assignment operator <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+=</code>. Let's add
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">vect2</code> to the
                    existing value of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">vect3</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">只需实现 + 运算符，你就可以使用复合赋值运算符 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+=</code>
                                。让我们将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">vect2</code>
                                加到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">vect3</code>
                                的现有值上：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0072"><code>vect3 += vect2;</code>
<code>Console.WriteLine($"vect3 = {vect3}");</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">This compiles and runs, resulting in the following:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这编译并运行，结果如下：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0073"><code>vect3 = ( 7, -5, -7)</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">In addition to adding vectors, you can multiply and subtract
                    them and compare their values. These operators can be implemented in the same way as the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code> operator. What
                    might be more interesting is multiplying a vector by a double. With the following three operator
                    overloads, a vector is multiplied by a vector, a vector is multiplied by a double, and a double is
                    multiplied by a vector. You need to implement the different operators depending what's on the left
                    and right sides, but you can reuse implementations. The operator overload where the vector is on the
                    left and the double on the right just reuses the operator overload where the arguments are changed
                    (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorOverloadingSample/Vector.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                除了可以添加向量外，还可以对向量进行乘法和减法运算，并比较它们的值。这些运算符的实现方式与 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">+</code>
                                运算符相同。可能更有趣的是将向量与一个 double 相乘。通过以下三个运算符重载，可以实现向量与向量相乘、向量与 double 相乘以及 double
                                与向量相乘。你需要根据左右操作数的不同来分别实现这些运算符，但可以重用实现代码。当向量位于左侧而 double 位于右侧的运算符重载，会重用改变参数顺序的运算符重载（代码文件
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">OperatorOverloadingSample/Vector.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0074"><code>public static Vector <b>operator *(Vector left, Vector right)</b> =&gt;</code>
<code>  new Vector(left.X * right.X, left.Y * right.Y, left.Z * right.Z);</code>
<code> </code>
<code>public static Vector <b>operator *(double left, Vector right)</b> =&gt;</code>
<code>  new Vector(left * right.X, left * right.Y, left * right.Z);</code>
<code> </code>
<code>public static Vector <b>operator *(Vector left, double right)</b> =&gt;</code>
<code>  right * left;</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The operators are used in the following code snippet. The
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> number used
                    is converted to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code> because
                    this is the best match for the overload:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">以下代码片段展示了这些运算符的使用。使用的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                数值被转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                ，因为这是与运算符重载的最佳匹配：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0075"><code>Console.WriteLine($"2 * vect3 = {2 * vect3}");</code>
<code>Console.WriteLine($"vect3 += vect2 gives {vect3 += vect2}");</code>
<code>Console.WriteLine($"vect3 = vect1 * 2 gives {vect3 = vect1 * 2}");</code>
<code>Console.WriteLine($"vect1 * vect3 = {vect1 * vect3}");</code></pre>
                <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <p id="c05-para-0152" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">There's an
                                important restriction on operator overloading. Because operator overloads are defined
                                using a static member, you cannot add static members to an interface contract. This
                                might change in a future C# version; interfaces just got an improvement with C# 8 and
                                default interface methods. Some more improvements have already been discussed.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">
                                        注意：运算符重载有一个重要的限制。因为运算符重载是通过静态成员定义的，所以你不能向接口合约中添加静态成员。这在未来版本的 C#中可能会改变；接口随着 C# 8
                                        得到了改进，并引入了默认接口方法。一些其他的改进已经讨论过了。</font>
                                </font>
                            </font>
                        </p>
                        <p id="c05-para-0153" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                                data-immersive-translate-paragraph="1">In case you need operator overloads with generic
                                types, you can create constraints on classes. The types can also be abstract classes and
                                generic types. With generic types, you can implement operator overloads.<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">
                                            如果你需要在泛型类型中使用运算符重载，你可以对类创建约束。这些类型也可以是抽象类和泛型类型。通过泛型类型，你可以实现运算符重载。</font>
                                    </font>
                                </font></i></p>
                        <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section>
        </section>
        <section aria-labelledby="head-2-46" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
            <span id="c05-sec-0038" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <h2 id="head-2-46" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">COMPARING OBJECTS FOR EQUALITY<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">比较对象以判断相等性</font>
                    </font>
                </font>
            </h2>
            <p id="c05-para-0154" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">Comparing objects for equality has become easier with C# 9 and
                records. Records already have built-in functionality to compare the values of the type. Let's look at
                what's implemented with records (what you can override) and what you need to do with classes and
                structs.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">随着 C# 9
                            和记录的引入，比较对象以判断相等性变得更加简单。记录已经内置了比较类型值的功能。让我们看看记录实现了什么（你可以重写什么），以及你需要如何处理类和结构体。</font>
                    </font>
                </font>
            </p>
            <p id="c05-para-0155" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">To compare references, the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code> class defines
                the static method <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ReferenceEquals</code>. This
                is not a comparison by value; instead it just compares the variables if they reference the same object
                in the heap. The functionality is the same for classes and records. Comparing two variables referencing
                the same object in the heap returns <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code>. If the two
                variables reference different objects in the heap, the method returns <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>, even if the
                content of the two objects is the same. Using this method to compare two variables referencing structs,
                new objects are created <span aria-label="140" epub:type="pagebreak" id="Page_140" role="doc-pagebreak"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>to reference the value
                type (known as <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">boxing</i>) and
                thus always returns <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>. The compiler
                warns on comparing structs this way.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要比较引用， <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code>
                            类定义了静态方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ReferenceEquals</code>
                            。这不是通过值来比较；而是仅仅比较变量是否引用堆中的同一个对象。类和记录的功能是相同的。比较两个引用堆中相同对象的变量返回 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code>
                            。如果两个变量引用堆中不同的对象，即使两个对象的内容相同，该方法也会返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>
                            。使用此方法比较引用 structs 的两个变量时，会创建新的对象来引用值类型（称为装箱），因此总是返回 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>
                            。编译器会对此种方式比较 structs 发出警告。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">The default implementation of the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code> class <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Equals</code> method just
                invokes <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object.ReferenceEquals</code>.
                In case you need to compare the values for equality, you can use the built-in functionality of the
                record type or create a custom implementation with the class. To compare the values of two reference
                types, you need to consider what's automatically implemented by a record and what you can implement when
                comparing classes for equality:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1"> <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code> 类的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Equals</code>
                            方法的默认实现只是调用了 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object.ReferenceEquals</code>
                            。如果你需要通过值来比较是否相等，可以使用记录类型的内置功能或使用类创建自定义实现。要比较两个引用类型的值，你需要考虑记录自动实现了什么，以及当通过值比较类时你可以实现什么：
                        </font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c05-list-0006" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <li id="c05-li-0025" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The object type defines the virtual method <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">bool Equals(object?)</code>
                    that can be overridden.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">对象类型定义了可被重写的虚拟方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">bool Equals(object?)</code>
                                。</font>
                        </font>
                    </font>
                </li>
                <li id="c05-li-0026" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The interface <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">IEquatable&lt;T&gt;</code>
                    defines the generic method <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">bool Equals(T? object)</code>
                    that can be implemented.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">接口 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">IEquatable&lt;T&gt;</code>
                                定义了通用方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">bool Equals(T? object)</code>
                                ，该方法可以被实现。</font>
                        </font>
                    </font>
                </li>
                <li id="c05-li-0027" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The operators <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">==</code> and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">!=</code> can be
                    overridden.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">操作符 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">==</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">!=</code>
                                可以被重写。</font>
                        </font>
                    </font>
                </li>
                <li id="c05-li-0028" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Records also implement an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">EqualityContract</code>,
                    which is used with the comparison to not only compare the values, but also if the comparison is done
                    with the same contract.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">记录也实现了一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">EqualityContract</code>
                                ，该接口用于比较时不仅比较值，还比较比较是否使用相同的契约。</font>
                        </font>
                    </font>
                </li>
            </ul>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">To compare references, the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Book</code> class implements
                the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">IEquatable&lt;Book&gt;</code>
                interface with the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">bool Equals(Book? other)</code>
                method. This method compares the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Title</code> and <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Publisher</code> properties.
                Similar to the record type, the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Book</code> class specifies
                the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">EqualityContract</code>
                property to also compare the type of the class. This way, comparing the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Title</code> and <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Publisher</code> properties
                with an object of another type returns always <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>. The
                implementation for equality comparison is only done with this method. The overridden <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Equals</code> method from the
                base class invokes this method, as well as the implementation for the operators <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">==</code> and <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">!=</code>. Implementing
                equality also requires overriding the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">GetHashCode</code> method
                from the base class (code file <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">EqualitySample/Book.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要比较引用， <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Book</code> 类实现了
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">IEquatable&lt;Book&gt;</code>
                            接口，并带有 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">bool Equals(Book? other)</code>
                            方法。该方法比较 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Title</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Publisher</code>
                            属性。类似于记录类型， <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Book</code> 类指定了
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">EqualityContract</code>
                            属性来比较类的类型。这样，使用其他类型的对象比较 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Title</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Publisher</code>
                            属性总是返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>
                            。相等比较的实现仅通过此方法完成。基类中重写的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Equals</code>
                            方法会调用此方法，以及操作符 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">==</code> 和 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">!=</code>
                            的实现。实现相等性也需要重写基类中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">GetHashCode</code>
                            方法（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">EqualitySample/Book.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0076"><code>class Book : IEquatable&lt;Book&gt;</code>
<code>{</code>
<code>  public Book(string title, string publisher)</code>
<code>  {</code>
<code>    Title = title;</code>
<code>    Publisher = publisher;</code>
<code>  }</code>
<code>  public string Title { get; }</code>
<code>  public string Publisher { get; }</code>
<code> </code>
<code>  protected virtual Type EqualityContract { get; } = typeof(Book);</code>
<code> </code>
<code>  public override string ToString() =&gt; Title;</code>
<code> </code>
<code>  public override bool Equals(object? obj) =&gt;</code>
<code>    this == obj as Book;</code>
<code> </code>
<code>  public override int GetHashCode() =&gt;</code>
<code>    Title.GetHashCode() ^ Publisher.GetHashCode();</code>
<code> </code>
<code>  public virtual bool Equals(Book? other) =&gt;</code>
<code>    this == other;</code>
<code> </code>
<code>  public static bool operator ==(Book? left, Book? right) =&gt;</code>
<code>    left?.Title == right?.Title &amp;&amp; left?.Publisher == right?.Publisher &amp;&amp;</code>
<code>    left?.EqualityContract == right?.EqualityContract;</code>
<code> </code>
<code>  public static bool operator !=(Book? left, Book? right) =&gt;</code>
<code>    !(left == right);</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span aria-label="141"
                    epub:type="pagebreak" id="Page_141" role="doc-pagebreak"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span></p>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <p id="c05-para-0159" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Don't be tempted to
                            overload the comparison operator by only calling the instance version of the </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Equals</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> method inherited
                            from </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Object</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">. If you do so and
                            then an attempt is made to evaluate </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">(objA == objB)</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, when </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">objA</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> happens to be
                        </i><code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, you get an
                            exception because the .NET runtime tries to evaluate </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null.Equals(objB)</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">. Working the other
                            way around (overriding </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Equals</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> to call the
                            comparison operator) should be safe.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 不要试图通过仅调用从 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Object</code>
                                    继承的实例版本的 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Equals</code>
                                    方法来重载比较运算符。如果你这样做，然后尝试评估 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">(objA == objB)</code>
                                    ，当 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">objA</code>
                                    恰好是 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                    时，你会因为 .NET 运行时试图评估 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null.Equals(objB)</code>
                                    而抛出异常。反过来（重载 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Equals</code>
                                    以调用比较运算符）应该是安全的。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside>
            <pre id="c05-code-0077"><code> </code> </pre>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <p id="c05-para-0161" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">To implement equality
                            comparison, some work is needed. With the record type, this work is done from the compiler.
                            If you use records within records, everything works out of the box. However, if you use
                            classes as record members, only references are compared—unless you implement equality
                            comparison.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意
                                    要实现相等性比较，需要做一些工作。对于记录类型，这项工作由编译器完成。如果你在记录中使用记录，一切都会开箱即用。但是，如果你将类作为记录成员使用，则只比较引用——除非你实现了相等性比较。
                                </font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">In the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Program.cs</code> file, two
                <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Book</code> objects are
                created that have the same content. Because there are two different objects in the heap, <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object.ReferenceEquals</code>
                returns <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>. Next,
                the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Equals</code> method
                from the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">IEquatable&lt;Book&gt;</code>
                interface, the overloaded <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object Equals</code>, and the
                operator <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">==</code> are
                used, and they all return <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code> because of the
                implemented value comparison (code file <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">EqualitySample/Program.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Program.cs</code>
                            文件中，创建了两个具有相同内容的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Book</code>
                            对象。由于堆中有两个不同的对象， <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object.ReferenceEquals</code>
                            返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">false</code>
                            。接下来，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Equals</code> 接口的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">IEquatable&lt;Book&gt;</code>
                            方法、重载的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object Equals</code>
                            以及操作符 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">==</code> ，它们都返回
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">true</code>
                            ，因为实现了值比较（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">EqualitySample/Program.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0078"><code>Book book1 = new("Professional C#", "Wrox Press");</code>
<code>Book book2 = new("Professional C#", "Wrox Press");</code>
<code> </code>
<code>if (!object.ReferenceEquals(book1, book2))</code>
<code>{</code>
<code>  Console.WriteLine("Not the same reference");</code>
<code>}</code>
<code> </code>
<code>if (book1.Equals(book2))</code>
<code>{</code>
<code>  Console.WriteLine("The same object using the generic Equals method");</code>
<code>}</code>
<code> </code>
<code>object book3 = book2;</code>
<code>if (book1.Equals(book3))</code>
<code>{</code>
<code>  Console.WriteLine("The same object using the overridden Equals method");</code>
<code>}</code>
<code> </code>
<code>if (book1 == book2)</code>
<code>{</code>
<code>  Console.WriteLine("The same book using the == operator");</code>
<code>}</code></pre>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <p id="c05-para-0164" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">For struct types,
                            similar functionality to classes applies; there are just a few important differences.
                            Remember, you can't use </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object.ReferenceEquals</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> with value types.
                            Another difference is that the </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object.Equals</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> method is already
                            overridden to compare the values. For more functionality with equality, similar to what has
                            been shown with the </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Book</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> class, implement the
                        </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">IEquality&lt;T&gt;</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> interface and
                            override the </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">==</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> and </i><code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">!=</code><i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> operators.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意
                                    对于结构类型，与类类似的功能适用；只是有几个重要的区别。记住，你不能使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object.ReferenceEquals</code>
                                    与值类型。另一个区别是 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object.Equals</code>
                                    方法已经重写为比较值。对于更多与相等性相关的功能，类似于 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Book</code>
                                    类中展示的，实现 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">IEquality&lt;T&gt;</code>
                                    接口并重写 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">==</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">!=</code>
                                    操作符。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside>
        </section> <span aria-label="142" epub:type="pagebreak" id="Page_142" role="doc-pagebreak"
            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
        <section aria-labelledby="head-2-47" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
            <span id="c05-sec-0042" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <h2 id="head-2-47" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">IMPLEMENTING CUSTOM INDEXERS<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">实现自定义索引器</font>
                    </font>
                </font>
            </h2>
            <p id="c05-para-0165" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">Custom indexers cannot be implemented using the operator
                overloading syntax, but they can be implemented with a syntax that looks similar to properties.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            自定义索引器不能使用运算符重载语法实现，但可以使用看起来类似于属性的语法实现。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">With the following code snippet, an array is created, and the
                indexer is used to access array elements. The second code line uses the indexer to access the second
                element and pass <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">42</code>
                to it. The third line uses the indexer to access the third element and pass the value of the element to
                the variable <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            通过以下代码片段，创建了一个数组，并使用索引器访问数组元素。第二行代码使用索引器访问第二个元素并将其传递给 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">42</code>
                            。第三行代码使用索引器访问第三个元素并将元素的值传递给变量 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">x</code> 。</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0079"><code>int[] arr1 = {1, 2, 3};</code>
<code>arr1[1] = 42;</code>
<code>int x = arr1[2];</code></pre>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <p id="c05-para-0168" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Arrays are explained
                            in <a href="c06.xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Chapter
                                6</a>.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意：数组在第六章中解释。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">To create a custom indexer, first create a <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code> record with the
                properties <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">FirstName</code>, <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">LastName</code>, and <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Birthday</code> (code file
                <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CustomIndexerSample/Person.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要创建自定义索引器，首先创建一个包含属性 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">FirstName</code>
                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">LastName</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Birthday</code> 的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                            记录（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CustomIndexerSample/Person.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0080"><code>public record Person(string FirstName, string LastName, DateTime Birthday)</code>
<code>{</code>
<code>  public override string ToString() =&gt; $"{FirstName} {LastName}";</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">The class <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">PersonCollection</code>
                defines a private array field that contains <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code> elements and a
                constructor where a number of <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code> objects can be
                passed (code file <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CustomIndexerSample/PersonCollection.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">类 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">PersonCollection</code>
                            定义了一个包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                            个元素的私有数组字段和一个构造函数，该构造函数可以传递多个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                            对象（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CustomIndexerSample/PersonCollection.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0081"><code>public class PersonCollection</code>
<code>{</code>
<code>  private Person[] _people;</code>
<code> </code>
<code>  public PersonCollection(params Person[] people) =&gt;</code>
<code>    _people = people.ToArray();</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">For allowing indexer-syntax to be used to access the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">PersonCollection</code> and
                return <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                objects, you can create an indexer. The indexer looks very similar to a property because it also
                contains <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code> and
                <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">set</code> accessors.
                What's different is the name. Specifying an indexer makes use of the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">this</code> keyword. The
                brackets that follow the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">this</code> keyword specify
                the type that is used with the index. An array offers indexers with the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> type, so <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> types are used
                here to pass the information directly to the contained array <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_people</code>. The use of
                the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">set</code> and <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code> accessors is
                similar to properties. The <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code> accessor is
                invoked when a value is retrieved; the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">set</code> accessor is
                invoked when a <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code> object is
                passed on the right side.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">为了允许使用索引器语法来访问 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">PersonCollection</code>
                            并返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                            个对象，可以创建一个索引器。索引器与属性非常相似，因为它也包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">set</code>
                            访问器。不同之处在于名称。指定索引器使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">this</code>
                            关键字。紧随 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">this</code>
                            关键字之后的括号指定了用于索引的类型。数组提供 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                            类型的索引器，因此这里使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                            类型将信息直接传递给包含的数组 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">_people</code>
                            。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">set</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code>
                            访问器与属性类似。当检索值时调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code>
                            访问器；当在右侧传递 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                            对象时调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">set</code> 访问器。
                        </font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0082"><code>public Person this[int index]</code>
<code>{</code>
<code>  get =&gt; _people[index];</code>
<code>  set =&gt; _people[index] = value;</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">With indexers, any type can be used as the indexing type. With
                the sample application, the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DateTime</code> struct is
                used. This indexer is used to return every person with a specified birthday. Because multiple people can
                have the same birthday, not a single <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code> object is
                returned; instead, a list of people is returned with the interface <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">IEnumerable&lt;Person&gt;</code>.
                With the implementation of the indexer, the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Where</code> method is used.
                A lambda expression is passed with the argument. The <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Where</code> method is
                defined in the namespace <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Linq</code>
                :<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用索引器时，任何类型都可以作为索引类型。在示例应用程序中，使用了
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DateTime</code>
                            结构体。这个索引器用于返回具有指定生日的人。由于多个人可能有相同的生日，因此不会返回单个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                            对象；相反，会返回一个具有 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">IEnumerable&lt;Person&gt;</code>
                            接口的人员列表。在索引器的实现中，使用了 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Where</code>
                            方法。通过传递一个带参数的 lambda 表达式。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Where</code> 方法在
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Linq</code>
                            命名空间中定义：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0083"><span aria-label="143" epub:type="pagebreak" id="Page_143" role="doc-pagebreak"></span>
<code>public IEnumerable&lt;Person&gt; this[DateTime birthDay]</code>
<code>{</code>
<code>  get =&gt; _people.<b>Where</b>(p =&gt; p.Birthday == birthDay);</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">The indexer using the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DateTime</code> type lets you
                retrieve <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                objects but doesn't allow you to set <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code> objects because
                there's a <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code>
                accessor but no <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">set</code>
                accessor. A shorthand notation exists to create the same code with an expression-bodied member (the same
                syntax available with properties):<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DateTime</code>
                            类型的索引器可以让你检索 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                            对象，但不能让你设置 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code>
                            对象，因为存在 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code> 访问器但没有
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">set</code>
                            访问器。存在一种简写符号，可以用表达式主体成员来创建相同的代码（与属性相同的语法可用）：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0084"><code>public IEnumerable&lt;Person&gt; this[DateTime birthDay] =&gt;</code>
<code>  _people.Where(p =&gt; p.Birthday == birthDay); </code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">With the top-level statements of the sample application, a <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">PersonCollection</code>
                object with four <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code> objects is
                created. With the first <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code> method, the
                third element is accessed using the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code> accessor of the
                indexer with the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                parameter. Within the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">foreach</code> loop, the
                indexer with the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DateTime</code> parameter is
                used to pass a specified date (code file <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CustomIndexerSample/Program.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在示例应用程序的顶层语句中，创建了一个包含四个 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Person</code> 对象的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">PersonCollection</code>
                            对象。通过第一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                            方法，使用具有 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                            参数的索引器的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">get</code>
                            访问器来访问第三个元素。在 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">foreach</code>
                            循环中，使用具有 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">DateTime</code>
                            参数的索引器来传递指定日期（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CustomIndexerSample/Program.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0085"><code>  Person p1 = new("Ayrton", "Senna", new DateTime(1960, 3, 21));</code>
<code>  Person p2 = new("Ronnie", "Peterson", new DateTime(1944, 2, 14));</code>
<code>  Person p3 = new("Jochen", "Rindt", new DateTime(1942, 4, 18));</code>
<code>  Person p4 = new("Francois", "Cevert", new DateTime(1944, 2, 25));</code>
<code>  PersonCollection coll = new(p1, p2, p3, p4);</code>
<code>  Console.WriteLine(coll[2]);</code>
<code>  foreach (var r in coll[new DateTime(1960, 3, 21)])</code>
<code>  {</code>
<code>    Console.WriteLine(r);</code>
<code>  }</code>
<code>  Console.ReadLine();</code></pre>
            <p id="c05-para-0175" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">When you run the program, the first <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code> method
                writes <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Jochen Rindt</code>
                to the console; the result of the <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">foreach</code> loop is <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Ayrton Senna</code> because
                that person has the same birthday as is assigned within the second indexer.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">运行程序时，第一个 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                            方法将 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Jochen Rindt</code>
                            写入控制台； <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">foreach</code>
                            循环的结果是 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Ayrton Senna</code>
                            ，因为那个人与第二个索引器中分配的生日相同。</font>
                    </font>
                </font>
            </p>
        </section>
        <section aria-labelledby="head-2-48" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
            <span id="c05-sec-0044" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <h2 id="head-2-48" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">USER-DEFINED CONVERSIONS<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">用户自定义转换</font>
                    </font>
                </font>
            </h2>
            <p id="c05-para-0176" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">Earlier in this chapter (see the “Explicit Conversions” section),
                you learned that you can convert values between predefined data types through a process of casting. You
                also saw that C# allows two different types of casts: implicit and explicit. This section looks at these
                types of casts.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            在本章之前（参见“显式转换”部分），您学习了可以通过强制转换的过程在预定义数据类型之间转换值。您还看到 C# 允许两种类型的强制转换：隐式和显式。本节将探讨这些类型的强制转换。
                        </font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">For an explicit cast, you explicitly mark the cast in your code
                by including the destination data type inside parentheses:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">对于显式类型转换，你通过在代码中用括号括起目标数据类型来显式标记转换：
                        </font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0086"><code>int i = 3;</code>
<code>long l = i; // implicit</code>
<code>short s = (short)i; // explicit</code></pre>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">For the predefined data types, explicit casts are required where
                there is a risk that the cast might fail or some data might be lost. The following are some examples:
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            对于预定义的数据类型，当存在转换可能失败或数据可能丢失的风险时，需要显式转换。以下是一些示例：</font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c05-list-0007" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <li id="c05-li-0029" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">When converting from an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code>, the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code> might not be
                    large enough to hold the value of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当从 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                转换到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code>
                                时， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">short</code>
                                可能不足以容纳 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                的值。</font>
                        </font>
                    </font>
                </li>
                <li id="c05-li-0030" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">When converting from signed to unsigned data types, incorrect
                    results are returned if the signed variable holds a negative value.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                当从有符号类型转换为无符号类型时，如果有符号变量包含负值，则返回不正确的结果。</font>
                        </font>
                    </font>
                </li>
                <li id="c05-li-0031" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">When converting from floating-point to integer data types,
                    the fractional part of the number will be lost.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当从浮点类型转换为整型时，数值的小数部分将被丢失。</font>
                        </font>
                    </font>
                </li>
                <li id="c05-li-0032" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">When converting from a nullable type to a non-nullable type,
                    a value of <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                    causes an exception.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当从可空类型转换为非可空类型时， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">null</code>
                                值会导致异常。</font>
                        </font>
                    </font>
                </li>
            </ul>
            <p id="c05-para-0179" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1"><span aria-label="144" epub:type="pagebreak" id="Page_144"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>By making the cast
                explicit in your code, C# forces you to affirm that you understand there is a risk of data loss, and
                therefore presumably you have written your code to take this into account.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">通过在代码中显式地进行转换，C#
                            迫使你必须确认你理解存在数据丢失的风险，因此你大概已经编写了考虑了这种情况的代码。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">Because C# allows you to define your own data types (structs and
                classes), it follows that you need the facility to support casts to and from those data types. The
                mechanism is to define a cast as a member operator of one of the relevant classes. Your cast operator
                must be marked as either <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">implicit</code> or <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">explicit</code> to indicate
                how you intend it to be used. The expectation is that you follow the same guidelines as for the
                predefined casts: if you know that the cast is always safe regardless of the value held by the source
                variable, then you define it as <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">implicit</code>. Conversely,
                if you know there is a risk of something going wrong for certain values—perhaps some loss of data or an
                exception being thrown—then you should define the cast as <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">explicit</code>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">由于 C#
                            允许你定义自己的数据类型（结构体和类），因此它也提供了支持向这些数据类型进行转换的功能。其机制是将转换定义为一个相关类的成员运算符。你的转换运算符必须标记为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">implicit</code> 或
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">explicit</code>
                            来指示你打算如何使用它。预期你应该遵循预定义转换的相同指南：如果你知道转换始终是安全的，无论源变量持有的值如何，那么你应该将其定义为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">implicit</code>
                            。相反，如果你知道对于某些值存在出错的风险——可能是一些数据丢失或抛出异常——那么你应该将转换定义为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">explicit</code> 。
                        </font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <p id="c05-para-0181" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">You should define any
                            custom casts you write as explicit if there are any source data values for which the cast
                            will fail or if there is any risk of an exception being thrown.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意
                                    如果你编写的任何自定义转换存在任何源数据值会导致转换失败的情况，或者存在抛出异常的风险，你应该将其定义为显式转换。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                </section>
            </aside>
            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">The syntax for defining a cast is similar to that for overloading
                operators discussed earlier in this chapter. This is not a coincidence—a cast is regarded as an operator
                whose effect is to convert from the source type to the destination type. To illustrate the syntax, the
                following is taken from an example <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">struct</code> named <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>, which is
                introduced in the next section, “Implementing User-Defined Casts”:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            定义强制转换的语法与本章前面讨论的运算符重载语法相似。这不是巧合——强制转换被视为一种运算符，其作用是从源类型转换为目标类型。为了说明语法，以下内容来自一个名为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                            的示例 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">struct</code>
                            ，该示例将在下一节“实现用户自定义强制转换”中介绍：</font>
                    </font>
                </font>
            </p>
            <pre id="c05-code-0087"><code>public static <b>implicit operator float</b> (Currency value)</code>
<code>{</code>
<code>  // processing</code>
<code>}</code></pre>
            <p id="c05-para-0183" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">The return type of the operator defines the target type of the
                cast operation, and the single parameter is the source object for the conversion. The cast defined here
                allows you to implicitly convert the value of a <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> into a <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>. Note that if a
                conversion has been declared as <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">implicit</code>, the compiler
                permits its use either implicitly or explicitly. If it has been declared as <code
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">explicit</code>, the compiler
                only permits it to be used explicitly. Similar to other operator overloads, casts must be declared as
                both <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">public</code> and
                <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">static</code>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            运算符的返回类型定义了强制转换操作的目标类型，单个参数是转换的源对象。这里定义的强制转换允许你将 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                            的值隐式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                            。请注意，如果转换已被声明为 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">implicit</code>
                            ，编译器允许其隐式或显式使用。如果它已被声明为 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">explicit</code>
                            ，编译器仅允许其显式使用。与其他运算符重载类似，强制转换必须同时声明为 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">public</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">static</code> 。
                        </font>
                    </font>
                </font>
            </p>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0046"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-137" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Implementing User-Defined Casts <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">实现用户自定义强制转换</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">This section illustrates the use of implicit and explicit
                    user-defined casts in an example called <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample</code>. In
                    this example, you define a struct, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>, which
                    holds a positive USD ($) monetary value. C# provides the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">decimal</code> type for
                    this purpose, but it is possible you still will want to write your own struct or class to represent
                    monetary values if you need to perform sophisticated financial processing and therefore want to
                    implement specific methods on such a class.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">本节通过一个名为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample</code>
                                的示例，说明了隐式和显式用户自定义类型转换的使用。在这个示例中，你定义了一个结构体 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                ，用于存储正美的货币值。C#提供了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">decimal</code>
                                类型用于此目的，但如果你需要进行复杂的金融处理，并且因此希望在类上实现特定的方法，你可能仍然需要编写自己的结构体或类来表示货币值。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <p id="c05-para-0185" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">The syntax for
                                casting is the same for structs and classes. This example happens to be for a struct,
                                but it would work just as well if you declared </i>
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                            <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> as a class.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">
                                        注意：结构体和类的类型转换语法相同。这个例子恰好是针对结构体的，但如果将 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                        声明为类，它同样适用。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Initially, the definition of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> struct is
                    as follows (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample/Currency.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">最初， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                结构体的定义如下（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample/Currency.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0088"><code>public readonly struct Currency</code>
<code>{</code>
<code>  public readonly uint Dollars;</code>
<code>  public readonly ushort Cents;</code>
<code> <span aria-label="145" epub:type="pagebreak" id="Page_145" role="doc-pagebreak"></span></code>
<code>  public Currency(uint dollars, ushort cents) =&gt; (Dollars, Cents) = (dollars, cents);</code>
<code> </code>
<code>  public override string ToString() =&gt; $"${Dollars}.{Cents,-2:00}";</code>
<code>}</code></pre>
                <p id="c05-para-0187" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The use of unsigned data types for the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Dollar</code> and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Cents</code> fields
                    ensures that a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> instance
                    can hold only positive values. It is restricted this way to illustrate some points about explicit
                    casts later. You might want to use a type like this to hold, for example, salary information for
                    company employees (people's salaries tend not to be negative!).<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Dollar</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Cents</code>
                                字段使用无符号数据类型，确保 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                实例只能包含正值。这种方式限制是为了后面说明显式类型转换的一些要点。你可能需要使用这种类型来存储例如公司员工的薪资信息（人们的薪资通常不会是负数！）。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Start by assuming that you want to be able to convert <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> instances
                    to <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> values,
                    where the integer part of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> represents
                    the dollars. In other words, you want to be able to write code like this:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">首先，假设你想能够将 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                实例转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                值，其中 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                的整数部分代表美元。换句话说，你想能够编写如下代码：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0089"><code>Currency balance = new(10, 50);</code>
<code>float f = balance; // We want f to be set to 10.5</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">To be able to do this, you need to define a cast. Hence, you
                    add the following to your <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                    definition:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要实现这一点，你需要定义一个强制类型转换。因此，你需要在你的
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                定义中添加以下内容：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0090"><code>public static implicit operator float (Currency value) =&gt;</code>
<code>  value.Dollars + (value.Cents/100.0f);</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The preceding cast is implicit. It is a sensible choice in
                    this case because, as it should be clear from the definition of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>, any
                    value that can be stored in the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> can also
                    be stored in a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>. There is no
                    way that anything should ever go wrong in this cast.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">前面的转换是隐式的。在这种情况下这是一个明智的选择，因为从
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                的定义来看应该很清楚，任何可以存储在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                中的值也可以存储在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                中。这种转换不可能出错。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <p id="c05-para-0191" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">There is a slight
                                cheat here. In fact, when converting a </i>
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                            <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> to a </i>
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                            <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">, there can be a
                                loss in precision, but Microsoft has deemed this error sufficiently marginal to count
                                the </i>
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                            <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">-to-</i>
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                            <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> cast as
                                implicit.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意这里有一点小欺骗。实际上，当将 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                        转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                        时，可能会丢失精度，但微软认为这种错误足够边缘，以至于将 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                        -到- <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                        转换计为隐式。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">However, if you have a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> that you
                    would like to be converted to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>, the
                    conversion is not guaranteed to work. A <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> can store
                    negative values, whereas <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> instances
                    can't, and a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> can store
                    numbers of a far higher magnitude than can be stored in the (<code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>) <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Dollar</code> field of
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>.
                    Therefore, if a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> contains an
                    inappropriate value, converting it to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> could
                    give unpredictable results. Because of this risk, the conversion from <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> should be
                    defined as explicit. Here is the first attempt, which does not return quite the correct results, but
                    it is instructive to examine why:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">然而，如果你有一个想要转换为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                ，这种转换并不保证能成功。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                可以存储负值，而 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                实例不能，并且 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                可以存储比 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                的 ( <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> )
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Dollar</code>
                                字段能存储的更高的数值。因此，如果 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                包含不合适的值，将其转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                可能会导致不可预测的结果。由于这种风险，从 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                的转换应该定义为显式。这是第一次尝试，它并没有返回完全正确的结果，但检查原因是有益的：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0091"><code>public static explicit operator Currency (float value)</code>
<code>{</code>
<code>  uint dollars = (uint)value;</code>
<code>  ushort cents = (ushort)((value-dollars)*100);</code>
<code>  return new Currency(dollars, cents);</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The following code now successfully compiles:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在以下代码成功编译了：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0092"><code>float amount = 45.63f;</code>
<code>Currency amount2 = (Currency)amount;</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">However, the following code, if you tried it, would generate
                    a compilation error because it attempts to use an explicit cast implicitly:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                然而，如果你尝试运行以下代码，它会生成编译错误，因为它试图隐式地使用显式转换：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0093"><code>float amount = 45.63f;</code>
<code>Currency amount2 = amount; // wrong</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">By making the cast explicit, you warn the developer to be
                    careful because data loss might occur. However, as you will soon see, this is not how you want your
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> struct
                    to behave. Try writing a test harness and running <span aria-label="146" epub:type="pagebreak"
                        id="Page_146" role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>the sample. Here
                    is the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Main</code>
                    method, which instantiates a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> struct
                    and attempts a few conversions. At the start of this code, you write out the value of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance</code> in two
                    different ways—this is needed to illustrate something later in the example (code file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                通过显式转换，你提醒开发者要小心，因为可能会发生数据丢失。然而，正如你很快就会看到的那样，这并不是你希望你的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                结构体表现的方式。试着写一个测试框架并运行示例。以下是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Main</code>
                                方法，它实例化一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                结构体并尝试进行几次转换。在这段代码的开头，你以两种不同的方式输出了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance</code>
                                的值——这是为了说明示例后面的一些内容（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0094"><code>  try</code>
<code>  {</code>
<code>    Currency balance = new(50,35);</code>
<code>    Console.WriteLine(balance);</code>
<code>    Console.WriteLine($"balance is {balance}"); // implicitly invokes ToString</code>
<code>    float balance2 = balance;</code>
<code>    Console.WriteLine($"After converting to float, = {balance2}");</code>
<code>    balance = (Currency) balance2;</code>
<code>    Console.WriteLine($"After converting back to Currency, = {balance}");</code>
<code>    Console.WriteLine("Now attempt to convert out of range value of " +</code>
<code>      "-$50.50 to a Currency:");</code>
<code> </code>
<code>    checked</code>
<code>    {</code>
<code>      balance = (Currency) (-50.50);</code>
<code>      Console.WriteLine($"Result is {balance}");</code>
<code>    }</code>
<code>  }</code>
<code>  catch(Exception e)</code>
<code>  {</code>
<code>    Console.WriteLine($"Exception occurred: {e.Message}");</code>
<code>  }</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Notice that the entire code is placed in a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">try</code> block to catch
                    any exceptions that occur during your casts. In addition, the lines that test converting an
                    out-of-range value to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> are
                    placed in a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code> block in
                    an attempt to trap negative values. Running this code produces the following output:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">注意，整个代码被放置在一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">try</code>
                                块中，以捕获转换过程中发生的任何异常。此外，测试将超出范围的值转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                的那些行被放置在一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                块中，试图捕获负值。运行这段代码会产生以下输出：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0095"><code>50.35</code>
<code>Balance is $50.35</code>
<code>After converting to float, = 50.35</code>
<code>After converting back to Currency, = $50.34</code>
<code>Now attempt to convert out of range value of -$50.50 to a Currency:</code>
<code>Result is $4294967246.00</code></pre>
                <p id="c05-para-0197" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">This output shows that the code did not quite work as
                    expected. First, converting back from <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> gave a
                    wrong result of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">$50.34</code> instead of
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">$50.35</code>. Second,
                    no exception was generated when you tried to convert an obviously out-of-range value.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这个输出表明代码并没有完全按预期工作。首先，从 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                转换回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                得到了错误的结果 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">$50.34</code>
                                而不是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">$50.35</code>
                                。其次，当你尝试转换一个明显超出范围的值时，并没有生成异常。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0198" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The first problem is caused by rounding errors. If a cast is
                    used to convert from a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>, the computer
                    truncates the number rather than rounds it. The computer stores numbers in binary rather than
                    decimal, and the fraction 0.35 cannot be exactly represented as a binary fraction (just as 1∕3
                    cannot be represented exactly as a decimal fraction; it comes out as 0.3333 recurring). The computer
                    ends up storing a value very slightly lower than 0.35 that can be represented exactly in binary
                    format. Multiply by 100, and you get a number fractionally less than 35, which is truncated to 34
                    cents. Clearly, in this situation, such errors caused by truncation are serious, and the way to
                    avoid them is to ensure that some intelligent rounding is performed in numerical conversions.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">第一个问题是由舍入误差引起的。如果使用强制类型转换将 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                ，计算机会对数值进行截断而不是四舍五入。计算机以二进制形式存储数值而不是十进制，小数 0.35 不能精确地表示为二进制小数（就像 1∕3 不能精确地表示为十进制小数；它表现为
                                0.3333 循环）。最终，计算机存储了一个略低于 0.35 的值，这个值可以用二进制格式精确表示。乘以 100 后，得到一个略低于 35 的数值分数，被截断为 34
                                分。显然，在这种情况下，由截断引起的这种误差是严重的，避免这些误差的方法是在数值转换中确保进行一些智能舍入。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0199" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Luckily, Microsoft has written a class that does this: <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Convert</code>.
                    The <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Convert</code>
                    object contains a large number of static methods to perform various numerical conversions, and the
                    one that we want is <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Convert.ToUInt16</code>.
                    Note that the extra care taken by the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Convert</code>
                    methods comes at a performance cost. You should use them only when necessary.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">幸运的是，微软编写了一个类来处理这个问题： <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Convert</code>
                                。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Convert</code>
                                对象包含许多静态方法来执行各种数值转换，我们想要的是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Convert.ToUInt16</code>
                                。请注意， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Convert</code>
                                方法所采取的额外小心是以性能为代价的。只有在必要时才应该使用它们。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0200" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Let's examine the second problem—why the expected overflow
                    exception wasn't thrown. The issue here is that the place where the overflow really occurs isn't
                    actually in the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Main</code> routine at
                    all—it is inside the <span aria-label="147" epub:type="pagebreak" id="Page_147" role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>code for the cast
                    operator, which is called from the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Main</code> method. The
                    code in this method was not marked as <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                让我们来分析第二个问题——为什么预期的溢出异常没有被抛出。这里的问题在于，真正的溢出发生的地方根本不是在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Main</code>
                                例程中，而是在从 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Main</code>
                                方法调用的转换操作符代码内部。这个方法中的代码没有被标记为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The solution is to ensure that the cast itself is computed in
                    a <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                    context, too. With both this change and the fix for the first problem, the revised code for the
                    conversion looks like the following:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">解决方案是确保转换本身也是在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                上下文中计算的。结合这个更改和第一个问题的修复，转换的修改后代码如下：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0096"><code>public static explicit operator Currency (float value)</code>
<code>{</code>
<code>  checked</code>
<code>  {</code>
<code>    uint dollars = (uint)value;</code>
<code>    ushort cents = Convert.ToUInt16((value-dollars)*100);</code>
<code>    return new Currency(dollars, cents);</code>
<code>  }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Note that you use <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Convert.ToUInt16</code>
                    to calculate the cents, as described earlier, but you do not use it for calculating the dollar part
                    of the amount. <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Convert</code> is
                    not needed when calculating the dollar amount because truncating the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> value is
                    what you want there.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">请注意，如之前所述，你使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Convert.ToUInt16</code>
                                来计算分，但你并不用它来计算金额的美元部分。在计算金额的美元部分时不需要 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Convert</code>
                                ，因为那里需要的是截断 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                值。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <p id="c05-para-0203" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">The </i>
                            <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Convert</code>
                            <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> methods also
                                carry out their own overflow checking. Hence, for the particular case we are
                                considering, there is no need to place the call to </i>
                            <code
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Convert.ToUInt16</code>
                            <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> inside the
                                checked context. The checked context is still required, however, for the explicit
                                casting of </i>
                            <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">value</code>
                            <i data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> to dollars.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意： <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Convert</code>
                                        方法也会执行它们自己的溢出检查。因此，对于我们正在考虑的特定情况，没有必要将 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Convert.ToUInt16</code>
                                        调用放在受检查的上下文中。然而，对于将 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">value</code>
                                        显式转换为美元，仍然需要受检查的上下文。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">You won't look at the new results with this new <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code> cast just
                    yet because you have some more modifications to make to the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample</code>
                    example later in this section.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你暂时还不会用这个新的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">checked</code>
                                转换来查看新结果，因为这个部分的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample</code>
                                示例后面你还需要做一些修改。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                    <div class="top hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <p id="c05-para-0205" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">NOTE</b> <i
                                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">If you are
                                defining a cast that will be used very often, and for which performance is at an
                                absolute premium, you may prefer not to do any error checking. That is also a legitimate
                                solution, provided that the behavior of your cast and the lack of error checking are
                                very clearly documented.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意
                                        如果你定义的转换会非常频繁使用，并且对性能要求绝对严格，你可能更倾向于不做任何错误检查。这也是一个合法的解决方案，只要你的转换行为和没有错误检查的情况都非常明确地记录在文档中。
                                    </font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <hr />
                        </div>
                    </section>
                </aside>
                <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0051"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                    <h4 id="head-4-29" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Casts Between Classes<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                            <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">类之间的转换</font>
                            </font>
                        </font>
                    </h4>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">The <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        example involves only classes that convert to or from <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                        —one of the predefined data types. However, it is not necessary to involve any of the simple
                        data types. It is perfectly legitimate to define casts to convert between instances of different
                        structs or classes that you have defined. You need to be aware of a couple of restrictions,
                        however:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1"> <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    示例仅涉及能够转换为或从 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                    转换的类——其中一种预定义的数据类型。然而，无需涉及任何简单数据类型。定义转换不同 struct 或 class 实例之间的转换是完全合法的。不过，您需要了解一些限制：
                                </font>
                            </font>
                        </font>
                    </p>
                    <ul class="check" id="c05-list-0008"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                        <li id="c05-li-0033" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">You cannot define a cast if one of the classes is
                            derived from the other (these types of casts already exist, as you will see later).<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">
                                        如果其中一个是另一个的派生类，则不能定义转换（这些类型的转换已经存在，正如您稍后将看到的）。</font>
                                </font>
                            </font>
                        </li>
                        <li id="c05-li-0034" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                            data-immersive-translate-paragraph="1">The cast must be defined inside the definition of
                            either the source or the destination data type.<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">转换必须定义在源数据类型或目标数据类型的定义内部。
                                    </font>
                                </font>
                            </font>
                        </li>
                    </ul>
                    <p id="c05-para-0207" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">To illustrate these requirements, suppose that you have
                        the class hierarchy shown in <a href="#c05-fig-0001" id="R_c05-fig-0001"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Figure 5-1</a>.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">为了说明这些要求，假设你有一个如图 5-1
                                    所示的类层次结构。</font>
                            </font>
                        </font>
                    </p> <span aria-label="148" epub:type="pagebreak" id="Page_148" role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                    <figure data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"> <img
                            alt="Schematic illustration of casts between classes." class="center"
                            src="images/c05f001.png" />
                        <figcaption data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
                            <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span
                                    class="figureLabel"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><a
                                        href="#R_c05-fig-0001" id="c05-fig-0001" role="doc-backlink"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><b
                                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                                            data-immersive-translate-paragraph="1">FIGURE 5-1<font
                                                class="notranslate immersive-translate-target-wrapper"
                                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                                <font class="notranslate"
                                                    data-immersive-translate-translation-element-mark="1">  </font>
                                                <font
                                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                                    data-immersive-translate-translation-element-mark="1">
                                                    <font
                                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                                        data-immersive-translate-translation-element-mark="1">图 5-1
                                                    </font>
                                                </font>
                                            </font></b></a></span></p>
                        </figcaption>
                    </figure>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">In other words, classes <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">C</code> and <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">D</code> are
                        indirectly derived from <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">A</code>. In this
                        case, the only legitimate user-defined cast between <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">A</code>, <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">B</code>, <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">C</code>, or <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">D</code> would be to
                        convert between classes <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">C</code> and <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">D</code>, because
                        these classes are not derived from each other. The code for this might look like the following
                        (assuming you want the casts to be explicit, which is usually the case when defining casts
                        between user-defined classes):<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">换句话说，类 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">C</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">D</code>
                                    是间接派生自 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">A</code>
                                    。在这种情况下， <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">A</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">B</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">C</code>
                                    或 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">D</code>
                                    之间唯一合法的用户定义转换将是类 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">C</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">D</code>
                                    之间的转换，因为这些类彼此不派生。这段代码可能看起来像下面这样（假设你想让转换是显式的，这在定义用户自定义类之间的转换时通常是这种情况）：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0097"><code>public static explicit operator D(C value)</code>
<code>{</code>
<code>  //…</code>
<code>}</code>
<code> </code>
<code>public static explicit operator C(D value)</code>
<code>{</code>
<code>  //…</code>
<code>}</code></pre>
                    <p id="c05-para-0209" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">For each of these casts, you can choose where you place
                        the definitions—inside the class definition of <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">C</code> or inside
                        the class definition of <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">D</code>, but not
                        anywhere else. C# requires you to put the definition of a cast inside either the source class
                        (or struct) or the destination class (or struct). A side effect of this is that you cannot
                        define a cast between two classes unless you have access to edit the source code for at least
                        one of them. This is sensible because it prevents third parties from introducing casts into your
                        classes.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">对于这些转换中的每一个，你可以选择在哪里放置定义——在
                                    <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">C</code>
                                    的类定义内部或 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">D</code>
                                    的类定义内部，但不能放在其他任何地方。C#要求你必须将转换的定义放在源类（或结构体）或目标类（或结构体）内部。这个副作用是，除非你可以访问至少一个类的源代码进行编辑，否则你不能在两个类之间定义转换。这是合理的，因为它可以防止第三方将转换引入你的类中。
                                </font>
                            </font>
                        </font>
                    </p>
                    <p id="c05-para-0210" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">After you have defined a cast inside one of the classes,
                        you cannot also define the same cast inside the other class. Obviously, there should be only one
                        cast for each conversion; otherwise, the compiler would not know which one to use.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    在某个类中定义了转换后，你不能再在另一个类中定义相同的转换。显然，每种转换应该只有一个转换；否则，编译器将不知道该使用哪一个。</font>
                            </font>
                        </font>
                    </p>
                </section>
                <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0052"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                    <h4 id="head-4-30" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Casts Between Base and Derived Classes<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">基类和派生类之间的转换</font>
                            </font>
                        </font>
                    </h4>
                    <p id="c05-para-0211" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">To see how these casts work, start by considering the
                        case in which both the source and the destination are reference types and consider two classes,
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code> and
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyDerived</code>,
                        where <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyDerived</code> is
                        derived directly or indirectly from <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    要了解这些转换是如何工作的，首先考虑源和目标都是引用类型的情况，并考虑两个类， <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyDerived</code>
                                    ，其中 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyDerived</code>
                                    直接或间接派生自 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>
                                    。</font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">First, from <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyDerived</code> to
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>, it
                        is always possible (assuming the constructors are available) to write this:<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">首先，从 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyDerived</code>
                                    到 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>
                                    ，在构造函数可用的情况下，总是可以编写如下内容：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0098"><code>MyDerived derivedObject = new MyDerived();</code>
<code>MyBase baseCopy = derivedObject;</code></pre>
                    <p id="c05-para-0213" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Here, you are casting implicitly from <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyDerived</code> to
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>. This
                        works because of the rule that any reference to a type <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code> is
                        allowed to refer to objects of class <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code> or
                        anything derived from <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>. In
                        object-oriented programming, instances of a derived class are, in a real sense, instances of the
                        base class, plus something extra. All the functions and fields defined on the base class are
                        defined in the derived class, too.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">这里，你正在隐式地将 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyDerived</code>
                                    转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>
                                    。这之所以可行，是因为任何引用类型 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>
                                    的规则允许引用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>
                                    类的对象或任何从 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>
                                    派生的对象。在面向对象编程中，派生类的实例在本质上，是基类实例加上一些额外的东西。基类上定义的所有函数和字段在派生类中也是定义的。</font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Alternatively, you can write this:<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">或者，你可以这样写：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0099"><code>MyBase derivedObject = new MyDerived();</code>
<code>MyBase baseObject = new MyBase();</code>
<code>MyDerived derivedCopy1 = (MyDerived) derivedObject; // OK</code>
<code>MyDerived derivedCopy2 = (MyDerived) baseObject; // Throws exception</code></pre>
                    <p id="c05-para-0215" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">This code is perfectly legal C# (in a syntactic sense,
                        that is) and illustrates casting from a base class to a derived class. However, the final
                        statement throws an exception when executed. When you perform the cast, the object being
                        referred to is examined. Because a base class reference can, in principle, refer to a derived
                        class instance, it is possible that this object is actually an instance of the derived class
                        that you are attempting to cast to. If that is the case, the cast succeeds, and the derived
                        reference is set to refer to the object. If, however, the object in question is not an instance
                        of the derived class (or of any class derived from it), the cast fails, and an exception is
                        thrown.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">这段代码是合法的
                                    C#（在语法意义上），并说明了从基类到派生类的转换。然而，执行时最后的语句会抛出异常。当你执行转换时，所引用的对象会被检查。因为基类引用原则上可以引用派生类实例，所以这个对象实际上是你要转换到的派生类实例的可能性是存在的。如果情况如此，转换成功，派生类引用被设置为引用该对象。但如果所涉及的对象不是派生类实例（或不是从它派生的任何类的实例），转换会失败，并抛出异常。
                                </font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Notice that the casts that the compiler has supplied,
                        which convert between base and derived class, do not actually do any data conversion on the
                        object in question. All they do is set the new reference to refer to the object if it is legal
                        for that conversion to occur. To that extent, these casts are very different in nature from the
                        ones that you normally define yourself. For example, in the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample</code>
                        example earlier, you defined casts that convert between a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        struct and a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>. In the
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                        -to-
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        cast, you actually instantiated a new <span aria-label="149" epub:type="pagebreak" id="Page_149"
                            role="doc-pagebreak"
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        struct and initialized it with the required values. The predefined casts between base and
                        derived classes do not do this. If you want to convert a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>
                        instance into a real <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyDerived</code>
                        object with values based on the contents of the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>
                        instance, you cannot use the cast syntax to do this. The most sensible option is usually to
                        define a derived class constructor that takes a base class instance as a parameter and have this
                        constructor perform the relevant initializations:<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    请注意，编译器提供的用于在基类和派生类之间进行转换的强制类型转换实际上并不会对相关对象进行任何数据转换。它们所做的一切只是在新引用中指向该对象，前提是该转换是合法的。在这方面，这些强制类型转换在本质上与你通常自己定义的强制类型转换有很大不同。例如，在之前的
                                    <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample</code>
                                    示例中，你定义了在 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    结构体和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                    之间进行转换的强制类型转换。在 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                    到 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    的强制类型转换中，你实际上实例化了一个新的 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    结构体，并用所需值对其进行了初始化。基类和派生类之间的预定义强制类型转换不会这样做。如果你想要将一个 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>
                                    实例转换为一个基于 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyBase</code>
                                    实例内容的真实 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">MyDerived</code>
                                    对象，你不能使用强制类型转换语法来完成这个操作。通常最合理的选项是定义一个派生类构造函数，该构造函数以基类实例作为参数，并让这个构造函数执行相关的初始化：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0100"><code>class DerivedClass: BaseClass</code>
<code>{</code>
<code>  public DerivedClass(BaseClass base)</code>
<code>  {</code>
<code>    // initialize object from the Base instance</code>
<code>  }</code>
<code>  // …</code></pre>
                </section>
                <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0053"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                    <h4 id="head-4-31" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Boxing and Unboxing Casts<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">装箱和拆箱转换</font>
                            </font>
                        </font>
                    </h4>
                    <p id="c05-para-0217" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">The previous discussion focused on casting between base
                        and derived classes where both participants were reference types. Similar principles apply when
                        casting value types, although in this case it is not possible to simply copy references—some
                        copying of data must occur.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    之前的讨论集中在基类和派生类之间的转换，其中两个参与者都是引用类型。当转换值类型时，类似的原理也适用，尽管在这种情况下无法简单地复制引用——必须进行一些数据复制。
                                </font>
                            </font>
                        </font>
                    </p>
                    <p id="c05-para-0218" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">It is not, of course, possible to derive from structs or
                        primitive value types. Casting between base and derived structs invariably means casting between
                        a primitive type or a struct and <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Object</code>.
                        (Theoretically, it is possible to cast between a struct and <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.ValueType</code>,
                        though it is hard to see why you would want to do this.)<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    当然，不可能从结构体或原始值类型派生。基类和派生结构体之间的转换始终意味着在原始类型或结构体与 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.Object</code>
                                    之间进行转换。（理论上，可以在结构体和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">System.ValueType</code>
                                    之间进行转换，尽管很难看出为什么要这样做。）</font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">The cast from any struct (or primitive type) to <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code> is
                        always available as an implicit cast—because it is a cast from a derived type to a base type—and
                        is just the familiar process of boxing. Here's an example using the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        struct:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">任何结构体（或原始类型）到 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code>
                                    的转换始终可用作隐式转换——因为它是从派生类型到基类型的转换——并且只是熟悉的装箱过程。这里是一个使用 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    结构体的示例：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0101"><code>Currency balance = new(40,0);</code>
<code>object baseCopy = balance;</code></pre>
                    <p id="c05-para-0220" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">When this implicit cast is executed, the contents of
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance</code> are
                        copied onto the heap into a boxed object, and the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">baseCopy</code>
                        object reference is set to this object. What actually happens behind the scenes is this: when
                        you originally defined the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        struct, .NET implicitly supplied another (hidden) class, a boxed <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        class, which contains all the same fields as the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        struct but is a reference type, stored on the heap. This happens whenever you define a value
                        type, whether it is a <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">struct</code> or an
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">enum</code>, and
                        similar boxed reference types exist corresponding to all the primitive value types of <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>, <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>, <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>, and so
                        on. It is not possible, or necessary, to gain direct programmatic access to any of these boxed
                        classes in source code, but they are the objects that are working behind the scenes whenever a
                        value type is cast to <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code>. When
                        you implicitly cast <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> to
                        <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code>, a
                        boxed <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        instance is instantiated and initialized with all the data from the <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        struct. In the preceding code, it is this boxed <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        instance to which <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">baseCopy</code>
                        refers. By these means, it is possible for casting from derived to base type to work
                        syntactically in the same way for value types as for reference types.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">当执行这个隐式转换时， <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance</code>
                                    的内容被复制到堆中，形成一个装箱对象，并将 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">baseCopy</code>
                                    对象引用设置为该对象。实际发生的情况是这样的：当你最初定义 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    结构时，.NET 会隐式地提供一个另一个（隐藏的）类，一个装箱的 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    类，它包含与 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    结构完全相同的字段，但是一个引用类型，存储在堆上。无论你定义的是 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">struct</code>
                                    还是 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">enum</code>
                                    ，每当定义一个值类型时，都会发生这种情况，并且存在类似的装箱引用类型，对应于 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                    等所有基本值类型。在源代码中不可能，也不需要直接程序化访问这些装箱类中的任何一个，但在值类型转换为 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code>
                                    时，它们是背后工作的对象。当你隐式地将 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">object</code>
                                    时，会实例化一个装箱的 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    实例，并用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    结构中的所有数据初始化它。在前面代码中， <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">baseCopy</code>
                                    指向的就是这个装箱的 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    实例。通过这些方式，从派生类型到基类型的转换对于值类型和引用类型在语法上可以相同地工作。</font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">Casting the other way is known as <i
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">unboxing</i>. Like
                        casting between a base reference type and a derived reference type, it is an explicit cast
                        because an exception is thrown if the object being cast is not of the correct type:<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    将其他方式称为拆箱。与基引用类型和派生引用类型之间的类型转换一样，它是一个显式转换，因为如果被转换的对象不是正确的类型，则会抛出异常：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c05-code-0102"><code>object derivedObject = new Currency(40,0);</code>
<code>object baseObject = new object();</code>
<code>Currency derivedCopy1 = (Currency)derivedObject; // OK</code>
<code>Currency derivedCopy2 = (Currency)baseObject; // Exception thrown</code></pre>
                    <p id="c05-para-0222" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">This code works in a way similar to the code presented
                        earlier for reference types. Casting <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">derivedObject</code>
                        to <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        works fine because <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">derivedObject</code>
                        actually refers to a boxed <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        instance—the cast is performed by copying the fields out of the boxed <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        object into a new <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        struct. The second cast fails because <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">baseObject</code>
                        does not refer to a boxed <code
                            data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                        object.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">这段代码的工作方式与前面为引用类型提供的代码类似。将
                                    <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">derivedObject</code>
                                    转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    可以正常工作，因为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">derivedObject</code>
                                    实际上引用了一个装箱的 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    实例——转换是通过将装箱的 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    对象的字段复制到一个新的 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    结构体中完成的。第二个转换失败，因为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">baseObject</code>
                                    并不引用一个装箱的 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                    对象。</font>
                            </font>
                        </font>
                    </p>
                    <p id="c05-para-0223" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                        data-immersive-translate-paragraph="1">When using boxing and unboxing, it is important to
                        understand that both processes actually copy the data into the new boxed or unboxed object.
                        Hence, manipulations on the boxed object, for example, do not affect the contents of the
                        original value type.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    在使用装箱和拆箱时，重要的是要理解这两个过程实际上都会将数据复制到新的装箱或拆箱对象中。因此，对装箱对象的操作，例如，不会影响原始值类型的內容。</font>
                            </font>
                        </font>
                    </p>
                </section>
            </section> <span aria-label="150" epub:type="pagebreak" id="Page_150" role="doc-pagebreak"
                data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <section data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"><span id="c05-sec-0054"
                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
                <h3 id="head-3-138" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Multiple Casting <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">多次转换</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">One thing you have to watch for when you are defining casts
                    is that if the C# compiler is presented with a situation in which no direct cast is available to
                    perform a requested conversion, it attempts to find a way of combining casts to do the conversion.
                    For example, with the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> struct,
                    suppose the compiler encounters a few lines of code like this:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在定义强制转换时，你必须注意一点：如果
                                C#编译器遇到无法直接进行所需转换的情况，它会尝试寻找结合多种强制转换来实现转换的方法。例如，对于 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                结构体，假设编译器遇到如下几行代码：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0103"><code>Currency balance = new(10,50);</code>
<code>long amount = (long)balance;</code>
<code>double amountD = balance;</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">You first initialize a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> instance,
                    and then you attempt to convert it to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>. The trouble
                    is that you haven't defined the cast to do that. However, this code still compiles successfully.
                    Here's what happens: the compiler realizes that you have defined an implicit cast to get from <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>, and the
                    compiler already knows how to explicitly cast a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>. Hence, it
                    compiles that line of code into IL code that converts <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance</code> first to a
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> and then
                    converts that result to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>. The same
                    thing happens in the final line of the code, when you convert <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance</code> to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>. However,
                    because the cast from <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> and the
                    predefined cast from <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code> are both
                    implicit, you can write this conversion in your code as an implicit cast. If you prefer, you could
                    also specify the casting route explicitly:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你首先初始化一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                实例，然后尝试将其转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                。问题在于你没有定义用于这种转换的强制类型转换。然而，这段代码仍然成功编译。具体过程如下：编译器发现你已经定义了从 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                的隐式强制类型转换，并且编译器已经知道如何将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                显式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                。因此，它将这行代码编译成 IL 代码，该代码首先将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance</code>
                                转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                ，然后将该结果转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                。代码的最后一行也发生了同样的事情，当你将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance</code>
                                转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                时。然而，因为从 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                的强制类型转换和从 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">double</code>
                                的预定义强制类型转换都是隐式的，你可以在代码中将这种转换写为隐式强制类型转换。如果你愿意，你也可以显式指定强制类型转换的路径：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0104"><code>Currency balance = new(10,50);</code>
<code>long amount = (long)(float)balance;</code>
<code>double amountD = (double)(float)balance;</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">However, in most cases, this would be seen as needlessly
                    complicating your code. The following code, by contrast, produces a compilation error:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                然而，在大多数情况下，这会被视为不必要地使你的代码复杂化。相比之下，以下代码会产生编译错误：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0105"><code>Currency balance = new(10,50);</code>
<code>long amount = balance;</code></pre>
                <p id="c05-para-0227" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The reason is that the best match for the conversion that the
                    compiler can find is still to convert first to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> and then to
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>. The
                    conversion from <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code> needs to be
                    specified explicitly, though.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">原因是编译器能找到的最佳转换匹配仍然是要先转换为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                ，然后再转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                。尽管 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">long</code>
                                的转换需要显式指定。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Not all of this by itself should give you too much trouble.
                    The rules are, after all, fairly intuitive and designed to prevent any data loss from occurring
                    without the developer knowing about it. However, the problem is that if you are not careful when you
                    define your casts, it is possible for the compiler to select a path that leads to unexpected
                    results. For example, suppose that it occurs to someone else in the group writing the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> struct
                    that it would be useful to be able to convert a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> containing
                    the total number of cents in an amount into a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> (cents,
                    not dollars, because the idea is not to lose the fractions of a dollar). Therefore, this cast might
                    be written to try to achieve this:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                这些规则本身不应该给你带来太多麻烦。毕竟，这些规则设计得相当直观，旨在防止在开发者不知情的情况下发生数据丢失。然而，问题在于如果你在定义你的类型转换时不小心，编译器可能会选择一条导致意外结果的路径。例如，假设团队中编写
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                结构体的其他人想到，将一个包含金额总分数（注意，是分数，不是美元，因为目的是不丢失美元的分数部分）的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                会很有用。因此，可能会编写这样的转换来尝试实现这个功能：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0106"><code>// Do not do this!</code>
<code>public static implicit operator Currency(uint value) =&gt;</code>
<code>  new Currency(value/100u, (ushort)(value%100));</code></pre>
                <p id="c05-para-0229" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Note the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">u</code> after the first
                    100 in this code ensures that <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">value/100u</code> is
                    interpreted as a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>. If you had
                    written <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">value/100</code>, the
                    compiler would have interpreted this as an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>, not a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">注意代码中第一个 100 后的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">u</code> 确保
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">value/100u</code>
                                被解释为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                。如果你写了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">value/100</code>
                                ，编译器会将其解释为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                ，而不是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> 。
                            </font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The comment <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Do not do this!</code> is
                    clearly noted in this code, and here is why: the following code snippet merely converts a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> containing
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">350</code> into a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> and back
                    again; but what do you think <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">bal2</code> will contain
                    after executing this?<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在这段代码中， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Do not do this!</code>
                                被明确标注，原因如下：接下来的代码片段仅将一个包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">350</code> 的
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                ，然后再转换回来；但执行后， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">bal2</code>
                                会包含什么内容呢？</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0107"><code>uint bal = 350;</code>
<code>Currency balance = bal;</code>
<code>uint bal2 = (uint)balance;</code></pre>
                <p id="c05-para-0231" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The answer is not <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">350</code> but <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">3</code>
                    ! Moreover, it all follows logically. You convert <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">350</code> implicitly to
                    a <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>,
                    giving the result <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance.Dollars = 3</code>,
                    <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance.Cents = 50</code>.
                    Then the compiler does its usual figuring out of the best path for the conversion back. <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Balance</code> ends up
                    being implicitly converted to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> (value <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">3.5</code>), and this is
                    converted explicitly to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> with value
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">3</code>. One way to
                    fix this would be to create a user-defined cast to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">答案不是 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">350</code> 而是
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">3</code>
                                ！此外，这一切都合乎逻辑。你将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">350</code>
                                隐式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                ，得到结果 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance.Dollars = 3</code>
                                ， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">balance.Cents = 50</code>
                                。然后编译器会像往常一样找出转换回的最佳路径。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Balance</code>
                                最终被隐式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                （值 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">3.5</code>
                                ），然后被显式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                ，值为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">3</code>
                                。解决这个问题的一种方法是为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                创建一个用户定义的转换。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0232" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1"><span aria-label="151" epub:type="pagebreak" id="Page_151"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>Of course, other
                    instances exist in which converting to another data type and back again causes data loss. For
                    example, converting a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> containing
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">5.8</code> to an <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> and back to a
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> again
                    loses the fractional part, giving you a result of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">5</code>, but there is a
                    slight difference in principle between losing the fractional part of a number and dividing an
                    integer by more than 100. <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> has
                    suddenly become a rather dangerous class that does strange things to integers!<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                当然，还有其他情况，将数据类型转换回来会导致数据丢失。例如，将一个包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">5.8</code> 的
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                ，然后再转换回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                会丢失小数部分，得到结果 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">5</code>
                                ，但丢失一个数字的小数部分和将整数除以 100 以上的概念之间有一个微小的差异。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                突然变成了一个相当危险的类，会对整数做奇怪的事情！</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The problem is that there is a conflict between how your
                    casts interpret integers. The casts between <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> and <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> interpret an
                    integer value of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">1</code> as corresponding
                    to one dollar, but the latest <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                    -to-
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> cast
                    interprets this value as one cent. This is an example of poor design. If you want your classes to be
                    easy to use, you should ensure that all your casts behave in ways that are mutually compatible, in
                    the sense that they intuitively give the same results. In this case, the solution is obviously to
                    rewrite the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                    -to-
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> cast so
                    that it interprets an integer value of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">1</code> as one dollar:
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">问题是你的类型转换在解释整数时有冲突。 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                之间的类型转换将整数值 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">1</code>
                                解释为对应一美元，但最新的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> 到
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                类型转换将此值解释为一分钱。这是一个设计不良的例子。如果你想让你的类易于使用，你应该确保所有你的类型转换在相互兼容的方式下工作，也就是说它们直观地给出相同的结果。在这种情况下，显然的解决方案是重写
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> 到
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                的类型转换，使其将整数值 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">1</code>
                                解释为一美元：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0108"><code>public static implicit operator Currency (uint value) =&gt;</code>
<code>  new Currency(value, 0);</code></pre>
                <p id="c05-para-0234" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Incidentally, you might wonder whether this new cast is
                    necessary at all. The answer is that it could be useful. Without this cast, the only way for the
                    compiler to carry out a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                    -to-
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                    conversion would be via a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>. Converting
                    directly is a lot more efficient in this case, so having this extra cast provides performance
                    benefits, though you need to ensure that it provides the same result as via a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>, which you
                    have now done. In other situations, you may also find that separately defining casts for different
                    predefined data types enables more conversions to be implicit rather than explicit, though that is
                    not the case here.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                顺便一提，你可能会想这个新的类型转换是否真的有必要。答案是它可能很有用。如果没有这个类型转换，编译器执行 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> 到
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                的转换的唯一方式就是通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                。在这种情况下直接转换效率更高，所以有这个额外的类型转换可以提供性能优势，尽管你需要确保它和通过 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                提供的结果相同，你已经做到了这一点。在其他情况下，你可能会发现为不同的预定义数据类型分别定义类型转换可以使更多的转换变得隐式而非显式，尽管这里不是这种情况。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">A good test of whether your casts are compatible is to ask
                    whether a conversion will give the same results (other than perhaps a loss of accuracy as in <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                    -to-
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code> conversions)
                    regardless of which path it takes. The <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> class
                    provides a good example of this. Consider this code:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                测试你的类型转换是否兼容的一个好方法是问一个转换是否无论通过哪条路径都会给出相同的结果（除了可能像 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">int</code>
                                转换那样损失精度）。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                类提供了一个很好的例子。考虑这段代码：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0109"><code>Currency balance = new(50, 35);</code>
<code>ulong bal = (ulong) balance;</code></pre>
                <p id="c05-para-0236" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">At present, there is only one way that the compiler can
                    achieve this conversion: by converting the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> to a
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> implicitly
                    and then to a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code> explicitly.
                    The <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                    -to-
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code> conversion
                    requires an explicit conversion, but that is fine because you have specified one here.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">目前，编译器实现这种转换只有一种方式：先将 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                隐式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                ，然后显式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code>
                                。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code>
                                的转换需要显式转换，但这没关系，因为你已经指定了一个。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Suppose, however, that you then added another cast to convert
                    implicitly from a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> to a
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>. You
                    actually do this by modifying the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> struct by
                    adding the casts both to and from <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> (code file
                    <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample/Currency.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">然而，假设你接着添加另一个转换，将隐式地从 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                。你实际上是通过修改 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                结构体，添加到和来自 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                的转换（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">CastingSample/Currency.cs</code>
                                ）来实现这一点：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0110"><code>public static implicit operator Currency(uint value) =&gt; </code>
<code>  new Currency(value, 0);</code>
<code>public static implicit operator uint(Currency value) =&gt; value.Dollars;</code></pre>
                <p id="c05-para-0238" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Now the compiler has another possible route to convert from
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> to
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code>
                    : to convert from <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> implicitly
                    and then to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code> implicitly.
                    Which of these two routes will it take? C# has some precise rules about the best route for the
                    compiler when there are several possibilities. (The rules are not covered in this book, but if you
                    are interested in the details, see the MSDN documentation.) The best answer is that you should
                    design your casts so that all routes give the same answer (other than possible loss of precision),
                    in which case it doesn't really matter which one the compiler picks. (As it happens in this case,
                    the compiler picks the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                    -to-
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                    -to-
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code> route in
                    preference to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                    -to-
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                    -to-
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code>.)<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在编译器有了另一条从 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code>
                                的可能转换路径：先隐式地从 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                ，然后再隐式地转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code>
                                。编译器会选择哪条路径呢？C# 对编译器在有多种可能时选择最佳路径有一些精确的规则。（这些规则不在这本书中涵盖，但如果你对细节感兴趣，可以查看 MSDN
                                文档。）最好的做法是设计你的转换，使得所有路径都给出相同的结果（除了可能的精度损失），在这种情况下，编译器选择哪条路径其实并不重要。（在这个例子中，编译器更倾向于选择
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                -to- <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                -to- <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code>
                                路径，而不是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                -to- <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                -to- <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">ulong</code>
                                路径。）</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">To test casting the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>, add this
                    test code to the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Main</code> method (code
                    file <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">UserDefinedConversion/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要测试将 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                ，将以下测试代码添加到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Main</code>
                                方法中（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">UserDefinedConversion/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0111"><code>try</code>
<code>{</code>
<code>  Currency balance = new(50,35);</code>
<code>  Console.WriteLine(balance);</code>
<code>  Console.WriteLine($"balance is {balance}");</code>
<code>  <b>uint balance3 = (uint) balance;</b></code>
<code>  <b>Console.WriteLine($"Converting to uint gives {balance3}");</b></code>
<code>}<span aria-label="152" epub:type="pagebreak" id="Page_152" role="doc-pagebreak"></span></code>
<code>catch (Exception ex)</code>
<code>{</code>
<code>  Console.WriteLine($"Exception occurred: {ex.Message}");</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">Running the sample now gives you these results:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在运行示例会给你这些结果： </font>
                        </font>
                    </font>
                </p>
                <pre id="c05-code-0112"><code>50</code>
<code>balance is $50.35</code>
<code>Converting to uint gives 50</code></pre>
                <p id="c05-para-0241" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The output shows that the conversion to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> has been
                    successful, though, as expected, you have lost the cents part of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> in making
                    this conversion.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">输出显示，转换到 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                已成功，不过正如预期，在这次转换中你丢失了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                的分部分。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0242" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">However, the output also demonstrates one last potential
                    problem that you need to be aware of when working with casts. The first line of output does not
                    display the balance correctly, displaying <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">50</code> instead of
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">50.35</code>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                然而，输出也展示了当你使用类型转换时需要了解的一个最后潜在问题。输出第一行没有正确显示余额，显示的是 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">50</code> 而不是
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">50.35</code>
                                。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0243" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">So, what is going on? The problem here is that when you
                    combine casts with method overloads, you get another source of unpredictability.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                那么，发生了什么？这里的问题是，当你将类型转换与方法重载结合使用时，你会得到另一个不可预测性的来源。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0244" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                    statement using the format string implicitly calls the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency.ToString</code>
                    method, ensuring that the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> is
                    displayed as a string.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用格式字符串的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                                语句会隐式调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency.ToString</code>
                                方法，确保 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                以字符串形式显示。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0245" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The first code line with <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>,
                    however, simply passes a raw <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> struct to
                    the <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                    method. Now, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code> has many
                    overloads, but none of them takes a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> struct.
                    Therefore, the compiler starts fishing around to see what it can cast the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> to in
                    order to make it match up with one of the overloads of <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>. As it
                    happens, one of the <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                    overloads is designed to display <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                    s quickly and efficiently, and it takes a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> as a
                    parameter—you have now supplied a cast that converts <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                    implicitly to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">然而， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                                的第一行代码只是将原始的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                结构体传递给 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                                方法。现在， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                                有许多重载版本，但没有一个接受 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                结构体。因此，编译器开始四处寻找，看看可以将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                转换为什么，以便与 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                                的重载版本匹配。碰巧，其中一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                                重载版本被设计为快速高效地显示 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                ，并且它接受 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                作为参数——你现在提供了一个将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                隐式转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                的转换。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0246" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">In fact, <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code> has
                    another overload that takes a <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> as a
                    parameter and displays the value of that <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>. If you look
                    closely at the output running the example previously where the cast to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> did not
                    exist, you see that the first line of output displayed <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> as a
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>, using
                    this overload. In that example, there wasn't a direct cast from <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code> to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>, so the
                    compiler picked <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                    -to-
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code> as its
                    preferred way of matching up the available casts to the available <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                    overloads. However, now that there is a direct cast to <code
                        data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code> available in
                    <code data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>, the
                    compiler has opted for that route.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">实际上， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                                还有一个重载版本，它接受一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                作为参数并显示该 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                的值。如果你仔细查看之前运行示例的输出，其中没有 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                的转换，你会发现第一行输出将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                显示为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                ，使用了这个重载版本。在那个示例中，没有从 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                的直接转换，所以编译器选择了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                -to- <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">float</code>
                                作为匹配可用转换到可用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">WriteLine</code>
                                重载的首选方式。然而，现在在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">Currency</code>
                                中存在直接到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">uint</code>
                                的转换，编译器选择了那条路径。</font>
                        </font>
                    </font>
                </p>
                <p id="c05-para-0247" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                    data-immersive-translate-paragraph="1">The upshot of this is that if you have a method call that
                    takes several overloads and you attempt to pass it a parameter whose data type doesn't match any of
                    the overloads exactly, then you are forcing the compiler to decide not only what casts to use to
                    perform the data conversion, but also which overload, and hence which data conversion, to pick. The
                    compiler always works logically and according to strict rules, but the results may not be what you
                    expect. If there is any doubt, you are better off specifying which cast to use explicitly.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                这意味着，如果你有一个接受多个重载的函数调用，而你试图传递一个数据类型与任何重载都不完全匹配的参数，那么你是在迫使编译器不仅决定执行数据转换要使用哪些转换，还要决定选择哪个重载，从而选择哪种数据转换。编译器总是按照逻辑和严格的规则工作，但结果可能并不符合你的预期。如果有任何疑问，你最好明确指定要使用的转换。
                            </font>
                        </font>
                    </font>
                </p>
            </section>
        </section>
        <section aria-labelledby="head-2-49" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88">
            <span id="c05-sec-0055" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"></span>
            <h2 id="head-2-49" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">SUMMARY<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">摘要</font>
                    </font>
                </font>
            </h2>
            <p id="c05-para-0248" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">This chapter looked at the standard operators provided by C#,
                described the mechanics of object equality, and examined how the compiler converts the standard data
                types from one to another. It also demonstrated how you can implement custom operator support on your
                data types using operator overloads. Finally, you looked at a special type of operator overload, the
                cast operator, which enables you to specify how instances of your types are converted to other data
                types.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">本章探讨了
                            C#提供的标准运算符，描述了对象相等的机制，并考察了编译器如何将标准数据类型从一种转换为另一种。它还演示了如何通过运算符重载在你的数据类型上实现自定义运算符支持。最后，你了解了另一种特殊的运算符重载——强制转换运算符，它使你能够指定你的类型的实例如何转换为其他数据类型。
                        </font>
                    </font>
                </font>
            </p>
            <p id="c05-para-0249" data-immersive-translate-walked="4931348d-14cb-4847-89f1-0302b87c3f88"
                data-immersive-translate-paragraph="1">The next chapter dives into arrays where the index operator has
                an important role.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">下一章将深入探讨数组，其中索引运算符扮演着重要角色。</font>
                    </font>
                </font>
            </p>
        </section>
    </section>
</body>
<div id="immersive-translate-popup" style="all: initial"></div>

</html>