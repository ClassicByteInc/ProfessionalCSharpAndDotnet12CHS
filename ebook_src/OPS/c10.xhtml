<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops"
    xmlns:svg="http://www.w3.org/2000/svg" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en"
    imt-state="dual" imt-trans-position="after">

<head>
    <title>10 错误和异常 --- 10 Errors and Exceptions</title>
    <link href="WileyTemplate_v5.5.css" rel="stylesheet" type="text/css" />
    <meta content="urn:uuid:e0000000-0000-0000-0000-000006715209" name="Adept.expected.resource" />
    <style data-id="immersive-translate-input-injected-css">
        .immersive-translate-input {
            position: absolute;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            z-index: 2147483647;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .immersive-translate-attach-loading::after {
            content: " ";

            --loading-color: #f78fb6;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: block;
            margin: 12px auto;
            position: relative;
            color: white;
            left: -100px;
            box-sizing: border-box;
            animation: immersiveTranslateShadowRolling 1.5s linear infinite;

            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-2000%, -50%);
            z-index: 100;
        }

        .immersive-translate-loading-spinner {
            vertical-align: middle !important;
            width: 10px !important;
            height: 10px !important;
            display: inline-block !important;
            margin: 0 4px !important;
            border: 2px rgba(221, 244, 255, 0.6) solid !important;
            border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-radius: 50% !important;
            padding: 0 !important;
            -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
            animation: immersive-translate-loading-animation 0.6s infinite linear !important;
        }

        @-webkit-keyframes immersive-translate-loading-animation {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @keyframes immersive-translate-loading-animation {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(359deg);
            }
        }

        .immersive-translate-input-loading {
            --loading-color: #f78fb6;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: block;
            margin: 12px auto;
            position: relative;
            color: white;
            left: -100px;
            box-sizing: border-box;
            animation: immersiveTranslateShadowRolling 1.5s linear infinite;
        }

        @keyframes immersiveTranslateShadowRolling {
            0% {
                box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            12% {
                box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            25% {
                box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            36% {
                box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color),
                    100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
            }

            50% {
                box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color),
                    110px 0 var(--loading-color), 100px 0 var(--loading-color);
            }

            62% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color),
                    120px 0 var(--loading-color), 110px 0 var(--loading-color);
            }

            75% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    130px 0 var(--loading-color), 120px 0 var(--loading-color);
            }

            87% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
            }

            100% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
            }
        }

        .immersive-translate-toast {
            display: flex;
            position: fixed;
            z-index: 2147483647;
            left: 0;
            right: 0;
            top: 1%;
            width: fit-content;
            padding: 12px 20px;
            margin: auto;
            overflow: auto;
            background: #fef6f9;
            box-shadow: 0px 4px 10px 0px rgba(0, 10, 30, 0.06);
            font-size: 15px;
            border-radius: 8px;
            color: #333;
        }

        .immersive-translate-toast-content {
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        .immersive-translate-toast-hidden {
            margin: 0 20px 0 72px;
            text-decoration: underline;
            cursor: pointer;
        }

        .immersive-translate-toast-close {
            color: #666666;
            font-size: 20px;
            font-weight: bold;
            padding: 0 10px;
            cursor: pointer;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-toast {
                top: 0;
                padding: 12px 0px 0 10px;
            }

            .immersive-translate-toast-content {
                flex-direction: column;
                text-align: center;
            }

            .immersive-translate-toast-hidden {
                margin: 10px auto;
            }
        }

        .immersive-translate-modal {
            display: none;
            position: fixed;
            z-index: 2147483647;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.4);
            font-size: 15px;
        }

        .immersive-translate-modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 40px 24px 24px;
            border: 1px solid #888;
            border-radius: 10px;
            width: 80%;
            max-width: 270px;
            font-family: system-ui, -apple-system, "Segoe UI", "Roboto", "Ubuntu",
                "Cantarell", "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
                "Segoe UI Symbol", "Noto Color Emoji";
            position: relative;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-modal-content {
                margin: 50% auto !important;
            }
        }

        .immersive-translate-modal .immersive-translate-modal-content-in-input {
            max-width: 500px;
        }

        .immersive-translate-modal-content-in-input .immersive-translate-modal-body {
            text-align: left;
            max-height: unset;
        }

        .immersive-translate-modal-title {
            text-align: center;
            font-size: 16px;
            font-weight: 700;
            color: #333333;
        }

        .immersive-translate-modal-body {
            text-align: center;
            font-size: 14px;
            font-weight: 400;
            color: #333333;
            word-break: break-all;
            margin-top: 24px;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-modal-body {
                max-height: 250px;
                overflow-y: auto;
            }
        }

        .immersive-translate-close {
            color: #666666;
            position: absolute;
            right: 16px;
            top: 16px;
            font-size: 20px;
            font-weight: bold;
        }

        .immersive-translate-close:hover,
        .immersive-translate-close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        .immersive-translate-modal-footer {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 24px;
        }

        .immersive-translate-btn {
            width: fit-content;
            color: #fff;
            background-color: #ea4c89;
            border: none;
            font-size: 16px;
            margin: 0 8px;
            padding: 9px 30px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .immersive-translate-btn:hover {
            background-color: #f082ac;
        }

        .immersive-translate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .immersive-translate-btn:disabled:hover {
            background-color: #ea4c89;
        }

        .immersive-translate-cancel-btn {
            /* gray color */
            background-color: rgb(89, 107, 120);
        }

        .immersive-translate-cancel-btn:hover {
            background-color: hsl(205, 20%, 32%);
        }

        .immersive-translate-action-btn {
            background-color: transparent;
            color: #ea4c89;
            border: 1px solid #ea4c89;
        }

        .immersive-translate-btn svg {
            margin-right: 5px;
        }

        .immersive-translate-link {
            cursor: pointer;
            user-select: none;
            -webkit-user-drag: none;
            text-decoration: none;
            color: #007bff;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        .immersive-translate-primary-link {
            cursor: pointer;
            user-select: none;
            -webkit-user-drag: none;
            text-decoration: none;
            color: #ea4c89;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        .immersive-translate-modal input[type="radio"] {
            margin: 0 6px;
            cursor: pointer;
        }

        .immersive-translate-modal label {
            cursor: pointer;
        }

        .immersive-translate-close-action {
            position: absolute;
            top: 2px;
            right: 0px;
            cursor: pointer;
        }

        .imt-image-status {
            background-color: rgba(0, 0, 0, 0.5) !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
            border-radius: 16px !important;
        }

        .imt-image-status img,
        .imt-image-status svg,
        .imt-img-loading {
            width: 28px !important;
            height: 28px !important;
            margin: 0 0 8px 0 !important;
            min-height: 28px !important;
            min-width: 28px !important;
            position: relative !important;
        }

        .imt-img-loading {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAtFBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////oK74hAAAAPHRSTlMABBMIDyQXHwyBfFdDMSw+OjXCb+5RG51IvV/k0rOqlGRM6KKMhdvNyZBz9MaupmxpWyj437iYd/yJVNZeuUC7AAACt0lEQVRIx53T2XKiUBCA4QYOiyCbiAsuuGBcYtxiYtT3f6/pbqoYHVFO5r+iivpo6DpAWYpqeoFfr9f90DsYAuRSWkFnPO50OgR9PwiCUFcl2GEcx+N/YBh6pvKaefHlUgZd1zVe0NbYcQjGBfzrPE8Xz8aF+71D8gG6DHFPpc4a7xFiCDuhaWgKgGIJQ3d5IMGDrpS4S5KgpIm+en9f6PlAhKby4JwEIxlYJV9h5k5nee9GoxHJ2IDSNB0dwdad1NAxDJ/uXDHYmebdk4PdbkS58CIVHdYSUHTYYRWOJblWSyu2lmy3KNFVJNBhxcuGW4YBVCbYGRZwIooipHsNqjM4FbgOQqQqSKQQU9V8xmi1QlgHqQQ6DDBvRUVCDirs+EzGDGOQTCATgtYTnbCVLgsVgRE0T1QE0qHCFAht2z6dLvJQs3Lo2FQoDxWNUiBhaP4eRgwNkI+dAjVOA/kUrIDwf3CG8NfNOE0eiFotSuo+rBiq8tD9oY4Qzc6YJw99hl1wzpQvD7ef2M8QgnOGJfJw+EltQc+oX2yn907QB22WZcvlUpd143dqQu+8pCJZuGE4xCuPXJqqcs5sNpsI93Rmzym1k4Npk+oD1SH3/a3LOK/JpUBpWfqNySxWzCfNCUITuDG5dtuphrUJ1myeIE9bIsPiKrfqTai5WZxbhtNphYx6GEIHihyGFTI69lje/rxajdh0s0msZ0zYxyPLhYCb1CyHm9Qsd2H37Y3lugVwL9kNh8Ot8cha6fUNQ8nuXi5z9/ExsAO4zQrb/ev1yrCB7lGyQzgYDGuxq1toDN/JGvN+HyWNHKB7zEoK+PX11e12G431erGYzwmytAWU56fkMHY5JJnDRR2eZji3AwtIcrEV8Cojat/BdQ7XOwGV1e1hDjGGjXbdArm8uJZtCH5MbcctVX8A1WpqumJHwckAAAAASUVORK5CYII=");
            background-size: 28px 28px;
            animation: image-loading-rotate 1s linear infinite !important;
        }

        .imt-image-status span {
            color: var(--bg-2, #fff) !important;
            font-size: 14px !important;
            line-height: 14px !important;
            font-weight: 500 !important;
            font-family: "PingFang SC", Arial, sans-serif !important;
        }

        @keyframes image-loading-rotate {
            from {
                transform: rotate(360deg);
            }

            to {
                transform: rotate(0deg);
            }
        }
    </style>
    <style data-id="immersive-translate-default-injected-css">
        :root {
            --immersive-translate-theme-underline-borderColor: #72ece9;
            --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
            --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
            --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
            --immersive-translate-theme-highlight-backgroundColor: #ffff00;
            --immersive-translate-theme-dashed-borderColor: #59c1bd;
            --immersive-translate-theme-blockquote-borderColor: #cc3355;
            --immersive-translate-theme-thinDashed-borderColor: #ff374f;
            --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
            --immersive-translate-theme-dashedBorder-borderRadius: 0;
            --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
            --immersive-translate-theme-solidBorder-borderRadius: 0;
            --immersive-translate-theme-dotted-borderColor: #94a3b8;
            --immersive-translate-theme-wavy-borderColor: #72ece9;
            --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
            --immersive-translate-theme-grey-textColor: #2f4f4f;
            --immersive-translate-theme-marker-backgroundColor: #fbda41;
            --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
            --immersive-translate-theme-marker2-backgroundColor: #ffff00;
            --immersive-translate-theme-background-backgroundColor: #dbafaf;
            --immersive-translate-theme-background-backgroundColor-rgb: 219, 175, 175;
            --immersive-translate-theme-background-backgroundOpacity: 12;
            --immersive-translate-theme-opacity-opacity: 10;
        }

        [imt-state="dual"] .immersive-translate-target-translation-pre-whitespace {
            white-space: pre-wrap !important;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container {
            position: absolute;
            background-color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
                sans-serif;
            top: 0;
            width: 600px;
            height: 100%;
            z-index: 2;
            line-height: 1.3;
            font-size: 16px;
        }

        [imt-state="dual"] .immersive-translate-target-wrapper[dir="rtl"] {
            text-align: right;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container .immersive-translate-target-wrapper {
            color: rgb(0, 0, 0);
            white-space: normal;
            position: absolute;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container .immersive-translate-target-wrapper font {
            color: inherit;
            white-space: inherit;
            position: unset;
        }

        [imt-state="translation"] .immersive-translate-target-wrapper &gt;

        br {
            display: none;
        }

        [imt-state="translation"] .immersive-translate-target-translation-block-wrapper {
            margin: 0 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper {
            margin: 8px 0 !important;
            display: inline-block;
        }

        [imt-trans-position="before"] .immersive-translate-target-translation-block-wrapper {
            display: block;
        }

        [imt-trans-position="before"] .immersive-translate-target-translation-block-wrapper {
            margin-top: 0 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-pdf-block-wrapper {
            margin: 0 !important;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-grey-inner {
            color: var(--immersive-translate-theme-grey-textColor);
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-underline-inner {
            border-bottom: 1px solid var(--immersive-translate-theme-underline-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeUnderline-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeUnderline-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
            border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
            padding: 6px;
            margin-top: 2px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
            border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
            padding: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-solidBorder {
            border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
            padding: 6px;
            margin-top: 2px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
            border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
            padding: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeDashed-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeDashed-borderColor) !important;
            text-decoration-style: dashed !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-thinDashed-inner {
            border-bottom: 1px dashed var(--immersive-translate-theme-thinDashed-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-dotted-inner {
            background-image: linear-gradient(to right,
                    var(--immersive-translate-theme-dotted-borderColor) 30%,
                    rgba(255, 255, 255, 0) 0%);
            background-position: bottom;
            background-size: 5px 1px;
            background-repeat: repeat-x;
            padding-bottom: 3px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeDotted-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeDotted-borderColor) !important;
            text-decoration-style: dotted !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-wavy-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-wavy-borderColor) !important;
            text-decoration-style: wavy !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-dashed-inner {
            background: linear-gradient(to right,
                    var(--immersive-translate-theme-dashed-borderColor) 0%,
                    var(--immersive-translate-theme-dashed-borderColor) 50%,
                    transparent 50%,
                    transparent 100%) repeat-x left bottom;
            background-size: 8px 2px;
            padding-bottom: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
            content: "";
            display: block;
            max-width: 80px;
            width: 10%;
            border-top: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
            padding-top: 8px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
            content: "";
            border-left: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
            max-height: 16px;
            height: 16px;
            padding-left: 8px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-highlight-inner {
            background: var(--immersive-translate-theme-highlight-backgroundColor);
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-marker {
            line-height: 1.5em;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-marker2-inner {
            font-weight: bold;
            text-shadow: 10px 0px 3px var(--immersive-translate-theme-marker2-backgroundColor),
                16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
                2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
                -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-marker-inner {
            /* TODO: add more texture */
            background: linear-gradient(to right,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3));
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-weakening {
            opacity: 0.618 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-italic {
            font-style: italic !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-bold {
            font-weight: bold !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-paper {
            margin: 8px 0;
            box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
            padding: 16px 32px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-blockquote {
            border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
            padding-left: 12px !important;
            margin-top: 4px;
            margin-bottom: 4px;
            padding-top: 4px;
            padding-bottom: 4px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-mask-inner {
            filter: blur(5px) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-mask-inner {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner {
            filter: blur(5px) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        /* opacity theme start */

        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner {
            filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-opacity-inner {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner,
        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner:hover {
            filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner:hover {
            filter: none !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-mask-inner:hover {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner:hover {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner:hover {
            filter: none !important;
        }

        /* opacity theme end */

        /* background theme start */
        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-background {
            margin: 8px 0;
            background: rgba(var(--immersive-translate-theme-background-backgroundColor-rgb),
                    calc(var(--immersive-translate-theme-background-backgroundOpacity) * 1%));
            border-radius: 4px;
            box-shadow: unset !important;
            padding: 12px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-background-inner {
            background: rgba(var(--immersive-translate-theme-background-backgroundColor-rgb),
                    calc(var(--immersive-translate-theme-background-backgroundOpacity) * 1%));
            padding-left: 6px;
            padding-right: 6px;
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper .immersive-translate-target-translation-theme-background-inner {
            background: unset;
            padding-left: unset;
            padding-right: unset;
        }

        /* background theme end */

        /* vertical css , please remain it in the last one. */
        .immersive-translate-target-translation-vertical-block-wrapper {
            margin: 0px 8px !important;
        }

        .immersive-translate-text {
            font-size: 15px !important;
        }

        .immersive-translate-error-toast {
            position: fixed;
            top: 5%;
            z-index: 99999999;
            left: 0;
            right: 0;
            margin: auto;
            max-width: 300px;
            padding: 16px;
            border-radius: 12px;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: row;
            justify-content: space-between;
        }

        @media all and (min-width: 750px) {
            .immersive-translate-error-toast {
                max-width: 400px;
            }
        }

        .immersive-translate-clickable-button {
            cursor: pointer;
        }

        .immersive-translate-help-button {
            cursor: pointer;
        }

        .immersive-translate-loading-text:before {
            content: "...";
        }

        /* dark mode for loading */

        @media only screen and (prefers-color-scheme: dark) {
            .immersive-translate-loading {
                border: 2px rgba(255, 255, 255, 0.25) solid !important;
                border-top: 2px rgba(255, 255, 255, 1) solid !important;
            }
        }

        .immersive-translate-error-wrapper {
            position: relative;
            display: inline-flex;
            padding: 6px;
            margin: 0 12px;
            white-space: nowrap;
            font-size: 0.9em;
        }

        [lang="zh-CN"] .immersive-translate-error-wrapper {
            font-size: 0.75em;
        }

        [lang="zh-TW"] .immersive-translate-error-wrapper {
            font-size: 0.75em;
        }

        .immersive-translate-tooltip {
            position: relative;
            display: inline-flex;
            /* little indicater to indicate it's hoverable */
        }

        .immersive-translate-tooltip-content {
            /* here's the magic */
            position: absolute;
            z-index: 100000000000;

            left: 50%;
            bottom: 0;
            transform: translate(-50%, 110%);
            line-height: 1;
            /* and add a small left margin */

            /* basic styles */
            width: max-content;
            max-width: 250px;
            word-wrap: break-word;
            white-space: pre-line;
            padding: 10px;
            border-radius: 10px;
            background: #000c;
            color: #fff;
            text-align: center;
            font-size: 14px;
            display: none;
            /* hide by default */
        }

        .immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
            display: inline-block;
        }

        .immersive-translate-tooltip:hover+.immersive-translate-tooltip-content {
            display: inline-block;
        }

        .immersive-translate-tooltip-content-table {
            left: unset !important;
            bottom: unset !important;
            transform: translate(-10%, 50%) !important;
        }

        .immersive-translate-tooltip:hover:before {
            display: inline-block;
        }

        .immersive-translate-loading-spinner {
            vertical-align: middle !important;
            width: 10px !important;
            height: 10px !important;
            display: inline-block !important;
            margin: 0 4px !important;
            border: 2px rgba(221, 244, 255, 0.6) solid !important;
            border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-radius: 50% !important;
            padding: 0 !important;
            -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
            animation: immersive-translate-loading-animation 0.6s infinite linear !important;
        }

        @-webkit-keyframes immersive-translate-loading-animation {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @keyframes immersive-translate-loading-animation {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(359deg);
            }
        }

        .imt-image-status {
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--bg-2, #fff);
            font-size: 14px;
        }
    </style>
    <style data-id="immersive-translate-user-custom-style">
        :root {

            .immersive-translate-target-inner {
                font-family: inherit;
            }


            .immersive-translate-target-inner {
                font-family: inherit;
            }
        }
    </style>
    <style data-id="immersive-translate-dynamic-injected-css">
        .immersive-translate-target-wrapper[dir='rtl'] {
            text-align: right;
        }

        .immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {
            display: block;
        }

        .immersive-translate-target-wrapper {
            word-break: break-word;
            user-select: text;
        }

        [imt-state="translation"] .immersive-translate-target-wrapper[dir='rtl'] {
            display: inline-block;
        }

        [dir='rtl'] .immersive-translate-target-wrapper:not([dir]) {
            text-align: left;
        }

        [imt-state=dual] .immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
            display: block;
        }

        [imt-trans-position=before] .immersive-translate-target-translation-block-wrapper {
            display: block !important;
        }

        [imt-state][data-immersive-translate_rtl] .immersive-translate-target-wrapper {
            display: block !important;
        }
    </style>
</head>

<body epub:type="bodymatter" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
    <section aria-labelledby="c10_1" epub:type="chapter" role="doc-chapter"
        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
        <header data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
            <h1 id="c10_1" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1"><span aria-label="263" epub:type="pagebreak" id="Page_263"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span><span id="c10"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span><span
                    class="chapterNumber"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">10</span><br /><span
                    class="chapterTitle" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Errors
                    and Exceptions</span>
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">10 错误和异常</font>
                    </font>
                </font>
            </h1>
        </header>
        <section aria-label="chapter opening" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
            <span id="c10-sec-0001" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <hr />
                </div>
                <section class="feature3" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <h3 data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">WHAT'S IN THIS CHAPTER?<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">本章包含什么内容？</font>
                            </font>
                        </font>
                    </h3>
                    <ul class="check2" id="c10-list-0001"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <li id="c10-li-0001" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1">Looking at the exception classes<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">查看异常类</font>
                                </font>
                            </font>
                        </li>
                        <li id="c10-li-0002" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1">Using <code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try…catch…finally</code>
                            to capture exceptions<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try…catch…finally</code>
                                        捕获异常</font>
                                </font>
                            </font>
                        </li>
                        <li id="c10-li-0003" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1">Filtering exceptions<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">过滤异常</font>
                                </font>
                            </font>
                        </li>
                        <li id="c10-li-0004" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1">Creating user-defined exceptions<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">创建自定义异常</font>
                                </font>
                            </font>
                        </li>
                        <li id="c10-li-0005" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1">Retrieving caller information<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">获取呼叫者信息</font>
                                </font>
                            </font>
                        </li>
                    </ul>
                    <div class="bottom hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <hr />
                    </div>
                </section>
            </aside>
            <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <hr />
                </div>
                <section class="feature3" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span
                        id="c10-fea-0001" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                    <h3 id="head-2-88" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">CODE DOWNLOADS FOR THIS CHAPTER<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">本章代码下载</font>
                            </font>
                        </font>
                    </h3>
                    <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span
                            id="c10-sec-0002"
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                        <p id="c10-para-0003" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1">The source code for this chapter is available on the
                            book page at <code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><a href="http://www.wiley.com">www.wiley.com</a></code>.
                            Click the Downloads link. The code can also be found at <code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><a href="https://github.com/ProfessionalCSharp/ProfessionalCSharp2021">https://github.com/ProfessionalCSharp/ProfessionalCSharp2021</a></code>
                            in the directory <code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">1_CS/ErrorsAndExceptions</code>.
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章的源代码可在书籍页面 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><a href="http://www.wiley.com">www.wiley.com</a></code>
                                        上找到。点击下载链接。代码也可以在目录 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">1_CS/ErrorsAndExceptions</code>
                                        中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><a href="https://github.com/ProfessionalCSharp/ProfessionalCSharp2021">https://github.com/ProfessionalCSharp/ProfessionalCSharp2021</a></code>
                                        找到。</font>
                                </font>
                            </font>
                        </p>
                        <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1">The code for this chapter is divided into the
                            following major examples:<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章的代码分为以下主要示例：</font>
                                </font>
                            </font>
                        </p>
                        <ul class="check" id="c10-list-0002"
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <li id="c10-li-0006" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">SimpleExceptions<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">简单异常 </font>
                                    </font>
                                </font>
                            </li>
                            <li id="c10-li-0007" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">ExceptionFilters<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">异常过滤器 </font>
                                    </font>
                                </font>
                            </li>
                            <li id="c10-li-0008" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">RethrowExceptions<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">重新抛出异常</font>
                                    </font>
                                </font>
                            </li>
                            <li id="c10-li-0009" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">SolicitColdCall</li>
                            <li id="c10-li-0010" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">CallerInformation<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">呼叫者信息</font>
                                    </font>
                                </font>
                            </li>
                        </ul>
                        <p id="c10-para-0005" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1">All the sample projects have nullable reference types
                            configured.<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">所有示例项目都已配置可空引用类型。</font>
                                </font>
                            </font>
                        </p>
                    </section>
                    <div class="bottom hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <hr />
                    </div>
                </section>
            </aside>
        </section> <span aria-label="264" epub:type="pagebreak" id="Page_264" role="doc-pagebreak"
            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
        <section aria-labelledby="head-2-89" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
            <span id="c10-sec-0003" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <h2 id="head-2-89" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">HANDLING ERRORS<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">处理错误</font>
                    </font>
                </font>
            </h2>
            <p id="c10-para-0006" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">Errors happen, and they are not always caused by the person who
                coded the application. Sometimes your application generates an error because of an action that was
                initiated by the end user of the application, or it might be simply due to the environmental context in
                which your code is running. In any case, you should anticipate errors occurring in your applications and
                code accordingly.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            错误会发生，并且并不总是由编写应用程序的人造成。有时你的应用程序生成错误是因为应用程序的最终用户发起的操作，或者可能仅仅是因为你的代码运行的环境上下文。无论如何，你应该预见你的应用程序中可能出现的错误，并相应地编写代码。
                        </font>
                    </font>
                </font>
            </p>
            <p id="c10-para-0007" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">.NET has enhanced the ways in which you deal with errors. C#'s
                mechanism for handling error conditions enables you to provide custom handling for each type of error
                condition and to separate the code that identifies errors from the code that handles them.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">.NET
                            增强了处理错误的方式。C#的错误处理机制使你能够为每种错误条件提供自定义处理，并将识别错误的代码与处理错误的代码分离。</font>
                    </font>
                </font>
            </p>
            <p id="c10-para-0008" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">Your programs should be capable of handling any possible errors
                that might occur. For example, in the middle of some complex processing of your code, you might discover
                that it doesn't have permission to read a file; or, while it is sending network requests, the network
                might go down. In such exceptional situations, it is not enough for a method to simply return an
                appropriate error code—there might be 15 or 20 nested method calls, so what you really want the program
                to do is jump back up through all those calls to exit the task completely and take the appropriate
                counteractions. The C# language has very good facilities for handling this kind of situation through the
                mechanism known as <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">exception
                    handling</i>.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            你的程序应该能够处理任何可能出现的错误。例如，在代码的某些复杂处理过程中，你可能会发现它没有权限读取文件；或者，在发送网络请求时，网络可能会中断。在这种情况下，一个方法仅仅返回一个适当的错误代码是不够的——可能存在
                            15 或 20 层嵌套方法调用，因此你真正希望程序能够通过所有这些调用返回，完全退出任务并采取适当的应对措施。C#语言通过异常处理机制提供了非常好的处理这种情况的功能。</font>
                    </font>
                </font>
            </p>
            <p id="c10-para-0009" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">This chapter covers catching and throwing exceptions in many
                different scenarios. You see exception types from different namespaces and their hierarchy, and you find
                out how to create custom exception types. You discover different ways to catch exceptions—for example,
                how to catch exceptions with the exact exception type or a base class. You also see how to deal with
                nested <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> blocks
                and how you could catch exceptions that way. For code that should be invoked no matter whether an
                exception occurs or the code continues with any error, you are introduced to creating <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                /
                <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> code blocks.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            本章涵盖了在多种不同场景下捕获和抛出异常。你将看到来自不同命名空间的异常类型及其层次结构，并了解到如何创建自定义异常类型。你将发现捕获异常的不同方法——例如，如何使用确切的异常类型或基类捕获异常。你还将看到如何处理嵌套的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                            块，以及如何通过这种方式捕获异常。对于无论是否发生异常或代码以任何错误继续执行都应该调用的代码，你将学习如何创建 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> /
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                            代码块。</font>
                    </font>
                </font>
            </p>
            <p id="c10-para-0010" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">By the end of this chapter, you will have a good grasp of
                advanced exception handling in your C# applications.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">到本章结束时，你将对 C# 应用程序中的高级异常处理有很好的掌握。
                        </font>
                    </font>
                </font>
            </p>
        </section>
        <section aria-labelledby="head-2-90" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
            <span id="c10-sec-0004" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <h2 id="head-2-90" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">PREDEFINED EXCEPTION CLASSES<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">预定义的异常类</font>
                    </font>
                </font>
            </h2>
            <p id="c10-para-0011" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">In C#, an exception is an object created (or <i
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">thrown</i>) when a particular
                exceptional error condition occurs. This object contains information that should help identify the
                problem. Although you can create your own exception classes (and you do so later), .NET includes many
                predefined exception classes. You can find all the .NET exceptions in the Microsoft documentation in the
                list of classes that derive from the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code> base class
                at <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><a href="https://docs.microsoft.com/dotnet/api/system.exception">https://docs.microsoft.com/dotnet/api/system.exception</a></code>.
                This large list only shows the exceptions that directly derive from <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>. When you
                click every other base class, for <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><a href="https://docs.microsoft.com/en-us/dotnet/api/system.systemexception">example https://docs.microsoft.com/en-us/dotnet/api/system.systemexception</a></code>,
                you see another large list of exception classes driving from <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SystemException</code>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在
                            C#中，异常是在特定异常错误条件发生时创建（或抛出）的对象。该对象包含应有助于识别问题的信息。尽管你可以创建自己的异常类（你稍后会这样做），但.NET 包含许多预定义的异常类。你可以在
                            Microsoft 文档中找到所有.NET 异常，位于从 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                            基类派生的类列表中。这个庞大的列表仅显示直接从 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                            派生的异常。当你点击每个其他基类时，对于 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><a href="https://docs.microsoft.com/en-us/dotnet/api/system.systemexception">example https://docs.microsoft.com/en-us/dotnet/api/system.systemexception</a></code>
                            ，你会看到另一个从 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SystemException</code>
                            派生的异常类的大列表。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">Here some really important exception types are explained:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">这里解释了一些非常重要的异常类型：</font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c10-list-0003" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <li id="c10-li-0011" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">When receiving arguments with a method, you should check the
                    arguments to determine whether they contain values as expected. If this is not the case, you can
                    throw an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ArgumentException</code>
                    or an exception that derives from this exception class like <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ArgumentNullException</code>
                    and <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ArgumentOutOfRangeException</code>.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                当方法接收参数时，你应该检查这些参数以确定它们是否包含预期的值。如果不是这样，你可以抛出一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ArgumentException</code>
                                或一个派生自这个异常类的异常，比如 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ArgumentNullException</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ArgumentOutOfRangeException</code>
                                。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0012" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NotSupportedException</code>
                    is thrown when a method is not supported—for example, from classes that implement interfaces but do
                    not implement all the members of the interface. You should not invoke methods that throw this
                    exception, so you should not handle this exception. This exception gives good information during
                    development time to change your code.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当方法不受支持时，会抛出 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NotSupportedException</code>
                                异常——例如，从实现了接口但未实现接口所有成员的类中调用方法。你不应该调用会抛出此异常的方法，因此也不应该处理此异常。这个异常在开发期间能提供良好的信息，帮助你修改代码。
                            </font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0013" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StackOverflowException</code>
                    is thrown by the runtime when the area of memory allocated for the stack is full. A stack overflow
                    can occur if a method continuously calls itself recursively. This is generally a fatal error because
                    it prevents your application from doing anything apart from terminating (in which case it is
                    unlikely that even the finally block will execute). Trying to handle errors like this yourself is
                    usually pointless; instead, you should have the application gracefully exit.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当为栈分配的内存区域已满时，运行时会抛出 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StackOverflowException</code>
                                异常。如果方法连续调用自身进行递归，可能会发生栈溢出。这通常是一个致命错误，因为它阻止你的应用程序除终止之外做任何事（在这种情况下，即使 finally
                                块也可能不会执行）。尝试自己处理这类错误通常是徒劳的；相反，你应该让应用程序优雅地退出。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0014" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1"><span aria-label="265" epub:type="pagebreak" id="Page_265"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>
                    is thrown after an arithmetic calculation and the value does not fit into the variable type—in a
                    checked context. Remember, you can create checked contexts with the checked keyword. Within the
                    checked context, if you attempt to cast an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code> containing a
                    value of –40 to an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">uint</code>, an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>
                    is thrown. Creating checked contexts is covered in <a href="c05.xhtml"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Chapter 5</a>, “Operators
                    and Casts.”<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>
                                是在算术计算后抛出的异常，并且计算结果不适合变量类型——在检查上下文中。记住，你可以使用 checked 关键字创建检查上下文。在检查上下文中，如果你尝试将包含 -40 值的
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code>
                                转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">uint</code>
                                ，会抛出 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>
                                。创建检查上下文的内容在第五章“运算符和类型转换”中介绍。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0015" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">For exceptions with file I/O, the base class <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IOException</code> is
                    defined. <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileLoadException</code>,
                    <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileNotFoundException</code>,
                    <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">EndOfStreamException</code>,
                    and <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">DriveNotFoundException</code>
                    are some examples that derive from this base class.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">对于文件 I/O 的异常，定义了基础类 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IOException</code>
                                。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileLoadException</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileNotFoundException</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">EndOfStreamException</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">DriveNotFoundException</code>
                                是从该基础类派生的一些示例。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0016" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">InvalidOperationException</code>
                    is typically thrown if methods of a class are not invoked in the correct order, for example, an
                    initialization call was missing.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">如果类的操作方法未按正确顺序调用，例如缺少初始化调用，通常会抛出
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">InvalidOperationException</code>
                                。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0017" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">TaskCanceledException</code>
                    is thrown on cancellation of tasks or timeouts.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在任务取消或超时时会抛出 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">TaskCanceledException</code>
                                。</font>
                        </font>
                    </font>
                </li>
            </ul>
            <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <p id="c10-para-0013" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Read the Microsoft
                            documentation for methods you invoke. Every method </i><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">that might throw
                            exceptions has documentation in the section “Exceptions” of which </i><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">exceptions can be
                            thrown. For example, the documentation for </i>
                        <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">GetStreamSync</code>
                        <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> from the </i>
                        <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HttpClient</code>
                        <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> class (</i><code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient.getstreamasync">https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient.getstreamasync</a></code><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">) lists </i>
                        <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ArgumentNullException</code>
                        <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">, </i>
                        <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HttpRequestException</code>
                        <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">, </i><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">and </i>
                        <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">TaskCanceledException</code>
                        <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意：请查阅 Microsoft
                                    文档了解您调用的方法。每个可能抛出异常的方法在“异常”部分都有文档说明可能抛出的异常。例如，来自 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HttpClient</code>
                                    类（ <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient.getstreamasync">https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient.getstreamasync</a></code>
                                    ）的 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">GetStreamSync</code>
                                    方法的文档列出了 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ArgumentNullException</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HttpRequestException</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">TaskCanceledException</code>
                                    。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <hr />
                    </div>
                </section>
            </aside>
            <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <p id="c10-para-0014" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Looking at the
                            hierarchy of the exception types, you might be wondering about the purpose of the base
                            classes </i><code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SystemException</code><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> and </i><code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ApplicationException</code><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">. With the original
                            design of .NET, it was planned to have </i><code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SystemException</code><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> as a base class for
                            all exceptions thrown from the runtime, and </i><code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ApplicationException</code><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> as a base class for
                            all application-defined exceptions. As it turned out, </i><code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ApplicationException</code><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> was rarely used as
                            the base class for specific exceptions. Nowadays, it's okay to directly derive your custom
                            exception from the </i><code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> base class.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意：查看异常类型的层次结构时，您可能会思考基类 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SystemException</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ApplicationException</code>
                                    的用途。在 .NET 的原始设计中，计划将 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SystemException</code>
                                    作为运行时抛出所有异常的基类，将 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ApplicationException</code>
                                    作为所有应用程序定义异常的基类。事实证明， <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ApplicationException</code>
                                    很少被用作特定异常的基类。如今，直接从 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                                    基类派生自定义异常是可以的。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <hr />
                    </div>
                </section>
            </aside>
        </section>
        <section aria-labelledby="head-2-91" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
            <span id="c10-sec-0007" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <h2 id="head-2-91" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">CATCHING EXCEPTIONS<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">捕获异常</font>
                    </font>
                </font>
            </h2>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">Given that .NET includes a selection of predefined base class
                exception objects, this section describes how you use them in your code to trap error conditions. In
                dealing with possible error conditions in C# code, you typically divide the relevant part of your
                program into blocks of three different types:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">鉴于 .NET
                            包含一组预定义的基类异常对象，本节将描述如何在您的代码中使用它们来捕获错误条件。在处理 C# 代码中的可能错误条件时，您通常将相关部分程序分为三种不同类型的块：</font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c10-list-0004" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <li id="c10-li-0018" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> blocks
                    encapsulate the code that forms part of the normal operation of your program and that might
                    encounter some serious error conditions.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块封装了构成程序正常操作的一部分代码，并且可能会遇到一些严重错误情况。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0019" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks
                    encapsulate the code dealing with the various error conditions that your code might have encountered
                    by working through any of the code in the accompanying <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block. This
                    block could also be used for logging errors.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块封装了处理代码可能遇到的各类错误情况的代码，通过在伴随的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块中的任何代码中执行。这个块也可以用于记录错误。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0020" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> blocks
                    encapsulate the code that cleans up any resources or takes any other action that you normally want
                    handled at the end of a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> or <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block. It is
                    important to understand that the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block is
                    executed whether an exception is thrown. Because the purpose of the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block is
                    to contain cleanup code that should always be executed, the compiler flags an error if you place a
                    <span aria-label="266" epub:type="pagebreak" id="Page_266" role="doc-pagebreak"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">return</code> statement
                    inside a <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                    block. An example of using the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block is
                    closing any connections that were opened in the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block.
                    Understand that the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block is
                    completely optional. If your application does not require any cleanup code (such as disposing of or
                    closing any open objects), then there is no need for this block.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块封装了清理任何资源或在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> 或
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块结束时通常希望处理的任何其他操作的代码。重要的是要理解 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块无论是否抛出异常都会被执行。由于 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块的目的是包含应该始终执行的清理代码，如果将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">return</code>
                                语句放置在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块内，编译器会报错。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块的一个示例是在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块中关闭打开的任何连接。理解 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块是完全可选的。如果您的应用程序不需要任何清理代码（例如释放或关闭任何打开的对象），那么就没有必要使用这个块。</font>
                        </font>
                    </font>
                </li>
            </ul>
            <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> blocks are a great
                            way to write some cleanup code. This block is executed in every case the </i><code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">/</i><code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> block is left. It's
                            executed on a successful return of the </i><code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code><i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> block and also
                            executed if an exception is thrown.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                    块是编写一些清理代码的好方法。当 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                    / <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                    块退出时，这个块会在所有情况下执行。当 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                    块成功返回时，它会被执行，如果抛出异常也会被执行。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <hr />
                    </div>
                </section>
            </aside>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">The following steps outline how these blocks work together to
                trap error conditions:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">以下步骤概述了这些模块如何协同工作以捕获错误情况：</font>
                    </font>
                </font>
            </p>
            <ol class="decimal" id="c10-list-0005"
                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <li id="c10-li-0021" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The execution flow first enters the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">执行流程首先进入 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                模块。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0022" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">If no errors occur in the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block,
                    execution proceeds normally through the block, and when the end of the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block is
                    reached, the flow of execution jumps to the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block if
                    one is present (step 5). However, if an error does occur within the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block,
                    execution jumps to a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block (step
                    3).<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">如果在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                模块中没有发生错误，执行将正常通过该模块，当到达 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                模块的末尾时，如果存在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                模块，执行流程将跳转到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                模块（步骤 5）。然而，如果在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                模块中发生错误，执行将跳转到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                模块（步骤 3）。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0023" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The error condition is handled in the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">错误情况在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                模块中处理。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0024" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">At the end of the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block,
                    execution automatically transfers to the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block if
                    one is present.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块的末尾，如果存在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块，执行将自动转移到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0025" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block is
                    executed (if present).<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">执行 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块（如果存在）。</font>
                        </font>
                    </font>
                </li>
            </ol>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">The C# syntax used to bring all this about looks roughly like
                this:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">用于实现这一切的 C#语法大致如下：</font>
                    </font>
                </font>
            </p>
            <pre id="c10-code-0001"><code>try</code>
<code>{</code>
<code>  // code for normal execution</code>
<code>}</code>
<code>catch</code>
<code>{</code>
<code>  // error handling</code>
<code>}</code>
<code>finally</code>
<code>{</code>
<code>  // clean up</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">A few variations on this theme exist:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">关于这个主题存在一些变体：</font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c10-list-0006" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <li id="c10-li-0026" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">You can omit the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block
                    because it is optional.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你可以省略 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块，因为它不是必需的。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0027" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">You can also supply as many <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks as
                    you want to handle specific types of errors. However, you don't want to get too carried away and
                    have a huge number of <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你也可以提供任意数量的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块来处理特定类型的错误。然而，你不想做得太过火，导致 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块数量过多。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0028" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">You can define filters with catch blocks to catch the
                    exception with the specific block only if the filter matches.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你可以使用 catch
                                块定义过滤器，只有当过滤器匹配时，才能用特定的块捕获异常。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0029" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">You can omit the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks
                    altogether, in which case the syntax serves not to identify exceptions but to guarantee that code in
                    the <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                    block will be executed when execution leaves the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block. This is
                    useful if the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block contains
                    several exit points. If you don't write a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block, a
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block is
                    required. You cannot use just a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block. What
                    would a <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                    block be good for without <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> or <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                    ?<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你可以完全省略 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块，在这种情况下，语法的作用不是识别异常，而是保证当执行离开 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块时， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块中的代码将被执行。如果 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块包含多个退出点，这很有用。如果你不写 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块，就需要 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块。你不能只用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块。没有 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> 或
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                ， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块有什么用？</font>
                        </font>
                    </font>
                </li>
            </ul>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1"><span aria-label="267" epub:type="pagebreak" id="Page_267"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>So far so good, but
                the question that has yet to be answered is this: if the code is running in the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block, how does it
                know when to switch to the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block if an
                error occurs? If an error is detected, the code does something known as <i
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throwing an exception</i>. In
                other words, it instantiates an exception object class and throws it:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">到目前为止一切顺利，但尚未回答的问题是：如果代码正在 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                            块中运行，当出现错误时，它如何知道何时切换到 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                            块？如果检测到错误，代码会执行一个称为抛出异常的操作。换句话说，它实例化一个异常对象类并将其抛出：</font>
                    </font>
                </font>
            </p>
            <pre id="c10-code-0002"><code>throw new OverflowException();</code></pre>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">Here, you have instantiated an exception object of the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>
                class. As soon as the application encounters a <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code> statement inside
                a <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block, it
                immediately looks for the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block associated
                with that <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block.
                If more than one <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block is
                associated with the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block, it
                identifies the correct <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block by
                checking which exception class the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block is
                associated with. For example, when the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>
                object is thrown, execution jumps to the following <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在这里，你实例化了 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>
                            类的异常对象。当应用程序在 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> 块内遇到
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code>
                            语句时，它会立即查找与该 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> 块关联的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                            块。如果与 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> 块关联的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                            块超过一个，它会通过检查 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                            块与哪个异常类关联来识别正确的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                            块。例如，当 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>
                            对象被抛出时，执行将跳转到以下 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> 块：
                        </font>
                    </font>
                </font>
            </p>
            <pre id="c10-code-0003"><code>catch (OverflowException ex)</code>
<code>{</code>
<code>  // exception handling here</code>
<code>}</code></pre>
            <p id="c10-para-0023" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">In other words, the application looks for the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block that
                indicates a matching exception class instance of the same class (or of a base class).<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">换句话说，应用程序会寻找表示匹配的异常类实例的 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                            块（该实例与同一类或基类相同）。</font>
                    </font>
                </font>
            </p>
            <p id="c10-para-0024" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">With this extra information, you can extend the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block with
                multiple <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                blocks. Assume, for the sake of argument, that two possible serious errors can occur in the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block: an overflow
                and an array out of bounds. Assume also that your code contains two Boolean variables, <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Overflow</code> and <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OutOfBounds</code>, which
                indicate whether these conditions exist. You have already seen that a predefined exception class exists
                to indicate overflow (<code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>);
                similarly, an <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                class exists to handle an array that is out of bounds.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">有了这些额外信息，你可以用多个 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> 块扩展
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                            块。假设为了论证， <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                            块中可能发生两种严重错误：溢出和数组越界。假设你的代码包含两个布尔变量 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Overflow</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OutOfBounds</code>
                            ，它们指示这些条件是否存在。你已经看到存在一个预定义的异常类来指示溢出（ <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>
                            ）；类似地，存在一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                            类来处理越界的数组。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">Now your <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block looks like
                this:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">现在你的 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                            块看起来是这样的：</font>
                    </font>
                </font>
            </p>
            <pre id="c10-code-0004"><code>try</code>
<code>{</code>
<code>  // code for normal execution</code>
<code>  if (Overflow == true)</code>
<code>  {</code>
<code>    throw new OverflowException();</code>
<code>  }</code>
<code>  // more processing</code>
<code>  if (OutOfBounds == true)</code>
<code>  {</code>
<code>    throw new IndexOutOfRangeException();</code>
<code>  }</code>
<code>  // otherwise continue normal execution</code>
<code>}</code>
<code>catch (OverflowException ex)</code>
<code>{</code>
<code>  // error handling for the overflow error condition</code>
<code>}</code>
<code>catch (IndexOutOfRangeException ex)</code>
<code>{</code>
<code>  // error handling for the index out of range error condition</code>
<code>}</code>
<code>finally</code>
<code>{</code>
<code>  // clean up</code>
<code>}</code></pre>
            <p id="c10-para-0026" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">This is because you can have <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code> statements that
                are nested in several method calls inside the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block, but the
                same <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block
                continues to apply even as execution flow enters these other methods. If the application <span
                    aria-label="268" epub:type="pagebreak" id="Page_268" role="doc-pagebreak"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>encounters a <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code> statement, it
                immediately goes back up through all the method calls on the stack, looking for the end of the
                containing <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block
                and the start of the appropriate <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block. During
                this process, all the local variables in the intermediate method calls will correctly go out of scope.
                This makes the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try…catch</code> architecture
                well suited to the situation described at the beginning of this section, whereby the error occurs inside
                a method call that is nested inside 15 or 20 method calls, and processing must stop immediately.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">这是因为你可以在 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code>
                            代码块中嵌套多个方法调用，但相同的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                            代码块在执行流进入这些其他方法时仍然适用。如果应用程序遇到 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code>
                            代码块，它会立即通过堆栈上的所有方法调用返回，寻找包含的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                            代码块的结束和适当的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                            代码块的开始。在此过程中，中间方法调用中的所有局部变量将正确地超出作用域。这使得 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try…catch</code>
                            架构非常适合本节开头描述的情况，即错误发生在嵌套在 15 或 20 个方法调用中的方法调用内，并且处理必须立即停止。</font>
                    </font>
                </font>
            </p>
            <p id="c10-para-0027" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">As you can probably gather from this discussion, <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> blocks can play a
                significant role in controlling the flow of your code's execution. However, it is important to
                understand that exceptions are intended for exceptional conditions, hence their name. You wouldn't want
                to use them as a way of controlling when to exit a <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">do…while</code> loop.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">从这次讨论中，你可能已经可以推断出， <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                            块在控制代码执行流程方面可以发挥重要作用。然而，重要的是要理解异常是为异常情况设计的，这也是它们名称的由来。你不会想用它们来控制何时退出 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">do…while</code>
                            循环。</font>
                    </font>
                </font>
            </p>
            <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0009"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                <h3 id="head-3-210" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Exceptions and Performance <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">异常与性能</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Exception handling has a performance implication. In cases
                    that are common, you shouldn't use exceptions to deal with errors. For example, when converting a
                    string to a number, you can use the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Parse</code> method of
                    the <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code> type.
                    This method throws a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code> in
                    case the <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">string</code>
                    passed to this method can't be converted to a number, and it throws an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>
                    if a number can be converted but it doesn't fit into an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                异常处理会对性能产生影响。在常见情况下，你不应该使用异常来处理错误。例如，在将字符串转换为数字时，你可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code>
                                类型的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Parse</code>
                                方法。如果传递给这个方法的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">string</code>
                                不能转换为数字，这个方法会抛出一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                                异常；如果数字可以转换，但它不适合放入一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code>
                                中，则会抛出一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">OverflowException</code>
                                异常：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0005"><code>void NumberDemo1(string n)</code>
<code>{</code>
<code>  if (n is null) throw new ArgumentNullException(nameof(n));</code>
<code>  try</code>
<code>  {</code>
<code>    <b>int i = int.Parse(n);</b></code>
<code>    Console.WriteLine($"converted: {i}");</code>
<code>  }</code>
<code>  <b>catch (FormatException ex)</b></code>
<code>  {</code>
<code>    Console.WriteLine(ex.Message);</code>
<code>  }</code>
<code>  <b>catch (OverflowException ex)</b></code>
<code>  {</code>
<code>    Console.WriteLine(ex.Message);</code>
<code>  }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">If the method <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NumberDemo1</code> is
                    typically used only in a way to pass numbers in a string and receiving something other than a number
                    is exceptional, it's okay to program it this way. However, in cases when it's normal for the program
                    flow to expect strings that cannot be converted, you can use the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">TryParse</code> method.
                    This method doesn't throw an exception if the string cannot be converted to a number. Instead, <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">TryParse</code> returns
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">true</code> if parsing
                    succeeds, and it returns <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">false</code> if parsing
                    fails:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">如果方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NumberDemo1</code>
                                通常仅用于在字符串中传递数字，而接收到的不是数字是异常情况，那么这样编程是可以的。然而，在程序流程通常预期字符串且无法转换为字符串的情况下，你可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">TryParse</code>
                                方法。该方法在字符串无法转换为数字时不会抛出异常。相反，如果解析成功， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">TryParse</code>
                                返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">true</code>
                                ，如果解析失败，则返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">false</code>
                                ：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0006"><code>void NumberDemo2(string n)</code>
<code>{</code>
<code>  if (n is null) throw new ArgumentNullException(nameof(n));</code>
<code>  if (<b>int.TryParse(n, out int result)</b>)</code>
<code>  {</code>
<code>    Console.WriteLine($"converted {result}");</code>
<code>  }</code>
<code>  else</code>
<code>  {</code>
<code>    Console.WriteLine("not a number");</code>
<code>  }</code>
<code>}</code></pre>
            </section> <span aria-label="269" epub:type="pagebreak" id="Page_269" role="doc-pagebreak"
                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0010"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                <h3 id="head-3-211" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Implementing Multiple Catch Blocks <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">实现多个捕获块</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The easiest way to see how <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try…catch…finally</code>
                    blocks work in practice is with a couple of examples. The first example is called <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SimpleExceptions</code>.
                    It repeatedly asks the user to type a number and then displays it. However, for the sake of this
                    example, imagine that the number must be between 0 and 5; otherwise, the program isn't able to
                    process the number properly. Therefore, you throw an exception if the user types anything outside
                    this range. The program then continues to ask for more numbers for processing until the user presses
                    the Enter key without entering anything.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">最直观地了解 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try…catch…finally</code>
                                块实际工作方式的方法是看几个例子。第一个例子叫做 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SimpleExceptions</code>
                                。它反复要求用户输入一个数字，然后显示该数字。然而，为了这个例子，假设这个数字必须在 0 到 5
                                之间；否则，程序无法正确处理这个数字。因此，如果用户输入的范围之外的任何内容，你就会抛出异常。然后程序继续要求输入更多数字进行处理，直到用户在没有任何输入的情况下按下
                                Enter 键。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <p id="c10-para-0031" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <i
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">You should note
                                that this code does not provide a good example of when to use exception handling, but it
                                does show good practice on how to use exception handling. As their name suggests,
                                exceptions are provided for other than normal circumstances. Users often type silly
                                things, so this situation doesn't really count. Normally, your program handles incorrect
                                user input by performing an instant check and asking the user to retype the input if it
                                isn't valid. However, generating exceptional situations is difficult in a small example
                                that you can read through in a few minutes, so I'm making do with this less-than-ideal
                                one to demonstrate how exceptions work. The examples that follow present more realistic
                                situations.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意
                                        你应该注意到这段代码并不是一个使用异常处理的良好示例，但它确实展示了使用异常处理的良好实践。正如它们的名字所暗示的，异常是为了处理非正常情况而提供的。用户经常输入一些愚蠢的东西，所以这种情况并不能真正算作异常。通常，你的程序通过即时检查来处理错误的用户输入，如果输入无效，则要求用户重新输入。然而，在一个几分钟内就能读完的小示例中生成异常情况是困难的，所以我只能用这个不太理想的示例来演示异常是如何工作的。接下来的示例展示了更现实的情况。
                                    </font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The code for <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SimpleExceptions</code>
                    looks like this (code file <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SimpleExceptions/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SimpleExceptions</code>
                                的代码如下（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SimpleExceptions/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0007"><code>while (true)</code>
<code>{</code>
<code>  try</code>
<code>  {</code>
<code>    Console.Write("Input a number between 0 and 5 " +</code>
<code>      "(or just hit return to exit)&gt; ");</code>
<code>    string? userInput = Console.ReadLine();</code>
<code> </code>
<code>    if (string.IsNullOrEmpty(userInput))</code>
<code>    {</code>
<code>      break;</code>
<code>    }</code>
<code> </code>
<code>    int index = Convert.ToInt32(userInput);</code>
<code> </code>
<code>    if (index &lt; 0 || index&gt; 5)</code>
<code>    {</code>
<code>      throw new IndexOutOfRangeException($"You typed in {userInput}");</code>
<code>    }</code>
<code>    Console.WriteLine($"Your number was {index}");</code>
<code>  }</code>
<code>  catch (IndexOutOfRangeException ex)</code>
<code>  {</code>
<code>    Console.WriteLine("Exception: " +</code>
<code>      $"Number should be between 0 and 5. {ex.Message}");</code>
<code>  }</code>
<code>  catch (Exception ex)</code>
<code>  {</code>
<code>    Console.WriteLine($"An exception was thrown. Exception type: {ex.GetType().Name} " +    </code>
<code>      $"Message: {ex.Message}");</code>
<code>  }<span aria-label="270" epub:type="pagebreak" id="Page_270" role="doc-pagebreak"></span></code>
<code>  finally</code>
<code>  {</code>
<code>    Console.WriteLine("Thank you\n");</code>
<code>  }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The core of this code is a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code> loop, which
                    continually uses <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ReadLine</code> to ask
                    for user input. <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ReadLine</code> returns a
                    string, so your first task is to convert it to an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code> using the
                    <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Convert.ToInt32</code>
                    method. The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Convert</code>
                    class contains various useful methods to perform data conversions, and it provides an alternative to
                    the <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int.Parse</code>
                    method. In general, <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Convert</code>
                    contains methods to perform various type conversions. Recall that the C# compiler resolves <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code> to instances
                    of the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Int32</code> base
                    class.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这段代码的核心是一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code>
                                循环，它不断地使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ReadLine</code>
                                来请求用户输入。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ReadLine</code>
                                返回一个字符串，所以你的第一个任务是使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Convert.ToInt32</code>
                                方法将其转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code> 。
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Convert</code>
                                类包含各种用于执行数据转换的实用方法，它为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int.Parse</code>
                                方法提供了另一种选择。通常， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Convert</code>
                                包含执行各种类型转换的方法。回想一下，C# 编译器将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code>
                                解析为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Int32</code>
                                基类实例。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <p id="c10-para-0034" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <i
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">It is also worth
                                pointing out that the parameter passed to the </i>
                            <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> block is scoped
                                to that </i>
                            <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> block—which is
                                why you can use the same parameter name, </i>
                            <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ex</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">, in successive
                            </i>
                            <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> blocks in the
                                preceding code.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意：还值得指出的是，传递给 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                        块的参数在该 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                        块的作用域内——这就是为什么在前面的代码中，你可以在连续的 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                        块中使用相同的参数名 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ex</code>
                                        。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p id="c10-para-0035" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">In the preceding example, you also check for an empty string
                    because it is your condition for exiting the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code> loop. Notice
                    how the <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">break</code>
                    statement breaks right out of the enclosing <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block as well
                    as the <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code>
                    loop because this is valid behavior. Of course, when execution breaks out of the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block, the
                    <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Console.WriteLine</code>
                    statement in the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block is
                    executed. Although you just display a greeting here, more commonly you will be doing tasks such as
                    closing file handles and calling the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code> method of
                    various objects to perform any cleanup. After the application leaves the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block, it
                    simply carries on executing into the next statement that it would have executed had the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block not
                    been present. In the case of this example, though, you iterate back to the start of the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code> loop and
                    enter the <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                    block again (unless the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block was
                    entered as a result of executing the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">break</code> statement in
                    the <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code> loop,
                    in which case you simply exit the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code> loop).<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在之前的示例中，你也检查了空字符串，因为这是你退出 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code>
                                循环的条件。注意 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">break</code>
                                语句如何直接跳出包含的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块以及 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code>
                                循环，因为这是有效的行为。当然，当执行跳出 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块时， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Console.WriteLine</code>
                                语句会被执行。虽然这里你只是显示一个问候，但更常见的是你需要执行诸如关闭文件句柄和调用各种对象的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code>
                                方法等任务来进行清理。当应用程序离开 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块后，它会继续执行到下一个语句，这个语句本应在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块不存在的情况下被执行。在这个示例中，不过，你会回到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code>
                                循环的开始并再次进入 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块（除非 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块是作为执行 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code>
                                循环中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">break</code>
                                语句的结果而进入的，在这种情况下，你只需退出 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">while</code>
                                循环）。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Next, you check for your exception condition:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">接下来，你检查你的异常条件：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0008"><code>if (index &lt; 0 || index&gt; 5)</code>
<code>{</code>
<code>  throw new IndexOutOfRangeException($"You typed in {userInput}");</code>
<code>}</code></pre>
                <p id="c10-para-0037" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">When throwing an exception, you need to specify what type of
                    exception to throw. Although the class <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Exception</code>
                    is available, it is intended only as a base class. It is considered bad programming practice to
                    throw an instance of this class as an exception because it conveys no information about the nature
                    of the error condition. .NET contains many other exception classes that are derived from <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>. Each of
                    these matches a particular type of exception condition, and you are free to define your own as well.
                    The goal is to provide as much information as possible about the particular exception condition by
                    throwing an instance of a class that matches the particular error condition. In the preceding
                    example, <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.IndexOutOfRangeException</code>
                    is the best choice for the circumstances. <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                    has several constructor overloads. The one chosen in the example takes a string describing the
                    error. Alternatively, you might choose to derive your own custom <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code> object
                    that describes the error condition in the context of your application.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">抛出异常时，需要指定要抛出哪种类型的异常。尽管类 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Exception</code>
                                可用，但它仅作为基类存在。将此类实例作为异常抛出被认为是一种不良编程实践，因为它不提供有关错误状态本质的信息。.NET 包含许多其他从 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                                派生的异常类。这些类中的每一个都与特定的异常条件相匹配，并且你可以自由地定义自己的异常类。目标是通过抛出与特定错误条件相匹配的类的实例来提供尽可能多的关于该异常条件的信息。在前面示例中，
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.IndexOutOfRangeException</code>
                                是这种情况下的最佳选择。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                                有多个构造函数重载。示例中选择的构造函数接受一个描述错误的字符串。或者，你也可以选择在应用程序的上下文中描述错误状态的自定义 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                                对象。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Suppose that the user next types a number that is not between
                    0 and 5. The number is picked up by the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">if</code> statement, and
                    an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                    object is instantiated and thrown. At this point, the application immediately exits the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block and
                    hunts for a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block that
                    handles <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>.
                    The first <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                    block it encounters is this:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">假设用户接下来输入一个不在 0 到 5 之间的数字。该数字被
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">if</code>
                                语句捕获，并实例化一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                                对象并抛出。此时，应用程序立即退出 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块，并寻找处理 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                                的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块。它遇到的第一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块是：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0009"><code>catch (IndexOutOfRangeException ex)</code>
<code>{</code>
<code>  Console.WriteLine($"Exception: Number should be between 0 and 5." +   </code>
<code>    $"{ex.Message}");</code>
<code>}</code></pre>
                <p id="c10-para-0039" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1"><span aria-label="271" epub:type="pagebreak" id="Page_271"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>Because this <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block takes
                    a parameter of the appropriate class, the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block
                    receives the exception instance and is executed. In this case, you display an error message and the
                    <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception.Message</code>
                    property (which corresponds to the string passed to the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                    's constructor). After executing this <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block,
                    control then switches to the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block,
                    just as if no exception had occurred.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">由于这个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块接受适当类别的参数， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块接收异常实例并执行。在这种情况下，你显示一个错误消息和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception.Message</code>
                                属性（对应于传递给 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                                构造函数的字符串）。执行完这个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块后，控制权切换到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块，就像没有发生异常一样。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Notice that in the example you have also provided another
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block:
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">请注意，在你提供的示例中，你还提供了一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0010"><code>catch (Exception ex)</code>
<code>{</code>
<code>  Console.WriteLine($"An exception was thrown. Message was: {ex.Message}");</code>
<code>}</code></pre>
                <p id="c10-para-0041" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">This <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block would
                    also be capable of handling an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                    if it weren't for the fact that such exceptions will already have been caught by the previous <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block. A
                    reference to a base class can also refer to any instances of classes derived from it, and all
                    exceptions are derived from <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>. This
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block
                    isn't executed because the application executes only the first suitable <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block it
                    finds from the list of available <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks. This
                    catch block isn't executed when an exception of type <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                    is thrown. The application executes only the first suitable catch block it finds from the list of
                    available catch blocks. This second catch block catches other exceptions derived from the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code> base
                    class. Be aware that the three separate calls to methods within the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block (<code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Console.ReadLine</code>,
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Console.Write</code>,
                    and <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Convert.ToInt32</code>)
                    might throw other exceptions.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块也能够处理一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                                ，但事实是，此类异常已经被之前的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块捕获了。对基类的引用也可以引用它派生出的任何类的实例，并且所有异常都派生自 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                                。这个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块不会被执行，因为应用程序只执行它找到的第一个合适的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块，从可用的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块列表中。当抛出一个类型为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                                的异常时，这个 catch 块不会被执行。应用程序只执行它找到的第一个合适的 catch 块，从可用的 catch 块列表中。这个第二个 catch 块捕获派生自 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                                基类的其他异常。请注意， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块内的三个方法调用（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Console.ReadLine</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Console.Write</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Convert.ToInt32</code>
                                ）可能会抛出其他异常。</font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0042" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">If the user types something that is not a number—say <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">a</code> or <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">hello</code>
                    —the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Convert.ToInt32</code>
                    method throws an exception of the class <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.FormatException</code>
                    to indicate that the string passed into <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ToInt32</code> is not in
                    a format that can be converted to an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code>. When this
                    happens, the application traces back through the method calls, looking for a handler that can handle
                    this exception. Your first <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block (the
                    one that takes an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>)
                    will not do. The application then looks at the second <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block. This
                    one will do because <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code> is
                    derived from <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>, so a
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                    instance can be passed in as a parameter here.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">如果用户输入的不是数字——比如 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">a</code> 或
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">hello</code>
                                ——那么 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Convert.ToInt32</code>
                                方法会抛出一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.FormatException</code>
                                类型的异常，以表示传入 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ToInt32</code>
                                的字符串不是可以转换为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">int</code>
                                的格式。当这种情况发生时，应用程序会回溯方法调用链，寻找能够处理这个异常的处理器。你的第一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块（那个接受 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                                的）将不会处理。应用程序接着查看第二个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块。这个块可以处理，因为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                                继承自 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                                ，所以一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                                实例可以作为参数传递到这里。</font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0043" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The structure of the example is fairly typical of a situation
                    with multiple <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks. You
                    start with <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                    blocks that are designed to trap specific error conditions. Then, you finish with more general
                    blocks that cover any errors for which you have not written specific error handlers. Indeed, the
                    order of the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks is
                    important. Had you written the previous two blocks in the opposite order, the code would not have
                    compiled because the second <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block is
                    unreachable (the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception catch</code>
                    block would catch all exceptions). Therefore, the uppermost <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks
                    should be the most granular options available, ending with the most general options.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">示例的结构在包含多个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块的情况下相当典型。你首先使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块来捕获特定的错误条件。然后，你用更通用的块来覆盖那些你未编写特定错误处理器的错误。确实， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块的顺序很重要。如果你将前两个块以相反的顺序编写，代码将无法编译，因为第二个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块是不可达的（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception catch</code>
                                块将捕获所有异常）。因此，最上层的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块应该是可用的最细粒度选项，最后以最通用的选项结束。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Now that you have analyzed the code for the example, you can
                    run it. The following output illustrates what happens with different inputs and demonstrates both
                    the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                    and the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                    being thrown:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                现在你已经分析了示例的代码，可以运行它。以下输出展示了不同输入时发生的情况，并演示了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                                被抛出：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0011"><code>Input a number between 0 and 5 (or just hit return to exit)&gt; 4</code>
<code>Your number was 4</code>
<code>Thank you</code>
<code>Input a number between 0 and 5 (or just hit return to exit)&gt; 0</code>
<code>Your number was 0</code>
<code>Thank you</code>
<code>Input a number between 0 and 5 (or just hit return to exit)&gt; 10</code>
<code>Exception: Number should be between 0 and 5. You typed in 10</code>
<code>Thank you</code>
<code>Input a number between 0 and 5 (or just hit return to exit)&gt; hello</code>
<code>An exception was thrown. Exception type: FormatException, Message: Input string was not in a correct format.</code>
<code>Thank you</code>
<code>Input a number between 0 and 5 (or just hit return to exit)&gt;</code>
<code>Thank you</code></pre>
            </section> <span aria-label="272" epub:type="pagebreak" id="Page_272" role="doc-pagebreak"
                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0013"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                <h3 id="head-3-212" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Catching Exceptions from Other Code <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">从其他代码捕获异常</font>
                        </font>
                    </font>
                </h3>
                <p id="c10-para-0045" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The previous example demonstrates the handling of two
                    exceptions. One of them, <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>,
                    was thrown by your own code. The other, <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>,
                    was thrown from inside one of the base classes. It is common for code in a library to throw an
                    exception if it detects that a problem has occurred or if one of the methods has been called
                    inappropriately by being passed the wrong parameters. However, library code rarely attempts to catch
                    exceptions; this is regarded as the responsibility of the client code.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">之前的示例展示了如何处理两个异常。其中一个， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                                ，是由您自己的代码抛出的。另一个， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                                ，是从其中一个基类内部抛出的。如果库中的代码检测到问题发生或某个方法被传递了错误的参数而调用不当，通常会抛出异常。然而，库代码很少尝试捕获异常；这被认为是客户端代码的责任。
                            </font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0046" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Often, exceptions are thrown from the base class libraries
                    while you are debugging. The process of debugging to some extent involves determining why exceptions
                    have been thrown and removing the causes. Your aim should be to ensure that by the time the code is
                    actually shipped, exceptions occur only in exceptional circumstances and, if possible, are handled
                    appropriately in your code.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                在调试过程中，异常通常是从基类库中抛出的。调试过程在一定程度上涉及确定异常的原因并移除这些原因。您的目标应该是确保在代码实际发布时，异常只在特殊情况下发生，并且如果可能的话，在您的代码中适当地处理这些异常。
                            </font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0014"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                <h3 id="head-3-213" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">System.Exception Properties <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">System.Exception 属性</font>
                        </font>
                    </font>
                </h3>
                <p id="c10-para-0047" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The example illustrated the use of only the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Message</code> property
                    of the exception object. However, a number of other properties are available in <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Exception</code>,
                    as shown in the following table:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">该示例仅展示了异常对象 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Message</code>
                                属性的使用。然而， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Exception</code>
                                中还有其他一些属性，如下表所示：</font>
                        </font>
                    </font>
                </p>
                <table border="1" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <thead data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <tr data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <th class="left bgcolor2" scope="col">PROPERTY</th>
                            <th class="left bgcolor2" scope="col">DESCRIPTION</th>
                        </tr>
                    </thead>
                    <tbody data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <tr data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Data</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">Enables you to add key/value statements to the
                                exception that can be used to supply extra information about it.<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">
                                            允许您向异常添加键/值语句，以便提供有关它的额外信息。 </font>
                                    </font>
                                </font>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HelpLink</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">A link to a help file that provides more
                                information about the exception.<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">指向提供有关异常更多信息的帮助文件的链接。
                                        </font>
                                    </font>
                                </font>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HResult</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">A numerical value that is assigned to the
                                exception.<font class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">分配给异常的数值。</font>
                                    </font>
                                </font>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">InnerException</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">If this exception was thrown inside a <code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                block, then <code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">InnerException</code>
                                contains the exception object that sent the code into that <code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                block.<font class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">如果这个异常是在 <code
                                                xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                            块中抛出的，那么 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">InnerException</code>
                                            包含发送代码进入那个 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                            块的异常对象。</font>
                                    </font>
                                </font>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Message</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">Text that describes the error condition.<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">描述错误状态的文本。</font>
                                    </font>
                                </font>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Source</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">The name of the application or object that caused
                                the exception.<font class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">导致异常的应用程序或对象的名称。
                                        </font>
                                    </font>
                                </font>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StackTrace</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">Provides details about the method calls on the
                                stack (to help track down the method that threw the exception).<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">
                                            提供有关调用堆栈上的方法的信息（以帮助追踪抛出异常的方法）。</font>
                                    </font>
                                </font>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">TargetSite</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1">A .NET reflection object that describes the
                                method that threw the exception.<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">一个描述抛出异常的方法的 .NET
                                            反射对象。</font>
                                    </font>
                                </font>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The property value for <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StackTrace</code> is
                    supplied automatically by the .NET runtime if a stack trace is available. <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Source</code> will always
                    be filled in by the .NET runtime as the name of the assembly in which the exception was raised
                    (though you might want to modify the property in your code to give more specific information),
                    whereas <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Data</code>,
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Message</code>, <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HelpLink</code>, and
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">InnerException</code>
                    must be filled in by the code that threw the exception, by setting these properties immediately
                    before throwing the exception. For example, the code to throw an exception might look something like
                    this:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StackTrace</code>
                                的属性值由.NET 运行时在存在堆栈跟踪时自动提供。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Source</code>
                                始终由.NET 运行时填写为引发异常的程序集名称（尽管你可能希望修改代码中的属性以提供更具体的信息），而 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Data</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Message</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HelpLink</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">InnerException</code>
                                必须由引发异常的代码填写，通过在抛出异常前立即设置这些属性。例如，抛出异常的代码可能看起来像这样：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0012"><code>if (ErrorCondition)</code>
<code>{</code>
<code>  ClassMyException myException = new("Help!!!!");</code>
<code>  myException.Source = "My Application Name";</code>
<code>  myException.HelpLink = "MyHelpFile.txt";</code>
<code>  myException.Data["ErrorDate"] = DateTime.Now;</code>
<code>  myException.Data.Add("AdditionalInfo", "Contact Bill from the Blue Team");</code>
<code>  throw myException;</code>
<code>}</code></pre>
                <p id="c10-para-0050" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1"><span aria-label="273" epub:type="pagebreak" id="Page_273"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>Here, <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ClassMyException</code>
                    is the name of the particular exception class you are throwing. Note that it is common practice for
                    the names of all exception classes to end with <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>. The
                    string passed to the constructor sets the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Message</code> property.
                    In addition, note that the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Data</code> property is
                    assigned in two possible ways.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在这里， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ClassMyException</code>
                                是你正在抛出的特定异常类的名称。请注意，所有异常类名称以 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                                结尾是一种常见做法。传递给构造函数的字符串设置 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Message</code>
                                属性。此外，请注意 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Data</code>
                                属性以两种可能的方式被分配。</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0015"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                <h3 id="head-3-214" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Exception Filters <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">异常过滤器</font>
                        </font>
                    </font>
                </h3>
                <p id="c10-para-0051" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">With the many different exception types and the hierarchy of
                    exceptions, the original plan with .NET was as soon as you need to handle errors differently, use a
                    different exception type. With many technologies used with .NET, this turned out to not be a
                    practical scenario. For example, using the Windows Runtime often results in COM exceptions, and you
                    want to handle <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">COMException</code>
                    differently based on the error code from this exception. To deal with this, C# 6 was enhanced to
                    support exception filters. A <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block runs
                    only if the filter returns <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">true</code>. You can have
                    different <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                    blocks that act differently when catching different exception types. In some scenarios, it's useful
                    to have the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks act
                    differently based on the content of an exception. When doing network calls, you get a network
                    exception for many different scenarios—for example, if the server is not available or the data
                    supplied do not match the expectations. It's good to react to these errors differently. Some
                    exceptions can be recovered in different ways, whereas with others, the user might need some
                    information.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">由于存在多种不同的异常类型以及异常的层次结构，.NET
                                最初的计划是：当你需要以不同方式处理错误时，就使用不同的异常类型。然而，在使用.NET 的许多技术中，这并非一个实用的场景。例如，使用 Windows Runtime
                                通常会导致出现 COM 异常，并且你希望根据该异常的错误代码以不同的方式处理 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">COMException</code>
                                。为了解决这个问题，C# 6 被增强以支持异常过滤器。一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块只有在过滤器返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">true</code>
                                时才会执行。你可以设置不同的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块，以便在捕获不同类型的异常时以不同的方式处理。在某些场景下，根据异常的内容让 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块以不同的方式执行是有用的。在进行网络调用时，你会因为许多不同的情况而得到网络异常——例如，如果服务器不可用或提供的数据与预期不符。针对这些错误以不同的方式做出反应是好的。有些异常可以通过不同的方式恢复，而对于其他异常，用户可能需要一些信息。
                            </font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The following code sample throws the exception of type <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">MyCustomException</code>
                    and sets the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ErrorCode</code> property
                    of this exception (code file <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ExceptionFilters/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">以下代码示例抛出类型为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">MyCustomException</code>
                                的异常，并设置该异常的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ErrorCode</code>
                                属性（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ExceptionFilters/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0013"><code>public static void ThrowWithErrorCode(int code)</code>
<code>{</code>
<code>  throw new MyCustomException("Error in Foo") { ErrorCode = code };</code>
<code>}</code></pre>
                <p id="c10-para-0053" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">In the following example, the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block
                    safeguards the method invocation with two <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks. The
                    first catch <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">block</code> uses the
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">when</code> keyword to
                    filter only exceptions if the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ErrorCode</code> property
                    equals <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">405</code>. The
                    expression for the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">when</code> clause needs
                    to return a Boolean value. If the result is <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">true</code>, this <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block
                    handles the exception. If it is <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">false</code>, other
                    catches are looked for. When passing <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">405</code> to the method
                    <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ThrowWithErrorCode</code>,
                    the filter returns <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">true</code>, and the
                    first <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                    handles the exception. When passing another value, the filter returns <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">false</code>, and the
                    second <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                    handles the exception. With filters, you can have multiple handlers to handle the same exception
                    type.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在以下示例中， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块使用两个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块保护方法调用。第一个 catch <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">block</code>
                                使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">when</code>
                                关键字仅过滤 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ErrorCode</code>
                                属性等于 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">405</code>
                                的异常。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">when</code>
                                子句的表达式需要返回布尔值。如果结果是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">true</code>
                                ，则此 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块处理异常。如果它是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">false</code>
                                ，则查找其他 catch。当将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">405</code>
                                传递给方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ThrowWithErrorCode</code>
                                时，过滤器返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">true</code>
                                ，第一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                处理异常。当传递其他值时，过滤器返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">false</code>
                                ，第二个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                处理异常。使用过滤器，您可以有多个处理器来处理相同的异常类型。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Of course, you can also remove the second <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block and
                    not handle the exception in that circumstance.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当然，你也可以移除第二个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块，并在那种情况下不处理异常。</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0014"><code>try</code>
<code>{</code>
<code>  ThrowWithErrorCode(405);</code>
<code>}</code>
<code>catch (MyCustomException ex) <b>when (ex.ErrorCode == 405)</b></code>
<code>{</code>
<code>  Console.WriteLine($"Exception caught with filter {ex.Message} " + </code>
<code>    $"and {ex.ErrorCode}");</code>
<code>}</code>
<code>catch (MyCustomException ex)</code>
<code>{</code>
<code>  Console.WriteLine($"Exception caught {ex.Message} and {ex.ErrorCode}");</code>
<code>}</code></pre>
            </section>
            <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0016"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                <h3 id="head-3-215" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Rethrowing Exceptions <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">重新抛出异常</font>
                        </font>
                    </font>
                </h3>
                <p id="c10-para-0055" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">When you catch exceptions, it's common to rethrow exceptions,
                    which means you can change the exception type while throwing the exception again. With this method,
                    you can give the caller more information about what happened. The original exception might not have
                    enough information about the context of what was going on. You can also log exception information
                    and give the caller different information. For example, for a user running the application,
                    exception information does not really help. A system administrator reading log files can react
                    accordingly.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                当你捕获异常时，通常会选择重新抛出异常，这意味着你可以在再次抛出异常时改变异常类型。通过这种方法，你可以向调用者提供更多关于发生情况的信息。原始异常可能没有足够的信息来描述当时的情况。你也可以记录异常信息，并给调用者提供不同的信息。例如，对于运行应用程序的用户来说，异常信息并没有太大的帮助。而系统管理员在阅读日志文件时可以采取相应的措施。
                            </font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0056" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1"><span aria-label="274" epub:type="pagebreak" id="Page_274"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>An issue with
                    rethrowing exceptions is that the caller often needs to find out the reason for what happened with
                    the earlier exception, and where it happened. Depending on how exceptions are thrown, stack trace
                    information might be lost. For you to see the different options on rethrowing exceptions, the sample
                    program <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">RethrowExceptions</code>
                    shows the different options.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                重新抛出异常的问题在于，调用者通常需要找出先前异常发生的原因和位置。根据异常抛出的方式，堆栈跟踪信息可能会丢失。为了让你看到重新抛出异常的不同选项，示例程序 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">RethrowExceptions</code>
                                展示了这些不同的选项。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">For this sample, two custom exception types are created. The
                    first one, <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">MyCustomException</code>,
                    defines the property <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ErrorCode</code> in
                    addition to the members of the base class <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                    ; the second one, <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">AnotherCustomException</code>,
                    supports passing an inner exception (code file <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">RethrowExceptions/MyCustomException.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">对于这个示例，创建了两种自定义异常类型。第一种， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">MyCustomException</code>
                                ，除了基类 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                                的成员外，还定义了属性 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ErrorCode</code>
                                ；第二种， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">AnotherCustomException</code>
                                ，支持传递一个内部异常（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">RethrowExceptions/MyCustomException.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0015"><code>public class MyCustomException : Exception</code>
<code>{</code>
<code>  public MyCustomException(string message)</code>
<code>    : base(message) { }</code>
<code> </code>
<code>  public int ErrorCode { get; set; }</code>
<code>}</code>
<code> </code>
<code>public class AnotherCustomException : Exception</code>
<code>{</code>
<code>  public AnotherCustomException(string message, Exception innerException)</code>
<code>    : base(message, innerException) { }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The method <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAll</code> invokes
                    the methods <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndThrowAgain</code>,
                    <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndThrowWithInnerException</code>,
                    <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndRethrow</code>,
                    and <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleWithFilter</code>.
                    The exception that is thrown is caught to write the exception message as well as the stack trace to
                    the console. To better find what line numbers are referenced from the stack trace, the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">#line</code> preprocessor
                    directive is used that restarts the line numbering. With this, the invocation of the methods using
                    the delegate <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">m</code>
                    is in line 114 (code file <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">RethrowExceptions/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAll</code>
                                调用了方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndThrowAgain</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndThrowWithInnerException</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndRethrow</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleWithFilter</code>
                                。抛出的异常被捕获，将异常消息以及堆栈跟踪写入控制台。为了更好地从堆栈跟踪中找到引用的行号，使用了 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">#line</code>
                                预处理器指令，该指令重新开始行号计数。通过这种方式，使用委托 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">m</code>
                                调用方法的行号是 114（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">RethrowExceptions/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0016"><code>#line 100</code>
<code>public static void HandleAll()</code>
<code>{</code>
<code>  Action[] methods = </code>
<code>  {</code>
<code>    HandleAndThrowAgain,</code>
<code>    HandleAndThrowWithInnerException,</code>
<code>    HandleAndRethrow,</code>
<code>    HandleWithFilter</code>
<code>  };</code>
<code> </code>
<code>  foreach (var m in methods)</code>
<code>  {</code>
<code>    try</code>
<code>    {</code>
<code>      m(); // line 114</code>
<code>    }</code>
<code>    catch (Exception ex)</code>
<code>    {</code>
<code>      Console.WriteLine(ex.Message);</code>
<code>      Console.WriteLine(ex.StackTrace);</code>
<code>      if (ex.InnerException != null)</code>
<code>      {</code>
<code>        Console.WriteLine($"\tInner Exception{ex.InnerException.Message}");</code>
<code>        Console.WriteLine(ex.InnerException.StackTrace);</code>
<code>      }<span aria-label="275" epub:type="pagebreak" id="Page_275" role="doc-pagebreak"></span></code>
<code>      Console.WriteLine();</code>
<code>    }</code>
<code>  }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The method <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ThrowAnException</code>
                    is the one to throw the first exception. This exception is thrown in line 8002. During development,
                    it helps to know where this exception is thrown:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ThrowAnException</code>
                                是抛出第一个异常的那个方法。这个异常在行 8002 被抛出。在开发过程中，知道这个异常在何处被抛出很有帮助：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0017"><code>#line 8000</code>
<code>public static void ThrowAnException(string message)</code>
<code>{</code>
<code>  throw new MyCustomException(message); // line 8002</code>
<code>}</code></pre>
                <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0017"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                    <h4 id="head-4-33" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">Naïvely Rethrowing the Exception<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">天真地重新抛出异常</font>
                            </font>
                        </font>
                    </h4>
                    <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">The method <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndThrowAgain</code>
                        does nothing more than log the exception to the console and throw it again using <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw ex</code>
                        :<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">方法 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndThrowAgain</code>
                                    仅仅是将异常记录到控制台并使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw ex</code>
                                    再次抛出：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c10-code-0018"><code>#line 4000</code>
<code>public static void HandleAndThrowAgain()</code>
<code>{</code>
<code>  try</code>
<code>  {</code>
<code>    ThrowAnException("test 1");</code>
<code>  }</code>
<code>  catch (Exception ex)</code>
<code>  {</code>
<code>    Console.WriteLine($"Log exception {ex.Message} and throw again");</code>
<code>    throw ex; // you shouldn't do that - line 4009</code>
<code>  }</code>
<code>}</code></pre>
                    <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">After running the application, the following simplified
                        output shows the stack trace (without the namespace and the full path to the code files):<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    运行应用程序后，以下简化的输出显示了堆栈跟踪（不包含命名空间和代码文件的完整路径）：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c10-code-0019"><code>Log exception test 1 and throw again</code>
<code>test 1</code>
<code>at Program.HandleAndThrowAgain() in Program.cs:line 4009</code>
<code>at Program.HandleAll() in Program.cs:line 114</code></pre>
                    <p id="c10-para-0062" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">The stack trace shows the call to the <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">m</code> method
                        within the <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAll</code>
                        method, which in turn invokes the <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndThrowAgain</code>
                        method. The information where the exception is thrown at first is completely lost in the call
                        stack of the final catch. This makes it hard to find the original reason of an error. Usually
                        it's not a good idea to just throw the same exception with <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code> passing
                        the exception object. The C# compiler now gives you the warning <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CA2200: re-throwing caught exception changes stack information</code>.
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">堆栈跟踪显示了在 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAll</code>
                                    方法中调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">m</code>
                                    方法的调用，而 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAll</code>
                                    方法又调用了 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndThrowAgain</code>
                                    方法。在最终 catch 的调用堆栈中，最初抛出异常的位置信息完全丢失。这使得很难找到错误的原始原因。通常来说，使用 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code>
                                    传递异常对象来仅仅抛出相同的异常并不是一个好主意。现在 C# 编译器会给你警告 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CA2200: re-throwing caught exception changes stack information</code>
                                    。</font>
                            </font>
                        </font>
                    </p>
                </section>
                <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0018"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                    <h4 id="head-4-34" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">Changing the Exception<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                            <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">修改异常</font>
                            </font>
                        </font>
                    </h4>
                    <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">One useful scenario is to change the type of the
                        exception and add information to the error. This is done in the method <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndThrowWithInnerException</code>.
                        After logging the error, a new exception of type <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">AnotherCustomException</code>
                        is thrown to pass <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ex</code> as the
                        inner exception:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">一个有用的场景是更改异常的类型并添加错误信息。这通过方法
                                    <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndThrowWithInnerException</code>
                                    完成。在记录错误后，会抛出一个类型为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">AnotherCustomException</code>
                                    的新异常，并将 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ex</code>
                                    作为内部异常传递：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c10-code-0020"><code>#line 3000</code>
<code>public static void HandleAndThrowWithInnerException()</code>
<code>{</code>
<code>  try<span aria-label="276" epub:type="pagebreak" id="Page_276" role="doc-pagebreak"></span></code>
<code>  {</code>
<code>    ThrowAnException("test 2"); // line 3004</code>
<code>  }</code>
<code>  catch (Exception ex)</code>
<code>  {</code>
<code>    Console.WriteLine($"Log exception {ex.Message} and throw again");</code>
<code>    <b>throw new AnotherCustomException("throw with inner exception", ex);</b> // 3009</code>
<code>  }</code>
<code>}</code></pre>
                    <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">By checking the stack trace of the outer exception, you
                        see line numbers 3009 and 114 similar to before. However, the inner exception gives the original
                        reason of the error. It gives the line of the method that invoked the erroneous method (3004)
                        and the line where the original (the inner) exception was thrown (8002):<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">通过检查外部异常的堆栈跟踪，你看到与之前类似的行号 3009
                                    和 114。然而，内部异常给出了错误的原始原因。它提供了调用错误方法的方法的行（3004）以及原始（内部）异常抛出的行（8002）：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c10-code-0021"><code>Log exception test 2 and throw again</code>
<code>throw with inner exception</code>
<code>at Program.HandleAndThrowWithInnerException() in Program.cs:line 3009</code>
<code>at Program.HandleAll() in Program.cs:line 114</code>
<code>Inner Exception throw with inner exception</code>
<code>at Program.ThrowAnException(String message) in Program.cs:line 8002</code>
<code>at Program.HandleAndThrowWithInnerException() in Program.cs:line 3004</code></pre>
                    <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">No information is lost this way.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">这种方式没有丢失任何信息。</font>
                            </font>
                        </font>
                    </p>
                    <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <hr />
                        </div>
                        <section class="feature2"
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <p id="c10-para-0066" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1"><b
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <i
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">When trying
                                    to find reasons for an error, take a look at whether an inner exception exists. This
                                    often gives helpful information.</i>
                                <font class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">
                                            注意：在尝试找出错误原因时，查看是否存在内部异常。这通常能提供有用的信息。</font>
                                    </font>
                                </font>
                            </p>
                            <div class="bottom hr"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                                <hr />
                            </div>
                        </section>
                    </aside>
                    <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <hr />
                        </div>
                        <section class="feature2"
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <p id="c10-para-0067" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1"><b
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <i
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">When catching
                                    exceptions, it's good practice to change the exception when rethrowing. For example,
                                    catching an </i><code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SqlException</code><i
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> can result
                                    in throwing a business-related exception such as </i><code
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">InvalidIsbnException</code><i
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">.</i>
                                <font class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">
                                            注意：在捕获异常时，重新抛出异常时更改异常是一个好习惯。例如，捕获 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SqlException</code>
                                            可能导致抛出一个与业务相关的异常，如 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">InvalidIsbnException</code>
                                            。</font>
                                    </font>
                                </font>
                            </p>
                            <div class="bottom hr"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                                <hr />
                            </div>
                        </section>
                    </aside>
                </section>
                <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0021"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                    <h4 id="head-4-35" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">Rethrowing the Exception<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">重新抛出异常</font>
                            </font>
                        </font>
                    </h4>
                    <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">If the exception type should not be changed, the same
                        exception can be rethrown just with the <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code>
                        statement. Using <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code> without
                        passing an exception object throws the current exception of the <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block
                        and keeps the exception information:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">如果不需要更改异常类型，可以使用 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code>
                                    语句直接重新抛出相同的异常。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code>
                                    而不传递异常对象会抛出 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                    块中的当前异常并保留异常信息：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c10-code-0022"><code>#line 2000</code>
<code>public static void HandleAndRethrow()</code>
<code>{</code>
<code>  try</code>
<code>  {</code>
<code>    ThrowAnException("test 3");</code>
<code>  }</code>
<code>  catch (Exception ex)</code>
<code>  {</code>
<code>    Console.WriteLine($"Log exception {ex.Message} and rethrow");</code>
<code>    <b>throw;</b> // line 2009</code>
<code>  }</code>
<code>} </code></pre>
                    <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1"><span aria-label="277" epub:type="pagebreak"
                            id="Page_277" role="doc-pagebreak"
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>With this in
                        place, the stack information is not lost. The exception was originally thrown in line 8002 and
                        rethrown in line 2009. Line 114 contains the delegate <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">m</code> that invoked
                        <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndRethrow</code>
                        :<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">这样一来，堆栈信息不会丢失。异常最初在第 8002
                                    行抛出，并在第 2009 行重新抛出。第 114 行包含调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAndRethrow</code>
                                    的委托 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">m</code>
                                    ：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c10-code-0023"><code>Log exception test 3 and rethrow</code>
<code>test 3</code>
<code>at Program.ThrowAnException(String message) in Program.cs:line 8002</code>
<code>at Program.HandleAndRethrow() in Program.cs:line 2009</code>
<code>at Program.HandleAll() in Program.cs:line 114</code></pre>
                </section>
                <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0022"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                    <h4 id="head-4-36" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">Using Filters to Add Functionality<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">使用过滤器添加功能</font>
                            </font>
                        </font>
                    </h4>
                    <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">When rethrowing exceptions using the <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code>
                        statement, the call stack contains the address of the throw. When you use exception filters, it
                        is possible not to change the call stack at all. Now add a <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">when</code> keyword
                        that passes a filter method. This filter method named <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Filter</code> logs
                        the message and always returns <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">false</code>. That's
                        why the <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block is
                        never invoked:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">使用 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">throw</code>
                                    语句重新抛出异常时，调用栈包含抛出地址。当你使用异常过滤器时，有可能完全不改变调用栈。现在添加一个 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">when</code>
                                    关键字，传递一个过滤器方法。这个名为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Filter</code>
                                    的过滤器方法记录消息，并始终返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">false</code>
                                    。这就是为什么 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                    块永远不会被调用的原因：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c10-code-0024"><code>#line 1000</code>
<code>public void HandleWithFilter()</code>
<code>{</code>
<code>  try</code>
<code>  {</code>
<code>    ThrowAnException("test 4"); // line 1004</code>
<code>  }</code>
<code>  catch (Exception ex) <b>when(Filter(ex)</b>)</code>
<code>  {</code>
<code>    Console.WriteLine("block never invoked");</code>
<code>  }</code>
<code>}</code>
<code>#line 1500</code>
<code><b>public bool Filter(Exception ex)</b></code>
<code><b>{</b></code>
<code>  <b>Console.WriteLine($"just log {ex.Message}");</b></code>
<code>  <b>return false;</b></code>
<code><b>}</b></code></pre>
                    <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1">Now when you look at the stack trace, the exception
                        originates in the <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAll</code>
                        method in line 114 that in turn invokes <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleWithFilter</code>,
                        line 1004 contains the invocation to <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ThrowAnException</code>,
                        and line 8002 contains the line where the exception was thrown:<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">现在当你查看堆栈跟踪时，异常源自第 114 行的 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleAll</code>
                                    方法，该方法反过来调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">HandleWithFilter</code>
                                    ，第 1004 行包含对 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ThrowAnException</code>
                                    的调用，第 8002 行包含抛出异常的行：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c10-code-0025"><code>just log test 4</code>
<code>test 4</code>
<code>at Program.ThrowAnException(String message) in Program.cs:line 8002</code>
<code>at Program.HandleWithFilter() in Program.cs:line 1004</code>
<code>at RethrowExceptions.Program.HandleAll() in Program.cs:line 114</code></pre>
                    <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <hr />
                        </div>
                        <section class="feature2"
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <p id="c10-para-0073" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                                data-immersive-translate-paragraph="1"><b
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <i
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">The primary
                                    use of exception filters is to filter exceptions based on a value of the exception.
                                    Exception filters can also be used for other effects, such as writing log
                                    information without changing the call stack. However, exception filters should be
                                    fast running, so you should do only simple checks and avoid side effects. Logging is
                                    one of </i> <i
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">the excusable
                                    exceptions.</i>
                                <font class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">注意
                                            异常过滤器的主要用途是基于异常的值来过滤异常。异常过滤器也可以用于其他效果，例如在不改变调用栈的情况下记录日志信息。然而，异常过滤器应该是快速运行的，因此你应该只进行简单的检查并避免副作用。记录日志是可接受的例外情况。
                                        </font>
                                    </font>
                                </font>
                            </p>
                            <div class="bottom hr"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                                <hr />
                            </div>
                        </section>
                    </aside>
                </section>
            </section> <span aria-label="278" epub:type="pagebreak" id="Page_278" role="doc-pagebreak"
                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0024"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                <h3 id="head-3-216" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">What Happens If an Exception Isn't Handled?<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">如果异常未被处理会怎样？</font>
                        </font>
                    </font>
                </h3>
                <p id="c10-para-0074" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Sometimes an exception might be thrown, but there is no <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block in
                    your code that is able to handle that kind of exception. The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SimpleExceptions</code>
                    example can serve to illustrate this. Suppose, for example, that you omitted the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                    and catchall <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks, and
                    you supplied only the block that traps an <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>.
                    In that circumstance, what would happen if a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                    were thrown?<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">有时可能会抛出异常，但你的代码中没有能够处理这种异常的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SimpleExceptions</code>
                                示例可以说明这一点。例如，假设你遗漏了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                                和捕获所有异常的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块，只提供了捕获 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IndexOutOfRangeException</code>
                                的块。在这种情况下，如果抛出一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                                会发生什么？</font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0075" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The answer is that the .NET runtime would catch it. Later in
                    this section, you learn how you can nest <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> blocks; and,
                    in fact, there is already a nested <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block behind
                    the scenes in the example. The .NET runtime has effectively placed the entire program inside another
                    huge <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                    block—it does this for every .NET program. This <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block has a
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> handler
                    that can catch any type of exception. If an exception occurs that your code does not handle, the
                    execution flow simply passes right out of your program and is trapped by this <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block in the
                    .NET runtime. However, the results of this probably will not be what you want because the execution
                    of your code is terminated promptly. The user sees a dialog that complains that your code has not
                    handled the exception and provides any details about the exception the .NET runtime was able to
                    retrieve. At least the exception has been caught!<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">答案是.NET 运行时会捕获它。在本节稍后，你将学习如何嵌套
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块；事实上，在示例中已经有一个后台嵌套的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块。.NET 运行时实际上已将整个程序置于另一个巨大的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块内——它为每个.NET 程序都这样做。这个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块有一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                处理器，可以捕获任何类型的异常。如果你的代码未处理异常，执行流程将直接从你的程序中退出，并由.NET 运行时的这个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块捕获。然而，这很可能不会是你想要的结果，因为你的代码会立即终止执行。用户会看到一个对话框，抱怨你的代码未处理异常，并提供.NET
                                运行时能够检索到的任何异常详细信息。至少异常已经被捕获了！</font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0076" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">In general, if you are writing an executable, try to catch as
                    many exceptions as you reasonably can and handle them in a sensible way. If you are writing a
                    library, it is normally best to catch exceptions that you can handle in a useful way, or where you
                    can add information to the context and throw other exception types as shown in the previous section.
                    Assume that the calling code handles any errors it encounters.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                一般来说，如果你在编写可执行文件，尽量捕获尽可能多的异常并以合理的方式处理它们。如果你在编写库，通常最好是捕获那些你可以以有用方式处理的异常，或者在可以添加上下文信息的情况下抛出其他类型的异常，如前一节所示。假设调用代码会处理它遇到的任何错误。
                            </font>
                        </font>
                    </font>
                </p>
            </section>
        </section>
        <section aria-labelledby="head-2-92" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
            <span id="c10-sec-0025" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <h2 id="head-2-92" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">USER-DEFINED EXCEPTION CLASSES<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">用户定义的异常类</font>
                    </font>
                </font>
            </h2>
            <p id="c10-para-0077" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">In the previous section, you already created a user-defined
                exception. You are now ready to look at a larger example that illustrates exceptions. This example,
                called <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall</code>,
                contains two nested <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> blocks and
                illustrates the practice of defining your own custom exception classes and throwing another exception
                from inside a <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                block.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            在前一节中，你已经创建了一个用户定义的异常。现在，你准备好查看一个更大的示例，该示例说明了异常。这个示例称为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall</code>
                            ，包含两个嵌套的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                            块，并说明了定义自己的自定义异常类以及从 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                            块中抛出另一个异常的实践。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">This example assumes that a sales company wants to increase its
                customer base. The company's sales team is going to phone a list of people to invite them to become
                customers, a practice known in sales jargon as cold-calling. To this end, you have a text file available
                that contains the names of the people to be cold-called. The file should be in a well-defined format in
                which the first line contains the number of people in the file and each subsequent line contains the
                name of the next person. In other words, a correctly formatted file of names might look like this:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            这个例子假设一家销售公司想要扩大客户群。公司的销售团队将给一份名单中的人打电话，邀请他们成为客户，在销售术语中这种做法被称为冷电话。为此，你有一份文本文件，其中包含要被冷电话的人的名字。该文件应采用明确的格式，其中第一行包含文件中的人数，后续每一行包含下一个人的名字。换句话说，一个格式正确的名字文件可能看起来像这样：
                        </font>
                    </font>
                </font>
            </p>
            <pre id="c10-code-0026"><code>4</code>
<code>George Washington</code>
<code>Benedict Arnold</code>
<code>John Adams</code>
<code>Thomas Jefferson</code></pre>
            <p id="c10-para-0079" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">This version of cold-calling is designed to display the name of
                the person on the screen (perhaps for the salesperson to read). That is why only the names, and not the
                phone numbers, of the individuals are contained in the file.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            这种冷电话的版本旨在在屏幕上显示人的名字（也许供销售人员阅读）。这就是为什么文件中只包含个人的名字，而不包含电话号码。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">For this example, your program asks the user for the name of the
                file and then simply reads it in and displays the names of people. That sounds like a simple task, but
                even so, a couple of things can go wrong and require you to abandon the entire procedure:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            在这个例子中，你的程序会要求用户输入文件名，然后简单地读取该文件并显示人的名字。这听起来像是一项简单的任务，但即便如此，也可能出现一些问题，需要你放弃整个流程：</font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c10-list-0007" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <li id="c10-li-0030" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The user might type the name of a file that does not exist.
                    This is caught as a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileNotFound</code>
                    exception.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">用户可能会输入一个不存在的文件名。这会被捕获为一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileNotFound</code>
                                异常。</font>
                        </font>
                    </font>
                </li>
                <li id="c10-li-0031" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The file might not be in the correct format. There are two
                    possible problems here. One, the first line of the file might not be an integer. Two, there might
                    not be as many names in the file as the first line of the file indicates. In both cases, you want to
                    trap this oddity as a custom exception that has been written especially for this purpose, <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                文件可能不是正确的格式。这里有两种可能的问题。第一，文件的第一行可能不是整数。第二，文件中的名字数量可能少于第一行所指示的数量。在这两种情况下，你都需要将这种异常捕获为一个专门为此目的编写的自定义异常，
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>
                                。</font>
                        </font>
                    </font>
                </li>
            </ul>
            <p id="c10-para-0081" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1"><span aria-label="279" epub:type="pagebreak" id="Page_279"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>There is something
                else that can go wrong that doesn't cause you to abandon the entire process but does mean you need to
                abandon a person's name and move on to the next name in the file (and therefore trap it by an inner
                <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block). Some
                people are spies working for rival sales companies, so you obviously do not want to let these people
                know what you are up to by accidentally phoning one of them. For simplicity, assume that you can
                identify who the spies are because their names begin with B. Such people should have been screened out
                when the data file was first prepared, but in case any have slipped through, you need to check each name
                in the file and throw a <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SalesSpyFoundException</code>
                if you detect a sales spy. This, of course, is another custom exception object.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            还有其他可能出错的情况，这种情况不会导致你放弃整个流程，但意味着你需要放弃某个人的名字，并继续处理文件中的下一个名字（因此需要通过内部的 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                            块来捕获它）。有些人可能是为竞争对手销售公司工作的间谍，所以显然你不希望通过意外地给其中一人打电话而让他们知道你在做什么。为了简化，假设你可以识别谁是间谍，因为他们的名字以 B
                            开头。这样的人应该在数据文件最初准备时就筛除了，但以防万一有漏网之鱼，你需要检查文件中的每个名字，并在检测到销售间谍时抛出 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SalesSpyFoundException</code>
                            。当然，这也是另一个自定义异常对象。</font>
                    </font>
                </font>
            </p>
            <p id="c10-para-0082" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">Finally, you implement this example by coding a class, <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>,
                which maintains the connection to the cold-call file and retrieves data from it. You code this class in
                a safe way, which means that its methods all throw exceptions if they are called inappropriately—for
                example, if a method that reads a file is called before the file has even been opened. For this purpose,
                you write another exception class: <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">UnexpectedException</code>.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">最后，你通过编写一个类 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                            来实现这个示例，该类维护与冷电话文件的连接并从中检索数据。你以安全的方式编写这个类，这意味着如果其方法被不恰当地调用，所有方法都会抛出异常——例如，如果在文件尚未打开之前就调用了读取文件的方法。为此，你编写了另一个异常类：
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">UnexpectedException</code>
                            。</font>
                    </font>
                </font>
            </p>
            <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0026"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                <h3 id="head-3-217" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Catching the User-Defined Exceptions <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">捕获用户定义的异常</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Start with the top-level statements of the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall</code>
                    sample, which catches your user-defined exceptions. Note that you need to call up file-handling
                    classes in the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.IO</code>
                    namespace as well as the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System</code> namespace
                    (code file <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">从 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall</code>
                                示例的顶层语句开始，它捕获你的用户定义异常。请注意，你还需要在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.IO</code>
                                命名空间以及 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System</code>
                                命名空间中调用文件处理类（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0027"><code>Console.Write("Please type in the name of the file " +</code>
<code>  "containing the names of the people to be cold called&gt; ");</code>
<code>string? fileName = Console.ReadLine();</code>
<code>if (fileName != null)</code>
<code>{</code>
<code>  ColdCallFileReaderLoop1(fileName);</code>
<code>  Console.WriteLine();</code>
<code>}</code>
<code>Console.ReadLine();</code>
<code> </code>
<code>void ColdCallFileReaderLoop1(string fileName)</code>
<code>{</code>
<code>  ColdCallFileReader peopleToRing = new();</code>
<code>  try</code>
<code>  {</code>
<code>    peopleToRing.Open(fileName);</code>
<code>    for (int i = 0; i &lt; peopleToRing.NPeopleToRing; i++)</code>
<code>    {</code>
<code>      peopleToRing.ProcessNextPerson();</code>
<code>    }</code>
<code>    Console.WriteLine("All callers processed correctly");</code>
<code>  }</code>
<code>  catch(FileNotFoundException)</code>
<code>  {</code>
<code>    Console.WriteLine($"The file {fileName} does not exist");</code>
<code>  }</code>
<code>  catch(ColdCallFileFormatException ex)</code>
<code>  {</code>
<code>    Console.WriteLine($"The file {fileName} appears to have been corrupted");</code>
<code>    Console.WriteLine($"Details of problem are: {ex.Message}");</code>
<code>    if (ex.InnerException != null)</code>
<code>    {</code>
<code>      Console.WriteLine($"Inner exception was: {ex.InnerException.Message}");</code>
<code>    }</code>
<code>  }<span aria-label="280" epub:type="pagebreak" id="Page_280" role="doc-pagebreak"></span></code>
<code>  catch(Exception ex)</code>
<code>  {</code>
<code>    Console.WriteLine($"Exception occurred:\n{ex.Message}");</code>
<code>  }</code>
<code>  finally</code>
<code>  {</code>
<code>    peopleToRing.Dispose();</code>
<code>  }</code>
<code>}</code></pre>
                <p id="c10-para-0084" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">This code is a little more than just a loop to process people
                    from the file. You start by asking the user for the name of the file. Then you instantiate an object
                    of a class called <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>,
                    which is defined shortly. The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                    class is the class that handles the file reading. Notice that you do this outside the initial <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block—that's
                    because the variables that you instantiate here need to be available in the subsequent <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> and <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> blocks,
                    and if you declare them inside the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block, they
                    would go out of scope at the closing curly brace of the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block, where
                    the compiler would complain about it.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                这段代码不仅仅是用来处理文件中的人的一个循环。你首先需要向用户询问文件名。然后你实例化一个名为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                                的类的对象，这个类稍后会定义。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                                类是处理文件读取的类。注意，你是在初始的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块之外进行这个操作的——这是因为你在这里实例化的变量需要在后续的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块中可用，如果你在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块中声明它们，它们会在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块的关闭大括号处超出作用域，编译器会对此报错。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">In the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block, you
                    open the file (using the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader.Open</code>
                    method) and loop over all the people in it. The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader.ProcessNextPerson</code>
                    method reads in and displays the name of the next person in the file, and the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader.NPeopleToRing</code>
                    property indicates how many people should be in the file (obtained by reading the file's first
                    line). There are three <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> blocks: one
                    for <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileNotFoundException</code>,
                    one for <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>,
                    and one to trap any other .NET exceptions.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块中，你打开文件（使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader.Open</code>
                                方法）并遍历文件中的所有人。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader.ProcessNextPerson</code>
                                方法读取并显示文件中下一个人的名字，而 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader.NPeopleToRing</code>
                                属性表示文件中应该有多少人（通过读取文件的第一行获得）。有三个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块：一个用于 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileNotFoundException</code>
                                ，一个用于 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>
                                ，还有一个用于捕获任何其他.NET 异常。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <p id="c10-para-0086" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <i
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">With the sample
                                application, the object of type </i><code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code><i
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> is instantiated
                                outside of the </i><code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code><i
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> block. It's a
                                good practice to create constructors that can't fail and don't take a long processing
                                time. In case you use such types, you can create an outer </i><code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code><i
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">/</i><code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code><i
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> block or declare
                                the variable outside the </i><code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code><i
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> block and
                                instantiate it within the </i><code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code><i
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> block.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意：在使用示例应用程序时，类型为 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                                        的对象是在 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                        块外部实例化的。创建不会失败且处理时间较短的构造函数是一个好习惯。如果你使用这种类型，可以创建一个外部的 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                        / <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                        块，或在 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                        块外部声明变量并在 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                        块内部实例化它。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p id="c10-para-0087" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">In the case of a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileNotFoundException</code>,
                    you display a message to that effect. Notice that in this <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block, the
                    exception instance is not actually used at all. This <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block is
                    used to illustrate the user-friendliness of the application. Exception objects generally contain
                    technical information that is useful for developers, but not the sort of stuff you want to show to
                    end users. Therefore, in this case, you create a simpler message of your own.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">对于 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileNotFoundException</code>
                                ，你显示一条相应的消息。注意在这个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块中，实际上并没有使用异常实例。这个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块用于说明应用程序的用户友好性。异常对象通常包含对开发者有用的技术信息，但不是你想展示给最终用户的内容。因此，在这种情况下，你创建了一条更简单的自定义消息。</font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0088" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">For the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>
                    handler, you have done the opposite, specifying how to obtain fuller technical information,
                    including details about the inner exception, if one is present.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">对于 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>
                                处理器，你做了相反的操作，指定了如何获取更完整的技术信息，包括内部异常的详细信息（如果存在）。</font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0089" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Finally, if you catch any other generic exceptions, you
                    display a user-friendly message, instead of letting any such exceptions fall through to the .NET
                    runtime.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                最后，如果你捕获了任何其他通用异常，你应该显示一个用户友好的消息，而不是让这些异常传递到.NET 运行时。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block is
                    there to clean up resources. In this case, that means closing any open file—performed by the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader.Dispose</code>
                    method.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块用于清理资源。在这种情况下，这意味着关闭任何打开的文件——由 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader.Dispose</code>
                                方法执行。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <p id="c10-para-0091" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <i
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">C# offers the
                            </i>
                            <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">using</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> statement and the
                            </i>
                            <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">using</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> declaration where
                                the compiler itself creates a </i>
                            <code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try/finally</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> block calling the
                            </i>
                            <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> method in the
                            </i>
                            <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> block. The </i>
                            <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">using</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> keyword can be
                                used with objects implementing the </i>
                            <code
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IDisposable</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> interface. You
                                can read the details of the </i>
                            <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">using</code>
                            <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> statement and
                                declaration in <a href="c13.xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Chapter
                                    13</a>, “Managed and Unmanaged Memory.”</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意：C# 提供了 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">using</code>
                                        语句和 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">using</code>
                                        声明，编译器会创建一个调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code>
                                        方法的 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try/finally</code>
                                        块，在 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                        块中。 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">using</code>
                                        关键字可用于实现 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IDisposable</code>
                                        接口的对象。你可以在第 13 章“托管和非托管内存”中阅读 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">using</code>
                                        语句和声明的详细信息。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section> <span aria-label="281" epub:type="pagebreak" id="Page_281" role="doc-pagebreak"
                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0029"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                <h3 id="head-3-218" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Throwing the User-Defined Exceptions <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">抛出用户定义的异常</font>
                        </font>
                    </font>
                </h3>
                <p id="c10-para-0092" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Now take a look at the definition of the class that handles
                    the file reading and (potentially) throws your user-defined exceptions: <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>.
                    Because this class maintains an external file connection, you need to ensure that it is disposed of
                    correctly in accordance with the principles outlined for the disposing of objects in <a
                        href="c13.xhtml" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Chapter
                        13</a>. Therefore, you derive this class from <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IDisposable</code>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在来看一下处理文件读取并（可能）抛出你用户定义的异常的类的定义：
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                                。因为这个类维护一个外部文件连接，你需要根据第 13 章中概述的对象释放原则来确保它被正确地释放。因此，你需要从这个类派生出来： <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IDisposable</code>
                                。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">First, you declare some private fields (code file <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall/ColdCallFileReader.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">首先，你声明一些私有字段（代码文件 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall/ColdCallFileReader.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0028"><code>public class ColdCallFileReader: IDisposable</code>
<code>{</code>
<code>  private FileStream? _fileStream;</code>
<code>  private StreamReader? _streamReader;</code>
<code>  private uint _nPeopleToRing;</code>
<code>  private bool _isDisposed = false;</code>
<code>  private bool _isOpen = false;</code></pre>
                <p id="c10-para-0094" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileStream</code> and
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StreamReader</code>,
                    both in the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.IO</code>
                    namespace, are the base classes that you use to read the file. <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileStream</code> enables
                    you to connect to the file in the first place, whereas <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StreamReader</code> is
                    designed to read text files and implements a method, <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ReadLine</code>, which
                    reads a line of text from a file. You look at <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StreamReader</code> more
                    closely in <a href="c18.xhtml"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Chapter 18</a>, “Files
                    and Streams,” which discusses file handling in depth.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileStream</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StreamReader</code>
                                都在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.IO</code>
                                命名空间中，是用于读取文件的基类。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FileStream</code>
                                使你能够连接到文件，而 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StreamReader</code>
                                专门用于读取文本文件，并实现了一个方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ReadLine</code>
                                ，该方法从文件中读取一行文本。你将在第 18 章“文件和流”中更详细地了解 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StreamReader</code>
                                ，该章节深入讨论了文件处理。</font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0095" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">_isDisposed</code> field
                    indicates whether the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code> method has
                    been called. <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                    is implemented so that after <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code> has been
                    called, it is not permitted to reopen connections and reuse the object. _
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">isOpen</code> is also
                    used for error checking—in this case, checking whether the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StreamReader</code>
                    actually connects to an open file.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">_isDisposed</code>
                                字段表示 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code>
                                方法是否已被调用。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                                的实现方式是，在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code>
                                被调用后，不允许重新打开连接并重用对象。_ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">isOpen</code>
                                也用于错误检查——在这种情况下，检查 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">StreamReader</code>
                                是否实际连接到一个打开的文件。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The process of opening the file and reading in that first
                    line—the one that tells you how many people are in the file—is handled by the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Open</code> method:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">打开文件并读取第一行——即告诉你文件中有多少人——的过程由
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Open</code>
                                方法处理：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0029"><code>public void Open(string fileName)</code>
<code>{</code>
<code>  if (_isDisposed)</code>
<code>  {</code>
<code>    throw new ObjectDisposedException(nameof(ColdCallFileReader));</code>
<code>  }</code>
<code> </code>
<code>  _fileStream = new(fileName, FileMode.Open);</code>
<code>  _streamReader = new(_fileStream);</code>
<code> </code>
<code>  try</code>
<code>  {</code>
<code>    string? firstLine = _streamReader.ReadLine();</code>
<code>    if (firstLine != null)</code>
<code>    {</code>
<code>      _nPeopleToRing = uint.Parse(firstLine);</code>
<code>      _isOpen = true;</code>
<code>    }</code>
<code>  }</code>
<code>  catch (FormatException ex)</code>
<code>  {</code>
<code>    throw new ColdCallFileFormatException(</code>
<code>      $"First line isn't an integer {ex}");</code>
<code>  }</code>
<code>}</code></pre>
                <p id="c10-para-0097" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1"><span aria-label="282" epub:type="pagebreak" id="Page_282"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>The first thing
                    you do in this method (as with all other <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                    methods) is check whether the client code has inappropriately called it after the object has been
                    disposed of and, if so, throw a predefined <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ObjectDisposedException</code>
                    object. The <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Open</code>
                    method checks the _
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">isDisposed</code> field
                    to determine whether <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code> has
                    already been called. Because calling <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code> implies
                    that the caller has now finished with this object, you regard it as an error to attempt to open a
                    new file connection if <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code> has been
                    called.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在这个方法中（与其他所有 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                                方法一样），你首先检查客户端代码是否在对象被销毁后不恰当地调用了它，如果是，则抛出一个预定义的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ObjectDisposedException</code>
                                对象。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Open</code>
                                方法检查 _ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">isDisposed</code>
                                字段以确定 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code>
                                是否已被调用。因为调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code>
                                意味着调用者现在已用完此对象，如果 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code>
                                被调用，尝试打开新的文件连接被视为错误。</font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0098" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Next, the method contains a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                    /
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code> block. The
                    purpose of this one is to catch any errors resulting from a file in which the first line does not
                    contain an integer. If the method <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">uint.Parse</code> cannot
                    parse the first line successfully, a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                    can be thrown. If that problem arises, the exception is caught and converted to a more meaningful
                    exception that indicates a problem with the format of the cold-call file. Note that <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.FormatException</code>
                    is there to indicate format problems with basic data types, not with files, so it's not a
                    particularly useful exception to pass back to the calling routine in this case. The new exception
                    thrown will be trapped by the outermost <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block. Because
                    no cleanup is needed here, there is no need for a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block.
                    Other exceptions that can happen such as the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IOException</code> on
                    calling the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ReadLine</code> method
                    are not caught here and are forwarded to the next <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">接下来，该方法包含一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> /
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">catch</code>
                                块。这个块的作用是捕获由文件引起的任何错误，该文件的第一行不包含整数。如果方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">uint.Parse</code>
                                无法成功解析第一行，可能会抛出 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">FormatException</code>
                                。如果出现该问题，异常将被捕获并转换为更具有意义的异常，该异常表明调用文件格式存在问题。请注意， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.FormatException</code>
                                是用来指示基本数据类型的格式问题，而不是文件问题，因此在这种情况下将其传递回调用例程并不是特别有用。新抛出的异常将被最外层的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code>
                                块捕获。由于这里不需要进行清理，因此不需要 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块。其他可能发生的异常，例如调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ReadLine</code>
                                方法时发生的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">IOException</code>
                                ，在这里不会被捕获，而是会被转发到下一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> 块。
                            </font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0099" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">If everything is fine, you set the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">_isOpen</code> field to
                    <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">true</code> to indicate
                    that there is now a valid file connection from which data can be read.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">如果一切正常，你将 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">_isOpen</code>
                                字段设置为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">true</code>
                                ，以指示现在有一个有效的文件连接，从中可以读取数据。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ProcessNextPerson</code>
                    method also contains an inner <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> block:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ProcessNextPerson</code>
                                方法还包含一个内部 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">try</code> 块：
                            </font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0030"><code>public void ProcessNextPerson()</code>
<code>{</code>
<code>  if (_isDisposed)</code>
<code>  {</code>
<code>    throw new ObjectDisposedException(nameof(ColdCallFileReader));</code>
<code>  }</code>
<code> </code>
<code>  if (!_isOpen)</code>
<code>  {</code>
<code>    throw new UnexpectedException(</code>
<code>      "Attempted to access coldcall file that is not open");</code>
<code>  }</code>
<code> </code>
<code>  try</code>
<code>  {</code>
<code>    string? name = _streamReader?.ReadLine();</code>
<code>    if (name is null)</code>
<code>    {</code>
<code>      throw new ColdCallFileFormatException("Not enough names");</code>
<code>    }</code>
<code>    if (name[0] is 'B')</code>
<code>    {</code>
<code>      throw new SalesSpyFoundException(name);</code>
<code>    }</code>
<code>    Console.WriteLine(name);</code>
<code>  }</code>
<code>  catch(SalesSpyFoundException ex)</code>
<code>  {</code>
<code>    Console.WriteLine(ex.Message);</code>
<code>  }</code>
<code>  finally</code>
<code>  {</code>
<code>  }</code>
<code>}</code></pre>
                <p id="c10-para-0101" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1"><span aria-label="283" epub:type="pagebreak" id="Page_283"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>Two possible
                    problems can exist when reading the file in the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ProcessNextPerson</code>
                    method (assuming there actually is an open file connection that is checked first). The first error
                    that is handled is when <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">null</code> is returned
                    from the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ReadLine</code> method.
                    This method returns <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">null</code> if it has
                    gone past the end of the file. Because the file contains the number of names at the start of the
                    file, a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>
                    is thrown on a mismatch, and there are fewer names than there should be. This is then caught by the
                    outer exception handler, which causes the execution to terminate.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在以 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ProcessNextPerson</code>
                                方法读取文件时（假设首先检查确实存在打开的文件连接），可能存在两种问题。首先处理的错误是当从 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ReadLine</code>
                                方法返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">null</code>
                                时。如果该方法已经超出文件末尾，它会返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">null</code>
                                。由于文件开头包含名称数量，当出现不匹配时，会抛出 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>
                                ，并且文件中的名称数量少于应有的数量。这随后被外部的异常处理器捕获，导致执行终止。</font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0102" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">With the second, the line is accessed. If it is discovered
                    that the name is a sales spy, a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SalesSpyFoundException</code>
                    is thrown. Because that exception has been caught here, inside the loop, it means that execution can
                    subsequently continue in the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Main</code> method of the
                    program, and the subsequent names in the file continue to be processed.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">对于第二种情况，会访问该行。如果发现名称是销售间谍，会抛出
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SalesSpyFoundException</code>
                                。由于该异常在此循环内部已被捕获，这意味着程序随后可以在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Main</code>
                                方法中继续执行，并且文件中的后续名称继续被处理。</font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0103" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Again, you don't need a <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block here
                    because there is no cleanup to do; however, this time an empty <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code> block is
                    included just to show that you can do so, if you want.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">同样，这里不需要 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块，因为没有需要清理的内容；但是，这次包含一个空的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">finally</code>
                                块，只是为了展示如果你需要，可以这样做。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The example is nearly finished. You have just two more
                    members of <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                    to look at: the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NPeopleToRing</code>
                    property, which returns the number of people who are supposed to be in the file, and the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code> method,
                    which closes an open file. Notice that the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code> method
                    returns immediately if it has already been called—this is the recommended way of implementing it. It
                    also confirms that there actually is a file stream to close before closing it. This example is shown
                    here to illustrate defensive coding techniques:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">示例几乎完成了。您只需再查看两个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileReader</code>
                                的成员：返回文件中应有多少人的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NPeopleToRing</code>
                                属性，以及关闭打开文件的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code>
                                方法。请注意，如果 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Dispose</code>
                                方法已经被调用，它会立即返回——这是推荐实现它的方式。它还确认在关闭之前确实有一个文件流可以关闭。这个示例在这里展示是为了说明防御性编程技术：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0031"><code>public uint NPeopleToRing</code>
<code>{</code>
<code>  get</code>
<code>  {</code>
<code>    if (_isDisposed)</code>
<code>    {</code>
<code>      throw new ObjectDisposedException("peopleToRing");</code>
<code>    }</code>
<code>    if (!_isOpen)</code>
<code>    {</code>
<code>      throw new UnexpectedException(</code>
<code>        "Attempted to access cold–call file that is not open");</code>
<code>    }</code>
<code>    return _nPeopleToRing;</code>
<code>  }</code>
<code>}</code>
<code> </code>
<code>public void Dispose()</code>
<code>{</code>
<code>  if (_isDisposed)</code>
<code>  {</code>
<code>    return;</code>
<code>  }</code>
<code>  _isDisposed = true;</code>
<code>  _isOpen = false;</code>
<code> </code>
<code>  _streamReader?.Dispose();</code>
<code>  _streamReader = null;</code>
<code>}</code></pre>
            </section> <span aria-label="284" epub:type="pagebreak" id="Page_284" role="doc-pagebreak"
                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <section data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span id="c10-sec-0030"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
                <h3 id="head-3-219" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Defining the User-Defined Exception Classes <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">定义用户自定义异常类</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Finally, you need to define three of your own exception
                    classes. Defining your own exception is quite easy because there are rarely any extra methods to
                    add. It is just a case of implementing a constructor to ensure that the base class constructor is
                    called correctly. Here is the full implementation of <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SalesSpyFoundException</code>
                    (code file <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall/SalesSpyFoundException.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                最后，你需要定义三个你自己的异常类。定义自己的异常非常简单，因为很少需要添加额外的方法。只需实现一个构造函数，确保基类构造函数被正确调用即可。以下是 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SalesSpyFoundException</code>
                                的完整实现（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall/SalesSpyFoundException.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0032"><code>public class SalesSpyFoundException: Exception</code>
<code>{</code>
<code>  public SalesSpyFoundException(string spyName)</code>
<code>    : base($"Sales spy found, with name {spyName}") { }</code>
<code> </code>
<code>  public SalesSpyFoundException(string spyName, Exception innerException)</code>
<code>    : base($"Sales spy found with name {spyName}", innerException) {  }</code>
<code>}</code></pre>
                <p id="c10-para-0106" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Notice that it is derived from <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>, as you
                    would expect for a custom exception. In fact, in practice, you would probably have added an
                    intermediate class, something like <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileException</code>,
                    derived from <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>, and
                    then derived both of your exception classes from this class. This ensures that the handling code has
                    that extra-fine degree of control over which exception handler handles each exception. However, to
                    keep the example simple, you will not do that.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">请注意，它源自 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                                ，正如您预期的那样，这是一个自定义异常。实际上，在实践中，您可能会添加一个中间类，比如 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileException</code>
                                ，它继承自 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Exception</code>
                                ，然后您的两个异常类都从这个类继承。这确保了处理代码对每个异常的处理有更精细的控制。然而，为了保持示例简单，您不会那样做。</font>
                        </font>
                    </font>
                </p>
                <p id="c10-para-0107" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">You have done one bit of processing in <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SalesSpyFoundException</code>.
                    You have assumed that the message passed into its constructor is just the name of the spy found, so
                    you turn this string into a more meaningful error message. You have also provided two constructors:
                    one that simply takes a message, and one that also takes an inner exception as a parameter. When
                    defining your own exception classes, it is best to include, at a minimum, at least these two
                    constructors (although you will not actually be using the second <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SalesSpyFoundException</code>
                    constructor in this example).<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SalesSpyFoundException</code>
                                中完成了一点点处理。你假设传入其构造函数的消息只是找到的间谍的名字，所以你把这个字符串转换成一个更有意义的错误消息。你还提供了两个构造函数：一个只接受消息，另一个也接受一个内部异常作为参数。当你定义自己的异常类时，最好至少包括这两个构造函数（尽管在这个例子中你实际上不会使用第二个
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SalesSpyFoundException</code>
                                构造函数）。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>
                    follows the same principles as the previous exception, but you don't do any processing on the
                    message (code file <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall/ColdCallFileFormatException.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>
                                遵循与之前异常相同的原理，但您不对消息进行处理（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall/ColdCallFileFormatException.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0033"><code>public class ColdCallFileFormatException: Exception</code>
<code>{</code>
<code>  public ColdCallFileFormatException(string message)</code>
<code>    : base(message) {}</code>
<code> </code>
<code>  public ColdCallFileFormatException(string message, Exception innerException)</code>
<code>    : base(message, innerException) {}</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Finally, you have <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">UnexpectedException</code>,
                    which looks much the same as <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>
                    (code file <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall/UnexpectedException.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">最后，你有 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">UnexpectedException</code>
                                ，它看起来和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ColdCallFileFormatException</code>
                                非常相似（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SolicitColdCall/UnexpectedException.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0034"><code>public class UnexpectedException: Exception</code>
<code>{</code>
<code>  public UnexpectedException(string message)</code>
<code>    : base(message) { }</code>
<code> </code>
<code>  public UnexpectedException(string message, Exception innerException)</code>
<code>    : base(message, innerException) { }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Now you are ready to test the program. First, try the <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">people.txt</code> file.
                    The contents are defined here:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在你可以测试程序了。首先，尝试 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">people.txt</code>
                                文件。内容定义在这里：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0035"><code>4</code>
<code>George Washington</code>
<code>Benedict Arnold<span aria-label="285" epub:type="pagebreak" id="Page_285" role="doc-pagebreak"></span></code>
<code>John Adams</code>
<code>Thomas Jefferson</code></pre>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">This has four names (which match the number given in the
                    first line of the file), including one spy. Then try the following <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">people2.txt</code> file,
                    which has an obvious formatting error:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                这有四个名字（与文件第一行给出的数量相匹配），包括一个间谍。然后尝试以下 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">people2.txt</code>
                                文件，它有一个明显的格式错误：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0036"><code>49</code>
<code>George Washington</code>
<code>Benedict Arnold</code>
<code>John Adams</code>
<code>Thomas Jefferson</code></pre>
                <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">Finally, try the example, but specify the name of a file that
                    does not exist, such as <code
                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">people3.txt</code>.
                    Running the program three times for the three filenames returns these results:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">最后，尝试示例，但指定一个不存在的文件名，例如 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">people3.txt</code>
                                。对三个文件名运行程序三次，返回这些结果：</font>
                        </font>
                    </font>
                </p>
                <pre id="c10-code-0037"><code>SolicitColdCall</code>
<code>Please type in the name of the file containing the names of the people to be cold</code>
<code>called&gt; people.txt</code>
<code>George Washington</code>
<code>Sales spy found, with name Benedict Arnold</code>
<code>John Adams</code>
<code>Thomas Jefferson</code>
<code>All callers processed correctly</code>
<code> </code>
<code>SolicitColdCall</code>
<code>Please type in the name of the file containing the names of the people to be cold</code>
<code>called&gt; people2.txt</code>
<code>George Washington</code>
<code>Sales spy found, with name Benedict Arnold</code>
<code>John Adams</code>
<code>Thomas Jefferson</code>
<code>The file people2.txt appears to have been corrupted.</code>
<code>Details of the problem are: Not enough names</code>
<code> </code>
<code>SolicitColdCall</code>
<code>Please type in the name of the file containing the names of the people to be cold</code>
<code>called&gt; people3.txt</code>
<code>The file people3.txt does not exist.</code></pre>
                <p id="c10-para-0113" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                    data-immersive-translate-paragraph="1">This application has demonstrated a number of different ways
                    in which you can handle the errors and exceptions that you might find in your own applications.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                这个应用程序展示了处理您自己应用程序中可能遇到的错误和异常的多种不同方法。</font>
                        </font>
                    </font>
                </p>
            </section>
        </section>
        <section aria-labelledby="head-2-93" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
            <span id="c10-sec-0031" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <h2 id="head-2-93" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">CALLER INFORMATION<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">调用者信息</font>
                    </font>
                </font>
            </h2>
            <p id="c10-para-0114" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">When dealing with errors, it is often helpful to get information
                about the error where it occurred. Earlier in this chapter, the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">#line</code> preprocessor
                directive was used to change the line numbering of the code to get better information with the call
                stack. A method can get caller information through optional parameters. You can use attributes to get
                the line numbers, filenames, and member names from within code. The attributes <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CallerLineNumber</code>,
                <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CallerFilePath</code>, and
                <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CallerMemberName</code>
                defined within the namespace <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Runtime.CompilerServices</code>
                are directly supported by the C# compiler, which sets these values.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">处理错误时，通常需要获取错误发生位置的信息。在本章前面，使用了 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">#line</code>
                            预处理器指令来更改代码的行号，以便通过调用堆栈获取更好的信息。一个方法可以通过可选参数获取调用者信息。你可以使用属性来从代码中获取行号、文件名和成员名。在命名空间 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">System.Runtime.CompilerServices</code>
                            中定义的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CallerLineNumber</code>
                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CallerFilePath</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CallerMemberName</code>
                            属性直接由 C# 编译器支持，编译器会设置这些值。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">The <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code> method from the
                following code snippet demonstrates how to use these attributes. With the implementation, the
                information is written to the console (code file <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CallerInformation/Program.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">以下代码片段中的 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code>
                            方法演示了如何使用这些属性。通过实现，信息会被写入控制台（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CallerInformation/Program.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c10-code-0038"><code>public void Log(<b>[CallerLineNumber]</b> int line = -1,</code>
<code>  <b>[CallerFilePath]</b> string path = default,</code>
<code>  <b>[CallerMemberName]</b> string name = default)<span aria-label="286" epub:type="pagebreak" id="Page_286" role="doc-pagebreak"></span></code>
<code>{</code>
<code>  Console.WriteLine($"Line {line}");</code>
<code>  Console.WriteLine(path);</code>
<code>  Console.WriteLine(name);</code>
<code>  Console.WriteLine();</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">Let's invoke this method with some different scenarios. In the
                following <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Main</code>
                method, the <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code>
                method is called by using an instance of the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Program</code> class, within
                the set accessor of the property, and within a lambda expression. Argument values are not assigned to
                the method, enabling the compiler to fill them in:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">让我们用一些不同的场景来调用这个方法。在下面的 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Main</code>
                            方法中，通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Program</code>
                            类的实例调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code>
                            方法，在属性的 set 访问器中，以及在 lambda 表达式中。方法参数值未分配，允许编译器填充它们：</font>
                    </font>
                </font>
            </p>
            <pre id="c10-code-0039"><code>public static void Main()</code>
<code>{</code>
<code>  Program p = new();</code>
<code>  p.Log();</code>
<code>  p.SomeProperty = 33;</code>
<code>  Action a1 = () =&gt; p.Log();</code>
<code>  a1();</code>
<code>}</code>
<code> </code>
<code>private int _someProperty;</code>
<code>public int SomeProperty</code>
<code>{</code>
<code>  get =&gt; _someProperty;</code>
<code>  set</code>
<code>  {</code>
<code>    Log();</code>
<code>    _someProperty = value;</code>
<code>  }</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">The result of the running program is shown next. Where the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code> method was
                invoked, you can see the line numbers, the filename, and the caller member name. With the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code> inside the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Main</code> method, the
                member name is <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Main</code>.
                The invocation of the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code> method inside the
                set accessor of the property <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SomeProperty</code> shows
                <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SomeProperty</code>. The
                <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code> method inside
                the lambda expression doesn't show the name of the generated method, but instead the name of the method
                where the lambda expression was invoked (<code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Main</code>), which is more
                useful, of course.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">程序的运行结果如下所示。在 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code>
                            方法被调用的地方，可以看到行号、文件名和调用成员名称。在 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Main</code> 方法内部的
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code> ，成员名称是
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Main</code> 。在属性
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SomeProperty</code>
                            的 set 访问器中调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code> 方法显示了
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">SomeProperty</code>
                            。lambda 表达式中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code>
                            方法没有显示生成方法的名称，而是显示了 lambda 表达式被调用的方法的名称（ <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Main</code>
                            ），这当然更有用。</font>
                    </font>
                </font>
            </p>
            <pre id="c10-code-0040"><code>Line 9</code>
<code>C:\ProCSharp\ErrorsAndExceptions\CallerInformation\Program.cs</code>
<code>Main</code>
<code> </code>
<code>Line 21</code>
<code>C:\ProCSharp\ErrorsAndExceptions\CallerInformation\Program.cs</code>
<code>SomeProperty</code>
<code> </code>
<code>Line 11</code>
<code>C:\ProCSharp\ErrorsAndExceptions\CallerInformation\Program.cs</code>
<code>Main</code></pre>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">Using the <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code> method within a
                constructor, the caller member name shows <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ctor</code>. With a
                destructor, the caller member name is <code
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Finalize</code>, as this is
                the method name generated.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在构造函数中使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Log</code>
                            方法，调用成员名称显示 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">ctor</code>
                            。对于析构函数，调用成员名称是 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Finalize</code>
                            ，因为这是生成的方法名称。</font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <p id="c10-para-0119" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">The destructor and
                            finalizer are covered in <a href="c13.xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Chapter
                                13</a>.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 析构函数和终结器在第 13 章中介绍。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <hr />
                    </div>
                </section>
            </aside>
            <p data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"><span aria-label="287"
                    epub:type="pagebreak" id="Page_287" role="doc-pagebreak"
                    data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span></p>
            <aside data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                <div class="top hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                    <p id="c10-para-0120" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">NOTE</b> <i
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">A great use of the
                        </i>
                        <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CallerMemberName</code>
                        <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"> attribute is with the
                            implementation of the interface </i>
                        <code
                            data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">INotifyPropertyChanged</code>
                        <i data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">. This interface
                            requires the name of the property to be passed with the method implementation. You can see
                            the implementation of this interface in <a href="c30.xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Chapter 30</a>,
                            “Patterns with XAML Apps.”</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">CallerMemberName</code>
                                    属性在实现接口 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">INotifyPropertyChanged</code>
                                    时的一个极佳用法。这个接口需要在方法实现中传递属性名称。你可以在第 30 章“使用 XAML 应用的模式”中看到这个接口的实现。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
                        <hr />
                    </div>
                </section>
            </aside>
        </section>
        <section aria-labelledby="head-2-94" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">
            <span id="c10-sec-0034" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"></span>
            <h2 id="head-2-94" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">SUMMARY<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">摘要</font>
                    </font>
                </font>
            </h2>
            <p id="c10-para-0121" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">This chapter examined the rich mechanism C# provides for dealing
                with error conditions through exceptions. You are not limited to the generic error codes that could be
                output from your code; instead, you have the capability to go in and uniquely handle the most granular
                of error conditions. Sometimes these error conditions are provided to you through .NET itself; at other
                times, though, you might want to code your own error conditions as illustrated in this chapter. In
                either case, you have many ways to protect the workflow of your applications from unnecessary and
                dangerous faults.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">本章探讨了
                            C#为处理异常情况提供的丰富机制。你不仅限于使用代码可能输出的通用错误代码；相反，你具备能力去深入处理最细粒度的错误情况。有时这些错误情况由.NET
                            本身提供；然而，在其他时候，你可能需要像本章所示那样自己编写错误情况。无论哪种情况，你都有许多方法来保护应用程序的工作流程免受不必要的和危险的故障。</font>
                    </font>
                </font>
            </p>
            <p id="c10-para-0122" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">Detailed information on logging errors is covered in <a
                    href="c16.xhtml" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">Chapter
                    16</a>, “Diagnostics and Metrics.”<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">关于记录错误的详细信息，请参阅第 16 章“诊断和指标”。</font>
                    </font>
                </font>
            </p>
            <p id="c10-para-0123" data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878"
                data-immersive-translate-paragraph="1">The next chapter goes into important keywords for asynchronous
                programming: <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">async</code>
                and <code data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">await</code>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">下一章将介绍异步编程的重要关键字： <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">async</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="fcced792-6254-44d4-9bbd-59514fe12878">await</code> 。
                        </font>
                    </font>
                </font>
            </p>
        </section>
    </section>
</body>
<div id="immersive-translate-popup" style="all: initial"></div>

</html>