<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops"
    xmlns:svg="http://www.w3.org/2000/svg" epub:prefix="index: http://www.index.com/" lang="en" xml:lang="en"
    imt-state="dual" imt-trans-position="after">

<head>
    <title>18 文件和流 --- 18 Files and Streams</title>
    <link href="WileyTemplate_v5.5.css" rel="stylesheet" type="text/css" />
    <meta content="urn:uuid:e0000000-0000-0000-0000-000006715209" name="Adept.expected.resource" />
    <style data-id="immersive-translate-input-injected-css">
        .immersive-translate-input {
            position: absolute;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            z-index: 2147483647;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .immersive-translate-attach-loading::after {
            content: " ";

            --loading-color: #f78fb6;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: block;
            margin: 12px auto;
            position: relative;
            color: white;
            left: -100px;
            box-sizing: border-box;
            animation: immersiveTranslateShadowRolling 1.5s linear infinite;

            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-2000%, -50%);
            z-index: 100;
        }

        .immersive-translate-loading-spinner {
            vertical-align: middle !important;
            width: 10px !important;
            height: 10px !important;
            display: inline-block !important;
            margin: 0 4px !important;
            border: 2px rgba(221, 244, 255, 0.6) solid !important;
            border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-radius: 50% !important;
            padding: 0 !important;
            -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
            animation: immersive-translate-loading-animation 0.6s infinite linear !important;
        }

        @-webkit-keyframes immersive-translate-loading-animation {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @keyframes immersive-translate-loading-animation {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(359deg);
            }
        }

        .immersive-translate-input-loading {
            --loading-color: #f78fb6;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            display: block;
            margin: 12px auto;
            position: relative;
            color: white;
            left: -100px;
            box-sizing: border-box;
            animation: immersiveTranslateShadowRolling 1.5s linear infinite;
        }

        @keyframes immersiveTranslateShadowRolling {
            0% {
                box-shadow: 0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            12% {
                box-shadow: 100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            25% {
                box-shadow: 110px 0 var(--loading-color), 100px 0 var(--loading-color),
                    0px 0 rgba(255, 255, 255, 0), 0px 0 rgba(255, 255, 255, 0);
            }

            36% {
                box-shadow: 120px 0 var(--loading-color), 110px 0 var(--loading-color),
                    100px 0 var(--loading-color), 0px 0 rgba(255, 255, 255, 0);
            }

            50% {
                box-shadow: 130px 0 var(--loading-color), 120px 0 var(--loading-color),
                    110px 0 var(--loading-color), 100px 0 var(--loading-color);
            }

            62% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color),
                    120px 0 var(--loading-color), 110px 0 var(--loading-color);
            }

            75% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    130px 0 var(--loading-color), 120px 0 var(--loading-color);
            }

            87% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    200px 0 rgba(255, 255, 255, 0), 130px 0 var(--loading-color);
            }

            100% {
                box-shadow: 200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0),
                    200px 0 rgba(255, 255, 255, 0), 200px 0 rgba(255, 255, 255, 0);
            }
        }

        .immersive-translate-toast {
            display: flex;
            position: fixed;
            z-index: 2147483647;
            left: 0;
            right: 0;
            top: 1%;
            width: fit-content;
            padding: 12px 20px;
            margin: auto;
            overflow: auto;
            background: #fef6f9;
            box-shadow: 0px 4px 10px 0px rgba(0, 10, 30, 0.06);
            font-size: 15px;
            border-radius: 8px;
            color: #333;
        }

        .immersive-translate-toast-content {
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        .immersive-translate-toast-hidden {
            margin: 0 20px 0 72px;
            text-decoration: underline;
            cursor: pointer;
        }

        .immersive-translate-toast-close {
            color: #666666;
            font-size: 20px;
            font-weight: bold;
            padding: 0 10px;
            cursor: pointer;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-toast {
                top: 0;
                padding: 12px 0px 0 10px;
            }

            .immersive-translate-toast-content {
                flex-direction: column;
                text-align: center;
            }

            .immersive-translate-toast-hidden {
                margin: 10px auto;
            }
        }

        .immersive-translate-modal {
            display: none;
            position: fixed;
            z-index: 2147483647;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.4);
            font-size: 15px;
        }

        .immersive-translate-modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 40px 24px 24px;
            border: 1px solid #888;
            border-radius: 10px;
            width: 80%;
            max-width: 270px;
            font-family: system-ui, -apple-system, "Segoe UI", "Roboto", "Ubuntu",
                "Cantarell", "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji",
                "Segoe UI Symbol", "Noto Color Emoji";
            position: relative;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-modal-content {
                margin: 50% auto !important;
            }
        }

        .immersive-translate-modal .immersive-translate-modal-content-in-input {
            max-width: 500px;
        }

        .immersive-translate-modal-content-in-input .immersive-translate-modal-body {
            text-align: left;
            max-height: unset;
        }

        .immersive-translate-modal-title {
            text-align: center;
            font-size: 16px;
            font-weight: 700;
            color: #333333;
        }

        .immersive-translate-modal-body {
            text-align: center;
            font-size: 14px;
            font-weight: 400;
            color: #333333;
            word-break: break-all;
            margin-top: 24px;
        }

        @media screen and (max-width: 768px) {
            .immersive-translate-modal-body {
                max-height: 250px;
                overflow-y: auto;
            }
        }

        .immersive-translate-close {
            color: #666666;
            position: absolute;
            right: 16px;
            top: 16px;
            font-size: 20px;
            font-weight: bold;
        }

        .immersive-translate-close:hover,
        .immersive-translate-close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        .immersive-translate-modal-footer {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 24px;
        }

        .immersive-translate-btn {
            width: fit-content;
            color: #fff;
            background-color: #ea4c89;
            border: none;
            font-size: 16px;
            margin: 0 8px;
            padding: 9px 30px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .immersive-translate-btn:hover {
            background-color: #f082ac;
        }

        .immersive-translate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .immersive-translate-btn:disabled:hover {
            background-color: #ea4c89;
        }

        .immersive-translate-cancel-btn {
            /* gray color */
            background-color: rgb(89, 107, 120);
        }

        .immersive-translate-cancel-btn:hover {
            background-color: hsl(205, 20%, 32%);
        }

        .immersive-translate-action-btn {
            background-color: transparent;
            color: #ea4c89;
            border: 1px solid #ea4c89;
        }

        .immersive-translate-btn svg {
            margin-right: 5px;
        }

        .immersive-translate-link {
            cursor: pointer;
            user-select: none;
            -webkit-user-drag: none;
            text-decoration: none;
            color: #007bff;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        .immersive-translate-primary-link {
            cursor: pointer;
            user-select: none;
            -webkit-user-drag: none;
            text-decoration: none;
            color: #ea4c89;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        .immersive-translate-modal input[type="radio"] {
            margin: 0 6px;
            cursor: pointer;
        }

        .immersive-translate-modal label {
            cursor: pointer;
        }

        .immersive-translate-close-action {
            position: absolute;
            top: 2px;
            right: 0px;
            cursor: pointer;
        }

        .imt-image-status {
            background-color: rgba(0, 0, 0, 0.5) !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
            border-radius: 16px !important;
        }

        .imt-image-status img,
        .imt-image-status svg,
        .imt-img-loading {
            width: 28px !important;
            height: 28px !important;
            margin: 0 0 8px 0 !important;
            min-height: 28px !important;
            min-width: 28px !important;
            position: relative !important;
        }

        .imt-img-loading {
            background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAtFBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////oK74hAAAAPHRSTlMABBMIDyQXHwyBfFdDMSw+OjXCb+5RG51IvV/k0rOqlGRM6KKMhdvNyZBz9MaupmxpWyj437iYd/yJVNZeuUC7AAACt0lEQVRIx53T2XKiUBCA4QYOiyCbiAsuuGBcYtxiYtT3f6/pbqoYHVFO5r+iivpo6DpAWYpqeoFfr9f90DsYAuRSWkFnPO50OgR9PwiCUFcl2GEcx+N/YBh6pvKaefHlUgZd1zVe0NbYcQjGBfzrPE8Xz8aF+71D8gG6DHFPpc4a7xFiCDuhaWgKgGIJQ3d5IMGDrpS4S5KgpIm+en9f6PlAhKby4JwEIxlYJV9h5k5nee9GoxHJ2IDSNB0dwdad1NAxDJ/uXDHYmebdk4PdbkS58CIVHdYSUHTYYRWOJblWSyu2lmy3KNFVJNBhxcuGW4YBVCbYGRZwIooipHsNqjM4FbgOQqQqSKQQU9V8xmi1QlgHqQQ6DDBvRUVCDirs+EzGDGOQTCATgtYTnbCVLgsVgRE0T1QE0qHCFAht2z6dLvJQs3Lo2FQoDxWNUiBhaP4eRgwNkI+dAjVOA/kUrIDwf3CG8NfNOE0eiFotSuo+rBiq8tD9oY4Qzc6YJw99hl1wzpQvD7ef2M8QgnOGJfJw+EltQc+oX2yn907QB22WZcvlUpd143dqQu+8pCJZuGE4xCuPXJqqcs5sNpsI93Rmzym1k4Npk+oD1SH3/a3LOK/JpUBpWfqNySxWzCfNCUITuDG5dtuphrUJ1myeIE9bIsPiKrfqTai5WZxbhtNphYx6GEIHihyGFTI69lje/rxajdh0s0msZ0zYxyPLhYCb1CyHm9Qsd2H37Y3lugVwL9kNh8Ot8cha6fUNQ8nuXi5z9/ExsAO4zQrb/ev1yrCB7lGyQzgYDGuxq1toDN/JGvN+HyWNHKB7zEoK+PX11e12G431erGYzwmytAWU56fkMHY5JJnDRR2eZji3AwtIcrEV8Cojat/BdQ7XOwGV1e1hDjGGjXbdArm8uJZtCH5MbcctVX8A1WpqumJHwckAAAAASUVORK5CYII=");
            background-size: 28px 28px;
            animation: image-loading-rotate 1s linear infinite !important;
        }

        .imt-image-status span {
            color: var(--bg-2, #fff) !important;
            font-size: 14px !important;
            line-height: 14px !important;
            font-weight: 500 !important;
            font-family: "PingFang SC", Arial, sans-serif !important;
        }

        @keyframes image-loading-rotate {
            from {
                transform: rotate(360deg);
            }

            to {
                transform: rotate(0deg);
            }
        }
    </style>
    <style data-id="immersive-translate-default-injected-css">
        :root {
            --immersive-translate-theme-underline-borderColor: #72ece9;
            --immersive-translate-theme-nativeUnderline-borderColor: #72ece9;
            --immersive-translate-theme-nativeDashed-borderColor: #72ece9;
            --immersive-translate-theme-nativeDotted-borderColor: #72ece9;
            --immersive-translate-theme-highlight-backgroundColor: #ffff00;
            --immersive-translate-theme-dashed-borderColor: #59c1bd;
            --immersive-translate-theme-blockquote-borderColor: #cc3355;
            --immersive-translate-theme-thinDashed-borderColor: #ff374f;
            --immersive-translate-theme-dashedBorder-borderColor: #94a3b8;
            --immersive-translate-theme-dashedBorder-borderRadius: 0;
            --immersive-translate-theme-solidBorder-borderColor: #94a3b8;
            --immersive-translate-theme-solidBorder-borderRadius: 0;
            --immersive-translate-theme-dotted-borderColor: #94a3b8;
            --immersive-translate-theme-wavy-borderColor: #72ece9;
            --immersive-translate-theme-dividingLine-borderColor: #94a3b8;
            --immersive-translate-theme-grey-textColor: #2f4f4f;
            --immersive-translate-theme-marker-backgroundColor: #fbda41;
            --immersive-translate-theme-marker-backgroundColor-rgb: 251, 218, 65;
            --immersive-translate-theme-marker2-backgroundColor: #ffff00;
            --immersive-translate-theme-background-backgroundColor: #dbafaf;
            --immersive-translate-theme-background-backgroundColor-rgb: 219, 175, 175;
            --immersive-translate-theme-background-backgroundOpacity: 12;
            --immersive-translate-theme-opacity-opacity: 10;
        }

        [imt-state="dual"] .immersive-translate-target-translation-pre-whitespace {
            white-space: pre-wrap !important;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container {
            position: absolute;
            background-color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica,
                sans-serif;
            top: 0;
            width: 600px;
            height: 100%;
            z-index: 2;
            line-height: 1.3;
            font-size: 16px;
        }

        [imt-state="dual"] .immersive-translate-target-wrapper[dir="rtl"] {
            text-align: right;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container .immersive-translate-target-wrapper {
            color: rgb(0, 0, 0);
            white-space: normal;
            position: absolute;
        }

        [imt-state="dual"] .immersive-translate-pdf-target-container .immersive-translate-target-wrapper font {
            color: inherit;
            white-space: inherit;
            position: unset;
        }

        [imt-state="translation"] .immersive-translate-target-wrapper &gt;

        br {
            display: none;
        }

        [imt-state="translation"] .immersive-translate-target-translation-block-wrapper {
            margin: 0 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper {
            margin: 8px 0 !important;
            display: inline-block;
        }

        [imt-trans-position="before"] .immersive-translate-target-translation-block-wrapper {
            display: block;
        }

        [imt-trans-position="before"] .immersive-translate-target-translation-block-wrapper {
            margin-top: 0 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-pdf-block-wrapper {
            margin: 0 !important;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-grey-inner {
            color: var(--immersive-translate-theme-grey-textColor);
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-underline-inner {
            border-bottom: 1px solid var(--immersive-translate-theme-underline-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeUnderline-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeUnderline-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-dashedBorder {
            border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
            padding: 6px;
            margin-top: 2px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-dashedBorder {
            border: 1px dashed var(--immersive-translate-theme-dashedBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-dashedBorder-borderRadius) !important;
            padding: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-solidBorder {
            border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
            padding: 6px;
            margin-top: 2px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-solidBorder {
            border: 1px solid var(--immersive-translate-theme-solidBorder-borderColor) !important;
            border-radius: var(--immersive-translate-theme-solidBorder-borderRadius) !important;
            padding: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeDashed-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeDashed-borderColor) !important;
            text-decoration-style: dashed !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-thinDashed-inner {
            border-bottom: 1px dashed var(--immersive-translate-theme-thinDashed-borderColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-dotted-inner {
            background-image: linear-gradient(to right,
                    var(--immersive-translate-theme-dotted-borderColor) 30%,
                    rgba(255, 255, 255, 0) 0%);
            background-position: bottom;
            background-size: 5px 1px;
            background-repeat: repeat-x;
            padding-bottom: 3px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-nativeDotted-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-nativeDotted-borderColor) !important;
            text-decoration-style: dotted !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-wavy-inner {
            text-decoration: underline !important;
            text-decoration-color: var(--immersive-translate-theme-wavy-borderColor) !important;
            text-decoration-style: wavy !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-dashed-inner {
            background: linear-gradient(to right,
                    var(--immersive-translate-theme-dashed-borderColor) 0%,
                    var(--immersive-translate-theme-dashed-borderColor) 50%,
                    transparent 50%,
                    transparent 100%) repeat-x left bottom;
            background-size: 8px 2px;
            padding-bottom: 2px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
            content: "";
            display: block;
            max-width: 80px;
            width: 10%;
            border-top: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
            padding-top: 8px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-inline-wrapper-theme-dividingLine::before {
            content: "";
            border-left: 1px dashed var(--immersive-translate-theme-dividingLine-borderColor);
            max-height: 16px;
            height: 16px;
            padding-left: 8px;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-highlight-inner {
            background: var(--immersive-translate-theme-highlight-backgroundColor);
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-marker {
            line-height: 1.5em;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-marker2-inner {
            font-weight: bold;
            text-shadow: 10px 0px 3px var(--immersive-translate-theme-marker2-backgroundColor),
                16px 3px 9px var(--immersive-translate-theme-marker2-backgroundColor),
                2px 0px 6px var(--immersive-translate-theme-marker2-backgroundColor),
                -12px 0px 12px var(--immersive-translate-theme-marker2-backgroundColor) !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-marker-inner {
            /* TODO: add more texture */
            background: linear-gradient(to right,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.1),
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 3%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 35%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.9) 70%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.8) 95%,
                    rgba(var(--immersive-translate-theme-marker-backgroundColor-rgb), 0.3));
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-weakening {
            opacity: 0.618 !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-italic {
            font-style: italic !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-bold {
            font-weight: bold !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-paper {
            margin: 8px 0;
            box-shadow: rgba(0, 0, 0, 0.24) 0px 3px 8px;
            padding: 16px 32px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-blockquote {
            border-left: 4px solid var(--immersive-translate-theme-blockquote-borderColor) !important;
            padding-left: 12px !important;
            margin-top: 4px;
            margin-bottom: 4px;
            padding-top: 4px;
            padding-bottom: 4px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-mask-inner {
            filter: blur(5px) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-mask-inner {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner {
            filter: blur(5px) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        /* opacity theme start */

        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner {
            filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [data-immersive-translate-root-translation-theme="none"] .immersive-translate-target-translation-theme-opacity-inner {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner,
        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner:hover {
            filter: opacity(calc(var(--immersive-translate-theme-opacity-opacity) * 1%)) !important;
            transition: filter 0.3s ease !important;
            border-radius: 10px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-opacity-inner:hover {
            filter: none !important;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-mask-inner:hover {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="opacity"] .immersive-translate-target-inner:hover {
            filter: none !important;
        }

        [data-immersive-translate-root-translation-theme="mask"] .immersive-translate-target-inner:hover {
            filter: none !important;
        }

        /* opacity theme end */

        /* background theme start */
        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper-theme-background {
            margin: 8px 0;
            background: rgba(var(--immersive-translate-theme-background-backgroundColor-rgb),
                    calc(var(--immersive-translate-theme-background-backgroundOpacity) * 1%));
            border-radius: 4px;
            box-shadow: unset !important;
            padding: 12px;
            display: inline-block;
        }

        [imt-state="dual"] .immersive-translate-target-translation-theme-background-inner {
            background: rgba(var(--immersive-translate-theme-background-backgroundColor-rgb),
                    calc(var(--immersive-translate-theme-background-backgroundOpacity) * 1%));
            padding-left: 6px;
            padding-right: 6px;
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        [imt-state="dual"] .immersive-translate-target-translation-block-wrapper .immersive-translate-target-translation-theme-background-inner {
            background: unset;
            padding-left: unset;
            padding-right: unset;
        }

        /* background theme end */

        /* vertical css , please remain it in the last one. */
        .immersive-translate-target-translation-vertical-block-wrapper {
            margin: 0px 8px !important;
        }

        .immersive-translate-text {
            font-size: 15px !important;
        }

        .immersive-translate-error-toast {
            position: fixed;
            top: 5%;
            z-index: 99999999;
            left: 0;
            right: 0;
            margin: auto;
            max-width: 300px;
            padding: 16px;
            border-radius: 12px;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: row;
            justify-content: space-between;
        }

        @media all and (min-width: 750px) {
            .immersive-translate-error-toast {
                max-width: 400px;
            }
        }

        .immersive-translate-clickable-button {
            cursor: pointer;
        }

        .immersive-translate-help-button {
            cursor: pointer;
        }

        .immersive-translate-loading-text:before {
            content: "...";
        }

        /* dark mode for loading */

        @media only screen and (prefers-color-scheme: dark) {
            .immersive-translate-loading {
                border: 2px rgba(255, 255, 255, 0.25) solid !important;
                border-top: 2px rgba(255, 255, 255, 1) solid !important;
            }
        }

        .immersive-translate-error-wrapper {
            position: relative;
            display: inline-flex;
            padding: 6px;
            margin: 0 12px;
            white-space: nowrap;
            font-size: 0.9em;
        }

        [lang="zh-CN"] .immersive-translate-error-wrapper {
            font-size: 0.75em;
        }

        [lang="zh-TW"] .immersive-translate-error-wrapper {
            font-size: 0.75em;
        }

        .immersive-translate-tooltip {
            position: relative;
            display: inline-flex;
            /* little indicater to indicate it's hoverable */
        }

        .immersive-translate-tooltip-content {
            /* here's the magic */
            position: absolute;
            z-index: 100000000000;

            left: 50%;
            bottom: 0;
            transform: translate(-50%, 110%);
            line-height: 1;
            /* and add a small left margin */

            /* basic styles */
            width: max-content;
            max-width: 250px;
            word-wrap: break-word;
            white-space: pre-line;
            padding: 10px;
            border-radius: 10px;
            background: #000c;
            color: #fff;
            text-align: center;
            font-size: 14px;
            display: none;
            /* hide by default */
        }

        .immersive-translate-tooltip:hover .immersive-translate-tooltip-content {
            display: inline-block;
        }

        .immersive-translate-tooltip:hover+.immersive-translate-tooltip-content {
            display: inline-block;
        }

        .immersive-translate-tooltip-content-table {
            left: unset !important;
            bottom: unset !important;
            transform: translate(-10%, 50%) !important;
        }

        .immersive-translate-tooltip:hover:before {
            display: inline-block;
        }

        .immersive-translate-loading-spinner {
            vertical-align: middle !important;
            width: 10px !important;
            height: 10px !important;
            display: inline-block !important;
            margin: 0 4px !important;
            border: 2px rgba(221, 244, 255, 0.6) solid !important;
            border-top: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-left: 2px rgba(0, 0, 0, 0.375) solid !important;
            border-radius: 50% !important;
            padding: 0 !important;
            -webkit-animation: immersive-translate-loading-animation 0.6s infinite linear !important;
            animation: immersive-translate-loading-animation 0.6s infinite linear !important;
        }

        @-webkit-keyframes immersive-translate-loading-animation {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @keyframes immersive-translate-loading-animation {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(359deg);
            }
        }

        .imt-image-status {
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--bg-2, #fff);
            font-size: 14px;
        }
    </style>
    <style data-id="immersive-translate-user-custom-style">
        :root {

            .immersive-translate-target-inner {
                font-family: inherit;
            }


            .immersive-translate-target-inner {
                font-family: inherit;
            }
        }
    </style>
    <style data-id="immersive-translate-dynamic-injected-css">
        .immersive-translate-target-wrapper[dir='rtl'] {
            text-align: right;
        }

        .immersive-translate-target-wrapper[dir='rtl'] [data-immersive-translate-class-bak*='block-wrapper'] {
            display: block;
        }

        .immersive-translate-target-wrapper {
            word-break: break-word;
            user-select: text;
        }

        [imt-state="translation"] .immersive-translate-target-wrapper[dir='rtl'] {
            display: inline-block;
        }

        [dir='rtl'] .immersive-translate-target-wrapper:not([dir]) {
            text-align: left;
        }

        [imt-state=dual] .immersive-translate-target-translation-block-wrapper-theme-dividingLine::before {
            display: block;
        }

        [imt-trans-position=before] .immersive-translate-target-translation-block-wrapper {
            display: block !important;
        }

        [imt-state][data-immersive-translate_rtl] .immersive-translate-target-wrapper {
            display: block !important;
        }
    </style>
</head>

<body epub:type="bodymatter" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
    <section aria-labelledby="c18_1" epub:type="chapter" role="doc-chapter"
        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
        <header data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <h1 id="c18_1" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1"><span aria-label="485" epub:type="pagebreak" id="Page_485"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span><span id="c18"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span><span
                    class="chapterNumber"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">18</span><br /><span
                    class="chapterTitle" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Files
                    and Streams</span>
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">18 文件和流</font>
                    </font>
                </font>
            </h1>
        </header>
        <section aria-label="chapter opening" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <span id="c18-sec-0001" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <hr />
                </div>
                <section class="feature3" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <h3 data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">WHAT'S IN THIS CHAPTER?<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">本章包含什么内容？</font>
                            </font>
                        </font>
                    </h3>
                    <ul class="check2" id="c18-list-0001"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <li id="c18-li-0001" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">Exploring the directory structure<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">探索目录结构</font>
                                </font>
                            </font>
                        </li>
                        <li id="c18-li-0002" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">Moving, copying, and deleting files and folders<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">移动、复制和删除文件和文件夹</font>
                                </font>
                            </font>
                        </li>
                        <li id="c18-li-0003" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">Reading and writing text in files<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">在文件中读取和写入文本</font>
                                </font>
                            </font>
                        </li>
                        <li id="c18-li-0004" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">Using streams to read and write files<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用流来读写文件 </font>
                                </font>
                            </font>
                        </li>
                        <li id="c18-li-0005" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">Using readers and writers to read and write files
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用读取器和写入器来读写文件 </font>
                                </font>
                            </font>
                        </li>
                        <li id="c18-li-0006" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">Compressing files<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">压缩文件 </font>
                                </font>
                            </font>
                        </li>
                        <li id="c18-li-0007" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">Monitoring file changes<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">监控文件变化</font>
                                </font>
                            </font>
                        </li>
                        <li id="c18-li-0008" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">Working with JSON serialization<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">处理 JSON 序列化</font>
                                </font>
                            </font>
                        </li>
                        <li id="c18-li-0009" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">Using Windows Runtime streams<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用 Windows 运行时流</font>
                                </font>
                            </font>
                        </li>
                    </ul>
                    <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                </section>
            </aside>
            <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <hr />
                </div>
                <section class="feature3" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span
                        id="c18-fea-0001" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                    <h3 id="head-2-164" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">CODE DOWNLOADS FOR THIS CHAPTER<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">本章代码下载</font>
                            </font>
                        </font>
                    </h3>
                    <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span
                            id="c18-sec-1003"
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                        <p id="c18-para-0003" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">The source code for this chapter is available on the
                            book page at <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="http://www.wiley.com">www.wiley.com</a></code>.
                            Click the Downloads link. The code can also be found at <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="https://github.com/ProfessionalCSharp/ProfessionalCSharp2021">https://github.com/ProfessionalCSharp/ProfessionalCSharp2021</a></code>
                            in the directory <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">2_Libs/FilesAndStreams</code>.
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章的源代码可在书籍页面 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="http://www.wiley.com">www.wiley.com</a></code>
                                        上找到。点击下载链接。代码也可以在目录 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">2_Libs/FilesAndStreams</code>
                                        中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="https://github.com/ProfessionalCSharp/ProfessionalCSharp2021">https://github.com/ProfessionalCSharp/ProfessionalCSharp2021</a></code>
                                        找到。</font>
                                </font>
                            </font>
                        </p>
                        <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">The code for this chapter is divided into the
                            following major examples:<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章的代码分为以下主要示例：</font>
                                </font>
                            </font>
                        </p>
                        <ul class="check" id="c18-list-0002"
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <li id="c18-li-0010" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1">FilesAndFolders<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">文件和文件夹</font>
                                    </font>
                                </font>
                            </li>
                            <li id="c18-li-0011" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1">StreamSamples<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">流示例</font>
                                    </font>
                                </font>
                            </li>
                            <li id="c18-li-0012" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1">ReaderWriterSamples</li>
                            <li id="c18-li-0013" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1">CompressFileSample</li>
                            <li id="c18-li-0014" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1">FileMonitor</li>
                            <li id="c18-li-0015" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1">JsonSample</li>
                            <li id="c18-li-0016" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1">WindowsAppEditor</li>
                        </ul>
                        <p id="c18-para-0005" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1"><span aria-label="486" epub:type="pagebreak"
                                id="Page_486" role="doc-pagebreak"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>The major
                            namespaces used in this chapter are <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO</code>,
                            <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO.Compression</code>,
                            <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text</code>,
                            and <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text.Json</code>.
                            With the Windows app sample, <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Winodws.Storage</code>
                            and <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Windows.Storage.Streams</code>
                            are important namespaces. All projects have nullable reference types enabled.<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">本章使用的主要命名空间是 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO</code>
                                        、 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO.Compression</code>
                                        、 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text</code>
                                        和 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text.Json</code>
                                        。在 Windows 应用示例中， <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Winodws.Storage</code>
                                        和 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Windows.Storage.Streams</code>
                                        是重要的命名空间。所有项目都启用了可空引用类型。</font>
                                </font>
                            </font>
                        </p>
                    </section>
                    <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                </section>
            </aside>
        </section>
        <section aria-labelledby="head-2-165" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <span id="c18-sec-0002" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <h2 id="head-2-165" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">OVERVIEW<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">概述</font>
                    </font>
                </font>
            </h2>
            <p id="c18-para-0006" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">When you're reading and writing to files and directories, you can
                use simple APIs, or you can use advanced ones that offer more features. Just use the simplest ones that
                fit your purpose. You also have to differentiate between .NET classes and the functionality offered from
                the Windows Runtime. From Universal Windows Platform (UWP) Windows apps, you don't have access to the
                file system in any directory; you have access only to specific directories. Alternatively, you can let
                the user pick files. This chapter covers all these options. You'll read and write files by using a
                simple API and get into more features by using streams. You'll use both .NET types and types from the
                Windows Runtime, and you'll mix both of these technologies to take advantage of .NET features with the
                Windows Runtime.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">当你读取和写入文件和目录时，你可以使用简单的
                            API，或者使用提供更多功能的进阶 API。只需使用适合你目的的最简单 API 即可。你还需要区分.NET 类和 Windows 运行时提供的功能。从通用 Windows
                            平台（UWP）Windows 应用中，你无法访问任何目录的文件系统；你只能访问特定目录。或者，你可以让用户选择文件。本章涵盖了所有这些选项。你将通过使用简单 API
                            来读取和写入文件，并通过使用流来探索更多功能。你将使用.NET 类型和 Windows 运行时的类型，并将混合这两种技术，以利用.NET 功能和 Windows 运行时。</font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0007" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">As you use streams, you also learn about compressing data and
                sharing data between different tasks using memory mapped files and pipes.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            在使用流的同时，你还学习了如何压缩数据，以及如何使用内存映射文件和管道在不同任务之间共享数据。</font>
                    </font>
                </font>
            </p>
        </section>
        <section aria-labelledby="head-2-166" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <span id="c18-sec-0003" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <h2 id="head-2-166" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">MANAGING THE FILE SYSTEM<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">管理文件系统</font>
                    </font>
                </font>
            </h2>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Let's start with simple APIs from the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO</code> namespace.
                The most important classes used to browse around the file system and perform operations such as moving,
                copying, and deleting files are:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">让我们从 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO</code>
                            命名空间中的简单 API 开始。用于浏览文件系统并执行移动、复制和删除文件等操作的最重要类是：</font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c18-list-0003" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <li id="c18-li-0017" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemInfo</code>—This
                    base class represents any file system object such as <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemInfo</code>
                                —这个基类表示任何文件系统对象，例如 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                                。</font>
                        </font>
                    </font>
                </li>
                <li id="c18-li-0018" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>—These classes
                    represent a file on the file system.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>
                                —这些类表示文件系统上的一个文件。</font>
                        </font>
                    </font>
                </li>
                <li id="c18-li-0019" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code>—These
                    classes represent a folder on the file system.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code>
                                —这些类代表文件系统上的一个文件夹。</font>
                        </font>
                    </font>
                </li>
                <li id="c18-li-0020" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code>—This class
                    contains static members that you can use to manipulate pathnames.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code>
                                —这个类包含你可以用来操作路径名的静态成员。</font>
                        </font>
                    </font>
                </li>
                <li id="c18-li-0021" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DriveInfo</code>—This
                    class has properties and methods that provide information about a selected drive.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DriveInfo</code>
                                —这个类具有属性和方法，可以提供有关选定驱动器的信息。</font>
                        </font>
                    </font>
                </li>
            </ul>
            <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directories or
                            folders? These terms are often used interchangeably. <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</i> is
                            a classic term for a file system object. A directory contains files and other directories. A
                            <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">folder</i> has its
                            origin with Apple's Lisa and is a GUI object. Often it is associated with an icon to map to
                            a directory.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意
                                    目录或文件夹？这些术语经常可以互换使用。目录是文件系统对象的经典术语。目录包含文件和其他目录。文件夹起源于苹果的 Lisa，是一个 GUI
                                    对象。通常它与一个图标相关联，用于映射到一个目录。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                </section>
            </aside>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Notice in the previous list that two classes work with folders
                and two other classes work with files. Which one of these classes you use depends largely on how many
                operations you need in order to access that folder or file:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            在之前的列表中请注意，有两个类用于处理文件夹，另外两个类用于处理文件。你使用哪个类很大程度上取决于你需要多少操作来访问那个文件夹或文件：</font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c18-list-0004" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <li id="c18-li-0022" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> contain
                    only static methods and are never instantiated. You use these classes by supplying the path to the
                    appropriate file system object whenever you call a member method. If you want to do only one
                    operation on a folder or file, using these classes is more efficient because it saves the overhead
                    of creating a .NET object.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>
                                只包含静态方法，并且永远不会被实例化。你使用这些类的方法时，只需在调用成员方法时提供适当的文件系统对象的路径。如果你只想对文件夹或文件执行一个操作，使用这些类更高效，因为它们节省了创建
                                .NET 对象的开销。</font>
                        </font>
                    </font>
                </li>
                <li id="c18-li-0023" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                    implement roughly the same public methods as <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>, as well as
                    some public properties and constructors, but they are stateful, and the members of these classes are
                    not static. You need to instantiate these classes before each instance is associated with a
                    particular folder <span aria-label="487" epub:type="pagebreak" id="Page_487" role="doc-pagebreak"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>or file. This
                    means that these classes are more efficient if you are performing multiple operations using the same
                    object. That's because they read the authentication and other information for the appropriate file
                    system object on construction, and then they do not need to read that information again, no matter
                    how many methods you call against each object (class instance). By comparison, the corresponding
                    stateless classes need to check the details of the file or folder again with every method you call.
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                实现了与 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>
                                大致相同的公共方法，以及一些公共属性和构造函数，但它们是状态化的，并且这些类的成员不是静态的。您需要在每个实例与特定文件夹或文件关联之前实例化这些类。这意味着如果您使用同一个对象执行多个操作，这些类会更高效。这是因为它们在构造时读取了适当的文件系统对象的认证和其他信息，然后无论您对每个对象（类实例）调用多少方法，都不需要再次读取这些信息。相比之下，相应的无状态类需要在每次调用方法时再次检查文件或文件夹的详细信息。
                            </font>
                        </font>
                    </font>
                </li>
            </ul>
            <p id="c18-para-0012" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">The next sample is a console application that accepts
                command-line arguments so you can easily start it with all the different features in action. Just check
                the downloaded source code for the arguments, or start the application without passing arguments to see
                the options you have.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            下一个示例是一个控制台应用程序，它接受命令行参数，因此您可以轻松地使用所有不同的功能来启动它。只需检查下载的源代码中的参数，或者不传递参数启动应用程序以查看您拥有的选项。</font>
                    </font>
                </font>
            </p>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0005"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-328" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Checking Drive Information <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">检查驱动器信息</font>
                        </font>
                    </font>
                </h3>
                <p id="c18-para-0013" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Before working with files and folders, let's check the drives
                    of the system. You use the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DriveInfo</code> class,
                    which can perform a scan of a system to provide a list of available drives and then dig in deeper to
                    provide a lot of details about any of the drives.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在处理文件和文件夹之前，让我们检查系统的驱动器。您使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DriveInfo</code>
                                类，该类可以执行系统扫描，以提供可用驱动器的列表，然后深入挖掘以提供有关任何驱动器的详细信息。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The following code snippet invokes the static method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DriveInfo.GetDrives</code>.
                    This method returns an array of <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DriveInfo</code> objects.
                    With this array, every drive that is ready is accessed to write information about the drive name,
                    type, and format, and it also shows size information (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">以下代码片段调用了静态方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DriveInfo.GetDrives</code>
                                。此方法返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DriveInfo</code>
                                对象的数组。使用这个数组，可以访问每个准备好的驱动器，以写入关于驱动器名称、类型和格式的信息，它还显示了大小信息（代码文件 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0001"><code>void ShowDrives()</code>
<code>{</code>
<code>  DriveInfo[] drives = DriveInfo.GetDrives();</code>
<code>  foreach (DriveInfo drive in drives)</code>
<code>  {</code>
<code>    if (drive.IsReady)</code>
<code>    {</code>
<code>      Console.WriteLine($"Drive name: {drive.Name}");</code>
<code>      Console.WriteLine($"Format: {drive.DriveFormat}");</code>
<code>      Console.WriteLine($"Type: {drive.DriveType}");</code>
<code>      Console.WriteLine($"Root directory: {drive.RootDirectory}");</code>
<code>      Console.WriteLine($"Volume label: {drive.VolumeLabel}");</code>
<code>      Console.WriteLine($"Free space: {drive.TotalFreeSpace}");</code>
<code>      Console.WriteLine($"Available space: {drive.AvailableFreeSpace}");</code>
<code>      Console.WriteLine($"Total size: {drive.TotalSize}");</code>
<code>      Console.WriteLine();</code>
<code>    }</code>
<code>  }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">When I run this program on my Windows system, which has only
                    a solid-state disk (SSD), I see this information:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当我在只有固态硬盘（SSD）的 Windows
                                系统上运行此程序时，我看到这些信息：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0002"><code>Drive name: C:\</code>
<code>Format: NTFS</code>
<code>Type: Fixed</code>
<code>Root directory: C:\</code>
<code>Volume label: Lokal Disk</code>
<code>Free space: 483677138944</code>
<code>Available space: 483677138944</code>
<code>Total size: 1022985498624</code></pre>
                <p id="c18-para-0016" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">When I run the same application on the same system with
                    Windows Subsystem for Linux (WSL-2) and the Ubuntu operating system, I see <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Fixed</code> and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Ram</code> types. <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Fixed</code> types use
                    the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ext3</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">v9fs</code> formats;
                    with the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Ram</code>
                    types, you can see the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">cgroupfs</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">cgroup2fs</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">devpts</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">proc</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">sysfs</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">temp</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">tmpfs</code>, and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">binfmt_misc</code>
                    formats. On Unix-based systems, a lot more functionality is available via file APIs, including
                    information about processes and resource restrictions with control groups (cgroups).<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当我在同一系统上使用 Windows 子系统
                                Linux（WSL-2）和 Ubuntu 操作系统运行相同的应用程序时，我会看到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Fixed</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Ram</code>
                                类型。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Fixed</code>
                                类型使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ext3</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">v9fs</code>
                                格式；而 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Ram</code>
                                类型则可以看到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">cgroupfs</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">cgroup2fs</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">devpts</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">proc</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">sysfs</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">temp</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">tmpfs</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">binfmt_misc</code>
                                格式。在基于 Unix 的系统上，通过文件 API 可以提供更多功能，包括进程信息以及通过控制组（cgroups）实现资源限制。</font>
                        </font>
                    </font>
                </p>
            </section> <span aria-label="488" epub:type="pagebreak" id="Page_488" role="doc-pagebreak"
                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0006"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-329" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Working with the Path Class <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 Path 类</font>
                        </font>
                    </font>
                </h3>
                <p id="c18-para-0017" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">For accessing files and directories, the names of the files
                    and directories need to be defined—including parent folders. When you combine multiple folders and
                    files using string concatenation operators, you can easily miss a separator character or use one too
                    many characters. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code> class can
                    help with this because this class adds missing separator characters, and it also deals with
                    different platform requirements on Windows- and Unix-based systems.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                要访问文件和目录，需要定义文件和目录的名称，包括父文件夹。当您使用字符串连接运算符组合多个文件夹和文件时，很容易遗漏分隔符字符或使用过多字符。 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code>
                                类可以帮助解决这个问题，因为此类会添加缺失的分隔符字符，并且还处理 Windows 和基于 Unix 的系统的不同平台要求。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code> class exposes
                    some static methods that make operations on pathnames easier. For example, suppose that you want to
                    display the full pathname for a file, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadMe.txt</code>, in the
                    folder <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">D:\Projects</code>. You
                    could find the path to the file using the following code:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code>
                                类公开了一些静态方法，使对路径名的操作更加容易。例如，假设您想在文件夹 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">D:\Projects</code>
                                中显示文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadMe.txt</code>
                                的完整路径名。您可以使用以下代码找到文件的路径：</font>
                        </font>
                    </font>
                </p>
                <pre
                    id="c18-code-0003"><code>Console.WriteLine(<b>Path.Combine(@"D:\Projects", "ReadMe.txt")</b>);</code></pre>
                <p id="c18-para-0019" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path.Combine</code> is
                    the method of this class that you are likely to use most often, but <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code> also
                    implements other methods that supply information about the path or the required format for it.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path.Combine</code>
                                是您最可能经常使用的此类方法，但 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code>
                                还实现了其他提供有关路径或其所需格式信息的方法。</font>
                        </font>
                    </font>
                </p>
                <p id="c18-para-0020" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">With the public fields <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">VolumeSeparatorChar</code>,
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectorySeparatorChar</code>,
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AltDirectorySeparatorChar</code>,
                    and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PathSeparator</code>, you
                    can get the platform-specific character that is used to separate drives, folders, and files, and the
                    separator of multiple paths. With Windows, these characters are <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">:</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">\</code>, and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">/</code>
                    ; with Linux, the special character for volumes and directories is <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">/</code>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">通过公共字段 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">VolumeSeparatorChar</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectorySeparatorChar</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AltDirectorySeparatorChar</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PathSeparator</code>
                                ，你可以获取用于分隔驱动器、文件夹和文件的特定平台字符，以及多路径的分隔符。对于 Windows，这些字符是 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">:</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">\</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">/</code> ；对于
                                Linux，卷和目录的特殊字符是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">/</code> 。
                            </font>
                        </font>
                    </font>
                </p>
                <p id="c18-para-0021" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code> class also
                    helps with accessing the user-specific temp folder (<code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetTempPath</code>) and
                    creating temporary (<code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetTempFileName</code>)
                    and random filenames (<code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetRandomFileName</code>).
                    Make sure that the method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetTempFileName</code>
                    includes the folder, whereas <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetRandomFileName</code>
                    just returns the filename without any folder.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code>
                                类还帮助访问用户特定的临时文件夹（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetTempPath</code>
                                ）以及创建临时（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetTempFileName</code>
                                ）和随机文件名（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetRandomFileName</code>
                                ）。请确保方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetTempFileName</code>
                                包含文件夹，而 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetRandomFileName</code>
                                仅返回文件名，不包含任何文件夹。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Environment</code> class
                    contains the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SpecialFolder</code>
                    enumeration that defines a list of special folders—for example, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Personal</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MyDocuments</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Recent</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MyMusic</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MyVideos</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ApplicationData</code>,
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">LocalApplicationData</code>,
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MyPictures</code>, and
                    more. Instead of using a hard-coded path, the following code iterates through all the enum values
                    and shows the path to one special folder. You should use this API instead to be independent if a
                    system is differently configured. However, be aware that depending on the operating system that is
                    used, several of the special folders are not filled. The following code snippet iterates through all
                    the defined special folders and shows the path (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Environment</code>
                                类包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SpecialFolder</code>
                                枚举，该枚举定义了一组特殊文件夹——例如 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Personal</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MyDocuments</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Recent</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MyMusic</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MyVideos</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ApplicationData</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">LocalApplicationData</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MyPictures</code>
                                等。不要使用硬编码的路径，以下代码遍历所有枚举值并显示一个特殊文件夹的路径。你应该使用这个 API
                                以确保在系统配置不同时保持独立性。然而，请注意，根据所使用的操作系统，某些特殊文件夹可能未填充。以下代码片段遍历所有定义的特殊文件夹并显示路径（代码文件 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0004"><code>void ShowSpecialFolders()</code>
<code>{</code>
<code>  foreach (var specialFolder in Enum.GetNames(typeof(Environment.SpecialFolder)))</code>
<code>  {</code>
<code>    Environment.SpecialFolder folder = </code>
<code>      Enum.Parse&lt;Environment.SpecialFolder&gt;(specialFolder);</code>
<code> </code>
<code>    string path = Environment.GetFolderPath(folder);</code>
<code>    Console.WriteLine($"{specialFolder}: {path}");</code>
<code>  }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">This shows part of the output running the application in the
                    WSL-2 subsystem with Ubuntu:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这显示了在 Ubuntu 的 WSL-2
                                子系统中运行应用程序的部分输出：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0005"><code>MyDocuments: /home/christian</code>
<code>Personal: /home/christian</code>
<code>LocalApplicationData: /home/christian/.local/share</code>
<code>CommonApplicationData: /usr/share</code>
<code>UserProfile: /home/christian</code></pre>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0007"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-330" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Creating Files and Folders <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">创建文件和文件夹</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Now let's look at using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code>, and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                    classes. First, you use the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WriteAllText</code>
                    method of the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> class to
                    create a file and write the string <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Hello, World!</code>.
                    Everything is done with a single API invocation (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在让我们看看如何使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                                类。首先，你使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WriteAllText</code>
                                类的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>
                                方法来创建一个文件并写入字符串 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Hello, World!</code>
                                。所有操作都是通过单个 API 调用完成的（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0006"><span aria-label="489" epub:type="pagebreak" id="Page_489" role="doc-pagebreak"></span>
<code>void CreateFile(string file)</code>
<code>{</code>
<code>  try</code>
<code>  {</code>
<code>    string path = Path.Combine(Environment.GetFolderPath(</code>
<code>      Environment.SpecialFolder.Personal), file);</code>
<code>    <b>File.WriteAllText(path, "Hello, World!");</b></code>
<code>    Console.WriteLine($"created file {path}");</code>
<code>  }</code>
<code>  catch (ArgumentException)</code>
<code>  {</code>
<code>    Console.WriteLine("Invalid characters in the filename?");</code>
<code>  }</code>
<code>  catch (IOException ex)</code>
<code>  {</code>
<code>    Console.WriteLine(ex.Message);</code>
<code>  }</code>
<code>}</code>
<code> </code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">To copy a file, you can use either the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Copy</code> method of the
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> class or
                    the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CopyTo</code>
                    method of the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> class:
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要复制文件，你可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Copy</code>
                                类的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>
                                方法或 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CopyTo</code>
                                类的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CopyTo</code>
                                方法：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0007"><code>FileInfo file = new(fileName1);</code>
<code>file.CopyTo(fileName2);</code>
<code>File.Copy(fileName1, fileName2);</code></pre>
                <p id="c18-para-0026" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">With the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> instance
                    method, you need to write two code lines, whereas when you use the static <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> method, you
                    need just one code line. If you need to perform additional actions on the file, the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> class is
                    faster. If you just need to do this one action on the file, you can reduce the code you need to
                    write with the static method.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                实例方法需要编写两行代码，而使用静态 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>
                                方法只需一行代码。如果你需要在文件上执行额外操作， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                类更快。如果你只需要在文件上执行这个操作，可以用静态方法减少需要编写的代码。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">You can instantiate a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> or <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                    class by passing to the constructor a string containing the path to the corresponding file system
                    object. You have just seen the process for a file. For a folder, the code looks similar:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你可以通过向构造函数传递一个包含相应文件系统对象路径的字符串来实例化
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                或 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                                类。你刚刚看到了文件的过程。对于文件夹，代码看起来类似：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0008"><code>DirectoryInfo myFolder = new(directory);</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">If the path represents an object that does not exist, an
                    exception is not thrown at construction; instead, it's thrown the first time you call a method that
                    actually requires the corresponding file system object to be there. You can find out whether the
                    object exists and is of the appropriate type by checking the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Exists</code> property,
                    which is implemented by both of these classes:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                如果路径表示一个不存在的对象，构造时不会抛出异常；相反，它会在你第一次调用实际需要相应文件系统对象存在的方法时抛出异常。你可以通过检查 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Exists</code>
                                属性来确定对象是否存在且类型正确，这个属性由这两个类实现：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0009"><code>FileInfo test = new(fileName);</code>
<code>Console.WriteLine(test.Exists);</code></pre>
                <p id="c18-para-0029" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Note that for this property to return <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">true</code>, the
                    corresponding file system object must be of the appropriate type. In other words, if you instantiate
                    a <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                    object by supplying the path of a folder or you instantiate a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                    object by giving it the path of a file, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Exists</code> has the
                    value <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">false</code>.
                    Most of the properties and methods of these objects return a value if possible—they won't
                    necessarily throw an exception just because the wrong type of object has been called, unless they
                    are asked to do something that is impossible. For example, the preceding code snippet might first
                    display <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">false</code>
                    (because <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">C:\Windows</code> is a
                    directory), but it still displays the time the folder was created because a directory has that
                    information. However, if you tried to open the directory as if it were a file, using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo.Open</code>
                    method, you'd get an exception.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">请注意，要使此属性返回 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">true</code>
                                ，相应的文件系统对象必须是正确的类型。换句话说，如果你通过提供文件夹的路径来实例化一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                对象，或者通过给它文件路径来实例化一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                                对象， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Exists</code>
                                的值将是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">false</code>
                                。这些对象的大多数属性和方法在可能的情况下会返回一个值——它们不会因为调用了错误类型的对象而一定会抛出异常，除非它们被要求做些不可能的事情。例如，前面的代码片段可能会首先显示
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">false</code>
                                （因为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">C:\Windows</code>
                                是一个目录），但它仍然会显示文件夹的创建时间，因为目录包含这些信息。然而，如果你尝试像文件一样打开目录，使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo.Open</code>
                                方法，你会得到一个异常。</font>
                        </font>
                    </font>
                </p>
                <p id="c18-para-0030" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">You move and delete files or directories using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MoveTo</code> and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Delete</code> methods of
                    the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                    classes. The equivalent methods on the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code> classes
                    are <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Move</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Delete</code>. The
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> classes
                    also implement the methods <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CopyTo</code> and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Copy</code>,
                    respectively. However, no methods exist to copy complete folders—you need to do that by copying each
                    file and folder in the folder's hierarchy.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                                类的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MoveTo</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Delete</code>
                                方法来移动和删除文件或目录。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code>
                                类上的等效方法是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Move</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Delete</code>
                                。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>
                                类也分别实现了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CopyTo</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Copy</code>
                                方法。然而，没有方法可以复制完整的文件夹——你需要通过复制文件夹层次结构中的每个文件和文件夹来完成这个操作。</font>
                        </font>
                    </font>
                </p>
                <p id="c18-para-0031" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Using all of these methods is quite intuitive. You can find
                    detailed descriptions in the Microsoft documentation.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用所有这些方法都非常直观。你可以在 Microsoft
                                文档中找到详细的描述。</font>
                        </font>
                    </font>
                </p>
            </section> <span aria-label="490" epub:type="pagebreak" id="Page_490" role="doc-pagebreak"
                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0008"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-331" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Accessing and Modifying File Properties <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">访问和修改文件属性</font>
                        </font>
                    </font>
                </h3>
                <p id="c18-para-0032" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Let's get some information about files. You can use both the
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> classes
                    to access file information. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> class defines
                    static methods, whereas the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> class
                    offers instance methods. The following code snippet shows how to use <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> to
                    retrieve multiple pieces of information. If you instead used the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> class, the
                    access would be slower because every access would mean a check to determine whether the user is
                    allowed to get this information. With the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> class,
                    the check happens only when calling the constructor.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">让我们获取一些关于文件的信息。你可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                类来访问文件信息。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>
                                类定义了静态方法，而 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                类提供了实例方法。以下代码片段展示了如何使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                来获取多个信息。如果你使用的是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>
                                类，访问速度会更慢，因为每次访问都需要检查用户是否有权获取这些信息。而使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                类时，检查只在调用构造函数时进行。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The sample code creates a new <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> object
                    and writes the result of the properties <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Name</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryName</code>,
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IsReadOnly</code>,
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Extension</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Length</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CreationTime</code>,
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">LastAccessTime</code>,
                    and <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Attributes</code>
                    to the console (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">示例代码创建了一个新的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                对象，并将属性 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Name</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryName</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IsReadOnly</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Extension</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Length</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CreationTime</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">LastAccessTime</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Attributes</code>
                                的结果写入控制台（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0010"><code>void FileInformation(string file)</code>
<code>{</code>
<code>  FileInfo fileInfo = new(file);</code>
<code>  if (!fileInfo.Exists)</code>
<code>  {</code>
<code>    Console.WriteLine("File not found.");</code>
<code>  }</code>
<code>  Console.WriteLine($"Name: {<b>fileInfo.Name</b>}");</code>
<code>  Console.WriteLine($"Directory: {<b>fileInfo.DirectoryName</b>}");</code>
<code>  Console.WriteLine($"Read only: {<b>fileInfo.IsReadOnly</b>}");</code>
<code>  Console.WriteLine($"Extension: {<b>fileInfo.Extension</b>}");</code>
<code>  Console.WriteLine($"Length: {<b>fileInfo.Length</b>}");</code>
<code>  Console.WriteLine($"Creation time: {<b>fileInfo.CreationTime:</b>F}");</code>
<code>  Console.WriteLine($"Access time: {<b>fileInfo.LastAccessTime:</b>F}");</code>
<code>  Console.WriteLine($"File attributes: {<b>fileInfo.Attributes</b>}");</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The following statement passes the filename <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">./Program.cs</code> in
                    command-line arguments:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">以下语句将文件名 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">./Program.cs</code>
                                传递给命令行参数：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0011"><code>&gt; dotnet run -- fileinfo --file ./Program.cs</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">This results in the following output (on my machine):<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这导致以下输出（在我的机器上）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0012"><code>Name: Program.cs</code>
<code>Directory: C:\FilesAndStreams\\FilesAndFolders</code>
<code>Read only: False</code>
<code>Extension: .cs</code>
<code>Length: 6773</code>
<code>Creation time: Friday, April 2, 2021 8:53:38 PM</code>
<code>Access time: Tuesday, April 6, 2021 9:47:07 PM</code>
<code>File attributes: Archive</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">A few of the properties of the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> class
                    cannot be set; they only define get accessors. It's not possible to set the filename, the file
                    extension, and the length of the file. The creation time and last access time can be set. The method
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ChangeFileProperties</code>
                    writes the creation time of a file to the console and later changes the creation time to a date in
                    the year 2035.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                类的某些属性不能被设置；它们只定义了获取访问器。无法设置文件名、文件扩展名和文件长度。创建时间和最后访问时间可以被设置。方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ChangeFileProperties</code>
                                将文件的创建时间写入控制台，然后后来将创建时间更改为 2035 年的一个日期。</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0013"><code>void ChangeFileProperties(string file)</code>
<code>{</code>
<code>  FileInfo = new(file);</code>
<code>  if (!fileInfo.Exists)</code>
<code>  {</code>
<code>    Console.WriteLine($"File {file} does not exist");</code>
<code>    return;</code>
<code>  }</code>
<code> <span aria-label="491" epub:type="pagebreak" id="Page_491" role="doc-pagebreak"></span></code>
<code>  Console.WriteLine($"creation time: {fileInfo.CreationTime:F}");</code>
<code>  fileInfo.CreationTime = new DateTime(2035, 12, 24, 15, 0, 0);</code>
<code>  Console.WriteLine($"creation time: {fileInfo.CreationTime:F}");</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Running the program shows the initial creation time of the
                    file as well as the creation time after it has been changed. Creating files in the future (at least
                    specifying the creation time) is possible with this technique.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                运行程序显示了文件的初始创建时间以及更改后的创建时间。使用这种技术可以创建未来的文件（至少可以指定创建时间）。</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0014"><code>creation time: Sunday, December 20, 2015 9:41:49 AM</code>
<code>creation time: Wednesday, December 24, 2025 3:00:00 PM</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">To see the creation time of files with the command line on
                    Windows, use <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">dir /T:C</code> on
                    Windows.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要在 Windows 的命令行上查看文件的创建时间，使用
                                Windows 上的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">dir /T:C</code>
                                。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <p id="c18-para-0039" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">There are some
                                issues with the creation time on Linux, which are explained in the comment of the method
                            </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SetCreationTime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> in the .NET
                                source code:</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意 Linux 上创建时间存在问题，这已在
                                        .NET 源代码中 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SetCreationTime</code>
                                        方法注释中解释。</font>
                                </font>
                            </font>
                        </p>
                        <p id="c18-para-0040" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1"><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">“Unix provides
                                APIs to update the last access time (</i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">atime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">) and last
                                modification time (</i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">mtime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">). There is no
                                API to update the </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CreationTime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">. Some platforms
                                (for example, Linux) don't store a creation time. On those platforms, the creation time
                                is synthesized as the oldest of last status change time (</i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ctime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">) and last
                                modification time (</i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">mtime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">). We update the
                            </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">LastWriteTime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> (</i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">mtime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">). This triggers
                                a metadata change for </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemWatcher NotifyFilters.CreationTime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">. Updating the
                            </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">mtime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">, causes the
                            </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ctime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> to be set ‘now.'
                                So, on platforms that don't store a </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CreationTime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">, </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetCreationTime</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> returns the
                                value that was previously set (when the value wasn't in the future).”</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">“Unix 提供了更新最后访问时间（ <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">atime</code>
                                        ）和最后修改时间（ <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">mtime</code>
                                        ）的 API。没有更新最后状态改变时间的 API。某些平台（例如 Linux）不存储创建时间。在这些平台上，创建时间被合成为首次状态改变时间（ <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ctime</code>
                                        ）和最后修改时间（ <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">mtime</code>
                                        ）中最旧的时间。我们更新了 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">LastWriteTime</code>
                                        （ <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">mtime</code>
                                        ）。这触发了 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemWatcher NotifyFilters.CreationTime</code>
                                        的元数据变更。更新 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">mtime</code>
                                        会导致 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ctime</code>
                                        被设置为‘现在’。因此，在那些不存储创建时间的平台上， <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetCreationTime</code>
                                        返回先前设置的值（当该值不在未来时）。”</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <hr />
                        </div>
                    </section>
                </aside>
                <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <p id="c18-para-0041" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Being able to
                                manually modify these properties might seem strange at first, but it can be quite
                                useful. For example, if you have a program that effectively modifies a file by simply
                                reading it in, deleting it, and creating a new file with the new contents, you would
                                probably want to modify the creation date to match the original creation date of the old
                                file.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意
                                        手动修改这些属性最初可能看起来有些奇怪，但它非常有用。例如，如果你有一个程序通过简单地读取文件、删除它并创建一个包含新内容的新文件来有效修改文件，你可能希望修改创建日期以匹配旧文件的原创建日期。
                                    </font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0011"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-332" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Using File to Read and Write <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 File 读取和写入 </font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">With <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.ReadAllText</code>
                    and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.WriteAllText</code>,
                    you can read and write a file using a single string. Instead of using one string, you can also use
                    file operations that use a string for every line in a file as shown here. The method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadAllLines</code>
                    returns a string array. <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadLines</code> returns
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IEnumerable&lt;string&gt;</code>,
                    which allows you to iterate through all the lines where you can start looping through the file
                    before the complete file was read (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">通过 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.ReadAllText</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.WriteAllText</code>
                                ，你可以使用单个字符串读取和写入文件。除了使用单个字符串，你还可以使用文件操作，这些操作使用字符串表示文件中的每一行，如下所示。方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadAllLines</code>
                                返回一个字符串数组。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadLines</code>
                                返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IEnumerable&lt;string&gt;</code>
                                ，这允许你迭代所有行，你可以在完整文件读取之前开始循环遍历文件（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0015"><code>void ReadLineByLine(string file)</code>
<code>{</code>
<code>  IEnumerable&lt;string&gt; lines = <b>File.ReadLines(file);</b></code>
<code>  int i = 1;</code>
<code>  foreach (var line in lines)</code>
<code>  {</code>
<code>    Console.WriteLine($"{i++}. {line}");</code>
<code>  }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><span aria-label="492" epub:type="pagebreak" id="Page_492"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>For writing a
                    string collection, you can use the method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.WriteAllLines</code>.
                    This method accepts a filename and an <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IEnumerable&lt;string&gt;</code>
                    type as parameter. To append strings to an existing file, you use <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.AppendAllLines</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">对于写入字符串集合，你可以使用方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.WriteAllLines</code>
                                。此方法接受一个文件名和一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IEnumerable&lt;string&gt;</code>
                                类型作为参数。要将字符串附加到现有文件，你使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.AppendAllLines</code>
                                ：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0016"><code>void WriteAFile()</code>
<code>{</code>
<code>  string fileName = Path.Combine(Environment.GetFolderPath(</code>
<code>    Environment.SpecialFolder.Personal), "movies.txt");</code>
<code>  string[] movies =</code>
<code>  {</code>
<code>    "Snow White And The Seven Dwarfs",</code>
<code>    "Gone With The Wind",</code>
<code>    "Casablanca",</code>
<code>    "The Bridge On The River Kwai",</code>
<code>    "Some Like It Hot"</code>
<code>  };</code>
<code> </code>
<code>  <b>File.WriteAllLines(fileName, movies);</b></code>
<code> </code>
<code>  string[] moreMovies =</code>
<code>  {</code>
<code>    "Psycho",</code>
<code>    "Easy Rider",</code>
<code>    "Pulp Fiction",</code>
<code>    "Star Wars",</code>
<code>    "The Matrix"</code>
<code>  };</code>
<code>  <b>File.AppendAllLines(fileName, moreMovies);</b></code>
<code>}</code></pre>
            </section>
        </section>
        <section aria-labelledby="head-2-167" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <span id="c18-sec-0012" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <h2 id="head-2-167" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">ITERATING FILES<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">迭代文件</font>
                    </font>
                </font>
            </h2>
            <p id="c18-para-0044" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">To work with multiple files, you can use the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code> class. <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code> defines the
                method <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetFiles</code> that
                returns a string array of all files in the directory. The method <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetDirectories</code> returns
                a string array of all directories.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要处理多个文件，你可以使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code>
                            类。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory</code>
                            定义了方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetFiles</code>
                            ，该方法返回目录中所有文件的字符串数组。方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetDirectories</code>
                            返回所有目录的字符串数组。</font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0045" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">All of these methods define overloads that allow passing a search
                pattern and a value of the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SearchOption</code>
                enumeration. <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SearchOption</code> enables
                you to walk through all subdirectories or to stay in the top-level directory by using the value <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AllDirectories</code> or
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">TopDirectoryOnly</code>.
                With this method you can pass simple expressions containing <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">*</code> for any number of
                characters and <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">?</code> for
                single characters.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">所有这些方法都定义了重载，允许传递一个搜索模式和一个 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SearchOption</code>
                            枚举的值。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SearchOption</code>
                            使你能够通过使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AllDirectories</code>
                            或 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">TopDirectoryOnly</code>
                            的值遍历所有子目录或停留在顶级目录。使用这个方法，你可以传递包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">*</code>
                            表示任意数量字符和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">?</code>
                            表示单个字符的简单表达式。</font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0046" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">When you walk through a huge directory (or subdirectories), the
                methods <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetFiles</code> and
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetDirectories</code> need
                to have the complete result before the result is returned. An alternative is to use the methods <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">EnumerateFiles</code> and
                <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">EnumerateDirectories</code>.
                These methods offer the same parameters for the search pattern and options, but they immediately start
                returning a result with <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IEnumerable&lt;string&gt;</code>.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">当你遍历一个巨大的目录（或子目录）时，方法 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetFiles</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetDirectories</code>
                            需要在结果返回之前获取完整结果。另一种选择是使用方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">EnumerateFiles</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">EnumerateDirectories</code>
                            。这些方法为搜索模式和选项提供了相同的参数，但它们会立即使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IEnumerable&lt;string&gt;</code>
                            开始返回结果。</font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0047" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Let’s have a look at another example. Within a directory and all
                its subdirectories, all files that end with Copy are deleted in case another file exists with the same
                name and size. On Windows, you can simulate this easily by selecting all files in a folder by pressing
                Ctrl+A on the keyboard, pressing Ctrl+C on the keyboard for copy, and pressing Ctrl+V on the keyboard
                while the mouse is still in the same folder to paste. The new files have the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Copy</code> postfix applied.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            让我们再来看一个例子。在目录及其所有子目录中，如果存在同名同大小的文件，所有以 Copy 结尾的文件都会被删除。在 Windows 系统中，你可以通过按键盘上的 Ctrl+A
                            选择文件夹中的所有文件，按键盘上的 Ctrl+C 复制，并在鼠标仍位于同一文件夹时按键盘上的 Ctrl+V 粘贴来轻松模拟这一操作。新文件会应用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Copy</code> 后缀。
                        </font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">The method <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeleteDuplicateFiles</code>
                iterates all files in the directory that is passed with the first argument, walking through all
                subdirectories using the option <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SearchOption.AllDirectories</code>.
                Within the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">foreach</code>
                statement, the current file in the iteration is compared to the file in the previous iteration. In cases
                where the filename is <span aria-label="493" epub:type="pagebreak" id="Page_493" role="doc-pagebreak"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>nearly the same and
                only <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">- Copy</code> is
                added, and if the size of the files is the same as well, the copied file is deleted by invoking <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo.Delete</code> (code
                file <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">方法 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeleteDuplicateFiles</code>
                            遍历通过第一个参数传递的目录中的所有文件，使用选项 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SearchOption.AllDirectories</code>
                            遍历所有子目录。在 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">foreach</code>
                            语句中，将迭代中的当前文件与上一次迭代的文件进行比较。如果文件名几乎相同且仅添加了 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">- Copy</code>
                            ，并且文件大小也相同，则通过调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo.Delete</code>
                            删除复制的文件（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FilesAndFolders/Program.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c18-code-0017"><code>void DeleteDuplicateFiles(string directory, bool checkOnly = true)</code>
<code>{</code>
<code>  IEnumerable&lt;string&gt; fileNames = Directory.EnumerateFiles(directory, "*", </code>
<code>    SearchOption.AllDirectories);</code>
<code>  string previousFileName = string.Empty;</code>
<code>  foreach (string fileName in fileNames)</code>
<code>  {</code>
<code>    string previousName = Path.GetFileNameWithoutExtension(previousFileName);</code>
<code>    int ix = previousFileName.LastIndexOf(" - Copy");</code>
<code>    if (!string.IsNullOrEmpty(previousFileName) &amp;&amp;</code>
<code>      previousName.EndsWith(" - Copy") &amp;&amp;</code>
<code>      fileName.StartsWith(previousFileName[..ix]))</code>
<code>    {</code>
<code>      FileInfo copiedFile = new(previousFileName);</code>
<code>      FileInfo originalFile = new(fileName);</code>
<code>      if (copiedFile.Length == originalFile.Length)</code>
<code>      {</code>
<code>        Console.WriteLine($"delete {copiedFile.FullName}");</code>
<code>        if (!checkOnly)</code>
<code>        {</code>
<code>          copiedFile.Delete();</code>
<code>        }</code>
<code>      }</code>
<code>    }</code>
<code>    previousFileName = fileName;</code>
<code>  }</code>
<code>}</code></pre>
        </section>
        <section aria-labelledby="head-2-168" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <span id="c18-sec-0013" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <h2 id="head-2-168" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">WORKING WITH STREAMS<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">处理流</font>
                    </font>
                </font>
            </h2>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Now let's look at some powerful options that are available when
                you work with files: streams. The idea of a stream has been around for a long time. A stream is an
                object used to transfer data. The data can be transferred in one of two directions:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            现在让我们来看看在处理文件时可用的强大选项：流。流的概念已经存在很长时间了。流是一个用于传输数据的对象。数据可以朝两个方向之一传输：</font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c18-list-0005" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <li id="c18-li-0024" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">If the data is being transferred from some outside source
                    into your program, it is called <i
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">reading</i> from the
                    stream.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">如果数据是从某个外部源传输到你的程序，这被称为从流中读取。
                            </font>
                        </font>
                    </font>
                </li>
                <li id="c18-li-0025" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">If the data is being transferred from your program to some
                    outside source, it is called <i
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">writing</i> to the
                    stream.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">如果数据是从你的程序传输到某个外部源，这被称为向流中写入。
                            </font>
                        </font>
                    </font>
                </li>
            </ul>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Often, the outside source will be a file, but that is not always
                the case. Other possibilities include the following:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">通常，外部源会是一个文件，但这并不总是情况。其他可能性包括以下这些：
                        </font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c18-list-0006" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <li id="c18-li-0026" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Reading data from or writing data to the network using some
                    network protocol, where the intention is for this data to be picked up by or sent from another
                    computer<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                使用某种网络协议从网络读取数据或向网络写入数据，目的是让这些数据被另一台计算机获取或发送</font>
                        </font>
                    </font>
                </li>
                <li id="c18-li-0027" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Reading from or writing to pipes, which allow one program to
                    communicate with another on the local system<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                从管道读取数据或向管道写入数据，这些管道允许本地系统上的一个程序与另一个程序通信</font>
                        </font>
                    </font>
                </li>
                <li id="c18-li-0028" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Reading from or writing to an area of memory<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">从内存区域读取数据或向内存区域写入数据</font>
                        </font>
                    </font>
                </li>
            </ul>
            <p id="c18-para-0051" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Some streams allow only writing, other streams allow only
                reading, and yet others allow random access. Random access enables you to position a cursor at any given
                point within a stream—for example, to start reading from the start of the stream to later move to the
                end of the stream and continue with a position in the middle of the stream.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            某些流只允许写入，其他流只允许读取，还有其他流允许随机访问。随机访问使你能够在流中的任何给定位置定位光标——例如，从流的开始处开始读取，然后移动到流的末尾，并继续从流中间的位置继续读取。
                        </font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0052" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1"><span aria-label="494" epub:type="pagebreak" id="Page_494"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>Of these examples,
                Microsoft has supplied a .NET class for writing to or reading from memory: the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO.MemoryStream</code>
                object. The <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Net.Sockets.NetworkStream</code>
                object handles network data. The <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code> class does not
                make any assumptions of the nature of the data source. It can be file streams, memory streams, network
                streams, or any data source you can think of.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在这些示例中，微软提供了一个.NET 类用于向内存写入或从内存读取：
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO.MemoryStream</code>
                            对象。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Net.Sockets.NetworkStream</code>
                            对象处理网络数据。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                            类不对数据源的性质做任何假设。它可以是文件流、内存流、网络流或任何你能想到的数据源。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Some streams can also be chained. For example, the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code> can be
                used to compress data. This stream can in turn write to the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>, <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MemoryStream</code>, or <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NetworkStream</code>. The
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CryptoStream</code> enables
                you to encrypt data. It's also possible to chain the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code> to the
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CryptoStream</code> and
                write in turn to the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">某些流也可以串联使用。例如， <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>
                            可以用于压缩数据。这个流可以反过来写入 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MemoryStream</code>
                            或 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NetworkStream</code>
                            。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CryptoStream</code>
                            使你能够加密数据。也可以将 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>
                            串联到 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CryptoStream</code>
                            ，并反过来写入 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                            。</font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <p id="c18-para-0054" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="c20.xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Chapter 20</a>,
                            “Security,” explains how you can use the </i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CryptoStream</code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 第 20 章“安全”，解释了你可以如何使用 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CryptoStream</code>
                                    。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                </section>
            </aside>
            <p id="c18-para-0055" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">When you use streams, the outside source might even be a variable
                within your code. This might sound paradoxical, but the technique of using streams to transmit data
                between variables can be a useful trick for converting data between data types. The C language used
                something similar—the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">sprintf</code> function—to
                convert between integer data types and strings or to format strings.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            当你使用流时，外部源甚至可能是一个代码中的变量。这可能听起来有些矛盾，但使用流在变量之间传输数据的技术可以是一种在数据类型之间转换数据的实用技巧。C 语言使用类似的东西—— <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">sprintf</code>
                            函数——来在整数数据类型和字符串之间进行转换，或者格式化字符串。</font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0056" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">The advantage of having a separate object for the transfer of
                data, rather than using the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> or <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code> classes
                to do this, is that separating the concept of transferring data from the particular data source makes it
                easier to swap data sources. Stream objects contain a lot of generic code that concerns the movement of
                data between outside sources and variables in your code. By keeping this code separate from any concept
                of a particular data source, you make it easier for this code to be reused in different circumstances.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">将数据传输的职责分离为一个独立对象，而不是使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> 或
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DirectoryInfo</code>
                            类来处理，其优势在于将数据传输的概念与特定的数据源分离，这使得更换数据源更加容易。流对象包含大量与数据在外部源和代码中的变量之间移动相关的通用代码。通过将这段代码与任何特定数据源的概念分离，你使得这段代码更容易在不同的情境下被重用。
                        </font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0057" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Although it's not that easy to directly read from and write to
                streams, you can use readers and writers. This is another separation of concerns. Readers and writers
                can read from and write to streams. For example, the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StringReader</code> and <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StringWriter</code> classes
                are part of the same inheritance tree as two classes that you use later to read and write text files.
                The classes will almost certainly share a substantial amount of code behind the scenes. <a
                    href="#c18-fig-0001" id="R_c18-fig-0001"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Figure 18-1</a> illustrates
                the hierarchy of some stream-related classes in the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO</code> namespace.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            虽然直接从流中读取和写入并不那么容易，但你可以使用读取器和写入器。这也是另一种关注点分离。读取器和写入器可以从流中读取和写入。例如， <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StringReader</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StringWriter</code>
                            类与后面你用来读取和写入文本文件的两个类属于同一个继承树。这些类在底层几乎肯定会共享大量代码。图 18-1 展示了 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO</code>
                            命名空间中一些与流相关的类的层次结构。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">As far as reading and writing files goes, the classes that
                concern us most are the following:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">就文件读取和写入而言，我们最关心的类是以下这些：</font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c18-list-0007" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <li id="c18-li-0029" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>—This
                    class is intended for reading and writing binary data in a file.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                                —这个类用于从文件中读取和写入二进制数据。</font>
                        </font>
                    </font>
                </li>
                <li id="c18-li-0030" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> and
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>—These
                    classes are designed specifically for reading from and writing to streams offering APIs for text
                    formats.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                —这两个类专门设计用于从提供文本格式 API 的流中读取和写入。</font>
                        </font>
                    </font>
                </li>
                <li id="c18-li-0031" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryReader</code> and
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>—These
                    classes are designed for reading from and writing to streams offering APIs for binary data.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryReader</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>
                                —这些类用于从提供二进制数据 API 的流中读取和写入。</font>
                        </font>
                    </font>
                </li>
            </ul>
            <p id="c18-para-0059" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">The difference between using these classes and directly using the
                underlying stream objects is that a basic stream works in bytes. For example, suppose that as part of
                the process of saving some document you want to write the contents of a variable of type <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code> to a binary file.
                Each <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code> occupies 8
                bytes, and if you use an ordinary binary stream, you would have to explicitly write each of those 8
                bytes of memory.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            使用这些类与直接使用底层流对象之间的区别在于，基本流以字节工作。例如，假设在保存某些文档的过程中，您需要将类型为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code>
                            的变量的内容写入二进制文件。每个 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code> 占用 8
                            个字节，如果您使用普通的二进制流，您将不得不显式地写出这 8 个字节的内存。</font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0060" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">In C# code, you would have to perform some bitwise operations to
                extract each of those 8 bytes from the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code> value. Using a
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>
                instance, you can encapsulate the entire operation in an overload of the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter.Write</code>
                method, which takes a <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code> as a parameter
                and places those 8 bytes into the stream (and if the stream is directed to a file, into the file). A
                corresponding <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryReader.Read</code>
                method extracts 8 bytes from the stream and recovers the value of the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在 C# 代码中，您必须执行一些位运算来从 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code> 值中提取这
                            8 个字节。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>
                            实例，您可以将整个操作封装在 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter.Write</code>
                            方法的重载中，该方法接受 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code>
                            作为参数，并将这 8 个字节放入流（如果流指向文件，则放入文件）。相应的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryReader.Read</code>
                            方法从流中提取 8 个字节并恢复 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code> 的值。
                        </font>
                    </font>
                </font>
            </p> <span aria-label="495" epub:type="pagebreak" id="Page_495" role="doc-pagebreak"
                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <figure data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> <img
                    alt="Snapshot of the working concept of streams." class="center" src="images/c18f001.png" />
                <figcaption data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span class="figureLabel"
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a
                                href="#R_c18-fig-0001" id="c18-fig-0001" role="doc-backlink"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><b
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                    data-immersive-translate-paragraph="1">FIGURE 18-1<font
                                        class="notranslate immersive-translate-target-wrapper"
                                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">
                                              </font>
                                        <font
                                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                            data-immersive-translate-translation-element-mark="1">
                                            <font
                                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                                data-immersive-translate-translation-element-mark="1">图 18-1</font>
                                        </font>
                                    </font></b></a></span></p>
                </figcaption>
            </figure>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0015"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-333" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Working with File Streams <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">处理文件流</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Let's get into programming streams reading and writing files.
                    A <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                    instance is used to read data from or write data to a file. To construct a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>, you
                    need four pieces of information:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">让我们开始编程流，用于读取和写入文件。一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                                实例用于从文件读取数据或向文件写入数据。要构造一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                                ，你需要四部分信息：</font>
                        </font>
                    </font>
                </p>
                <ul class="check" id="c18-list-0008"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <li id="c18-li-0032" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">The <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">file</i> you want to
                        access.<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">你想访问的文件。</font>
                            </font>
                        </font>
                    </li>
                    <li id="c18-li-0033" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">The <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">mode</i>, which
                        indicates how you want to open the file. For example, are you intending to create a new file or
                        open an existing file? If you are opening an existing file, should any write operations be
                        interpreted as overwriting the contents of the file or appending to the file?<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    模式，它表示你希望如何打开文件。例如，你是打算创建一个新文件还是打开一个现有文件？如果你正在打开一个现有文件，任何写操作应该被解释为覆盖文件内容还是追加到文件？
                                </font>
                            </font>
                        </font>
                    </li>
                    <li id="c18-li-0034" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">The <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">access</i>, which
                        indicates how you want to access the file. For example, do you want to read from or write to the
                        file or do both?<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    访问方式，它表示你希望如何访问文件。例如，你想从文件中读取、向文件中写入，还是两者都要？</font>
                            </font>
                        </font>
                    </li>
                    <li id="c18-li-0035" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">The <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">share</i> access,
                        which specifies whether you want exclusive access to the file. Alternatively, are you willing to
                        have other streams access the file simultaneously? If so, should other streams have access to
                        read the file, to write to it, or to do both?<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    共享访问，它指定你是否希望对文件有独占访问权。或者，你是否愿意让其他流同时访问该文件？如果是这样，其他流应该有权限读取文件、向文件写入，还是两者都能做？</font>
                            </font>
                        </font>
                    </li>
                </ul>
                <p id="c18-para-0062" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The first piece of information is usually represented by a
                    string that contains the full pathname of the file, and this chapter considers only those
                    constructors that require a string here. Besides those, however, some additional constructors take a
                    native Windows handle to a file instead. The remaining three pieces of information are <span
                        aria-label="496" epub:type="pagebreak" id="Page_496" role="doc-pagebreak"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>represented by
                    three .NET enums called <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileMode</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileAccess</code>, and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileShare</code>. The
                    values of these enumerations are listed in the following table and are self-explanatory:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                第一条信息通常由一个包含文件完整路径名的字符串表示，本章仅考虑那些在此需要字符串的构造函数。然而除此之外，一些额外的构造函数接受一个指向文件的本地 Windows
                                句柄。其余三条信息由三个.NET 枚举类型 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileMode</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileAccess</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileShare</code>
                                表示。这些枚举的值列在下表中，且具有自解释性：</font>
                        </font>
                    </font>
                </p>
                <table border="1" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <thead data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <tr data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <th class="left bgcolor2" scope="col">ENUMERATION</th>
                            <th class="left bgcolor2" scope="col">VALUES</th>
                        </tr>
                    </thead>
                    <tbody data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <tr data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileMode</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Append</code>,
                                <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Create</code>,
                                <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CreateNew</code>,
                                <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Open</code>,
                                <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenOrCreate</code>,
                                or <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Truncate</code>
                                <font class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1"> <code
                                                xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Append</code>
                                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Create</code>
                                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CreateNew</code>
                                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Open</code>
                                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenOrCreate</code>
                                            或 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Truncate</code>
                                        </font>
                                    </font>
                                </font>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileAccess</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>,
                                <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadWrite</code>,
                                or <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code>
                                <font class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1"> <code
                                                xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadWrite</code>
                                            或 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code>
                                        </font>
                                    </font>
                                </font>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileShare</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Delete</code>,
                                <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Inheritable</code>,
                                <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">None</code>,
                                <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>,
                                <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadWrite</code>,
                                or <code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code>
                                <font class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1"> <code
                                                xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Delete</code>
                                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Inheritable</code>
                                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">None</code>
                                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadWrite</code>
                                            或 <code xmlns="http://www.w3.org/1999/xhtml"
                                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code>
                                        </font>
                                    </font>
                                </font>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p id="c18-para-0064" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Note that in the case of <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileMode</code>,
                    exceptions can be thrown if you request a mode that is inconsistent with the existing status of the
                    file. <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Append</code>,
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Open</code>, and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Truncate</code> throw an
                    exception if the file does not already exist, and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CreateNew</code> throws
                    an exception if it does. <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Create</code> and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenOrCreate</code> cope
                    with either scenario, but <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Create</code> deletes any
                    existing file to replace it with a new, initially empty, one. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileAccess</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileShare</code>
                    enumerations are bitwise flags, so values can be combined with the C# bitwise <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OR</code> operator, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">|</code>.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">请注意，在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileMode</code>
                                的情况下，如果你请求的文件模式与文件的现有状态不一致，可能会抛出异常。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Append</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Open</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Truncate</code>
                                在文件不存在时会抛出异常，而 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CreateNew</code>
                                在文件存在时会抛出异常。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Create</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenOrCreate</code>
                                可以处理这两种情况，但 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Create</code>
                                会删除任何现有文件，并用一个新创建的、初始为空的文件替换它。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileAccess</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileShare</code>
                                是位标志，因此可以使用 C# 的位运算符 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OR</code>
                                进行组合，即 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">|</code> 。
                            </font>
                        </font>
                    </font>
                </p>
                <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0016"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                    <h4 id="head-4-53" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">Creating a FileStream<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                            <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">创建 FileStream</font>
                            </font>
                        </font>
                    </h4>
                    <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">There is a large number of constructors for the <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>.
                        The following sample uses one with four parameters (code file <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>):
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1"> <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                                    有大量的构造函数。以下示例使用一个带有四个参数的构造函数（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>
                                    ）：</font>
                            </font>
                        </font>
                    </p>
                    <ul class="check" id="c18-list-0009"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <li id="c18-li-0036" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">The filename<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                </font>
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">文件名</font>
                                </font>
                            </font>
                        </li>
                        <li id="c18-li-0037" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">The <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileMode</code>
                            enumeration with the <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Open</code> value
                            to open an existing file<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileMode</code>
                                        枚举值 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Open</code>
                                        打开现有文件</font>
                                </font>
                            </font>
                        </li>
                        <li id="c18-li-0038" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">The <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileAccess</code>
                            enumeration with the <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> value
                            to read the file<font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileAccess</code>
                                        枚举值 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                        读取文件</font>
                                </font>
                            </font>
                        </li>
                        <li id="c18-li-0039" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1">The <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileShare</code>
                            enumeration with a <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> value
                            to allow other programs to read but not change the file at the same time<font
                                class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">使用 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileShare</code>
                                        枚举值 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                        允许其他程序同时读取但不能修改文件</font>
                                </font>
                            </font>
                        </li>
                    </ul>
                    <pre id="c18-code-0018"><code>void ReadFileUsingFileStream(string fileName)</code>
<code>{</code>
<code>  const int bufferSize = 4096;</code>
<code>  <b>using FileStream stream = new(fileName, FileMode.Open, FileAccess.Read, FileShare    .Read);</b></code>
<code>  ShowStreamInformation(stream);</code>
<code>  //…</code>
<code>}</code></pre>
                    <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">Instead of using the constructor of the <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                        class to create a <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                        object, you can create a <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                        directly using the <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> class
                        with the <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenRead</code>
                        method. The <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenRead</code>
                        method opens a file (similar to <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileMode.Open</code>),
                        returns a stream that can be read (<code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileAccess.Read</code>),
                        and also allows other processes read access (<code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileShare.Read</code>):
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">除了使用 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                                    类的构造函数创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                                    对象外，您还可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>
                                    类和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenRead</code>
                                    方法直接创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                                    。 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenRead</code>
                                    方法打开文件（类似于 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileMode.Open</code>
                                    ），返回可读取的流（ <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileAccess.Read</code>
                                    ），并允许其他进程读取（ <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileShare.Read</code>
                                    ）：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c18-code-0019"><code>using FileStream stream = File.OpenRead(fileName);</code></pre>
                </section>
                <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0017"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                    <h4 id="head-4-54" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">Getting Stream Information<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">获取流信息</font>
                            </font>
                        </font>
                    </h4>
                    <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">The <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code> class
                        defines the properties <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CanRead</code>, <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CanWrite</code>,
                        <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CanSeek</code>, and
                        <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CanTimeout</code>
                        that you can read to get information about what can be done with a stream. For reading and
                        writing streams, the timeout values <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadTimeout</code>
                        and <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WriteTimeout</code>
                        specify timeouts in milliseconds. Setting these values can be important in networking scenarios
                        to make sure the user does not have to wait too long when reading or writing and the stream
                        fails. The <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Position</code>
                        property returns the current position of the cursor in the stream. Every time some data is read
                        from the stream, the position moves to the next byte that will be read. The sample code writes
                        information about the stream to the console (code file <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>):
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1"> <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                    类定义了 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CanRead</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CanWrite</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CanSeek</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CanTimeout</code>
                                    这些属性，你可以读取这些属性来获取有关流可以执行哪些操作的信息。对于读取和写入流，超时值 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadTimeout</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WriteTimeout</code>
                                    指定了以毫秒为单位的超时时间。在网络场景中设置这些值非常重要，以确保在读取或写入时用户不会等待过长时间，并且流不会失败。 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Position</code>
                                    属性返回流中光标当前的位置。每次从流中读取一些数据时，位置都会移动到下一个将被读取的字节。示例代码将流的信息写入控制台（代码文件 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>
                                    ）：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c18-code-0020"><span aria-label="497" epub:type="pagebreak" id="Page_497" role="doc-pagebreak"></span>
<code>void ShowStreamInformation(Stream stream)</code>
<code>{</code>
<code>  Console.WriteLine($"stream can read: {<b>stream.CanRead</b>}, " +</code>
<code>    $"can write: {<b>stream.CanWrite</b>}, can seek: {<b>stream.CanSeek</b>}, " +</code>
<code>    $"can timeout: {<b>stream.CanTimeout</b>}");</code>
<code>  Console.WriteLine($"length: {<b>stream.Length</b>}, position: {<b>stream.Position</b>}");</code>
<code>  if (<b>stream.CanTimeout</b>)</code>
<code>  {</code>
<code>    Console.WriteLine($"read timeout: {<b>stream.ReadTimeout</b>} " +</code>
<code>      $"write timeout: {<b>stream.WriteTimeout</b>} ");</code>
<code>  }</code>
<code>}</code></pre>
                    <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">When you run the program with the file stream that has
                        been opened, you get the following output. The position is currently <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">0</code> as read has
                        not yet happened:<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    当你使用已打开的文件流运行程序时，你会得到以下输出。由于读取尚未发生，位置目前为 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">0</code>
                                    ：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c18-code-0021"><code>stream can read: True, can write: False, can seek: True, can timeout: False</code>
<code>length: 1113, position: 0</code></pre>
                </section>
                <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0018"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                    <h4 id="head-4-55" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">Analyzing Text File Encodings<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">分析文本文件编码</font>
                            </font>
                        </font>
                    </h4>
                    <p id="c18-para-0069" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">With text files, the next step is to read the first bytes
                        of the stream—the preamble. The <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">preamble</i> gives
                        information about how the file is encoded (the text format used). This is also known as <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">byte order mark</i>
                        (BOM).<font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    对于文本文件，下一步是读取流的第一字节——前导字节。前导字节提供了有关文件编码方式（使用的文本格式）的信息。这也被称为字节顺序标记（BOM）。</font>
                            </font>
                        </font>
                    </p>
                    <p id="c18-para-0070" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">You can read a stream by using <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadByte</code>,
                        which reads just a byte from the stream, or the <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> method,
                        which fills a byte array. With the <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetEncoding</code>
                        sample method, an array of 5 bytes is created, and the byte array is filled from the <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> method.
                        The second and third parameters specify the offset within the byte array and the count of the
                        number of bytes that are available to fill. The <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> method
                        returns the number of bytes read; the stream might be smaller than the buffer. In case no more
                        characters are available to read, the <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> method
                        returns <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">0</code>.
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">你可以通过使用 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadByte</code>
                                    来读取流，它从流中读取一个字节，或者使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                    方法，它填充一个字节数组。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetEncoding</code>
                                    示例方法创建一个包含 5 个字节的数组，并通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                    方法从流中填充字节数组。第二个和第三个参数指定字节数组中的偏移量和可填充的字节数量。 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                    方法返回读取的字节数；流可能比缓冲区小。如果没有更多字符可供读取， <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                    方法返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">0</code>
                                    。</font>
                            </font>
                        </font>
                    </p>
                    <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">The sample code analyzes the first characters of the
                        stream to return the detected encoding and positions the stream after the encoding characters
                        (code file <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>):
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">
                                    示例代码分析流的第一个字符以返回检测到的编码，并将流定位到编码字符之后（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>
                                    ）：</font>
                            </font>
                        </font>
                    </p>
                    <pre id="c18-code-0022"><code>Encoding GetEncoding(Stream stream)</code>
<code>{</code>
<code>  if (!stream.CanSeek) throw new ArgumentException(</code>
<code>    "require a stream that can seek");</code>
<code> </code>
<code>  Encoding = Encoding.ASCII;</code>
<code>  <b>byte[] bom = new byte[5];</b></code>
<code>  <b>int nRead = stream.Read(bom, offset: 0, count: 5);</b></code>
<code>  if (bom[0] == 0xff &amp;&amp; bom[1] == 0xfe &amp;&amp; bom[2] == 0 &amp;&amp; bom[3] == 0)</code>
<code>  {</code>
<code>    Console.WriteLine("UTF-32");</code>
<code>    stream.Seek(4, SeekOrigin.Begin);</code>
<code>    return Encoding.UTF32;</code>
<code>  }</code>
<code>  else if (bom[0] == 0xff &amp;&amp; bom[1] == 0xfe)</code>
<code>  {</code>
<code>    Console.WriteLine("UTF-16, little endian");</code>
<code>    stream.Seek(2, SeekOrigin.Begin);</code>
<code>    return Encoding.Unicode;</code>
<code>  }</code>
<code>  else if (bom[0] == 0xfe &amp;&amp; bom[1] == 0xff)</code>
<code>  {</code>
<code>    Console.WriteLine("UTF-16, big endian");</code>
<code>    stream.Seek(2, SeekOrigin.Begin);<span aria-label="498" epub:type="pagebreak" id="Page_498" role="doc-pagebreak"></span></code>
<code>    return Encoding.BigEndianUnicode;</code>
<code>  }</code>
<code>  else if (bom[0] == 0xef &amp;&amp; bom[1] == 0xbb &amp;&amp; bom[2] == 0xbf)</code>
<code>  {</code>
<code>    Console.WriteLine("UTF-8");</code>
<code>    stream.Seek(3, SeekOrigin.Begin);</code>
<code>    return Encoding.UTF8;</code>
<code>  }</code>
<code>  stream.Seek(0, SeekOrigin.Begin);</code>
<code>  return encoding;</code>
<code>}</code></pre>
                    <p id="c18-para-0072" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">The start of a file can begin with the characters <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FF</code> and <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FE</code>. The order
                        of these bytes gives information about how the document is stored. Two-byte Unicode can be
                        stored in little- or big-endian. (Endianness describes the order of bytes in memory.) With <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FF</code> followed by
                        <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FE</code>, it's
                        little-endian, and when <code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FE</code> is followed
                        by <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FF</code>, it's
                        big-endian. This endianness goes back to mainframes by IBM that used big-endian for byte
                        ordering, and PDP11 systems from Digital Equipment that used little-endian. Communicating across
                        the network with computers that have different endianness requires changing the order of bytes
                        on one side. Nowadays, the Intel CPU architecture uses little-endian, and the ARM architecture
                        allows switching between little- and big-endian.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">文件的开始可以以字符 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FF</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FE</code>
                                    开头。这些字节的顺序提供了有关文档存储方式的信息。两字节的 Unicode 可以以小端或大端格式存储。（端序描述了内存中字节的顺序。）当 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FF</code>
                                    后面跟着 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FE</code>
                                    时，表示小端；当 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FE</code>
                                    后面跟着 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FF</code>
                                    时，表示大端。这种端序可以追溯到 IBM 使用大端字节排序的大型主机，以及 Digital Equipment 的 PDP11
                                    系统使用小端字节排序。当与具有不同端序的计算机进行网络通信时，需要在其中一方改变字节的顺序。如今，Intel CPU 架构使用小端，而 ARM
                                    架构允许在小端和大端之间切换。</font>
                            </font>
                        </font>
                    </p>
                    <p id="c18-para-0073" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1">What's the other difference between these encodings? With
                        ASCII, 7 bits are enough for every character. Originally based on the English alphabet, ASCII
                        offers lowercase, uppercase, and control characters. Extended ASCII makes use of the eighth bit
                        to allow switching to language-specific characters. Switching is not easy as it requires paying
                        attention to the code map and also does not provide enough characters for some Asian languages.
                        UTF-16 (Unicode Text Format) solves this by having 16 bits for every character. Because UTF-16
                        is still not enough for historical glyphs, UTF-32 uses 32 bits for every character. Although
                        Windows NT 3.1 switched to UTF-16 for the default text encoding (from a Microsoft extension of
                        ASCII before), nowadays the most-used text format is UTF-8. With the Web, UTF-8 turned out to be
                        the most-used text format since 2007 (this superseded ASCII, which had been the most common
                        character encoding before). UTF-8 uses a variable length for character definitions. One
                        character is defined by using between 1 and 6 bytes. UTF-8 is detected by this character
                        sequence at the beginning of a file: 0xEF, 0xBB, 0xBF.<font
                            class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">这些编码之间的另一个区别是什么？使用 ASCII
                                    时，每个字符只需要 7 位。它最初基于英语字母表，提供小写字母、大写字母和控制字符。扩展 ASCII 利用第 8
                                    位来允许切换到特定语言的字符。切换并不容易，因为它需要关注代码映射，并且对某些亚洲语言来说字符数量也不够。UTF-16（Unicode 文本格式）通过为每个字符使用
                                    16 位解决了这个问题。由于 UTF-16 仍然不足以表示历史字形，UTF-32 为每个字符使用 32 位。尽管 Windows NT 3.1 将默认文本编码切换到
                                    UTF-16（之前是微软对 ASCII 的扩展），但现在最常用的文本格式是 UTF-8。随着互联网的发展，自 2007 年以来 UTF-8
                                    成为了最常用的文本格式（这取代了之前最常见的字符编码 ASCII）。UTF-8 使用可变长度来定义字符。一个字符使用 1 到 6 个字节来定义。UTF-8
                                    可以通过文件开头的这个字符序列来检测：0xEF, 0xBB, 0xBF。</font>
                            </font>
                        </font>
                    </p>
                </section>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0019"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-334" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Reading Streams <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">读取流</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">After opening the file and creating the stream, the file is
                    read using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> method. This
                    is repeated until the method returns <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">0</code>. A string is
                    created using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Encoder</code> created
                    from the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetEncoding</code> method
                    defined earlier. Do not forget to close the stream using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Dispose</code> method. If
                    possible, use the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">using</code>
                    declaration—as is done with the following code sample—to dispose of the stream automatically (code
                    file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在打开文件并创建流之后，使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                方法读取文件。重复此操作，直到该方法返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">0</code>
                                。使用先前定义的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetEncoding</code>
                                方法创建的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Encoder</code>
                                创建一个字符串。不要忘记使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Dispose</code>
                                方法关闭流。如果可能，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">using</code>
                                声明——如下面的代码示例所示——自动释放流（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0023"><code>void ReadUsingFileStream(string fileName)</code>
<code>{</code>
<code>  const int BUFFERSIZE = 4096;</code>
<code>  using FileStream stream = new(fileName, FileMode.Open, FileAccess.Read, FileShare.Read);</code>
<code> </code>
<code>  ShowStreamInformation(stream);</code>
<code>  Encoding encoding = GetEncoding(stream);</code>
<code> </code>
<code>  var buffer = new byte[BUFFERSIZE].AsSpan();</code>
<code> </code>
<code>  bool completed = false;</code>
<code>  do</code>
<code>  {</code>
<code>    int nread = stream.Read(buffer);</code>
<code>    if (nread == 0) completed = true;<span aria-label="499" epub:type="pagebreak" id="Page_499" role="doc-pagebreak"></span></code>
<code>    if (nread &lt; buffer.Length)</code>
<code>    {</code>
<code>      buffer[nread..].Clear();</code>
<code>    }</code>
<code> </code>
<code>    string s = encoding.GetString(buffer[..nread]);</code>
<code>    Console.WriteLine($"read {nread} bytes");</code>
<code>    Console.WriteLine(s);</code>
<code>  } while (!completed);</code>
<code>}</code></pre>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0020"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-335" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Writing Streams <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">写入流</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">How streams can be written is demonstrated by writing a
                    simple string to a text file. To create a stream that can be written to, the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenWrite</code>
                    method can be used. This time, a temporary filename is created with the help of members of the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code> class. <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetTempPath</code>
                    returns the path of the user's <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">temp</code> folder, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetRandomFileName</code>
                    returns a random filename, and finally the random filename extension is changed using <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ChangeExtension</code>
                    (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                如何写入流通过向文本文件写入一个简单字符串来演示。要创建一个可写入的流，可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenWrite</code>
                                方法。这次，借助 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Path</code>
                                类的成员创建一个临时文件名。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetTempPath</code>
                                返回用户的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">temp</code>
                                文件夹的路径， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetRandomFileName</code>
                                返回一个随机文件名，最后使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ChangeExtension</code>
                                （代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>
                                ）更改随机文件名的扩展名：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0024"><code>void WriteTextFile()</code>
<code>{</code>
<code>  string tempFileName = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName());</code>
<code>  string tempTextFileName = <b>Path.ChangeExtension(tempFileName,</b> "txt");</code>
<code>  using FileStream stream = <b>File.OpenWrite</b>(tempTextFileName);</code>
<code>  //…</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">When you're writing a UTF-8 file, the preamble needs to be
                    written to the file. This can be done by sending the 3 bytes of the UTF-8 preamble to the stream
                    with the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WriteByte</code> method:
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当你正在写入 UTF-8 文件时，需要将前缀写入文件。这可以通过使用
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WriteByte</code>
                                方法将 UTF-8 前缀的 3 个字节发送到流中完成：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0025"><code>stream.<b>WriteByte</b>(0xef);</code>
<code>stream.WriteByte(0xbb);</code>
<code>stream.WriteByte(0xbf);</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">There's an alternative for doing this. You don't need to
                    remember the bytes to specify the encoding. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Encoding</code> class
                    already has this information. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetPreamble</code> method
                    returns a byte array with the preamble for the file. This byte array is written using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code> method of
                    the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                    class:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">有另一种方法可以做到这一点。你不需要记住字节来指定编码。 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Encoding</code>
                                类已经包含这些信息。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetPreamble</code>
                                方法返回一个包含文件前缀的字节数组。这个字节数组使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                类的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code>
                                方法写入：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0026"><code>var preamble = Encoding.UTF8.GetPreamble().AsSpan();</code>
<code>stream.Write(preamble);</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Now the content of the file can be written. As the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code> method
                    requires byte arrays to write, strings need to be converted. For converting a string to a byte array
                    with UTF-8, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Encoding.UTF8.GetBytes</code>
                    does the job before the byte array is written:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在可以写入文件的内容。由于 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code>
                                方法需要字节数组来写入，字符串需要被转换。为了将字符串转换为 UTF-8 的字节数组，在字节数组写入之前 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Encoding.UTF8.GetBytes</code>
                                会处理这个转换：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0027"><code>string hello = "Hello, World!";</code>
<code>var buffer = Encoding.UTF8.GetBytes(hello).AsSpan();</code>
<code>stream.Write(buffer);</code>
<code>Console.WriteLine($"file {stream.Name} written");</code></pre>
                <p id="c18-para-0079" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">You can open the temporary file using an editor, and it will
                    use the correct encoding.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">你可以使用编辑器打开临时文件，它会使用正确的编码。</font>
                        </font>
                    </font>
                </p>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0021"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-336" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Copying Streams <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">复制流</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Now let's combine reading and writing from streams by copying
                    the file content. With the next code snippet, the readable stream is opened with <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenRead</code>, and
                    the writeable stream is opened with <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenWrite</code>. A
                    buffer is read using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream.Read</code> method
                    and written with <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream.Write</code>. The
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code> methods
                    have <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code> overloads
                    that can use the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Span&lt;byte&gt;</code>,
                    which allows creating slices to reference the same memory <span aria-label="500"
                        epub:type="pagebreak" id="Page_500" role="doc-pagebreak"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>underneath; thus,
                    it is not necessary (contrary to the byte array overload) to pass the start position and size with
                    the arguments for <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code> (code file
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                现在让我们通过复制文件内容来结合从流中读取和写入。在下一个代码片段中，可读流通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenRead</code>
                                打开，可写流通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenWrite</code>
                                打开。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream.Read</code>
                                方法读取缓冲区，并使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream.Write</code>
                                方法写入。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                方法有 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code>
                                重载，可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Span&lt;byte&gt;</code>
                                ，这允许创建切片来引用底层的相同内存；因此，与字节数组重载不同，对于 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code>
                                不需要通过参数传递起始位置和大小（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0028"><code>void CopyUsingStreams(string inputFile, string outputFile)</code>
<code>{</code>
<code>  const int BUFFERSIZE = 4096;</code>
<code>  <b>using var inputStream = File.OpenRead(inputFile);</b></code>
<code>  <b>using var outputStream = File.OpenWrite(outputFile);</b></code>
<code>  var buffer = new byte[BUFFERSIZE].AsSpan();</code>
<code>  bool completed = false;</code>
<code>  do</code>
<code>  {</code>
<code>    <b>int nRead = inputStream.Read(buffer);</b></code>
<code>    if (nRead == 0) completed = true;</code>
<code>    <b>outputStream.Write(buffer[..nRead]);</b></code>
<code>  } while (!completed);</code>
<code>}</code></pre>
                <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <p id="c18-para-0082" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">The Span type is
                                shown in detail in <a href="c13.xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Chapter
                                    13</a>, “Managed and Unmanaged Memory.”</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意 Span 类型在第 13
                                        章“托管和非托管内存”中有详细说明。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">To copy a stream, it's not necessary to write the code to
                    read and write a stream. Instead, you can use the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CopyTo</code> method of
                    the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                    class, as shown here (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要复制流，无需编写读取和写入流的代码。相反，你可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                类的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CopyTo</code>
                                方法，如下所示（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0029"><code>void CopyUsingStreams2(string inputFile, string outputFile)</code>
<code>{</code>
<code>  using var inputStream = File.OpenRead(inputFile);</code>
<code>  using var outputStream = File.OpenWrite(outputFile);</code>
<code>  <b>inputStream.CopyTo(outputStream);</b></code>
<code>}</code></pre>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0023"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-337" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Using Random Access to Streams <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用流的随机访问</font>
                        </font>
                    </font>
                </h3>
                <p id="c18-para-0084" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Random access to streams provides an advantage in that—even
                    with large files—you can access a specific position within the file in a fast way.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                流的随机访问的优势在于，即使对于大文件，你也可以以快速的方式访问文件中的特定位置。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">To see random access in action, the following code snippet
                    creates a large file. This code snippet creates the file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">sampledata.data</code>
                    with records that are all the same length and contain a number, a 20-character string, and a random
                    date. The number of records that is passed to the method is created with the help of the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Enumerable.Range</code>
                    method (defined with the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Linq</code>
                    namespace). The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Select</code> method
                    creates a tuple that contains <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Number</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Text</code>, and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Date</code> fields. Out
                    of these records, a string with <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">#</code> pre- and postfix
                    is created, with a fixed length for every value and a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">;</code> separator
                    between each value. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WriteAsync</code> method
                    writes the record to the stream. The File and Stream APIs offer asynchronous APIs beside the
                    synchronous ones. This sample makes use of the asynchronous APIs that allow the calling (code file
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                要展示随机访问的用法，以下代码片段创建了一个大文件。这个代码片段创建的文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">sampledata.data</code>
                                包含长度相同的记录，每条记录包含一个数字、一个 20 字符的字符串和一个随机日期。传递给方法的记录数量是通过 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Enumerable.Range</code>
                                方法（在 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Linq</code>
                                命名空间中定义）创建的。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Select</code>
                                方法创建一个包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Number</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Text</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Date</code>
                                字段的元组。在这些记录中，创建一个带有 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">#</code>
                                前缀和后缀的字符串，每个值都有固定长度，并且每个值之间用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">;</code>
                                分隔符分隔。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WriteAsync</code>
                                方法将记录写入流。文件和流 API 除了同步 API 外，还提供了异步 API。这个示例使用了异步 API，允许调用（代码文件 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0030"><code>string SampleDataFilePath = Path.Combine(Environment.GetFolderPath(</code>
<code>  Environment.SpecialFolder.ApplicationData), "samplefile.data");</code>
<code> </code>
<code>public static async Task CreateSampleFileAsync(int count)</code>
<code>{</code>
<code>  FileStream stream = File.Create(SampleDataFilePath);</code>
<code>  using StreamWriter writer = new(stream);<span aria-label="501" epub:type="pagebreak" id="Page_501" role="doc-pagebreak"></span></code>
<code>  Random r = new();</code>
<code>  var records = Enumerable.Range(1, count).Select(x =&gt; </code>
<code>  (</code>
<code>    Number: x,</code>
<code>    Text: $"Sample text {r.Next(200)}",</code>
<code>    Date: new DateTime(Math.Abs((long)((r.NextDouble() * 2 - 1) *</code>
<code>      DateTime.MaxValue.Ticks)))</code>
<code>  ));</code>
<code>  Console.WriteLine("Start writing records…");</code>
<code>  foreach (var rec in records)</code>
<code>  {</code>
<code>    string date = rec.Date.ToString("d", CultureInfo.InvariantCulture);</code>
<code>    string s =</code>
<code>      $"#{rec.Number,8};{rec.Text,-20};{date}#{Environment.NewLine}";</code>
<code>    <b>await writer.WriteAsync(s);</b></code>
<code>  }</code>
<code>  Console.WriteLine($"Created the file {SampleDataFilePath}");</code>
<code>}</code></pre>
                <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <p id="c18-para-0087" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">The File and
                                Stream APIs not only offer synchronous APIs but also APIs implementing the task-based
                                async pattern (which is explained in <a href="c11.xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Chapter
                                    11</a>, “Tasks and Asynchronous Programming”). This allows the calling thread to
                                work on some other functionality instead of waiting for the I/O.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意 文件和流 API 不仅提供同步
                                        API，还提供实现基于任务的异步模式（该模式在第 11 章“任务和异步编程”中解释）的 API。这使得调用线程可以在等待 I/O 的同时处理其他功能。
                                    </font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <hr />
                        </div>
                    </section>
                </aside>
                <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <p id="c18-para-0088" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a
                                    href="c13.xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Chapter
                                    13</a> explains that every object implementing </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IDisposable</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> should be
                                disposed of. In the previous code snippet, it looks like </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> is not disposed
                                of. However, that's not the case. The </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> takes control
                                over the used resource and disposes of the stream when the </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> is disposed of.
                                To keep the stream opened for a longer period than the </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> is alive, you
                                can configure this with the constructor of the </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">. In that case,
                                you need to dispose of the stream explicitly.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意：第 13 章解释了所有实现 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IDisposable</code>
                                        的对象都应该被释放。在之前的代码片段中，看起来 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                                        没有被释放。但实际上并非如此。 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                        控制着使用的资源，并在 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                        被释放时释放流。若要使流保持开启的时间比 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                        存活的时间更长，可以通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                        的构造函数进行配置。在这种情况下，你需要显式地释放流。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Now, let's position a cursor randomly within the stream to
                    read different records. The user is asked to enter a record number that should be accessed. The byte
                    in the stream that should be accessed is based on the record number and the record size. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Seek</code> method of the
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code> class now
                    enables you to position the cursor within the stream. The second argument specifies whether the
                    position is based on the beginning of the stream, the end of the stream, or the current position
                    (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                现在，让我们在流中随机定位一个光标以读取不同的记录。用户被要求输入一个要访问的记录号。要访问的流中的字节是基于记录号和记录大小的。 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Seek</code>
                                类的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                方法现在使你能够在流中定位光标。第二个参数指定位置是基于流的开始、流的结束还是当前位置（代码文件 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamSamples/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0031"><code>async Task RandomAccessSampleAsync()</code>
<code>{</code>
<code>  const int RECORDSIZE = 44;</code>
<code>  try</code>
<code>  {</code>
<code>    using <b>FileStream stream = File.OpenRead(SampleDataFilePath)</b>;</code>
<code>    var buffer = new byte[RECORDSIZE].AsMemory();</code>
<code> </code>
<code>    do</code>
<code>    {</code>
<code>      try<span aria-label="502" epub:type="pagebreak" id="Page_502" role="doc-pagebreak"></span></code>
<code>      {</code>
<code>        Console.Write("record number (or 'bye' to end): ");</code>
<code>        string line = Console.ReadLine() ?? throw new InvalidOperationException();</code>
<code>        if (string.Equals(line, "bye", StringComparison.CurrentCultureIgnoreCase)) break;</code>
<code> </code>
<code>        if (int.TryParse(line, out int record))</code>
<code>        {</code>
<code>          <b>stream.Seek((record - 1) * RECORDSIZE, SeekOrigin.Begin);</b></code>
<code>          <b>int read = await stream.ReadAsync(buffer);</b></code>
<code>          string s = Encoding.UTF8.GetString(buffer.Span[0..read});</code>
<code>          Console.WriteLine($"record: {s}");</code>
<code>        }</code>
<code>      }</code>
<code>      catch (Exception ex)</code>
<code>      {</code>
<code>        Console.WriteLine(ex.Message);</code>
<code>      }</code>
<code>    } while (true);</code>
<code>    Console.WriteLine("finished");</code>
<code>  }</code>
<code>  catch (FileNotFoundException)</code>
<code>  {</code>
<code>    Console.WriteLine("Create the sample file using the option -sample first");</code>
<code>  }</code>
<code>}</code></pre>
                <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <p id="c18-para-0091" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Contrary to the
                                synchronous </i> <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> method of the
                            </i> <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code> <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> class where a
                            </i> <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Span&lt;byte&gt;</code>
                            <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> parameter is
                                offered with an overload, the </i> <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadAsync</code>
                            <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> method gives a
                            </i> <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Memory&lt;byte&gt;</code>
                            <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> overload. </i>
                            <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Span&lt;T&gt;</code>
                            <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> is a ref struct
                                type and thus can only be stored on the stack. This is unsuitable for asynchronous
                                methods, which is why the </i> <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Memory&lt;byte&gt;</code>
                            <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> type is offered
                                with the asynchronous overloads.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意：与 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                        类的同步 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                        方法不同，该方法提供了一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Span&lt;byte&gt;</code>
                                        参数的重载， <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadAsync</code>
                                        方法提供了一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Memory&lt;byte&gt;</code>
                                        重载。 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Span&lt;T&gt;</code>
                                        是一个引用结构类型，因此只能存储在栈上。这对于异步方法不适用，这就是为什么异步重载提供了 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Memory&lt;byte&gt;</code>
                                        类型。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">You can now try to create a file with 1.5 million records or
                    more. A file this size is slow when you open it using Notepad, but it is extremely fast when you use
                    random access. Depending on your system, the CPU, and the disk type, you might use higher or lower
                    values for the tests.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在你可以尝试创建一个包含 150
                                万条记录或更多的文件。使用记事本打开这种大小的文件会很慢，但使用随机访问时却非常快。根据你的系统、CPU 和磁盘类型，你可能需要为测试使用更高的或更低的值。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <p id="c18-para-0093" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">If the records
                                that should be accessed don’t have a fixed size, it still can be useful to use random
                                access for large files. One way to deal with this is to write the position of the
                                records to the beginning of the file. Another option is to read a larger block where the
                                record could be and find the record identifier and the record delimiters within the
                                memory block.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意
                                        如果应该访问的记录没有固定大小，对于大文件仍然可以使用随机访问。一种处理方法是将记录的位置写入文件开头。另一种选择是读取一个可能包含记录的较大数据块，并在内存块中找到记录标识符和记录分隔符。
                                    </font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <hr />
                        </div>
                    </section>
                </aside>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0028"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-338" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Using Buffered Streams <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用缓冲流</font>
                        </font>
                    </font>
                </h3>
                <p id="c18-para-0094" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">For performance reasons, when you read from or write to a
                    file, the output is buffered. This means that if your program asks for the next bytes of a file
                    stream and the stream passes the request on to the operating system (OS), then the OS will not
                    connect to the file system and then locate and read the file off the disk just to get the additional
                    bytes. Instead, the OS retrieves a large block of the file at one time and stores this block in an
                    area of <span aria-label="503" epub:type="pagebreak" id="Page_503" role="doc-pagebreak"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>memory known as a
                    <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">buffer</i>. Subsequent
                    requests for data from the stream are satisfied from the buffer until the buffer runs out, at which
                    point the OS grabs another block of data from the file.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                出于性能考虑，当你从文件中读取或向文件写入时，输出会被缓冲。这意味着如果你的程序请求文件流的下一个字节，而流将请求传递给操作系统（OS），那么操作系统不会连接到文件系统，然后定位并从磁盘读取文件来获取这些额外的字节。相反，操作系统一次性检索文件的一个大块数据，并将这个数据块存储在称为缓冲区的内存区域中。后续对流的请求数据会从缓冲区中满足，直到缓冲区用完，此时操作系统会从文件中获取另一个数据块。
                            </font>
                        </font>
                    </font>
                </p>
                <p id="c18-para-0095" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Writing to files works in the same way. For files, this is
                    done automatically by the OS, but you might have to write a stream class to read from some other
                    device that is not buffered. If so, you can create a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BufferedStream</code>,
                    which implements a buffer itself, and pass the stream that should be buffered to the constructor.
                    Note, however, that <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BufferedStream</code> is
                    not designed for the situation in which an application frequently alternates between reading and
                    writing data.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                向文件写入的方式与此相同。对于文件，这是由操作系统自动完成的，但如果你需要从未缓冲的其他设备读取数据，可能需要编写一个流类。如果是这种情况，你可以创建一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BufferedStream</code>
                                ，它自身实现了一个缓冲区，并将应该被缓冲的流传递给构造函数。请注意，然而 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BufferedStream</code>
                                并非设计用于应用程序频繁在读写数据之间切换的情况。</font>
                        </font>
                    </font>
                </p>
            </section>
        </section>
        <section aria-labelledby="head-2-169" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <span id="c18-sec-0029" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <h2 id="head-2-169" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">USING READERS AND WRITERS<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用读取器和写入器</font>
                    </font>
                </font>
            </h2>
            <p id="c18-para-0096" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Reading and writing text files using the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code> class
                requires working with byte buffers and dealing with the encoding as described in the previous section.
                There's an easier way to do this: using readers and writers. You can use the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> and <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code> classes
                to read and write to the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>, and you
                have an easier job not dealing with byte arrays and encodings.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                            类读写文本文件需要处理字节缓冲区并处理编码，如前一节所述。有更简单的方法：使用读取器和写入器。你可以使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                            类来读写 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                            ，这样你就不用处理字节数组和编码，工作会更简单。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">That's because these classes work at a slightly higher level and
                are specifically geared to reading and writing text. The methods that they implement can automatically
                detect convenient points to stop reading text, based on the contents of the stream. In particular:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            这是因为这些类在稍高的层次上工作，并且专门用于读取和写入文本。它们实现的那些方法可以根据流的内存认识到方便的停止读取文本的时机。具体来说：</font>
                    </font>
                </font>
            </p>
            <ul class="check" id="c18-list-0010" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <li id="c18-li-0040" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">These classes implement methods to read or write one line of
                    text at a time: <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader.ReadLine</code>
                    and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter.WriteLine</code>.
                    In the case of reading, this means that the stream automatically determines where the next carriage
                    return is and stops reading at that point. In the case of writing, it means that the stream
                    automatically appends the carriage return–line feed combination to the text that it writes out. The
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NewLine</code> property
                    of the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">TextWriter</code> base
                    class allows to customize the newline character.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这些类实现了逐行读取或写入文本的方法： <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader.ReadLine</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter.WriteLine</code>
                                。在读取的情况下，这意味着流会自动确定下一个回车符的位置，并在该位置停止读取。在写入的情况下，这意味着流会自动将回车换行组合添加到它写入的文本中。 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">TextWriter</code>
                                基类的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NewLine</code>
                                属性允许自定义换行符。</font>
                        </font>
                    </font>
                </li>
                <li id="c18-li-0041" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">By using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                    classes, you don't need to worry about the encoding used in the file.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                类时，你无需担心文件中使用的编码。</font>
                        </font>
                    </font>
                </li>
            </ul>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0030"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-339" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The StreamReader Class<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">StreamReader 类</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Let's convert the previous example to use the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> to
                    read a file. It looks a lot easier now. The constructor of the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                    receives the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>. You
                    can check for the end of the file by using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">EndOfStream</code>
                    property, and you read lines using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadLine</code> method
                    (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReaderWriterSamples/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">让我们将前面的示例转换为使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                来读取文件。现在看起来简单多了。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                的构造函数接收 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                                。你可以通过使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">EndOfStream</code>
                                属性来检查文件末尾，并使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadLine</code>
                                方法逐行读取（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReaderWriterSamples/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0032"><code>void ReadFileUsingReader(string fileName)</code>
<code>{</code>
<code>  FileStream stream = new(fileName, FileMode.Open, FileAccess.Read, FileShare.Read);</code>
<code>  using <b>StreamReader reader = new(stream)</b>;</code>
<code> </code>
<code>  while (<b>!reader.EndOfStream</b>)</code>
<code>  {</code>
<code>    string? line = <b>reader.ReadLine()</b>;</code>
<code>    Console.WriteLine(line);</code>
<code>  }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">It's no longer necessary to deal with byte arrays and the
                    encoding. However, be aware that the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> by
                    default uses the UTF-8 encoding. You can let the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> use
                    the encoding as it is defined by the preamble in the file by specifying a different constructor:
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">不再需要处理字节数组和编码。但请注意，默认情况下， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                使用 UTF-8 编码。您可以通过指定不同的构造函数来让 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                使用文件前缀中定义的编码：</font>
                        </font>
                    </font>
                </p>
                <pre
                    id="c18-code-0033"><code>StreamReader reader = new(stream, detectEncodingFromByteOrderMarks: true);</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">You can also explicitly specify the encoding:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">您也可以显式指定编码：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0034"><code>StreamReader reader = new(stream, Encoding.Unicode);</code></pre>
                <p id="c18-para-0101" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><span aria-label="504" epub:type="pagebreak" id="Page_504"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>Other constructors
                    enable you to set the buffer size to be used; the default is 1,024 bytes. Also, you can specify that
                    the underlying stream should not be closed on closing the reader. By default, when the reader is
                    closed (using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Dispose</code> or <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Close</code> method), the
                    underlying stream is closed as well.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">其他构造函数允许您设置使用的缓冲区大小；默认为 1,024
                                字节。此外，您可以指定底层流在关闭读取器时不应该关闭。默认情况下，当使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Dispose</code>
                                或 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Close</code>
                                方法关闭读取器时，底层流也会被关闭。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Instead of explicitly instantiating a new <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>, you
                    can create a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> by
                    using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenText</code> method of
                    the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code> class
                    (or by using the constructor of the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">您可以选择不显式实例化新的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                ，而是通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File</code>
                                类的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenText</code>
                                方法（或使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                的构造函数）来创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                。</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0035"><code>var reader = File.OpenText(fileName);</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">With the code snippet to read the file, the file was read
                    line by line using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadLine</code> method.
                    The <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                    also allows reading the complete file from the position of the cursor in the stream using <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadToEnd</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用读取文件的代码片段，文件是逐行使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadLine</code>
                                方法读取的。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                也允许使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadToEnd</code>
                                从流中的光标位置读取整个文件：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0036"><code>string content = reader.ReadToEnd();</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> also
                    allows the content to read to a char array. This is similar to the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> method of the
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code> class; it
                    doesn't read to a byte array but instead to a char array. Remember, the char type uses two bytes.
                    This is perfect for 16-bit Unicode, but is not as useful with UTF-8, where a single character can be
                    between one and six bytes long:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                也允许将内容读取到字符数组中。这类似于 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                类中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                方法；它不是读取到字节数组，而是读取到字符数组。记住，字符类型使用两个字节。这对于 16 位 Unicode 来说很完美，但在 UTF-8
                                中不太有用，因为单个字符可以是一个到六个字节长：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0037"><code>int nChars = 100;</code>
<code>char[] charArray = new char[nChars];</code>
<code>int nCharsRead = reader.Read(charArray, 0, nChars);</code></pre>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0031"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-340" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The StreamWriter Class<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">StreamWriter 类</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code> works
                    in the same way as the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>,
                    except that you use <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code> only
                    to write to a file (or to another stream). The following code snippet shows creating a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code> that
                    passes a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>. Then a
                    passed string array is written to the stream (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReaderWriterSamples/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                的作用与 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                相同，只是你只能使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                来写入文件（或写入其他流）。以下代码片段展示了创建一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                并传递一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                                的过程。然后，传递的字符串数组被写入流（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReaderWriterSamples/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0038"><code>void WriteFileUsingWriter(string fileName, string[] lines)</code>
<code>{</code>
<code>  var outputStream = File.OpenWrite(fileName);</code>
<code>  using <b>StreamWriter writer = new(outputStream, Encoding.UTF8)</b>;</code>
<code>  foreach (var line in lines)</code>
<code>  {</code>
<code>    writer.WriteLine(line);</code>
<code>  }</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code> is
                    using the UTF-8 format by default to write the text content. But be aware that the preamble is
                    written only if you pass the encoding to the constructor. Similarly to the constructor of the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>, the
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                    allows specifying the buffer size and whether the underlying stream should not be closed on closing
                    of the writer.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                默认使用 UTF-8 格式来写入文本内容。但请注意，只有当你将编码传递给构造函数时，才会写入前缀。与 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                的构造函数类似， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                允许指定缓冲区大小，以及是否在关闭写入器时关闭底层流。</font>
                        </font>
                    </font>
                </p>
                <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <p id="c18-para-0107" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">When opening
                                existing files with </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenWrite</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> or passing a
                                filename to the constructor of the </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">, you need to be
                                aware of different behaviors: </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenWrite</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> sets the current
                                position of the stream to the start of the file, whereas using the </i><code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code><i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> constructor sets
                                the current position to the end of the file.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意 当使用 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenWrite</code>
                                        打开现有文件或向 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                        的构造函数传递文件名时，你需要注意不同的行为： <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenWrite</code>
                                        将流的当前位置设置为文件开头，而使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                        构造函数将当前位置设置为文件末尾。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p id="c18-para-0108" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code> method of
                    the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                    defines 19 overloads that allow passing strings and several .NET data types. When using the methods
                    passing the .NET data types, remember that all these are changed to strings with the specified
                    encoding. To write the data types in binary format, you can use the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>
                    that's shown next.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code>
                                的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                方法定义了 19 个重载，允许传递字符串和多个 .NET 数据类型。在使用传递 .NET
                                数据类型的方法时，请记住所有这些都会根据指定的编码转换为字符串。要以二进制格式写入数据类型，可以使用接下来显示的 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>
                                。</font>
                        </font>
                    </font>
                </p>
            </section> <span aria-label="505" epub:type="pagebreak" id="Page_505" role="doc-pagebreak"
                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0033"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-341" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Reading and Writing Binary Files <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">读取和写入二进制文件</font>
                        </font>
                    </font>
                </h3>
                <p id="c18-para-0109" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">To read and write binary files, one option is to directly use
                    the stream types; in this case, it's good to use byte arrays for reading and writing. Another option
                    is to use readers and writers defined for this scenario: <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryReader</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>.
                    You use them similarly to the way you use <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                    except <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryReader</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>
                    don't use any encoding. Files are written in binary format rather than text format.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                要读取和写入二进制文件，一种选择是直接使用流类型；在这种情况下，最好使用字节数组进行读取和写入。另一种选择是使用为此场景定义的读取器和写入器： <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryReader</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>
                                。它们的使用方式与使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                类似，只是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryReader</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>
                                不使用任何编码。文件以二进制格式而不是文本格式写入。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Unlike the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code> type, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>
                    defines 20 overloads for the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code> method. The
                    overloads accept different types, as shown in the following code snippet that writes a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">double</code>, an <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">int</code>, a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code>, and a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">string</code> (code file
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReaderWriterSamples/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">与 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                类型不同， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryWriter</code>
                                为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code>
                                方法定义了 20 个重载。这些重载接受不同类型，如下面的代码片段所示，它写入了一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">double</code>
                                、一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">int</code>
                                、一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">long</code>
                                和一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">string</code>
                                （代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReaderWriterSamples/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0039"><code>public static void WriteFileUsingBinaryWriter(string binFile)</code>
<code>{</code>
<code>  var outputStream = File.Create(binFile);</code>
<code>  using <b>var writer = new BinaryWriter(outputStream)</b>;</code>
<code>  double d = 47.47;</code>
<code>  int i = 42;</code>
<code>  long l = 987654321;</code>
<code>  string s = "sample";</code>
<code>  <b>writer.Write(d);</b></code>
<code>  <b>writer.Write(i);</b></code>
<code>  <b>writer.Write(l);</b></code>
<code>  <b>writer.Write(s);</b></code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">To read the file again, you can use a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryReader</code>. This
                    class defines methods to read all the different types, such as <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadDouble</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadInt32</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadInt64</code>, and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadString</code>,
                    which are shown here:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要再次读取文件，你可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryReader</code>
                                。这个类定义了读取不同类型的方法，例如 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadDouble</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadInt32</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadInt64</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadString</code>
                                ，这里显示了它们：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0040"><code>public static void ReadFileUsingBinaryReader(string binFile)</code>
<code>{</code>
<code>  var inputStream = File.Open(binFile, FileMode.Open);</code>
<code>  using BinaryReader reader = new(inputStream))</code>
<code>  double d = reader.ReadDouble();</code>
<code>  int i = reader.ReadInt32();</code>
<code>  long l = reader.ReadInt64();</code>
<code>  string s = reader.ReadString();</code>
<code>  Console.WriteLine($"d: {d}, i: {i}, l: {l}, s: {s}");</code>
<code>}</code></pre>
                <p id="c18-para-0112" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The order for reading the file must match exactly the order
                    in which it has been written. When creating your own binary format, you need to know what and how it
                    is stored and read accordingly. The older Microsoft Word document format was using a binary file
                    format, whereas the newer <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">docx</code> file
                    extension is a ZIP file containing XML files. How ZIP files can be read and written is explained in
                    the next section.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                读取文件的顺序必须与写入时的顺序完全一致。在创建自己的二进制格式时，你需要知道它存储了什么内容以及如何读取，并据此进行操作。较旧的 Microsoft Word
                                文档格式使用二进制文件格式，而新的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">docx</code>
                                文件扩展名是一个包含 XML 文件的 ZIP 文件。ZIP 文件的读写方式将在下一节中解释。</font>
                        </font>
                    </font>
                </p>
            </section>
        </section>
        <section aria-labelledby="head-2-170" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <span id="c18-sec-0034" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <h2 id="head-2-170" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">COMPRESSING FILES<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">压缩文件</font>
                    </font>
                </font>
            </h2>
            <p id="c18-para-0113" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">.NET includes types to compress and decompress streams using
                different algorithms. You can use <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>, <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GZipStream</code>, and <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BrotliStream</code> to
                compress and decompress streams; the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code> class
                enables you to create and read ZIP files.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">.NET 包含用于使用不同算法压缩和解压缩流的类型。你可以使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>
                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GZipStream</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BrotliStream</code>
                            来压缩和解压缩流； <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code>
                            类使你能够创建和读取 ZIP 文件。</font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0114" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Both <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code> and
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GZipStream</code> use the
                same algorithm for compression (in fact, <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GZipStream</code> uses <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code> behind
                the scenes), but <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GZipStream</code> adds a
                cyclic redundancy check to detect data corruption. Brotli is a relatively new open-source compression
                algorithm from Google. The speed of Brotli is similar to deflate, but it offers a better compression.
                Contrary to most other compression algorithms, it uses a dictionary for often-used words for better
                compression. Nowadays, this algorithm is supported by most modern browsers.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1"> <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GZipStream</code>
                            都使用相同的压缩算法（实际上， <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GZipStream</code>
                            在后台使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>
                            ），但 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GZipStream</code>
                            添加了循环冗余校验来检测数据损坏。Brotli 是来自 Google 的一种相对较新的开源压缩算法。Brotli 的速度与 deflate
                            相似，但提供了更好的压缩效果。与其他大多数压缩算法不同，它使用字典来存储常用词汇以实现更好的压缩。如今，这种算法得到了大多数现代浏览器的支持。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1"><span aria-label="506" epub:type="pagebreak" id="Page_506"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>Using a ZIP file has
                the advantage that you can compress files to an archive (with <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code>), and you
                can open this archive directly with Windows Explorer; it's been built into Windows since 1998. You can't
                open a gzip archive with Windows Explorer; you need third-party tools for gzip.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用 ZIP 文件的优势在于你可以将文件压缩成归档文件（使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code>
                            ），并且可以直接用 Windows 资源管理器打开这个归档文件；自 1998 年起它就内置在 Windows 系统中了。你不能用 Windows 资源管理器打开 gzip
                            归档文件；你需要第三方工具来处理 gzip。</font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <p id="c18-para-0116" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">The algorithm used by
                        </i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> and </i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GZipStream</code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> is the deflate
                            algorithm. This algorithm is defined by RFC 1951 (</i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="https://tools.ietf.org/html/rfc1951">https://tools.ietf.org/html/rfc1951</a></code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">). This algorithm is
                            widely thought not to be covered by patents, which is why it is in widespread use.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GZipStream</code>
                                    使用的算法是 deflate 算法。该算法由 RFC 1951（ <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="https://tools.ietf.org/html/rfc1951">https://tools.ietf.org/html/rfc1951</a></code>
                                    ）定义。普遍认为这个算法不受专利保护，这也是它被广泛使用的原因。</font>
                            </font>
                        </font>
                    </p>
                    <p id="c18-para-0117" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1"><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Brotli is available
                            on GitHub at </i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="https://github.com/google/brotli">https://github.com/google/brotli</a></code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> and defined by RFC
                            7932 (</i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="https://tools.ietf.org/html/rfc7932">https://tools.ietf.org/html/rfc7932</a></code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">). Brotli works great
                            for compressing text files. You can try to compress a large text file with the deflate and
                            Brotli algorithms, and you will see an impressive difference.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">Brotli 可在 GitHub 上获取 <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="https://github.com/google/brotli">https://github.com/google/brotli</a></code>
                                    ，并由 RFC 7932（ <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="https://tools.ietf.org/html/rfc7932">https://tools.ietf.org/html/rfc7932</a></code>
                                    ）定义。Brotli 非常适合压缩文本文件。你可以尝试使用 deflate 和 Brotli 算法压缩一个大的文本文件，你会看到令人印象深刻的差异。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                </section>
            </aside>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0036"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-342" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Using the Deflate Stream <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 Deflate 流</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">As explained earlier, a feature from streams is that you can
                    chain them. To compress a stream, all you need to do is create <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code> and
                    pass another stream (in this example, the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">outputStream</code> to
                    write a file) to the constructor, with the argument <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CompressionMode.Compress</code>
                    for compression. Writing to the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>
                    either by using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code> method or by
                    using other features, such as the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CopyTo</code> method as
                    shown in the following code snippet, is all that's needed for file compression (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CompressFileSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                如前所述，流的一个特性是你可以将它们串联起来。要压缩一个流，你只需要创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>
                                ，并将另一个流（在这个例子中，用于写入文件的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">outputStream</code>
                                ）传递给构造函数，并使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CompressionMode.Compress</code>
                                作为压缩参数。通过使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Write</code>
                                方法或使用其他特性（例如在以下代码片段中显示的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CopyTo</code>
                                方法）向 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>
                                写入，这就是文件压缩所需的一切（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CompressFileSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0041"><code>void CompressFile(string fileName, string compressedFileName)</code>
<code>{</code>
<code>  using FileStream inputStream = File.OpenRead(fileName);</code>
<code>  FileStream outputStream = File.OpenWrite(compressedFileName);</code>
<code>  <b>using DeflateStream compressStream = new(outputStream, CompressionMode.Compress);</b></code>
<code>  <b>inputStream.CopyTo(compressStream);</b></code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">To decompress the deflate-compressed file again, the
                    following code snippet opens the file using a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code> and
                    creates the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>
                    object with <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CompressionMode.Decompress</code>
                    passing the file stream for decompression. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream.CopyTo</code>
                    method copies the decompressed stream to a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MemoryStream</code>. This
                    code snippet then makes use of a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> to
                    read the data from the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MemoryStream</code> and
                    write the output to the console. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> is
                    configured to leave the assigned <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MemoryStream</code> open
                    (using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">leaveOpen</code>
                    argument), so the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MemoryStream</code> could
                    also be used after closing the reader:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要再次解压缩 deflate 压缩的文件，以下代码片段使用
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileStream</code>
                                打开文件，并使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CompressionMode.Decompress</code>
                                传递文件流进行解压缩，创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeflateStream</code>
                                对象。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream.CopyTo</code>
                                方法将解压缩的流复制到 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MemoryStream</code>
                                。此代码片段还利用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                从 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MemoryStream</code>
                                读取数据并将输出写入控制台。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                配置为保留分配的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MemoryStream</code>
                                打开（使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">leaveOpen</code>
                                参数），因此关闭读取器后 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">MemoryStream</code>
                                也可以使用：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0042"><code>void DecompressFile(string fileName)</code>
<code>{</code>
<code>  FileStream inputStream = File.OpenRead(fileName);</code>
<code>  using MemoryStream outputStream = new();</code>
<code>  <b>using DeflateStream compressStream = new(inputStream, CompressionMode.Decompress);</b></code>
<code>  <b>compressStream.CopyTo(outputStream);</b></code>
<code>  outputStream.Seek(0, SeekOrigin.Begin);</code>
<code>  using StreamReader reader = new(outputStream, Encoding.UTF8,</code>
<code>    detectEncodingFromByteOrderMarks: true, bufferSize: 4096,</code>
<code>    leaveOpen: true);</code>
<code>  string result = reader.ReadToEnd();</code>
<code>  Console.WriteLine(result);</code>
<code>  // because of leaveOpen set, you can use the outputStream after </code>
<code>  // the StreamReader is closed, and the StreamReader is closed on its own</code>
<code>}</code></pre>
            </section> <span aria-label="507" epub:type="pagebreak" id="Page_507" role="doc-pagebreak"
                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0037"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-343" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Using Brotli <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 Brotli</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Using <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BrotliStream</code>,
                    compression with Brotli is like using deflate. You just need to instantiate the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BrotliStream</code> class
                    (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CompressFileSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BrotliStream</code>
                                ，Brotli 压缩就像使用 deflate 一样。你只需要实例化 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BrotliStream</code>
                                类（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CompressFileSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0043"><code>void CompressFileWithBrotli(string fileName, string compressedFileName)</code>
<code>{</code>
<code>  using FileStream inputStream = File.OpenRead(fileName);</code>
<code>  FileStream outputStream = File.OpenWrite(compressedFileName);</code>
<code>  <b>using BrotliStream compressStream = new(outputStream, CompressionMode.Compress);</b></code>
<code>  inputStream.CopyTo(compressStream);</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Decompression works like this using <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BrotliStream</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BrotliStream</code>
                                进行解压缩如下：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0044"><code>void DecompressFileWithBrotli(string fileName)</code>
<code>{</code>
<code>  FileStream inputStream = File.OpenRead(fileName);</code>
<code>  using MemoryStream outputStream = new();</code>
<code>  <b>using BrotliStream compressStream = new(inputStream, CompressionMode.Decompress);</b></code>
<code>  compressStream.CopyTo(outputStream);</code>
<code>  outputStream.Seek(0, SeekOrigin.Begin);</code>
<code>  using StreamReader reader = new(outputStream, Encoding.UTF8, </code>
<code>    detectEncodingFromByteOrderMarks: true, bufferSize: 4096, </code>
<code>    leaveOpen: true);</code>
<code>  string result = reader.ReadToEnd();</code>
<code>  Console.WriteLine(result);</code>
<code>}</code></pre>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0038"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-344" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Zipping Files <font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">压缩文件</font>
                        </font>
                    </font>
                </h3>
                <p id="c18-para-0122" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Today, the ZIP file format is the standard for many different
                    file types. Word documents (<code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">docx</code>) as well as
                    NuGet packages are all stored as ZIP files. With .NET, it's easy to create a ZIP archive.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">如今，ZIP 文件格式已成为多种不同文件类型的标准。Word 文档（
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">docx</code>
                                ）以及 NuGet 包都存储为 ZIP 文件。使用 .NET，可以轻松创建 ZIP 存档。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">For creating a ZIP archive, you can create an object of <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code>. A
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code>
                    contains multiple <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchiveEntry</code>
                    objects. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code> class
                    is not a stream, but it uses a stream to read or write to (this is similar to the reader and writer
                    classes discussed earlier). The following code snippet creates a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code> that
                    writes the compressed content to the file stream opened with <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenWrite</code>.
                    What's added to the ZIP archive is defined by the directory passed. <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory.EnumerateFiles</code>
                    enumerates all the files in the directory and creates a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchiveEntry</code>
                    object for every file. Invoking the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Open</code> method
                    creates a <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                    object. With the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CopyTo</code> method of
                    the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code> that
                    is read, the file is compressed and written to the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchiveEntry</code>
                    (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CompressFileSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要创建 ZIP 存档，可以创建一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code>
                                对象。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code>
                                包含多个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchiveEntry</code>
                                对象。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code>
                                类不是流，但它使用流来读取或写入（这与之前讨论的读取器和写入器类类似）。以下代码片段创建了一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchive</code>
                                ，它将压缩内容写入使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">File.OpenWrite</code>
                                打开的文件流。添加到 ZIP 存档的内容由传递的目录定义。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Directory.EnumerateFiles</code>
                                列出目录中的所有文件，并为每个文件创建一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchiveEntry</code>
                                对象。调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Open</code>
                                方法创建一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                对象。使用可读 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CopyTo</code>
                                方法，文件被压缩并写入 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ZipArchiveEntry</code>
                                （代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CompressFileSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0045"><code>void CreateZipFile(string sourceDirectory, string zipFile)</code>
<code>{</code>
<code>  FileStream zipStream = File.Create(zipFile);</code>
<code>  using <b>ZipArchive archive = new(zipStream, ZipArchiveMode.Create);</b></code>
<code> </code>
<code>  IEnumerable&lt;string&gt; files = Directory.EnumerateFiles(</code>
<code>    sourceDirectory, "*", SearchOption.TopDirectoryOnly);</code>
<code>  foreach (var file in files)</code>
<code>  {</code>
<code>    <b>ZipArchiveEntry entry = archive.CreateEntry(Path.GetFileName(file));</b></code>
<code>    using FileStream inputStream = File.OpenRead(file);<span aria-label="508" epub:type="pagebreak" id="Page_508" role="doc-pagebreak"></span></code>
<code>    using Stream outputStream = <b>entry.Open()</b>;</code>
<code>    <b>inputStream.CopyTo(outputStream);</b></code>
<code>  }</code>
<code>}</code></pre>
                <p id="c18-para-0124" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Instead of using streams with extracting entries from a ZIP
                    archive, you can also use the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ExtractToFile</code>
                    method.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">除了使用从 ZIP 存档中提取条目的流，你还可以使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ExtractToFile</code>
                                方法。</font>
                        </font>
                    </font>
                </p>
            </section>
        </section>
        <section aria-labelledby="head-2-171" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <span id="c18-sec-0039" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <h2 id="head-2-171" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">WATCHING FILE CHANGES<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">监控文件变化</font>
                    </font>
                </font>
            </h2>
            <p id="c18-para-0125" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">With <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemWatcher</code>, you
                can monitor file changes. Events are fired on creating, renaming, deleting, and changing files. This can
                be used in scenarios where you need to react to file changes—for example, with a server when a file is
                uploaded, or if a file is cached in memory and the cache needs to be invalidated when the file changes.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemWatcher</code>
                            ，你可以监控文件变化。在文件创建、重命名、删除和更改时都会触发事件。这可以用于需要响应文件变化的场景——例如，当文件上传到服务器时，或者当文件被缓存在内存中且缓存需要在文件更改时失效时。
                        </font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">As <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemWatcher</code> is
                easy to use, let's look at another sample. The sample code starts watching files with the method <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WatchFiles</code>. Using the
                constructor of the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemWatcher</code>, you
                can supply the directory that should be watched. You can also provide a filter to access only specific
                files that match with the filter expression. When you set the property <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IncludeSubdirectories</code>,
                you can define whether only the files in the specified directory should be watched or whether files in
                subdirectories should also be watched. With the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Created</code>, <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Changed</code>, <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Deleted</code>, and <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Renamed</code> events, event
                handlers are supplied. All of these events are of type <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemEventHandler</code>
                with the exception of the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Renamed</code> event that is
                of type <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">RenamedEventHandler</code>.
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">RenamedEventHandler</code>
                derives from <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemEventHandler</code>
                and offers additional information about the event (code file <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileMonitor/Program.cs</code>):
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">由于 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemWatcher</code>
                            易于使用，让我们再来看一个示例。示例代码使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WatchFiles</code>
                            方法开始监控文件。通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemWatcher</code>
                            的构造函数，你可以提供要监控的目录。你也可以提供一个过滤器来访问匹配过滤器表达式的特定文件。当你设置 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IncludeSubdirectories</code>
                            属性时，可以定义是否只监控指定目录中的文件，或者是否也监控子目录中的文件。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Created</code> 、
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Changed</code> 、
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Deleted</code> 和
                            <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Renamed</code>
                            事件，可以提供事件处理程序。所有这些事件都是 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemEventHandler</code>
                            类型，除了 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Renamed</code>
                            事件是 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">RenamedEventHandler</code>
                            类型。 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">RenamedEventHandler</code>
                            继承自 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemEventHandler</code>
                            并提供有关事件的额外信息（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileMonitor/Program.cs</code>
                            ）：</font>
                    </font>
                </font>
            </p>
            <pre id="c18-code-0046"><code><b>FileSystemWatcher? _watcher;</b></code>
<code> </code>
<code>if (args == null || args.Length != 1)</code>
<code>{</code>
<code>    Console.WriteLine("Enter the directory to watch markdown files: " +</code>
<code>      "FileMonitor [directory]");</code>
<code>    return;</code>
<code>}</code>
<code> </code>
<code>WatchFiles(args[0], "*.md");</code>
<code>Console.WriteLine("Press enter to stop watching");</code>
<code>Console.ReadLine();</code>
<code>UnWatchFiles();</code>
<code> </code>
<code>void WatchFiles(string path, string filter)</code>
<code>{</code>
<code>  <b>_watcher = new(path, filter)</b></code>
<code>  {</code>
<code>    <b>IncludeSubdirectories</b> = true</code>
<code>  };</code>
<code>  _watcher.<b>Created</b> += OnFileChanged;</code>
<code>  _watcher.<b>Changed</b> += OnFileChanged;</code>
<code>  _watcher.<b>Deleted</b> += OnFileChanged;</code>
<code>  _watcher.<b>Renamed</b> += OnFileRenamed;</code>
<code>  <b>_watcher.EnableRaisingEvents = true;</b></code>
<code>  Console.WriteLine("watching file changes…");</code>
<code>}</code></pre>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">The information that is received with a file change is of type
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemEventArgs</code>.
                It contains the name of the file that changed as well as the kind of change that is an enumeration of
                type <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WatcherChangeTypes</code>:
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">通过文件更改接收到的信息类型为 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemEventArgs</code>
                            。它包含已更改文件的名称以及更改类型，这是一个类型为 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WatcherChangeTypes</code>
                            的枚举：</font>
                    </font>
                </font><span aria-label="509" epub:type="pagebreak" id="Page_509" role="doc-pagebreak"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span></p>
            <pre id="c18-code-0047"><code>void OnFileChanged(object sender, FileSystemEventArgs e) =&gt;</code>
<code>  Console.WriteLine($"file {e.Name} {e.ChangeType}");</code></pre>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">On renaming the file, additional information is received with the
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">RenamedEventArgs</code>
                parameter. This type derives from <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemEventArgs</code>
                and defines additional information about the original name of the file:<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在重命名文件时，通过 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">RenamedEventArgs</code>
                            参数会接收到额外的信息。该类型派生自 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemEventArgs</code>
                            ，并定义了有关文件原始名称的额外信息：</font>
                    </font>
                </font>
            </p>
            <pre id="c18-code-0048"><code>void OnFileRenamed(object sender, RenamedEventArgs e) =&gt;</code>
<code>  Console.WriteLine($"file {e.OldName} {e.ChangeType} to {e.Name}");</code></pre>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">When you start the application by specifying a folder to watch
                and *
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">.md</code> as the filter,
                the following is the output after creating the file <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">sample1.md</code>, adding
                content, renaming it to <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">sample2.md</code>, and
                finally deleting it:<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">当你通过指定一个文件夹来监视并使用* <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">.md</code>
                            作为过滤器来启动应用程序时，在创建文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">sample1.md</code>
                            、添加内容、将其重命名为 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">sample2.md</code>
                            并最终删除它之后，输出如下：</font>
                    </font>
                </font>
            </p>
            <pre id="c18-code-0049"><code>watching file changes…</code>
<code>Press enter to stop watching</code>
<code>file sample1.md Created</code>
<code>file sample1.md Changed</code>
<code>file sample1.md Renamed to sample2.md</code></pre>
        </section>
        <section aria-labelledby="head-2-172" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <span id="c18-sec-0040" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <h2 id="head-2-172" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">JSON SERIALIZATION<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">JSON 序列化</font>
                    </font>
                </font>
            </h2>
            <p id="c18-para-0130" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">There are many ways to serialize and deserialize .NET objects.
                Binary (also known as <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">runtime
                    serialization</i>), XML, and JSON serialization are built into the .NET base class library (BCL).
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">序列化和反序列化.NET
                            对象有多种方法。二进制（也称为运行时序列化）、XML 和 JSON 序列化都内置于.NET 基础类库（BCL）中。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Binary serialization that serializes all fields has versioning
                issues. If names of private fields change (which can be in a base class), deserialization of content
                that was written with an older version might not work with new versions of the library. Microsoft
                recommends not using binary serialization with the built-in functionality.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">
                            序列化所有字段的二进制序列化存在版本问题。如果私有字段的名称发生变化（这可能发生在基类中），使用较旧版本编写的内容在新版本的库中可能无法正常反序列化。微软建议不要使用内置功能的二进制序列化。
                        </font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <p id="c18-para-0132" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WARNING</b> <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Other than the
                            versioning issues, the </i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryFormatter</code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> (used for binary
                            serialization) is dangerous to use and not recommended for data processing. The </i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Deserialize</code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> method is never safe
                            with untrusted input. This also applies for the </i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SoapFormatter</code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">, </i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NetDataContractSerializer</code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">, </i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">LosFormatter</code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">, and </i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ObjectStateFormatter</code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">. For more details,
                            see </i><code
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="https://docs.microsoft.com/en-us/dotnet/standard/serialization/binaryformatter-security-guide">https://docs.microsoft.com/en-us/dotnet/standard/serialization/binaryformatter-security-guide</a></code><i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">警告 除了版本控制问题外， <code
                                        xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">BinaryFormatter</code>
                                    （用于二进制序列化）使用起来很危险，不推荐用于数据处理。 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Deserialize</code>
                                    方法在处理不可信输入时从不安全。这也适用于 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SoapFormatter</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NetDataContractSerializer</code>
                                    、 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">LosFormatter</code>
                                    和 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ObjectStateFormatter</code>
                                    。更多详情，请参阅 <code xmlns="http://www.w3.org/1999/xhtml"
                                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><a href="https://docs.microsoft.com/en-us/dotnet/standard/serialization/binaryformatter-security-guide">https://docs.microsoft.com/en-us/dotnet/standard/serialization/binaryformatter-security-guide</a></code>
                                    。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                </section>
            </aside>
            <p id="c18-para-0133" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">To serialize objects into XML, classes from the namespace <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Xml.Serialization</code>
                can be used. With the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">XmlSerializer</code>, you can
                serialize .NET objects into XML and use attributes to influence the outcome of the XML result. LINQ to
                XML (<code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Xml.Linq</code>)
                offers an easy way to create XML elements. Windows Communication Foundation (WCF) and SOAP was based on
                XML. Microsoft Office files are ZIP files containing XML. .NET project files and XAML files that create
                user interfaces with WinUI are based on XML. .NET classes working with XML haven't been updated in the
                last years and don't support new features such as C# nominal records.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">要将对象序列化为 XML，可以使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Xml.Serialization</code>
                            命名空间中的类。通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">XmlSerializer</code>
                            ，可以将 .NET 对象序列化为 XML，并使用属性来影响 XML 结果。LINQ to XML ( <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Xml.Linq</code>
                            ) 提供了一种简单的方法来创建 XML 元素。Windows Communication Foundation (WCF) 和 SOAP 都基于 XML。Microsoft
                            Office 文件是包含 XML 的 ZIP 文件。使用 WinUI 创建用户界面的 .NET 项目文件和 XAML 文件都基于 XML。处理 XML 的 .NET
                            类在近几年没有更新，不支持 C# 显式记录等新特性。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Nowadays, JSON serialization is more important. Most
                representational state transfer (REST) services use JSON to transfer data between the client and the
                server. Read <a href="c25.xhtml"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Chapter 25</a>, “Services,”
                for information on how to implement services using REST.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">如今，JSON 序列化更为重要。大多数表示状态转移 (REST) 服务使用
                            JSON 在客户端和服务器之间传输数据。有关如何使用 REST 实现服务的详细信息，请阅读第 25 章，“服务”。</font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <p id="c18-para-0135" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">While JSON is more
                            important with new formats, XML still has many uses. For example, Office files are
                            compressed ZIP files containing XML. .NET project files use XML. Creating user interfaces
                            with WinUI is based on XAML, which is based on XML.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意：虽然 JSON 在新格式中更为重要，但 XML
                                    仍然有许多用途。例如，Office 文件是包含 XML 的压缩 ZIP 文件。.NET 项目文件使用 XML。使用 WinUI 创建用户界面基于 XAML，而 XAML
                                    基于 XML。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                </section>
            </aside>
            <p id="c18-para-0136" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1"><span aria-label="510" epub:type="pagebreak" id="Page_510"
                    role="doc-pagebreak"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>Nowadays, JSON
                serialization is used more often. Not long ago, many of the Microsoft project templates used the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Newtonsoft.Json</code>
                library for JSON serialization. Now, with <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text.Json</code>, a
                new library was created by the .NET team. This library is faster and needs fewer object allocations
                because it is based on new techniques with the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Span</code> type. James
                Newton-King who developed <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Newtonsoft.Json</code> is now
                working for Microsoft.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">如今，JSON 序列化使用得更加频繁。不久前，许多 Microsoft
                            项目模板使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Newtonsoft.Json</code>
                            库进行 JSON 序列化。现在，随着 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text.Json</code>
                            的出现，.NET 团队创建了一个新的库。这个库更快，因为它基于新的 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Span</code>
                            类型技术，需要的对象分配更少。开发 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Newtonsoft.Json</code>
                            的 James Newton-King 现在在为 Microsoft 工作。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">The sample application for JSON serialization is a console
                application using different options from the namespaces <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text.Json</code> and
                <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text.Json.Serialization</code>.
                <font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">用于 JSON 序列化的示例应用程序是一个使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text.Json</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text.Json.Serialization</code>
                            命名空间的不同选项的控制台应用程序。</font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <p id="c18-para-0138" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Other serialization
                            options are shown in <a href="c25.xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Chapter 25</a>
                            and <a href="c28.xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Chapter 28</a>,
                            “SignalR.” In <a href="c25.xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Chapter 25</a>,
                            gRPC Remote Procedure Calls (gRPC) services make use of serialization with Protocol Buffers
                            (Protobuf). SignalR uses JSON by default, but you can easily configure to serialize with the
                            binary format MessagePack.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意 其他序列化选项在《第 25 章》和《第 28
                                    章“SignalR”》中展示。在《第 25 章》中，gRPC 远程过程调用（gRPC）服务使用 Protocol
                                    Buffers（Protobuf）进行序列化。SignalR 默认使用 JSON，但您可以轻松配置为使用二进制格式 MessagePack 进行序列化。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                </section>
            </aside>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0044"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-345" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">JSON Serialization<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">JSON 序列化 </font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">To serialize .NET objects in the JSON format, the records
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Card</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Category</code>, and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Item</code> are
                    specified and contain <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Title</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Text</code>, and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Price</code> properties.
                    A menu card (type <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Card</code>) can contain
                    a list of <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Category</code> objects,
                    and a <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Category</code>
                    contains a list of <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Item</code> objects (code
                    file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">要在 JSON 格式中序列化.NET 对象，指定记录 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Card</code> 、
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Category</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Item</code>
                                ，它们包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Title</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Text</code> 和
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Price</code>
                                属性。菜单卡（类型 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Card</code>
                                ）可以包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Category</code>
                                对象列表，而 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Category</code>
                                包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Item</code>
                                对象列表（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0050"><code>public record Item(string Title, string Text, decimal Price);</code>
<code>public record Category(string Title)</code>
<code>{</code>
<code>    public IList&lt;Item&gt; Items { get; init; } = new List&lt;Item&gt;();</code>
<code>}</code>
<code>public record Card(string Title)</code>
<code>{</code>
<code>    public IList&lt;Category&gt; Categories { get; init; } = new List&lt;Category&gt;();</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">In the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Program.cs</code> file, a
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Card</code> is created
                    that contains two categories and three items, and it is then serialized by invoking the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SerializeJson</code>
                    method:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Program.cs</code>
                                文件中，创建一个包含两个类别和三个项目的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Card</code>
                                ，然后通过调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SerializeJson</code>
                                方法进行序列化：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0051"><code>Category appetizers = new("Appetizers");</code>
<code>appetizers.Items.Add(new Item("Dungeness Crab Cocktail", "Classic cocktail sauce", 27M));</code>
<code>appetizers.Items.Add(new Item("Almond Crusted Scallops", </code>
<code>  "Almonds, Parmesan, chive beurre blanc", 19M));</code>
<code> </code>
<code>Category dinner = new("Dinner");</code>
<code>dinner.Items.Add(new Item("Grilled King Salmon", "Lemon chive beurre blanc", 49M));</code>
<code> </code>
<code>Card = new("The Restaurant");</code>
<code>card.Categories.Add(appetizers);</code>
<code>card.Categories.Add(dinner);</code>
<code> </code>
<code>string json = SerializeJson(card);</code>
<code>DeserializeJson(json);</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">With the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSerializer</code>
                    class, you can invoke the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Serialize</code> method
                    to create a JSON representation of the passed object. Optionally, you can configure the
                    serialization passing configuration with the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSerializerOptions</code>
                    :<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSerializer</code>
                                类，你可以调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Serialize</code>
                                方法来创建传递对象的 JSON 表示。可选地，你可以通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSerializerOptions</code>
                                传递配置进行序列化：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0052"><code>string SerializeJson(Card card)</code>
<code>{<span aria-label="511" epub:type="pagebreak" id="Page_511" role="doc-pagebreak"></span></code>
<code>  Console.WriteLine(nameof(SerializeJson));</code>
<code>  <b>JsonSerializerOptions</b> options = new()</code>
<code>  {</code>
<code>    WriteIndented = true,</code>
<code>    PropertyNamingPolicy = JsonNamingPolicy.CamelCase,</code>
<code>    DictionaryKeyPolicy = JsonNamingPolicy.CamelCase,</code>
<code>    AllowTrailingCommas = true,</code>
<code>    // ReferenceHandler = ReferenceHandler.Preserve</code>
<code>  };</code>
<code>  <b>string json = JsonSerializer.Serialize(card, options);</b></code>
<code>  Console.WriteLine(json);</code>
<code>  Console.WriteLine();</code>
<code>  return json;</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">When you run the application, because the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PropertyNamingPolicy</code>
                    was configured with <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonNamingPolicy.CamelCase</code>,
                    contrary to the property names, the keys are shown with camelCase:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">当你运行应用程序时，因为 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PropertyNamingPolicy</code>
                                被配置为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonNamingPolicy.CamelCase</code>
                                ，与属性名称不同，键以 camelCase 显示：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0053"><code>{</code>
<code>  "title": "The Restaurant",</code>
<code>  "categories": [</code>
<code>    {</code>
<code>      "title": "Appetizers",</code>
<code>      "items": [</code>
<code>        {</code>
<code>          "title": "Dungeon Crab Cocktail",</code>
<code>          "text": "Classic cocktail sauce",</code>
<code>          "price": 27</code>
<code>        },</code>
<code>        {</code>
<code>          "title": "Almond Crusted Scallops",</code>
<code>          "text": "Almonds, Parmesan, chive beurre blanc",</code>
<code>          "price": 19</code>
<code>        }</code>
<code>      ]</code>
<code>    },</code>
<code>    {</code>
<code>      "title": "Dinner",</code>
<code>      "items": [</code>
<code>        {</code>
<code>          "title": "Grilled King Salmon",</code>
<code>          "text": "Lemon chive buerre blanc",</code>
<code>          "price": 49</code>
<code>        }</code>
<code>      ]</code>
<code>    }</code>
<code>  ]</code>
<code>}</code></pre>
                <p id="c18-para-0143" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Other than supplying options, to influence JSON
                    serialization, you can apply attributes to the model to be serialized. With the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonIgnoreAttribute</code>,
                    you can specify that this member should not be serialized. With this attribute you can also specify
                    a condition—for example, to only ignore it when the value is <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">null</code> (<code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonIgnoreCondition.WhenWritingDefault</code>).
                    The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonNumberHandlingAttribute</code>
                    allows you to specify that numbers should be serialized as JSON numbers (without quotes), or with
                    quotes. With the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonConverterAttribute</code>,
                    you can specify to use a custom converter class with types or properties.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">除了提供选项以影响 JSON
                                序列化外，您还可以将属性应用于要序列化的模型。通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonIgnoreAttribute</code>
                                ，您可以指定此成员不应被序列化。使用此属性，您还可以指定一个条件——例如，仅在值为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">null</code> （
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonIgnoreCondition.WhenWritingDefault</code>
                                ）时忽略它。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonNumberHandlingAttribute</code>
                                允许您指定数字应作为 JSON 数字（不带引号）或带引号进行序列化。通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonConverterAttribute</code>
                                ，您可以指定使用自定义转换器类与类型或属性。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><span aria-label="512" epub:type="pagebreak" id="Page_512"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>If you need to
                    serialize an object graph with cyclic references, where objects reference other objects that already
                    have been serialized, the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSerializer</code>
                    couldn't handle this scenario before .NET 5. Since .NET 5, you can configure the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReferenceHandler</code>
                    setting to <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReferenceHandler.Preserve</code>.
                    This setting creates identifiers for every JSON object serialized; thus, the serializer knows what
                    objects already have been serialized, and it can reference these objects by its ID. Use this setting
                    only in scenarios where it is required based on your object tree. Many JSON serializers can't work
                    with this result. The following snippet shows the result with this setting:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">
                                如果你需要序列化一个具有循环引用的对象图，其中对象引用了已经序列化的其他对象，那么在.NET 5 之前， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSerializer</code>
                                无法处理这种情况。自.NET 5 以来，你可以将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReferenceHandler</code>
                                设置配置为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReferenceHandler.Preserve</code>
                                。此设置会为每个序列化的 JSON 对象创建标识符；因此，序列化器知道哪些对象已经被序列化，并且可以通过其 ID
                                引用这些对象。仅在基于你的对象树需要此设置的场景中使用该设置。许多 JSON 序列化器无法处理此结果。以下代码片段显示了使用此设置的结果：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0054"><code>{</code>
<code>  <b>"$id": "1",</b></code>
<code>  "title": "The Restaurant",</code>
<code>  "categories": {</code>
<code>    <b>"$id": "2",</b></code>
<code>    "$values": [</code>
<code>      {</code>
<code>        <b>"$id": "3",</b></code>
<code>        "title": "Appetizers",</code>
<code>        "items": {</code>
<code>          <b>"$id": "4",</b></code>
<code>          "$values": [</code>
<code>            {</code>
<code>              "$id": "5",</code>
<code>              "title": "Dungeon Crab Cocktail",</code>
<code>              "text": "Classic cocktail sauce",</code>
<code>              "price": 27</code>
<code>            },</code>
<code>//…</code></pre>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0045"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-346" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">JSON Deserialization<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">JSON 反序列化 </font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">With the implementation of the method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeserializeJson</code>,
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSerializer.Deserialize</code>
                    is invoked to get the object tree out of the JSON string (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">通过方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DeserializeJson</code>
                                的实现，调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSerializer.Deserialize</code>
                                从 JSON 字符串中获取对象树（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0055"><code>void DeserializeJson(string json)</code>
<code>{</code>
<code>    Console.WriteLine(nameof(DeserializeJson));</code>
<code>    JsonSerializerOptions options = new()</code>
<code>    {</code>
<code>        PropertyNameCaseInsensitive = true</code>
<code>    };</code>
<code>    <b>Card? card = JsonSerializer.Deserialize&lt;Card&gt;(json, options);</b></code>
<code>    if (card is null)</code>
<code>    {</code>
<code>        Console.WriteLine("no card deserialized");</code>
<code>        return;</code>
<code>    }</code>
<code>    Console.WriteLine($"{card.Title}");</code>
<code>    foreach (var category in card.Categories)</code>
<code>    {</code>
<code>        Console.WriteLine($"\t{category.Title}");</code>
<code>        foreach (var item in category.Items)</code>
<code>        {</code>
<code>            Console.WriteLine($"\t\t{item.Title}");</code>
<code>        }</code>
<code>    }</code>
<code>    Console.WriteLine();</code>
<code>}</code></pre>
            </section> <span aria-label="513" epub:type="pagebreak" id="Page_513" role="doc-pagebreak"
                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0046"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-347" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Using JsonDocument<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 JsonDocument </font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">With the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonDocument</code>
                    class, you can access the document object model (DOM) of a JSON document. The static method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonDocument.Parse</code>
                    returns a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonDocument</code>
                    object. With this object you can access the JSON elements and arrays. The root element is accessed
                    with the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonDocument</code>
                    instance <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">document.RootElement</code>.
                    The returned type is a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonElement</code>. This
                    type offers many methods that return specific .NET types—if the data can be converted, for example,
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetBoolean</code>,
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetByte</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetDateTime</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetGuid</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetInt32</code>. Using
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetProperty</code>
                    returns another <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonElement</code>. The
                    previously created JSON document contains the name <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">"categories"</code> that
                    contains an array of items. With this JSON, using <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetProperty("categories")</code>
                    allows to enumerate the array with the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">EnumerateArray</code>
                    method. For every array element, a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonElement</code> is
                    returned. To access the different names and values of an element, you can use <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">EnumerateObject</code>
                    (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonDocument</code>
                                类，你可以访问 JSON 文档的文档对象模型（DOM）。静态方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonDocument.Parse</code>
                                返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonDocument</code>
                                对象。通过这个对象，你可以访问 JSON 元素和数组。根元素通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonDocument</code>
                                实例的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">document.RootElement</code>
                                访问。返回的类型是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonElement</code>
                                ，这个类型提供了许多返回特定 .NET 类型的方法——如果数据可以转换，例如 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetBoolean</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetByte</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetDateTime</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetGuid</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetInt32</code>
                                。使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetProperty</code>
                                返回另一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonElement</code>
                                。先前创建的 JSON 文档包含一个名为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">"categories"</code>
                                的元素，其中包含一个项目数组。使用这个 JSON，通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetProperty("categories")</code>
                                可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">EnumerateArray</code>
                                方法枚举数组。对于每个数组元素，返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonElement</code>
                                。要访问元素的名称和值，你可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">EnumerateObject</code>
                                （代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0056"><code>void UseDom(string json)</code>
<code>{</code>
<code>  Console.WriteLine(nameof(UseDom));</code>
<code> </code>
<code>  using <b>JsonDocument document = JsonDocument.Parse(json);</b></code>
<code>  <b>JsonElement titleElement</b> = document.RootElement.GetProperty("title");</code>
<code>  Console.WriteLine(titleElement);</code>
<code>  foreach (JsonElement category in <b>document.RootElement</b></code>
<code>    <b>.GetProperty("categories").EnumerateArray())</b></code>
<code>  {</code>
<code>    foreach (JsonElement item in <b>category.GetProperty("items").EnumerateArray())</b></code>
<code>    {</code>
<code>      foreach (JsonProperty property in <b>item.EnumerateObject())</b></code>
<code>      {</code>
<code>        Console.WriteLine($"{property.Name} {property.Value}");</code>
<code>      }</code>
<code>      Console.WriteLine($"{item.GetProperty("title")}");</code>
<code>    }</code>
<code>  }</code>
<code>}</code></pre>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0047"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-348" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">JSON Reader</h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">A fast way to read through a JSON document and access all its
                    tokens is by using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Utf8JsonReader</code>. By
                    invoking the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> method, you
                    can access token by token. With the next code snippet, the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> method is
                    used in a <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">while</code>
                    loop. This method returns <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">true</code> as long as
                    it's not the end of the stream. Using the reader in the current iteration, you can access the values
                    with methods such as <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetString</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetInt32</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetDateTime</code>, and
                    also JSON comments with <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetComment</code>. To see
                    what kind of token was just read, you use the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">TokenType</code>
                    property. With the JSON previously generated, if the token type is a property name (<code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonTokenType.PropertyName</code>),
                    and the name of the property is <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">"title"</code>, which is
                    retrieved with the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetString</code> method,
                    the next token that's available on the next <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code> iteration is
                    a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonTokenType.String</code>.
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetString</code> on
                    this token returns the value of the title (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">快速读取 JSON 文档并访问所有标记的一种方法是通过使用
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Utf8JsonReader</code>
                                。通过调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                方法，你可以逐个访问标记。在下一个代码片段中， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                方法在一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">while</code>
                                循环中使用。该方法在不是流末尾时返回 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">true</code>
                                。使用当前迭代的读取器，你可以通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetString</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetInt32</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetDateTime</code>
                                等方法访问值，以及使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetComment</code>
                                访问 JSON 注释。要查看刚刚读取的标记类型，你使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">TokenType</code>
                                属性。对于之前生成的 JSON，如果标记类型是属性名（ <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonTokenType.PropertyName</code>
                                ），并且属性名是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">"title"</code>
                                （通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetString</code>
                                方法获取），那么在下一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Read</code>
                                迭代的下一个标记是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonTokenType.String</code>
                                。对 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">GetString</code>
                                这个标记调用返回标题的值（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0057"><code>void UseReader(string json)</code>
<code>{</code>
<code>  bool isNextPrice = false;</code>
<code>  bool isNextTitle = false;</code>
<code>  string? title = default;</code>
<code>  byte[] data = Encoding.UTF8.GetBytes(json);</code>
<code>  Utf8JsonReader reader = new(data);</code>
<code>  while (reader.Read())</code>
<code>  {<span aria-label="514" epub:type="pagebreak" id="Page_514" role="doc-pagebreak"></span></code>
<code>    if (reader.TokenType == JsonTokenType.PropertyName &amp;&amp; reader.GetString() == "title")</code>
<code>    {</code>
<code>      isNextTitle = true;</code>
<code>    }</code>
<code>    if (reader.TokenType == JsonTokenType.String &amp;&amp; isNextTitle)</code>
<code>    {</code>
<code>      title = reader.GetString();</code>
<code>      isNextTitle = false;</code>
<code>    }</code>
<code>    if (reader.TokenType == JsonTokenType.PropertyName &amp;&amp; reader.GetString() == "price")</code>
<code>    {</code>
<code>      isNextPrice = true;</code>
<code>    }</code>
<code>    if (reader.TokenType == JsonTokenType.Number &amp;&amp; isNextPrice &amp;&amp; </code>
<code>      reader.TryGetDecimal(out decimal price))</code>
<code>    {</code>
<code>      Console.WriteLine($"{title}, price: {price:C}");</code>
<code>      isNextPrice = false;</code>
<code>    }</code>
<code>  }</code>
<code>  Console.WriteLine();</code>
<code>}</code></pre>
            </section>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0048"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-349" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">JSON Writer<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                        <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">JSON 写入器</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Similar to using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Utf8JsonReader</code> to
                    read tokens, you can use the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Utf8Writer</code> to
                    write tokens. The following code snippet creates a JSON document containing an array of <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Book</code> objects that
                    contain <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Title</code>
                    and <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Subtitle</code>
                    properties (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSample/Program.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">类似于使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Utf8JsonReader</code>
                                读取标记，你可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Utf8Writer</code>
                                写入标记。以下代码片段创建了一个包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Book</code>
                                对象数组的 JSON 文档，这些对象包含 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Title</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Subtitle</code>
                                属性（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonSample/Program.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0058"><code>void UseWriter()</code>
<code>{</code>
<code>  using MemoryStream stream = new();</code>
<code> </code>
<code>  JsonWriterOptions options = new()</code>
<code>  {</code>
<code>    Indented = true</code>
<code>  };</code>
<code>  using (<b>Utf8JsonWriter writer = new(stream, options)</b>)</code>
<code>  {</code>
<code>    <b>writer.WriteStartArray();</b></code>
<code>      <b>writer.WriteStartObject();</b></code>
<code>        <b>writer.WriteStartObject("Book");</b></code>
<code>          <b>writer.WriteString("Title", "Professional C# and .NET");</b></code>
<code>          writer.WriteString("Subtitle", "2021 Edition");</code>
<code>        <b>writer.WriteEndObject();</b></code>
<code>      writer.WriteEndObject();</code>
<code>      writer.WriteStartObject();</code>
<code>        writer.WriteStartObject("Book");</code>
<code>          writer.WriteString("Title", "Professional C# 7 and .NET Core 2");</code>
<code>          writer.WriteString("Subtitle", "2018 Edition");</code>
<code>        writer.WriteEndObject();</code>
<code>      writer.WriteEndObject();</code>
<code>    <b>writer.WriteEndArray();</b></code>
<code>  }</code>
<code>  string json = Encoding.UTF8.GetString(stream.ToArray());</code>
<code>  Console.WriteLine(json);<span aria-label="515" epub:type="pagebreak" id="Page_515" role="doc-pagebreak"></span></code>
<code>  Console.WriteLine();</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">This is the generated JSON from the previous code snippet:
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">这是从上一个代码片段生成的 JSON：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0059"><code>[</code>
<code>  {</code>
<code>    "Book": {</code>
<code>      "Title": "Professional C# and .NET",</code>
<code>      "Subtitle": "2021 Edition"</code>
<code>    }</code>
<code>  },</code>
<code>  {</code>
<code>    "Book": {</code>
<code>      "Title": "Professional C# 7 and .NET Core 2",</code>
<code>      "Subtitle": "2018 Edition"</code>
<code>    }</code>
<code>  }</code>
<code>]</code></pre>
            </section>
        </section>
        <section aria-labelledby="head-2-173" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <span id="c18-sec-0049" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <h2 id="head-2-173" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">USING FILES AND STREAMS WITH THE WINDOWS RUNTIME<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">使用 Windows 运行时处理文件和流</font>
                    </font>
                </font>
            </h2>
            <p id="c18-para-0150" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">With the Windows Runtime, you implement streams with native
                types. Although they are implemented with native code, they look like .NET types. However, there's a
                difference you need to be aware of: for streams, the Windows Runtime implements its own types in the
                namespace <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Windows.Storage.Streams</code>.
                Here you can find classes such as <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInputStream</code>, <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileOutputStream</code>, and
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">RandomAccessStreams</code>.
                All these classes are based on interfaces—for example, <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>, <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IOutputStream</code>, and
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStream</code>.
                You'll also find the concept of readers and writers. Windows Runtime readers and writers are the types
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataReader</code> and <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">通过 Windows
                            Runtime，你使用原生类型实现流。尽管它们是用原生代码实现的，但看起来像.NET 类型。然而，有一个你需要注意的区别：对于流，Windows Runtime 在 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Windows.Storage.Streams</code>
                            命名空间中实现了自己的类型。在这里你可以找到诸如 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInputStream</code>
                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileOutputStream</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">RandomAccessStreams</code>
                            之类的类。所有这些类都是基于接口的——例如 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>
                            、 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IOutputStream</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStream</code>
                            。你还会发现读取器和写入器的概念。Windows Runtime 的读取器和写入器是类型 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataReader</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code>
                            。</font>
                    </font>
                </font>
            </p>
            <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Let's look at what's different from the .NET streams you've seen
                so far and how .NET streams and types can map to these native types.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">让我们看看与迄今为止你见过的.NET 流的不同之处，以及.NET
                            流和类型如何映射到这些原生类型。</font>
                    </font>
                </font>
            </p>
            <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <hr />
                </div>
                <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <p id="c18-para-0152" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                        data-immersive-translate-paragraph="1"><b
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Because the WinUI
                            framework is in an early stage, make sure to read the readme file associated with the
                            downloadable sample code for information on how to build and start WinUI applications and
                            for specifics with the samples.</i>
                        <font class="notranslate immersive-translate-target-wrapper"
                            data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                            <font
                                class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                data-immersive-translate-translation-element-mark="1">
                                <font
                                    class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                    data-immersive-translate-translation-element-mark="1">注意：由于 WinUI
                                    框架仍处于早期阶段，请确保阅读与可下载示例代码相关的 readme 文件，以获取有关如何构建和启动 WinUI 应用程序的信息，以及有关示例的具体信息。</font>
                            </font>
                        </font>
                    </p>
                    <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                </section>
            </aside>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0051"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-350" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Windows App Editor </h3>
                <p id="c18-para-0153" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Let's create an editor starting with the WinUI Blank App
                    Visual Studio template.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">让我们从 WinUI 空白应用 Visual Studio
                                模板开始创建一个编辑器。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">To add commands for opening and saving a file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AppBarButton</code>,
                    elements are added to the window (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WinUIAppEditor/MainWindow.xaml</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">为了添加打开和保存文件的功能 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AppBarButton</code>
                                ，需要在窗口中添加元素（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WinUIAppEditor/MainWindow.xaml</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0060"><code>&lt;CommandBar IsOpen="True" Grid.Row="1"&gt;</code>
<code>  &lt;AppBarButton Icon="OpenFile" Label="Open" Click="{x:Bind OnOpen}"/&gt;</code>
<code>  &lt;AppBarButton Icon="Save" Label="Save" Click="{x:Bind OnSave}"/&gt;</code>
<code>&lt;/CommandBar&gt;</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">TextBox</code> added to
                    the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Grid</code> will
                    receive the contents of the file:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">添加到 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Grid</code> 的
                                <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">TextBox</code>
                                将接收文件的内容：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0061"><code>&lt;Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"&gt;</code>
<code>  &lt;<b>TextBox x:Name="text1" HorizontalTextAlignment="Left" AcceptsReturn="True" /</b>&gt;</code>
<code>&lt;/Grid&gt;</code></pre>
                <p id="c18-para-0156" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><span aria-label="516" epub:type="pagebreak" id="Page_516"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OnOpen</code> event
                    handler first starts the dialog where the user can select a file. Remember, you used the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenFileDialog</code>
                    earlier. With Windows apps, you can use pickers. To open files, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileOpenPicker</code> is
                    the preferred type. You can configure this picker to define the proposed start location for the
                    user. You set the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SuggestedStartLocation</code>
                    to <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PickerLocationId.DocumentsLibrary</code>
                    to open the user's documents folder. <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PickerLocationId</code>
                    is an enumeration that defines various special folders.<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OnOpen</code>
                                事件处理器首先启动一个对话框，用户可以在其中选择文件。记住，你之前使用了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenFileDialog</code>
                                。在 Windows 应用中，你可以使用选择器。要打开文件， <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileOpenPicker</code>
                                是首选类型。你可以配置这个选择器来定义用户建议的起始位置。将 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">SuggestedStartLocation</code>
                                设置为 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PickerLocationId.DocumentsLibrary</code>
                                以打开用户的文档文件夹。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PickerLocationId</code>
                                是一个枚举，定义了各种特殊文件夹。</font>
                        </font>
                    </font>
                </p>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Next, the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileTypeFilter</code>
                    collection specifies the file types that should be listed for the user. Finally, the method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PickSingleFileAsync</code>
                    returns the file selected from the user. To allow users to select multiple files, you can use the
                    method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PickMultipleFilesAsync</code>
                    instead. This method returns a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StorageFile</code>. <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StorageFile</code> is
                    defined in the namespace <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Windows.Storage</code>.
                    This class is the equivalent of the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code> class for
                    opening, creating, copying, moving, and deleting files (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WindowsAppEditor/MainWindow.xaml.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">接下来， <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileTypeFilter</code>
                                集合指定了应为用户列出的文件类型。最后，方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PickSingleFileAsync</code>
                                返回用户选择的文件。若要允许用户选择多个文件，您可以使用方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">PickMultipleFilesAsync</code>
                                。此方法返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StorageFile</code>
                                。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StorageFile</code>
                                定义在命名空间 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Windows.Storage</code>
                                中。此类相当于用于打开、创建、复制、移动和删除文件的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileInfo</code>
                                类（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WindowsAppEditor/MainWindow.xaml.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0062"><code>public async void OnOpen()</code>
<code>{</code>
<code>  try</code>
<code>  {</code>
<code>    <b>FileOpenPicker picker = new()</b></code>
<code>    <b>{</b></code>
<code>      <b>ViewMode = PickerViewMode.Thumbnail,</b></code>
<code>      <b>SuggestedStartLocation = PickerLocationId.DocumentsLibrary</b></code>
<code>    <b>};</b></code>
<code>    <b>picker.FileTypeFilter.Add(".txt");</b></code>
<code>    <b>picker.FileTypeFilter.Add(".md");</b></code>
<code> </code>
<code>    <b>StorageFile file = await picker.PickSingleFileAsync();</b></code>
<code>    //…</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Now, open the file using <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenReadAsync</code>.
                    This method returns a stream that implements the interface <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStreamWithContentType</code>,
                    which derives from the interfaces <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStream</code>,
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>,
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IOuputStream</code>,
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IContentProvider</code>,
                    and <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IDisposable</code>.
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStream</code>
                    allows random access to a stream with the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Seek</code> method, and
                    it gives information about the size of a stream. <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>
                    defines the method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadAsync</code> to read
                    from a stream. <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IOutputStream</code> is
                    the opposite; it defines the methods <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WriteAsync</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FlushAsync</code>.
                    <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IContentTypeProvider</code>
                    defines the property <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ContentType</code> that
                    gives information about the content of the file. Remember the encodings of the text files? Now it
                    would be possible to read the content of the stream invoking the method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadAsync</code>.
                    However, the Windows Runtime also knows the reader's and writer's concepts that have already been
                    discussed. A <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataReader</code> accepts
                    an <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>
                    with the constructor. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataReader</code> type
                    defines methods to read primitive data types such as <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadInt16</code>, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadInt32</code>, and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadDateTime</code>.
                    You can read a byte array with <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadBytes</code>, and a
                    string with <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadString</code>. The
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadString</code>
                    method requires the number of characters to read. The string is assigned to the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Text</code> property of
                    the <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">TextBox</code>
                    control to display the content:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在使用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenReadAsync</code>
                                打开文件。这种方法返回一个实现 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStreamWithContentType</code>
                                接口的流，该接口继承自 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStream</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IOuputStream</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IContentProvider</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IDisposable</code>
                                接口。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStream</code>
                                允许通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Seek</code>
                                方法对流进行随机访问，并提供有关流大小的信息。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>
                                定义了从流中读取数据的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadAsync</code>
                                方法。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IOutputStream</code>
                                则相反，它定义了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WriteAsync</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FlushAsync</code>
                                方法。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IContentTypeProvider</code>
                                定义了提供文件内容信息的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ContentType</code>
                                属性。还记得文本文件的编码吗？现在可以通过调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadAsync</code>
                                方法来读取流的内容。然而，Windows 运行时也了解前面讨论过的读取器和写入器的概念。一个 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataReader</code>
                                通过构造函数接受一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>
                                。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataReader</code>
                                类型定义了读取基本数据类型（如 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadInt16</code>
                                、 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadInt32</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadDateTime</code>
                                ）的方法。你可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadBytes</code>
                                读取字节数组，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadString</code>
                                读取字符串。 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ReadString</code>
                                方法需要指定要读取的字符数。字符串被分配给 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">TextBox</code>
                                控件的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Text</code>
                                属性以显示内容：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0063"><code>//…</code>
<code>  if (file != null)</code>
<code>  {</code>
<code>    <b>IRandomAccessStreamWithContentType stream = await file.OpenReadAsync();</b></code>
<code>    <b>using DataReader reader = new(stream);</b></code>
<code>    <b>await reader.LoadAsync((uint)stream.Size);</b></code>
<code>    <b>text1.Text = reader.ReadString((uint)stream.Size);</b></code>
<code>  }</code>
<code>}</code>
<code>catch (Exception ex)</code>
<code>{</code>
<code>  MessageDialog dlg = new(ex.Message, "Error");</code>
<code>  await dlg.ShowAsync();</code>
<code>}</code></pre>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span aria-label="517"
                        epub:type="pagebreak" id="Page_517" role="doc-pagebreak"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span></p>
                <aside data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <div class="top hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <hr />
                    </div>
                    <section class="feature2" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <p id="c18-para-0160" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                            data-immersive-translate-paragraph="1"><b
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">NOTE</b> <i
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Like the readers
                                and the writers of the .NET base class library, the </i> <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataReader</code>
                            <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> and </i> <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code>
                            <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> manage the stream
                                that is passed with the constructor. On disposing of the reader or writer, the stream
                                gets disposed of as well. With .NET classes, to keep the underlying stream open for a
                                longer time, you can set the </i> <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">leaveOpen</code>
                            <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"> argument in the
                                constructor. With the Windows Runtime types, you can detach the stream from the readers
                                and writers by invoking the method </i> <code
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DetachStream</code>
                            <i data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">.</i>
                            <font class="notranslate immersive-translate-target-wrapper"
                                data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                                <font
                                    class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                                    data-immersive-translate-translation-element-mark="1">
                                    <font
                                        class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                        data-immersive-translate-translation-element-mark="1">注意与.NET 基础类库的读取器和写入器一样，
                                        <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataReader</code>
                                        和 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code>
                                        管理通过构造函数传递的流。在释放读取器或写入器时，流也会被释放。使用.NET 类时，为了保持底层流更长时间开放，可以在构造函数中设置 <code
                                            xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">leaveOpen</code>
                                        参数。使用 Windows 运行时类型时，可以通过调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                            data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DetachStream</code>
                                        方法将流从读取器和写入器中分离。</font>
                                </font>
                            </font>
                        </p>
                        <div class="bottom hr" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <hr />
                        </div>
                    </section>
                </aside>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">On saving the document, the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OnSave</code> method is
                    invoked. First, <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSavePicker</code> is
                    used to allow the user to select the document—similarly to <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileOpenPicker</code>.
                    Next, the file is opened using <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenTransactedWriteAsync</code>.
                    The NTFS file system supports transactions; these are not covered directly from the base class
                    libraries but are available with the Windows Runtime. <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenTransactedWriteAsync</code>
                    returns a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StorageStreamTransaction</code>
                    object that implements the interface <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IStorageStreamTransaction</code>.
                    This object itself is not a stream (although the name might lead you to believe this), but it
                    contains a stream that you can reference with the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code> property.
                    This property returns an <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStream</code>
                    stream. As you can create a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataReader</code>, you
                    can create a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code> to
                    write primitive data types, including strings as in this example. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StoreAsync</code> method
                    finally writes the content from the buffer to the stream. The transaction needs to be committed by
                    invoking the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CommitAsync</code> method
                    before disposing of the writer:<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">在保存文档时，会调用 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OnSave</code>
                                方法。首先，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSavePicker</code>
                                来允许用户选择文档——类似于 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileOpenPicker</code>
                                。接下来，使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenTransactedWriteAsync</code>
                                打开文件。NTFS 文件系统支持事务；这些事务不直接从基础类库中涵盖，但可以通过 Windows 运行时获得。 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">OpenTransactedWriteAsync</code>
                                返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StorageStreamTransaction</code>
                                对象，该对象实现了 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IStorageStreamTransaction</code>
                                接口。这个对象本身不是流（尽管名字可能会让你这样认为），但它包含一个可以通过 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                属性引用的流。这个属性返回一个 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStream</code>
                                流。由于你可以创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataReader</code>
                                ，因此可以创建 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code>
                                来写入基本数据类型，包括本例中的字符串。最后，通过调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StoreAsync</code>
                                方法将缓冲区的内容写入流。在释放写入器之前，需要通过调用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">CommitAsync</code>
                                方法提交事务：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0064"><code>public async void OnSave()</code>
<code>{</code>
<code>  try</code>
<code>  {</code>
<code>    FileSavePicker picker = new()</code>
<code>    {</code>
<code>      SuggestedStartLocation = PickerLocationId.DocumentsLibrary,</code>
<code>      SuggestedFileName = "New Document"</code>
<code>    };</code>
<code>    picker.FileTypeChoices.Add("Plain Text", new List&lt;string&gt;() { ".txt" });</code>
<code>    StorageFile file = await picker.PickSaveFileAsync();</code>
<code>    if (file != null)</code>
<code>    {</code>
<code>      <b>using StorageStreamTransaction tx = await file.OpenTransactedWriteAsync();</b></code>
<code>      IRandomAccessStream stream = tx.Stream;</code>
<code>      stream.Seek(0);</code>
<code>      using DataWriter writer = new(stream);</code>
<code>      writer.WriteString(text1.Text);</code>
<code>      tx.Stream.Size = await writer.StoreAsync();</code>
<code>      await tx.CommitAsync();</code>
<code>    }</code>
<code>  }</code>
<code>  catch (Exception ex)</code>
<code>  {</code>
<code>    MessageDialog dlg = new(ex.Message, "Error");</code>
<code>    await dlg.ShowAsync();</code>
<code>  }</code>
<code>}</code></pre>
                <p id="c18-para-0162" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code> doesn't
                    add the preamble defining the kind of Unicode file to the stream. You need to do that explicitly, as
                    explained earlier in this chapter. The <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code> just
                    deals with the encoding of the file by setting the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">UnicodeEncoding</code>
                    and <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ByteOrder</code>
                    properties. The default setting is <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">UnicodeEncoding.Utf8</code>
                    and <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ByteOrder.BigEndian</code>.
                    Instead of working with the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code>, you
                    can also take advantage of the features of <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> and
                    <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code> as
                    well as the .NET <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code> class, as
                    shown in the next section.<font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1"> <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code>
                                不会向流中添加定义 Unicode 文件类型的预处理器。你需要像本章前面解释的那样显式地完成这一操作。 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code>
                                只处理文件的编码，通过设置 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">UnicodeEncoding</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ByteOrder</code>
                                属性。默认设置是 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">UnicodeEncoding.Utf8</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">ByteOrder.BigEndian</code>
                                。除了使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">DataWriter</code>
                                ，你还可以利用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                和 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                以及.NET <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                类的功能，如下一节所示。</font>
                        </font>
                    </font>
                </p>
            </section> <span aria-label="518" epub:type="pagebreak" id="Page_518" role="doc-pagebreak"
                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <section data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><span id="c18-sec-0053"
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
                <h3 id="head-3-351" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Mapping Windows Runtime Types to . NET Types<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">将 Windows 运行时类型映射到.NET 类型</font>
                        </font>
                    </font>
                </h3>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">Let's start with reading the file. To convert a Windows
                    Runtime stream to a .NET stream for reading, you can use the extension method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AsStreamForRead</code>.
                    This method is defined in the namespace <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO</code> (that
                    must be opened) in the assembly <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Runtime.WindowsRuntime</code>.
                    This method creates a new <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code> object that
                    manages the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>. Now,
                    you can use it as a normal .NET stream, as shown previously—for example, passing it to a <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code> and
                    using this reader to access the file (code file <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WindowsAppEditor/MainWindow.xaml.cs</code>):
                    <font class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">让我们从读取文件开始。要将 Windows 运行时流转换为.NET
                                流以进行读取，您可以使用扩展方法 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AsStreamForRead</code>
                                。此方法定义在必须打开的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO</code>
                                命名空间中的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Runtime.WindowsRuntime</code>
                                程序集中。此方法创建一个新的 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                                对象来管理 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>
                                。现在，您可以使用它作为普通的.NET 流，如之前所示——例如，将其传递给 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamReader</code>
                                ，并使用此读取器来访问文件（代码文件 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">WindowsAppEditor/MainWindow.xaml.cs</code>
                                ）：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0065"><code>public async void OnOpenDotnet()</code>
<code>{</code>
<code>  try</code>
<code>  {</code>
<code>    FileOpenPicker picker = new()</code>
<code>    {</code>
<code>      ViewMode = PickerViewMode.Thumbnail,</code>
<code>      SuggestedStartLocation = PickerLocationId.DocumentsLibrary</code>
<code>    };</code>
<code>    picker.FileTypeFilter.Add(".txt");</code>
<code>    picker.FileTypeFilter.Add(".md");</code>
<code> </code>
<code>    StorageFile file = await picker.PickSingleFileAsync();</code>
<code>    if (file != null)</code>
<code>    {</code>
<code>      IRandomAccessStreamWithContentType wrtStream =</code>
<code>        await file.OpenReadAsync();</code>
<code>      <b>Stream stream = wrtStream.AsStreamForRead();</b></code>
<code>      <b>using StreamReader reader = new(stream);</b></code>
<code>      <b>text1.Text = await reader.ReadToEndAsync();</b></code>
<code>    }</code>
<code>  }</code>
<code>  catch (Exception ex)</code>
<code>  {</code>
<code>    MessageDialog dlg = new(ex.Message, "Error");</code>
<code>    await dlg.ShowAsync();</code>
<code>  }</code>
<code>}</code></pre>
                <p id="c18-para-0164" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1">All the Windows Runtime stream types can easily be converted
                    to .NET streams and the other way around. The following table lists the methods needed:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">所有 Windows 运行时流类型都可以轻松转换为.NET
                                流，反之亦然。下表列出了所需的方法：</font>
                        </font>
                    </font>
                </p>
                <table border="1" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                    <thead data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <tr data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <th class="left bgcolor2" scope="col"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1">CONVERT FROM<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">从...转换</font>
                                    </font>
                                </font>
                            </th>
                            <th class="left bgcolor2" scope="col"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                                data-immersive-translate-paragraph="1">CONVERT TO<font
                                    class="notranslate immersive-translate-target-wrapper"
                                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  
                                    </font>
                                    <font
                                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                                        data-immersive-translate-translation-element-mark="1">
                                        <font
                                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                            data-immersive-translate-translation-element-mark="1">到...转换</font>
                                    </font>
                                </font>
                            </th>
                            <th class="left bgcolor2" scope="col">METHOD</th>
                        </tr>
                    </thead>
                    <tbody data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                        <tr data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AsStream</code>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AsStreamForRead</code>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IOutputStream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AsStreamForWrite</code>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IInputStream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AsInputStream</code>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IOutputStream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AsOutputStream</code>
                            </td>
                        </tr>
                        <tr data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Stream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">IRandomAccessStream</code>
                            </td>
                            <td class="left bgcolor3"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"><code
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AsRandomAccessStream</code>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <p data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                    data-immersive-translate-paragraph="1"><span aria-label="519" epub:type="pagebreak" id="Page_519"
                        role="doc-pagebreak"
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>Now save the
                    change to the file as well. The stream for writing is converted with the extension method <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AsStreamForWrite</code>.
                    Now, this stream can be written using the <code
                        data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                    class. The code snippet also writes the preamble for the UTF-8 encoding to the file:<font
                        class="notranslate immersive-translate-target-wrapper"
                        data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                        <font
                            class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                            data-immersive-translate-translation-element-mark="1">
                            <font
                                class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                                data-immersive-translate-translation-element-mark="1">现在也将更改保存到文件中。使用扩展方法 <code
                                    xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">AsStreamForWrite</code>
                                将流转换为写入模式。现在，可以使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">StreamWriter</code>
                                类向该流中写入数据。代码片段还将 UTF-8 编码的前导信息写入文件：</font>
                        </font>
                    </font>
                </p>
                <pre id="c18-code-0066"><code>public async void OnSaveDotnet()</code>
<code>{</code>
<code>  try</code>
<code>  {</code>
<code>    FileSavePicker picker = new()</code>
<code>    {</code>
<code>      SuggestedStartLocation = PickerLocationId.DocumentsLibrary,</code>
<code>      SuggestedFileName = "New Document"</code>
<code>    };</code>
<code>    picker.FileTypeChoices.Add("Plain Text", new List&lt;string&gt;() { ".txt" });</code>
<code>    StorageFile file = await picker.PickSaveFileAsync();</code>
<code>    if (file != null)</code>
<code>    {</code>
<code>      StorageStreamTransaction tx = await file.OpenTransactedWriteAsync();</code>
<code>      <b>using var writer = new StreamWriter(tx.Stream.AsStreamForWrite());</b></code>
<code>      <b>byte[] preamble = Encoding.UTF8.GetPreamble();</b></code>
<code>      <b>await stream.WriteAsync(preamble, 0, preamble.Length);</b></code>
<code>      <b>await writer.WriteAsync(text1.Text);</b></code>
<code>      <b>await writer.FlushAsync();</b></code>
<code>      <b>tx.Stream.Size = (ulong)stream.Length;</b></code>
<code>      <b>await tx.CommitAsync();</b></code>
<code>    }</code>
<code>  }</code>
<code>  catch (Exception ex)</code>
<code>  {</code>
<code>    MessageDialog dlg = new(ex.Message, "Error");</code>
<code>    await dlg.ShowAsync();</code>
<code>  }</code>
<code>}</code></pre>
            </section>
        </section>
        <section aria-labelledby="head-2-174" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">
            <span id="c18-sec-0054" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"></span>
            <h2 id="head-2-174" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">SUMMARY<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN">
                    <font class="notranslate" data-immersive-translate-translation-element-mark="1">  </font>
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-inline-wrapper-theme-none immersive-translate-target-translation-inline-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">摘要</font>
                    </font>
                </font>
            </h2>
            <p id="c18-para-0167" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">In this chapter, you examined how to use the .NET classes with
                static and instance methods to access the file system from your C# code. For the file system, you used
                APIs to copy, move, create, and delete files and folders; and you used streams to read and write binary
                and text files.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在本章中，你学习了如何使用.NET 类中的静态和实例方法从
                            C#代码中访问文件系统。对于文件系统，你使用了 API 来复制、移动、创建和删除文件和文件夹；你还使用了流来读取和写入二进制和文本文件。</font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0168" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">You saw how to compress files using the deflate and the Brotli
                algorithm, and you created ZIP files. You used <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemWatcher</code> to
                get information when files change.<font class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">你了解了如何使用 deflate 和 Brotli 算法压缩文件，并创建了
                            ZIP 文件。你使用了 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">FileSystemWatcher</code>
                            来获取文件变化时的信息。</font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0169" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">In using the new <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text.Json</code>
                namespace and the new performant JSON serializer, you've seen easy ways to serialize and deserialize
                .NET objects into and from JSON. You've also seen other options to deal with JSON files, such as
                accessing the DOM with the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonDocument</code> and
                directly accessing the tokens from JSON with the <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Utf8JsonReader</code> and
                <code data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Utf8JsonWriter</code>.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">在使用新的 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.Text.Json</code>
                            命名空间和新的高性能 JSON 序列化器时，你看到了将.NET 对象序列化和反序列化为 JSON 的简单方法。你还看到了处理 JSON 文件的其他选项，例如使用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">JsonDocument</code>
                            访问 DOM，以及使用 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Utf8JsonReader</code>
                            和 <code xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">Utf8JsonWriter</code>
                            直接访问 JSON 中的令牌。</font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0170" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">Finally, you've seen how to map .NET streams to Windows Runtime
                streams to take advantage of .NET features within Windows apps.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">最后，你学习了如何将.NET 流映射到 Windows 运行时流，以便在
                            Windows 应用中利用.NET 功能。</font>
                    </font>
                </font>
            </p>
            <p id="c18-para-0171" data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f"
                data-immersive-translate-paragraph="1">The next chapter continues working with streams, sending streams
                across the network, and making use of <code
                    data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO.Pipelines</code>
                for efficient communication across the network.<font
                    class="notranslate immersive-translate-target-wrapper"
                    data-immersive-translate-translation-element-mark="1" lang="zh-CN"><br />
                    <font
                        class="notranslate immersive-translate-target-translation-theme-none immersive-translate-target-translation-block-wrapper-theme-none immersive-translate-target-translation-block-wrapper"
                        data-immersive-translate-translation-element-mark="1">
                        <font
                            class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-none-inner"
                            data-immersive-translate-translation-element-mark="1">下一章将继续处理流，通过网络发送流，并利用 <code
                                xmlns="http://www.w3.org/1999/xhtml"
                                data-immersive-translate-walked="03daeb6a-a64f-40c4-aebd-45114c088b2f">System.IO.Pipelines</code>
                            实现高效的跨网络通信。</font>
                    </font>
                </font>
            </p>
        </section>
    </section>
</body>
<div id="immersive-translate-popup" style="all: initial"></div>

</html>